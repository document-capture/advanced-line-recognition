OBJECT Page 6085597 CDC Document Lines ListPart
{
  OBJECT-PROPERTIES
  {
    Date=30.03.21;
    Time=12:00:00;
    Modified=Yes;
    Version List=DCW17.00.00.7.00,ALR;
  }
  PROPERTIES
  {
    CaptionML=[DEU=CDC Document Lines ListPart;
               ENU=CDC Document Lines ListPart];
    LinksAllowed=No;
    SourceTable=Table6085596;
    PageType=ListPart;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             IdentifierVisible := TRUE;
           END;

    OnOpenPage=BEGIN
                 IdentifierVisible := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       UpdateTranslInfo;
                       FillSortingBuffer;
                     END;

    OnNewRecord=BEGIN
                  "Document No." := Document."No.";
                  "Template No." := Document."Template No.";
                  "Translate to Type" := 0;
                  "Translate to No." := '';

                  IF NOT BelowxRec THEN BEGIN
                    xRecLineNo := xRec."Line No.";
                    "Line No." := 0
                  END ELSE
                    "Line No." := GetLastLineNo + 1;

                  CurrLineNo := "Line No.";
                END;

    OnInsertRecord=BEGIN
                     xRecLineNo := 0;

                     IF NOT BelowxRec THEN
                       ManuallyInsertLine(xRec."Line No.");
                     EXIT(TRUE);
                   END;

    OnDeleteRecord=VAR
                     Value@1000000000 : Record 6085593;
                   BEGIN
                     Value.SETCURRENTKEY("Document No.","Is Value",Type,"Page No.","Line No.");
                     Value.SETRANGE("Document No.",Document."No.");
                     Value.SETRANGE("Is Value",TRUE);
                     Value.SETRANGE(Type,Value.Type::Line);
                     Value.SETRANGE("Line No.","Line No.");
                     Value.DELETEALL;
                     EXIT(TRUE);
                   END;

    OnAfterGetCurrRecord=BEGIN
                           CurrLineNo := "Line No.";
                         END;

    ActionList=ACTIONS
    {
      { 1160040000;  ;ActionContainer;
                      Name=ActionItems;
                      ActionContainerType=ActionItems }
      { 1160040002;1 ;ActionGroup;
                      Name=Line;
                      CaptionML=[DEU=&Zeile;
                                 ENU=&Line];
                      Image=Line }
      { 1160040001;2 ;Action    ;
                      Name=Card;
                      CaptionML=[DEU=Karte;
                                 ENU=Card];
                      ToolTipML=[DEU=Zeigt detaillierte Informationen ber den in der Belegzeile oder Buchungsblattzeile befindlichen Datensatz an oder „ndert diese.;
                                 ENU=View or change detailed information about the record on the document or journal line.];
                      Image=EditLines;
                      OnAction=BEGIN
                                 Rec.ShowCard;
                               END;
                                }
      { 3       ;1   ;ActionGroup;
                      Name=TranslationsGr;
                      CaptionML=[DEU=šbersetzungen;
                                 ENU=&Translations];
                      Image=Track }
      { 6       ;2   ;Action    ;
                      Name=NoTranslation;
                      CaptionML=[DEU=Nr.;
                                 ENU=No.];
                      ToolTipML=[DEU=šbersetzungen fr Nr. anzeigen oder bearbeiten.;
                                 ENU=View or edit No. translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSalesTransl@1001 : Codeunit 6085707;
                               BEGIN
                                 PurchSalesTransl.ShowItemNoTrans(Document);
                               END;
                                }
      { 5       ;2   ;Action    ;
                      Name=DescriptionTranslation;
                      CaptionML=[DEU=Beschreibung;
                                 ENU=Description];
                      ToolTipML=[DEU=šbersetzungen fr Beschreibung anzeigen oder bearbeiten.;
                                 ENU=View or edit Description translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSalesTransl@1001 : Codeunit 6085707;
                               BEGIN
                                 PurchSalesTransl.ShowDescriptionTrans(Document);
                               END;
                                }
      { 4       ;2   ;Action    ;
                      Name=UOM;
                      CaptionML=[DEU=Einheit;
                                 ENU=Unit of Measure];
                      ToolTipML=[DEU=šbersetzungen fr Einheit anzeigen oder bearbeiten.;
                                 ENU=View or edit Unit of Measure translations.];
                      Visible=ShowUOMTranslation;
                      Image=Track;
                      OnAction=VAR
                                 PurchSalesTransl@1001 : Codeunit 6085707;
                               BEGIN
                                 IF "Translate to Type" = "Translate to Type"::Item THEN
                                   PurchSalesTransl.ShowUOMTrans(Document,"Translate to No.")
                                 ELSE
                                   PurchSalesTransl.ShowUOMTrans(Document,'');
                               END;
                                }
      { 8       ;2   ;Action    ;
                      Name=CrossReferences;
                      CaptionML=[DEU=Artikelreferenzen;
                                 ENU=Cross References];
                      ToolTipML=[DEU=Richtet eine eigene šbersetzung des ausgew„hlten Artikel fr den Debitor oder Kreditor ein. Artikelreferenzen auf die Artikelnummer des Debitors bedeuten, dass ihre Artikelnummer automatisch anstelle der von Ihnen verwendeten Nummer auf den Verkaufsbelegen angezeigt wird.;
                                 ENU=Set up a customer's or vendor's own identification of the selected item. Cross-references to the customer's item number means that the item number is automatically shown on sales documents instead of the number that you use.];
                      Image=Change;
                      OnAction=VAR
                                 ItemReferenceMgt@6085574 : Codeunit 6086026;
                               BEGIN
                                 ItemReferenceMgt.ShowItemReference(Document."Source Record Table ID",Document."Source Record No.");
                               END;
                                }
      { 100061000;1  ;ActionGroup;
                      Name=AdvancedLineRecognition;
                      CaptionML=[DAN=Avanceret linjegenkendelse;
                                 DEU=Erw. Zeilenerkennung;
                                 ENU=Adv. line recognition;
                                 FRA=Recon. avanc‚e de ligne;
                                 NLD=Geavanceerde lijnherkenning];
                      Image=SetupLines }
      { 100061001;2  ;Action    ;
                      Name=SearchByLinkedField;
                      CaptionML=[DAN=Find v‘rdi ved hj‘lp af forbundet felt;
                                 DEU=Suche ber verknpftes Feld;
                                 ENU=Find value by linked field;
                                 FRA=Find value by linked field;
                                 NLD=Vind waarde via gekoppeld veld];
                      ToolTipML=[DAN=Det ›nskede felt bliver fundet via en fast forskydning (afstand) fra et andet felt.;
                                 DEU=Das gewnschte Feld wird ber einen fest definiertes Offset (Abstand) von einem anderen Feld gefunden.;
                                 ENU=The desired field is found via a fixed offset (distance) from another field.;
                                 FRA=The desired field is found via a fixed offset (distance) from another field.;
                                 NLD=Het gewenste veld wordt gevonden via een vaste offset (afstand) uit een ander veld.
                                 ];
                      Promoted=Yes;
                      Image=Link;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1000000000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.SetToAnchorLinkedField(Rec);
                               END;
                                }
      { 100061002;2  ;Action    ;
                      Name=SearchByColumnHeading;
                      CaptionML=[DAN=Find v‘rdi ved hj‘lp af kolonneoverskrift;
                                 DEU=Feld mit Spaltenberschrift;
                                 ENU=Find value by column heading;
                                 FRA=Find value by column heading;
                                 NLD=Vind waarde via kolomkoptekst];
                      ToolTipML=[DAN=Der s›ges efter det ›nskede felt ved hj‘lp af en tidligere anvendt kolonneoverskrift i omr†det for den aktuelle position.;
                                 DEU=Das gewnschte Feld wird ber eine vorher trainierte Spaltenberschrift im Bereich der aktuellen Position gesucht.;
                                 ENU=The desired field is searched for using a previously trained column heading in the range of the current position.;
                                 FRA=The desired field is searched for using a previously trained column heading in the range of the current position.;
                                 NLD=Het gewenste veld wordt gezocht via een eerder getrainde kolomkop binnen het bereik van de huidige positie.];
                      Promoted=Yes;
                      Image=Table;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1113400000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.SetToFieldSearchWithColumnHeding(Rec);
                               END;
                                }
      { 100061003;2  ;Action    ;
                      Name=SearchByCaption;
                      CaptionML=[DAN=Find v‘rdi ved hj‘lp af overskrift;
                                 DEU=Feld mit Suchtext;
                                 ENU=Find value by caption;
                                 FRA=Find value by caption;
                                 NLD=Vind waarde via bijschrift];
                      ToolTipML=[DAN=Der s›ges efter det ›nskede felt ved hj‘lp af en tidligere anvendt s›getekst/overskrift i omr†det for den aktuelle position.;
                                 DEU=Das gewnschte Feld wird ber einen vorher trainierten Suchtext/Caption im Bereich der aktuellen Position gesucht.;
                                 ENU=The desired field is searched for using a previously trained search text/caption in the area of the current position.;
                                 FRA=The desired field is searched for using a previously trained search text/caption in the area of the current position.;
                                 NLD=Het gewenste veld wordt gezocht via een eerder getrainde zoektekst/bijschrift in het gebied van de huidige positie.];
                      Promoted=Yes;
                      Image=Find;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1113400000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.SetToFieldSearchWithCaption(Rec);
                               END;
                                }
      { 100061004;2  ;Separator  }
      { 100061005;2  ;Action    ;
                      Name=ResetFieldToDefault;
                      CaptionML=[DAN=Nulstil felt;
                                 DEU=Feld zurcksetzen;
                                 ENU=Reset field;
                                 FRA=Reset field;
                                 NLD=Veld opnieuw instellen];
                      ToolTipML=[DAN=De avancerede linjegenkendelsesindstillinger nulstilles til det ›nskede felt.
                                 ;
                                 DEU=Die Einstellungen der erweiterten Zeilenerkennung werden fr das gewnschte Feld zurckgesetzt.;
                                 ENU=The advanced line recognition settings are reset for the desired field.;
                                 FRA=The advanced line recognition settings are reset for the desired field.;
                                 NLD=De geavanceerde lijnherkenning instellingen voor het gewenste veld zijn gereset.];
                      Image=ResetStatus;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.ResetFieldFromMenu(Rec);
                               END;
                                }
      { 100061006;2  ;Action    ;
                      Name=ShowVersionNo;
                      CaptionML=[DAN=Version;
                                 DEU=Version;
                                 ENU=Version;
                                 FRA=Version;
                                 NLD=Versie];
                      ToolTipML=[DAN=Viser den aktuelt benyttede version af avancerede linjegenkendelse.;
                                 DEU=Zeigt die aktuell verwendete Version der erweiterten Zeilenerkennung an.;
                                 ENU=Displays the currently used version of the advanced line detection.;
                                 FRA=Displays the currently used version of the advanced line detection.;
                                 NLD=Toont de momenteel gebruikte versie van de geavanceerde lijnherkenning.];
                      Image=Info;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1160040000 : Codeunit 61000;
                                 YouAreUsingALRVersion@1160040001 : TextConst 'DEU=Sie nutzen die Version %1 der erweiterten Zeilenerkennung.;ENU=You are using version %1 of the advanced line recognition.';
                               BEGIN
                                 MESSAGE(YouAreUsingALRVersion,AdvLineRecognitionMgt.ShowVersionNo);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                Name=ContentArea;
                ContainerType=ContentArea }

    { 6085600;1;Field     ;
                Name=CDC Document Lines ListPart;
                SourceExpr='';
                Visible=IdentifierVisible }

    { 1000000001;1;Group  ;
                Name=Repeater;
                IndentationColumnName=1;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                Name=OK;
                ToolTipML=[DEU=Gibt an, ob die Zeile gltig ist.;
                           ENU=Specifies whether the line is valid.];
                SourceExpr=OK;
                Editable=FALSE }

    { 1   ;2   ;Field     ;
                Name=Translate to Type;
                ToolTipML=[DEU=Gibt die interne Art an, in den die erkannte Nummer bersetzt werden soll.;
                           ENU=Specifies the internal type to translate the recognized number value to.];
                SourceExpr="Translate to Type";
                Editable=AllowEdit }

    { 2   ;2   ;Field     ;
                Name=Translate to No.;
                ToolTipML=[DEU=Gibt die interne Nummer an, in die die erkannte Nummer bersetzt werden soll.;
                           ENU=Specifies the internal number to translate the recognized number value to.];
                SourceExpr="Translate to No.";
                Editable=AllowEdit;
                OnValidate=BEGIN
                             FillSortingBuffer;
                             Document.FIND('=');
                             Document.ValidateDocument;
                           END;

                OnLookup=BEGIN
                           EXIT(LookupTranslToNo(Text));
                         END;
                          }

    { 1000000013;2;Field  ;
                Name=Control1000000013;
                CaptionML=[DEU=Zugeordnete Menge;
                           ENU=Matched Quantity];
                ToolTipML=[DEU=Gibt die mit der Zeile bereinstimmende Menge an.;
                           ENU=Specifies the quantity matched to the line.];
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr=GetMatchedQty;
                Visible=ShowMatchedQty;
                Editable=AllowEdit;
                OnDrillDown=BEGIN
                              ShowMatchSpec;
                            END;
                             }

    { 161024012;2;Field   ;
                Name=Line No.;
                ToolTipML=[DEU=Gibt die Zeilennummer an.;
                           ENU=Specifies the line number.];
                SourceExpr="Line No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1100000000;2;Field  ;
                Name=Field Value 1;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 1";
                CaptionClass=FieldCaptions[1];
                Visible=NoOfColumns >= 1;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(1,"Field Value 1");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(1,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(1);
                             END;
                              }

    { 1100000001;2;Field  ;
                Name=Field Value 2;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 2";
                CaptionClass=FieldCaptions[2];
                Visible=NoOfColumns >= 2;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(2,"Field Value 2");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(2,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(2);
                             END;
                              }

    { 1100000002;2;Field  ;
                Name=Field Value 3;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 3";
                CaptionClass=FieldCaptions[3];
                Visible=NoOfColumns >= 3;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(3,"Field Value 3");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(3,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(3);
                             END;
                              }

    { 1100000003;2;Field  ;
                Name=Field Value 4;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 4";
                CaptionClass=FieldCaptions[4];
                Visible=NoOfColumns >= 4;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(4,"Field Value 4");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(4,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(4);
                             END;
                              }

    { 1100000004;2;Field  ;
                Name=Field Value 5;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 5";
                CaptionClass=FieldCaptions[5];
                Visible=NoOfColumns >= 5;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(5,"Field Value 5");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(5,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(5);
                             END;
                              }

    { 1100000005;2;Field  ;
                Name=Field Value 6;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 6";
                CaptionClass=FieldCaptions[6];
                Visible=NoOfColumns >= 6;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(6,"Field Value 6");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(6,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(6);
                             END;
                              }

    { 1100000006;2;Field  ;
                Name=Field Value 7;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 7";
                CaptionClass=FieldCaptions[7];
                Visible=NoOfColumns >= 7;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(7,"Field Value 7");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(7,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(7);
                             END;
                              }

    { 1100000007;2;Field  ;
                Name=Field Value 8;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 8";
                CaptionClass=FieldCaptions[8];
                Visible=NoOfColumns >= 8;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(8,"Field Value 8");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(8,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(8);
                             END;
                              }

    { 1100000008;2;Field  ;
                Name=Field Value 9;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 9";
                CaptionClass=FieldCaptions[9];
                Visible=NoOfColumns >= 9;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(9,"Field Value 9");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(9,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(9);
                             END;
                              }

    { 1100000009;2;Field  ;
                Name=Field Value 10;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 10";
                CaptionClass=FieldCaptions[10];
                Visible=NoOfColumns >= 10;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(10,"Field Value 10");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(10,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(10);
                             END;
                              }

    { 1000000003;2;Field  ;
                Name=Field Value 11;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 11";
                CaptionClass=FieldCaptions[11];
                Visible=NoOfColumns >= 11;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(11,"Field Value 11");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(11,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(11);
                             END;
                              }

    { 1000000004;2;Field  ;
                Name=Field Value 12;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 12";
                CaptionClass=FieldCaptions[12];
                Visible=NoOfColumns >= 12;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(12,"Field Value 12");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(12,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(12);
                             END;
                              }

    { 1000000005;2;Field  ;
                Name=Field Value 13;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 13";
                CaptionClass=FieldCaptions[13];
                Visible=NoOfColumns >= 13;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(13,"Field Value 13");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(13,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(13);
                             END;
                              }

    { 1000000006;2;Field  ;
                Name=Field Value 14;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 14";
                CaptionClass=FieldCaptions[14];
                Visible=NoOfColumns >= 14;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(14,"Field Value 14");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(14,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(14);
                             END;
                              }

    { 1000000007;2;Field  ;
                Name=Field Value 15;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 15";
                CaptionClass=FieldCaptions[15];
                Visible=NoOfColumns >= 15;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(15,"Field Value 15");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(15,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(15);
                             END;
                              }

    { 1000000008;2;Field  ;
                Name=Field Value 16;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 16";
                CaptionClass=FieldCaptions[16];
                Visible=NoOfColumns >= 16;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(16,"Field Value 16");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(16,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(16);
                             END;
                              }

    { 1000000009;2;Field  ;
                Name=Field Value 17;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 17";
                CaptionClass=FieldCaptions[17];
                Visible=NoOfColumns >= 17;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(17,"Field Value 17");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(17,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(17);
                             END;
                              }

    { 1000000010;2;Field  ;
                Name=Field Value 18;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 18";
                CaptionClass=FieldCaptions[18];
                Visible=NoOfColumns >= 18;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(18,"Field Value 18");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(18,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(18);
                             END;
                              }

    { 1000000011;2;Field  ;
                Name=Field Value 19;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 19";
                CaptionClass=FieldCaptions[19];
                Visible=NoOfColumns >= 19;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(19,"Field Value 19");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(19,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(19);
                             END;
                              }

    { 1000000012;2;Field  ;
                Name=Field Value 20;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 20";
                CaptionClass=FieldCaptions[20];
                Visible=NoOfColumns >= 20;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(20,"Field Value 20");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(20,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(20);
                             END;
                              }

  }
  CODE
  {
    VAR
      Document@1000000010 : Record 6085590;
      DocCat@1160040002 : Record 6085575;
      CaptureMgt@1000000008 : Codeunit 6085576;
      WebClientMgt@6085575 : Codeunit 6085662;
      ShowMatchedQty@1000000001 : Boolean INDATASET;
      AllowEdit@1000000002 : Boolean INDATASET;
      IdentifierVisible@6085600 : Boolean;
      FieldCodes@1001 : ARRAY [20] OF Code[20];
      FieldCaptions@1000 : ARRAY [20] OF Text[250];
      xRecLineNo@6085573 : Integer;
      CurrLineNo@6085574 : Integer;
      NoOfColumns@6085577 : Integer INDATASET;
      ShowUOMTranslation@6085576 : Boolean INDATASET;

    PROCEDURE GetCaptions@1000000002();
    VAR
      Field@1000000003 : Record 6085580;
      Template@1000000001 : Record 6085579;
      I@1000000002 : Integer;
      AddField@1000 : Boolean;
    BEGIN
      CLEAR(FieldCodes);
      CLEAR(FieldCaptions);
      NoOfColumns := 0;

      Field.SETCURRENTKEY("Template No.",Type,"Sort Order");
      Field.SETRANGE("Template No.",Document."Template No.");
      Field.SETRANGE(Type,Field.Type::Line);
      IF Field.FINDSET THEN
        REPEAT
          AddField := TRUE;
          IF Document."File Type" = Document."File Type"::XML THEN BEGIN
            IF Field."Show Field" = Field."Show Field"::IfValue THEN
              IF NOT CaptureMgt.LineFieldHasAnyValues(Document,Field.Code) THEN
                AddField := FALSE;

            IF Field."Show Field" = Field."Show Field"::Never THEN
              AddField := FALSE;
          END;

          IF AddField THEN BEGIN
            I := I + 1;
            FieldCodes[I] := Field.Code;
            FieldCaptions[I] := Field."Field Name";
            NoOfColumns += 1;
          END;
        UNTIL (Field.NEXT = 0) OR (I = 20);

      FOR I := 1 TO 20 DO
        IF FieldCaptions[I] = '' THEN
          FieldCaptions[I] := '-';
    END;

    PROCEDURE SetDocument@1000000003(VAR NewDocument@1000000001 : Record 6085590;BuildTempLines@1000 : Boolean);
    VAR
      Value@1000000003 : Record 6085593;
      Template@1000000005 : Record 6085579;
      i@1000000000 : Integer;
      NoOfLines@1000000004 : Integer;
    BEGIN
      Document := NewDocument;
      ShowUOMTranslation := Document.GetSourceTableNo = DATABASE::Vendor;

      IF NOT DocCat.GET(Document."Document Category Code") THEN
        CLEAR(DocCat);

      DELETEALL;

      GetCaptions;

      IF BuildTempLines THEN
        Document.BuildTempLinesTable(Rec);

      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE UpdatePage@1000000000();
    BEGIN
      UpdateFieldValues;
    END;

    PROCEDURE UpdateFieldValues@1000000006();
    VAR
      Template@1000000002 : Record 6085579;
      Field@1000000000 : Record 6085580;
      i@1000000001 : Integer;
      Update@6085573 : Boolean;
    BEGIN
      IF CurrLineNo > 0 THEN // We store the line number OnAfterGetCurrRecord as the Rec point might be invalid in NAV2017 at the point of invocation (UpdatePage).
        Update := NOT GET("Document No.",CurrLineNo);

      "Field Value 1" := GetValueAsText(FieldCodes[1]);
      "Field Value 2" := GetValueAsText(FieldCodes[2]);
      "Field Value 3" := GetValueAsText(FieldCodes[3]);
      "Field Value 4" := GetValueAsText(FieldCodes[4]);
      "Field Value 5" := GetValueAsText(FieldCodes[5]);
      "Field Value 6" := GetValueAsText(FieldCodes[6]);
      "Field Value 7" := GetValueAsText(FieldCodes[7]);
      "Field Value 8" := GetValueAsText(FieldCodes[8]);
      "Field Value 9" := GetValueAsText(FieldCodes[9]);
      "Field Value 10" := GetValueAsText(FieldCodes[10]);
      "Field Value 11" := GetValueAsText(FieldCodes[11]);
      "Field Value 12" := GetValueAsText(FieldCodes[12]);
      "Field Value 13" := GetValueAsText(FieldCodes[13]);
      "Field Value 14" := GetValueAsText(FieldCodes[14]);
      "Field Value 15" := GetValueAsText(FieldCodes[15]);
      "Field Value 16" := GetValueAsText(FieldCodes[16]);
      "Field Value 17" := GetValueAsText(FieldCodes[17]);
      "Field Value 18" := GetValueAsText(FieldCodes[18]);
      "Field Value 19" := GetValueAsText(FieldCodes[19]);
      "Field Value 20" := GetValueAsText(FieldCodes[20]);

      AllowEdit := Document.Status = Document.Status::Open;

      IF WebClientMgt.IsWebClient AND Update THEN BEGIN
        DELETEALL;
        Document.BuildTempLinesTable(Rec);
        CurrPage.UPDATE(FALSE);
      END ELSE
        IF LineIsInserted("Document No.",CurrLineNo) THEN
          CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE LineIsInserted@1(DocumentNo@1001 : Code[20];LineNo@1002 : Integer) : Boolean;
    VAR
      TempDocumentLine@1000 : TEMPORARY Record 6085596;
    BEGIN
      TempDocumentLine.COPY(Rec,TRUE);
      EXIT(TempDocumentLine.GET(DocumentNo,LineNo));
    END;

    PROCEDURE GetValueAsText@1000000008(FieldCode@1000000000 : Code[20]) : Text[250];
    VAR
      Field@1000000001 : Record 6085580;
    BEGIN
      IF Field.GET(Document."Template No.",Field.Type::Line,FieldCode) THEN
        EXIT(CaptureMgt.GetValueAsText(Document."No.","Line No.",Field));
    END;

    PROCEDURE UpdateFieldValue@1000000007(ActiveFieldIndex@1000000003 : Integer;VAR NewValue@1000000000 : Text[250]);
    VAR
      Field@1000000004 : Record 6085580;
      Value@1000000002 : Record 6085593;
    BEGIN
      IF xRecLineNo <> 0 THEN BEGIN
        ManuallyInsertLine(xRecLineNo);
        xRecLineNo := 0;
      END;

      Field.GET(Document."Template No.",Field.Type::Line,FieldCodes[ActiveFieldIndex]);
      CaptureMgt.UpdateFieldValue(Document."No.","Page No.","Line No.",Field,NewValue,TRUE,TRUE);
      NewValue := GetValueAsText(FieldCodes[ActiveFieldIndex]);

      ValidateLine;
      IF MODIFY THEN;

      UpdatePage;
    END;

    PROCEDURE Assist@1000000011(ActiveFieldIndex@1000000001 : Integer);
    VAR
      TemplateFieldCard@6085573 : Page 6085586;
      Field@1000000000 : Record 6085580;
    BEGIN
      Field.GET(Document."Template No.",Field.Type::Line,FieldCodes[ActiveFieldIndex]);
      Field.SETRECFILTER;
      TemplateFieldCard.SetDocumentNo(Document."No.");
      TemplateFieldCard.SETTABLEVIEW(Field);
      TemplateFieldCard.RUN;
    END;

    PROCEDURE LookupValue@1000000004(ActiveFieldIndex@1000000001 : Integer;VAR Text@1000000002 : Text[1024]) : Boolean;
    VAR
      Field@1000000000 : Record 6085580;
      NewText@1000000003 : Text[1024];
    BEGIN
      Field.GET(Document."Template No.",Field.Type::Line,FieldCodes[ActiveFieldIndex]);
      NewText := CaptureMgt.LookupValue("Document No.",Field,"Line No.",Text);
      IF NewText <> '' THEN BEGIN
        Text := NewText;
        EXIT(TRUE);
      END;
    END;

    PROCEDURE GetMatchedQty@1000000005() : Decimal;
    VAR
      PurchDocMatch@1000000000 : Record 6085700;
    BEGIN
      PurchDocMatch.SETRANGE("Document No.",Document."No.");
      PurchDocMatch.SETRANGE("Document Line No.","Line No.");
      PurchDocMatch.CALCSUMS(Quantity);
      EXIT(PurchDocMatch.Quantity);
    END;

    PROCEDURE SetShowMatchedQty@1000000001(NewShowMatchedQty@1000000000 : Boolean);
    BEGIN
      ShowMatchedQty := NewShowMatchedQty;
    END;

    PROCEDURE ValidateLine@1160040000();
    VAR
      Template@1160040000 : Record 6085579;
    BEGIN
      IF Template.GET(Document."Template No.") AND (Template."Codeunit ID: Line Validation" <> 0) THEN
        CODEUNIT.RUN(Template."Codeunit ID: Line Validation",Rec)
      ELSE
        OK := TRUE;
    END;

    PROCEDURE HasLines@6085573() : Boolean;
    BEGIN
      IF COUNT = 0 THEN
        EXIT(FALSE)
      ELSE
        IF COUNT = 1 THEN BEGIN
          IF ("Field Value 1" = '') AND
            ("Field Value 2" = '') AND
            ("Field Value 3" = '') AND
            ("Field Value 4" = '') AND
            ("Field Value 5" = '') AND
            ("Field Value 6" = '') AND
            ("Field Value 7" = '') AND
            ("Field Value 8" = '') AND
            ("Field Value 9" = '') AND
            ("Field Value 10" = '') AND
            ("Field Value 11" = '') AND
            ("Field Value 12" = '') AND
            ("Field Value 13" = '') AND
            ("Field Value 14" = '') AND
            ("Field Value 15" = '') AND
            ("Field Value 16" = '') AND
            ("Field Value 17" = '') AND
            ("Field Value 18" = '') AND
            ("Field Value 19" = '') AND
            ("Field Value 20" = '')
          THEN
            EXIT(FALSE);
        END;
      EXIT(TRUE);
    END;

    BEGIN
    END.
  }
}

