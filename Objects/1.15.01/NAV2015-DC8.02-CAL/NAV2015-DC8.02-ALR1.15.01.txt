OBJECT Table 6085580 CDC Template Field
{
  OBJECT-PROPERTIES
  {
    Date=14-04-22;
    Time=12:00:00;
    Modified=Yes;
    Version List=DCW13.70.00.8.01,ALR1.15;
  }
  PROPERTIES
  {
    DataCaptionFields=Type,Code,Field Name;
    OnInsert=VAR
               Template@1000000000 : Record 6085579;
             BEGIN
               IF "Language Code" = '' THEN BEGIN
                 Template.GET("Template No.");
                 "Language Code" := Template."Language Code";
               END;

               "Source Table Filter GUID" := CREATEGUID;
               SetOrderRecords;
             END;

    OnDelete=VAR
               TemplField@161024012 : Record 6085580;
               Rule@1000000002 : Record 6085583;
               Caption@1000000000 : Record 6085581;
               Translation@1000000001 : Record 6085582;
               DataTransl@1160040001 : Record 6085584;
               RecIDMgt@1160040000 : Codeunit 6085604;
             BEGIN
               IF ("G/L Account Field Code" <> '') AND ("G/L Account Field Code" <> Code) THEN BEGIN
                 TemplField.SETRANGE("Template No.","Template No.");
                 TemplField.SETRANGE(Type,Type);
                 TemplField.SETRANGE("G/L Account Field Code","G/L Account Field Code");
                 IF TemplField.COUNT = 1 THEN
                   IF TemplField.GET("Template No.",Type,"G/L Account Field Code") THEN
                     TemplField.DELETE(TRUE);
               END;

               Rule.SETRANGE("Template No.","Template No.");
               Rule.SETRANGE(Type,Type);
               Rule.SETRANGE(Code,Code);
               Rule.DELETEALL(TRUE);

               Caption.SETRANGE("Template No.","Template No.");
               Caption.SETRANGE(Type,Type);
               Caption.SETRANGE(Code,Code);
               Caption.DELETEALL(TRUE);

               Translation.SETRANGE("Template No.","Template No.");
               Translation.SETRANGE(Type,Type);
               Translation.SETRANGE(Code,Code);
               Translation.DELETEALL(TRUE);

               DataTransl.SETRANGE("Template No.","Template No.");
               DataTransl.SETRANGE(Type,Type);
               DataTransl.SETRANGE("Field Code",Code);
               DataTransl.DELETEALL(TRUE);

               RecIDMgt.DeleteTableFilter("Source Table Filter GUID");
             END;

    CaptionML=ENU=Template Field;
    LookupPageID=Page6085602;
    DrillDownPageID=Page6085602;
  }
  FIELDS
  {
    { 1   ;   ;Template No.        ;Code20        ;TableRelation="CDC Template";
                                                   CaptionML=ENU=Template No.;
                                                   NotBlank=Yes }
    { 2   ;   ;Type                ;Option        ;CaptionML=ENU=Type;
                                                   OptionCaptionML=ENU=Header,Line;
                                                   OptionString=Header,Line }
    { 3   ;   ;Code                ;Code20        ;CaptionML=ENU=Code;
                                                   NotBlank=Yes }
    { 4   ;   ;Data Type           ;Option        ;OnValidate=VAR
                                                                GLSetup@161024012 : Record 98;
                                                                Template@161024013 : Record 6085579;
                                                              BEGIN
                                                                SetFixedValue('');

                                                                IF "Data Type" <> "Data Type"::Lookup THEN
                                                                  VALIDATE("Source Table No.",0);

                                                                IF "Data Type" = "Data Type"::Number THEN BEGIN
                                                                  GLSetup.GET;
                                                                  VALIDATE("Decimal Places",GLSetup."Amount Decimal Places");
                                                                  VALIDATE("Blank Zero",TRUE);
                                                                END;

                                                                IF "Data Type" = "Data Type"::Date THEN BEGIN
                                                                  Template.GET("Template No.");
                                                                  "Date Format" := Template."Date Format" + 1;
                                                                END;

                                                                IF NOT ("Data Type" IN ["Data Type"::Text,"Data Type"::Date]) THEN
                                                                  "Enable Rule Generation" := FALSE;
                                                              END;

                                                   CaptionML=ENU=Data Type;
                                                   OptionCaptionML=ENU=Text,Number,Date,Boolean,,,,,Lookup;
                                                   OptionString=Text,Number,Date,Boolean,,,,,Lookup }
    { 5   ;   ;Required            ;Boolean       ;CaptionML=ENU=Required }
    { 6   ;   ;Search for Value    ;Boolean       ;CaptionML=ENU=Search for Value }
    { 7   ;   ;Caption Is Part Of Value;Boolean   ;CaptionML=ENU=Caption Is Part Of Value }
    { 8   ;   ;Insert on new Templates;Boolean    ;InitValue=Yes;
                                                   CaptionML=ENU=Insert on new Templates }
    { 9   ;   ;Number Has Decimals ;Boolean       ;CaptionML=ENU=Number Has Decimals }
    { 10  ;   ;Caption Offset X    ;Integer       ;CaptionML=ENU=Caption Offset X }
    { 11  ;   ;Caption Offset Y    ;Integer       ;CaptionML=ENU=Caption Offset Y }
    { 12  ;   ;Fixed Value (Text)  ;Text250       ;CaptionML=ENU=Fixed Value (Text) }
    { 13  ;   ;Fixed Value (Decimal);Decimal      ;CaptionML=ENU=Fixed Value (Decimal) }
    { 14  ;   ;Fixed Value (Date)  ;Date          ;CaptionML=ENU=Fixed Value (Date) }
    { 15  ;   ;Fixed Value (Lookup);Code20        ;TableRelation=IF (Lookup Table=CONST(Vendor)) Vendor
                                                                 ELSE IF (Lookup Table=CONST(Contact)) Contact
                                                                 ELSE IF (Lookup Table=CONST(Customer)) Customer
                                                                 ELSE IF (Lookup Table=CONST(Job)) Job
                                                                 ELSE IF (Lookup Table=CONST(Item)) Item
                                                                 ELSE IF (Lookup Table=CONST(Fixed Asset)) "Fixed Asset"
                                                                 ELSE IF (Lookup Table=CONST(Employee)) Employee
                                                                 ELSE IF (Lookup Table=CONST(Dimension Value)) "Dimension Value".Code WHERE (Dimension Code=FIELD(Lookup Rel. Code));
                                                   CaptionML=ENU=Fixed Value (Lookup) }
    { 17  ;   ;Validation Dateformula From;DateFormula;
                                                   CaptionML=ENU=Validation Dateformula From }
    { 18  ;   ;Validation Dateformula To;DateFormula;
                                                   CaptionML=ENU=Validation Dateformula To }
    { 19  ;   ;Never use Global Captions;Boolean  ;InitValue=Yes;
                                                   CaptionML=ENU=Never use Global Captions;
                                                   Description=Deprecated NAV }
    { 20  ;   ;Decimal Places      ;Code10        ;CaptionML=ENU=Decimal Places }
    { 21  ;   ;Blank Zero          ;Boolean       ;CaptionML=ENU=Blank Zero }
    { 22  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=ENU=Language Code }
    { 23  ;   ;Enable Rule Generation;Boolean     ;OnValidate=BEGIN
                                                                IF "Enable Rule Generation" THEN
                                                                  IF NOT ("Data Type" IN ["Data Type"::Text,"Data Type"::Date]) THEN
                                                                    ERROR(EnableRuleActivateErr,FIELDCAPTION("Enable Rule Generation"),"Data Type"::Text,"Data Type"::Date);
                                                              END;

                                                   CaptionML=ENU=Enable Rule Generation }
    { 24  ;   ;Multiline           ;Boolean       ;CaptionML=ENU=Multiline }
    { 25  ;   ;Default Page Source ;Option        ;CaptionML=ENU=Default Page Source;
                                                   OptionCaptionML=ENU=First Page,Last Page;
                                                   OptionString=First Page,Last Page }
    { 26  ;   ;Auto Update Caption ;Boolean       ;InitValue=Yes;
                                                   CaptionML=ENU=Auto Update Caption }
    { 27  ;   ;Typical Field Width ;Decimal       ;CaptionML=ENU=Field Width;
                                                   DecimalPlaces=0:5 }
    { 28  ;   ;Auto Update Field Width;Boolean    ;InitValue=Yes;
                                                   CaptionML=ENU=Auto Update Field Width;
                                                   Description=Deprecated NAV }
    { 29  ;   ;Typical Field Height;Decimal       ;CaptionML=ENU=Field Height;
                                                   DecimalPlaces=0:5 }
    { 30  ;   ;Auto Update Field Height;Boolean   ;InitValue=Yes;
                                                   CaptionML=ENU=Auto Update Field Height;
                                                   Description=Deprecated NAV }
    { 31  ;   ;Sort Order          ;Integer       ;CaptionML=ENU=Sort Order }
    { 32  ;   ;Field Name          ;Text50        ;CaptionML=ENU=Field Name }
    { 33  ;   ;Stop Lines Recognition;Option      ;CaptionML=ENU=Stop Lines Recognition;
                                                   OptionCaptionML=ENU=" ,If Caption is on same line,If Value is on same line,If Caption or Value is on same line,If Caption is on same line (continue on next page),If Value is on same line (continue on next page),If Caption or Value is on same line (continue on next page)";
                                                   OptionString=[ ,If Caption is on same line,If Value is on same line,If Caption or Value is on same line,If Caption is on same line (continue on next page),If Value is on same line (continue on next page),If Caption or Value is on same line (continue on next page)] }
    { 34  ;   ;Make Absolute Number;Boolean       ;CaptionML=ENU=Make Absolute Number }
    { 37  ;   ;Lookup Table        ;Option        ;CaptionML=ENU=Lookup Table;
                                                   OptionCaptionML=ENU=" ,Vendor,Contact,Customer,Job,Item,Fixed Asset,Employee,Dimension Value";
                                                   OptionString=[ ,Vendor,Contact,Customer,Job,Item,Fixed Asset,Employee,Dimension Value] }
    { 38  ;   ;Lookup Rel. Code    ;Code20        ;TableRelation=IF (Lookup Table=CONST(Dimension Value)) Dimension;
                                                   CaptionML=ENU=Relation Code }
    { 39  ;   ;Codeunit ID: Is OK  ;Integer       ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   CaptionML=ENU=Codeunit ID: Is OK;
                                                   BlankZero=Yes }
    { 41  ;   ;Codeunit ID: Lookup ;Integer       ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   CaptionML=ENU=Codeunit ID: Lookup;
                                                   BlankZero=Yes }
    { 43  ;   ;Codeunit ID: Validate;Integer      ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   CaptionML=ENU=Codeunit ID: Validate;
                                                   BlankZero=Yes }
    { 45  ;   ;Formula             ;Code250       ;OnValidate=VAR
                                                                CaptureMgt@1160040000 : Codeunit 6085576;
                                                                WebClientManagement@6085574 : Codeunit 6085662;
                                                                TempDec@6085573 : Decimal;
                                                              BEGIN
                                                                SetFormula(Formula);
                                                              END;

                                                   CaptionML=ENU=Formula }
    { 46  ;   ;G/L Account Field Code;Code20      ;TableRelation="CDC Template Field".Code WHERE (Template No.=FIELD(Template No.),
                                                                                                  Type=CONST(Header),
                                                                                                  Data Type=CONST(Text));
                                                   OnLookup=VAR
                                                              TemplateField@6085573 : Record 6085580;
                                                            BEGIN
                                                              TemplateField.FILTERGROUP(4);
                                                              TemplateField.SETRANGE("Template No.","Template No.");
                                                              TemplateField.SETRANGE(Type,TemplateField.Type::Header);
                                                              TemplateField.SETRANGE("Data Type",TemplateField."Data Type"::Text);
                                                              TemplateField.FILTERGROUP(0);
                                                              IF TemplateField.GET("Template No.",TemplateField.Type::Header,"G/L Account Field Code") THEN;
                                                              IF PAGE.RUNMODAL(0,TemplateField) = ACTION::LookupOK THEN
                                                                "G/L Account Field Code" := TemplateField.Code;
                                                            END;

                                                   CaptionML=ENU=G/L Account Field Code }
    { 47  ;   ;Transfer Amount to Document;Option ;CaptionML=ENU=Transfer Amount to Document;
                                                   OptionCaptionML=ENU=" ,If lines are not recognised,Always";
                                                   OptionString=[ ,If lines are not recognised,Always] }
    { 48  ;   ;Subtract from Amount Field;Code20  ;TableRelation="CDC Template Field".Code WHERE (Template No.=FIELD(Template No.),
                                                                                                  Type=FIELD(Type),
                                                                                                  Transfer Amount to Document=FILTER(<>' '));
                                                   OnValidate=BEGIN
                                                                IF "Subtract from Amount Field" = Code THEN
                                                                  ERROR(Text003);
                                                              END;

                                                   CaptionML=ENU=Subtract from Amount Field (on registration) }
    { 49  ;   ;Codeunit ID: Capture Value;Integer ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   CaptionML=ENU=Codeunit ID: Capture Value;
                                                   BlankZero=Yes }
    { 51  ;   ;Purch. Alloc. G/L Account No.;Code20;
                                                   TableRelation="G/L Account";
                                                   CaptionML=ENU=Purch. Alloc. G/L Account No. }
    { 52  ;   ;Date Format         ;Option        ;CaptionML=ENU=Date Format;
                                                   OptionCaptionML=ENU=" ,Day / Month / Year,Month / Day / Year,Year / Day / Month,Year / Month / Day,Day / Year / Month,Month / Year / Day";
                                                   OptionString=[ ,Day / Month / Year,Month / Day / Year,Year / Day / Month,Year / Month / Day,Day / Year / Month,Month / Year / Day] }
    { 53  ;   ;Source Table No.    ;Integer       ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Table));
                                                   OnValidate=VAR
                                                                RecIDMgt@1160040000 : Codeunit 6085604;
                                                                DCLogMgt@1000 : Codeunit 6085658;
                                                              BEGIN
                                                                IF "Source Table No." <> 0 THEN
                                                                  TESTFIELD("Data Type","Data Type"::Lookup);

                                                                DCLogMgt.IsLogActive2("Source Table No.",TRUE);

                                                                IF "Source Table No." = xRec."Source Table No." THEN
                                                                  EXIT;

                                                                RecIDMgt.CheckDocValue(Type = Type::Line,Code,"Template No.",FIELDCAPTION("Source Table No."));
                                                                RecIDMgt.DeleteTableFilter("Source Table Filter GUID");
                                                                CLEAR("Source Table Filter GUID");
                                                                "Fixed Value (Rec. ID Tree ID)" := 0;
                                                                "Source Field No." := RecIDMgt.GetFirstKeyField("Source Table No.");
                                                              END;

                                                   CaptionML=ENU=Source Table No.;
                                                   BlankZero=Yes }
    { 55  ;   ;Source Table Filter GUID;GUID      ;CaptionML=ENU=Source Table Filter GUID }
    { 56  ;   ;Source Field No.    ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Source Table No.));
                                                   OnValidate=VAR
                                                                RecIDMgt@1160040000 : Codeunit 6085604;
                                                              BEGIN
                                                                IF "Source Field No." = xRec."Source Field No." THEN
                                                                  EXIT;

                                                                IF xRec."Source Field No." > 0 THEN
                                                                  RecIDMgt.CheckDocValue(Type = Type::Line,Code,"Template No.",FIELDCAPTION("Source Field No."));

                                                                IF NOT RecIDMgt.PartOfKey("Source Table No.","Source Field No.") THEN
                                                                  ERROR(Text005,FIELDCAPTION("Source Field No."),FIELDCAPTION("Source Table No."));
                                                              END;

                                                   CaptionML=ENU=Source Field No.;
                                                   BlankZero=Yes }
    { 57  ;   ;Destination Header Field No.;Integer;
                                                   TableRelation=Field.No.;
                                                   OnValidate=VAR
                                                                Template@1160040001 : Record 6085579;
                                                                Field@161024013 : Record 2000000041;
                                                                DocCat@161024012 : Record 6085575;
                                                                RecIDMgt@1160040000 : Codeunit 6085604;
                                                              BEGIN
                                                                IF ("Destination Header Field No." = xRec."Destination Header Field No.") OR ("Destination Header Field No." = 0) THEN
                                                                  EXIT;

                                                                Template.GET("Template No.");
                                                                DocCat.GET(Template."Category Code");
                                                                DocCat.TESTFIELD("Destination Header Table No.");

                                                                Field.GET(DocCat."Destination Header Table No.","Destination Header Field No.");
                                                                Field.TESTFIELD(Enabled);
                                                                Field.TESTFIELD(Class,Field.Class::Normal);
                                                              END;

                                                   CaptionML=ENU=Destination Header Field No.;
                                                   BlankZero=Yes }
    { 58  ;   ;No. of Source Table Filters;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("CDC Table Filter Field" WHERE (Table Filter GUID=FIELD(Source Table Filter GUID)));
                                                   CaptionML=ENU=No. of Source Table Filters;
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 59  ;   ;Fixed Value (Rec. ID Tree ID);Integer;
                                                   TableRelation="CDC Record ID Tree";
                                                   CaptionML=ENU=Fixed Value (Rec. ID Tree ID) }
    { 60  ;   ;Destination Line Field No.;Integer ;TableRelation=Field.No.;
                                                   OnValidate=VAR
                                                                Template@1160040001 : Record 6085579;
                                                                Field@161024013 : Record 2000000041;
                                                                DocCat@161024012 : Record 6085575;
                                                                RecIDMgt@1160040000 : Codeunit 6085604;
                                                              BEGIN
                                                                IF ("Destination Line Field No." = xRec."Destination Line Field No.") OR ("Destination Line Field No." = 0) THEN
                                                                  EXIT;

                                                                Template.GET("Template No.");
                                                                DocCat.GET(Template."Category Code");
                                                                DocCat.TESTFIELD("Destination Line Table No.");

                                                                Field.GET(DocCat."Destination Line Table No.","Destination Line Field No.");
                                                                Field.TESTFIELD(Enabled);
                                                                Field.TESTFIELD(Class,Field.Class::Normal);
                                                              END;

                                                   CaptionML=ENU=Destination Line Field No.;
                                                   BlankZero=Yes }
    { 61  ;   ;Delete Blanks       ;Boolean       ;CaptionML=ENU=Delete Blanks }
    { 62  ;   ;Caption Mandatory   ;Boolean       ;CaptionML=ENU=Caption Mandatory }
    { 63  ;   ;Use as Doc. Separator;Boolean      ;OnValidate=BEGIN
                                                                IF NOT "Use as Doc. Separator" THEN
                                                                  EXIT;

                                                                TESTFIELD(Type,Type::Header);
                                                              END;

                                                   CaptionML=ENU=Use as Document Separator }
    { 64  ;   ;Fixed Value (Boolean);Boolean      ;CaptionML=ENU=Fixed Value (Boolean) }
    { 65  ;   ;Offset DPI          ;Integer       ;CaptionML=ENU=Offset DPI }
    { 66  ;   ;Typical Field DPI   ;Integer       ;CaptionML=ENU=Typical Field DPI }
    { 67  ;   ;Transfer Blank Values;Boolean      ;CaptionML=ENU=Transfer Blank Values }
    { 68  ;   ;Calculate Date (Date Formula);DateFormula;
                                                   CaptionML=ENU=Calculate Date (Date Formula) }
    { 100 ;   ;XML Path            ;Text250       ;OnValidate=VAR
                                                                XmlLibrary@1000 : Codeunit 6085573;
                                                              BEGIN
                                                                XmlLibrary.FormatXmlPath("XML Path");
                                                                "XML Path" := XmlLibrary.StripHeaderLineTag(Rec,"XML Path");
                                                              END;

                                                   CaptionML=ENU=XML Path }
    { 101 ;   ;Change Sign         ;Boolean       ;CaptionML=ENU=Change Sign }
    { 102 ;   ;Show Field          ;Option        ;CaptionML=ENU=Show Field;
                                                   OptionCaptionML=ENU=Never,If it has a value,Always;
                                                   OptionString=Never,IfValue,Always }
    { 50001;  ;Replacement Field   ;Code20        ;TableRelation="CDC Template Field".Code WHERE (Template No.=FIELD(Template No.),
                                                                                                  Type=FIELD(Replacement Field Type));
                                                   OnValidate=VAR
                                                                CKLAdvLineRecognitionMgt@1000000000 : Codeunit 61000;
                                                              BEGIN
                                                                IF Rec."Replacement Field" <> '' THEN
                                                                  Rec.VALIDATE("Copy Value from Previous Value", FALSE);
                                                              END;

                                                   CaptionML=[DAN=Erstatningsfelt;
                                                              DEU=Ersatzfeld;
                                                              ENU=Substitution Field;
                                                              FRA=Champ de substitution;
                                                              NLD=Vervangingsveld] }
    { 50002;  ;Linked Field        ;Code20        ;TableRelation="CDC Template Field".Code WHERE (Template No.=FIELD(Template No.),
                                                                                                  Type=CONST(Line));
                                                   CaptionML=[DAN=Ankerfelt;
                                                              DEU=Anker Feld;
                                                              ENU=Anchor Field;
                                                              FRA=Champ d'ancrage;
                                                              NLD=Ankerveld] }
    { 50003;  ;Sorting             ;Integer       ;CaptionML=[DAN=Sortering;
                                                              DEU=Sortierung;
                                                              ENU=Sorting;
                                                              FRA=Tri;
                                                              NLD=Sorteren] }
    { 50004;  ;Field value position;Option        ;CaptionML=[DAN=Feltposition;
                                                              DEU=Feldposition;
                                                              ENU=Field position;
                                                              FRA=Position du champ;
                                                              NLD=Veld positie];
                                                   OptionCaptionML=[DAN=" ,Over standardlinje,Under standardlinje";
                                                                    DEU=" ,Oberhalb Standardzeile,Unterhalb Standardzeile";
                                                                    ENU=" ,Above standard line,Below standard line";
                                                                    FRA=" ,Au-dessus de la ligne standard, en-dessous de la ligne standard";
                                                                    NLD=" ,boven de standaard lijn, onder de standaard lijn"];
                                                   OptionString=[ ,AboveStandardLine,BelowStandardLine] }
    { 50005;  ;Field value search direction;Option;OnValidate=BEGIN
                                                                TESTFIELD("Advanced Line Recognition Type", "Advanced Line Recognition Type"::FindFieldByColumnHeading);
                                                              END;

                                                   CaptionML=ENU=Value search direction;
                                                   OptionCaptionML=[DEU=Abw?rts,Aufw?rts;
                                                                    ENU=Downwards,Upwards];
                                                   OptionString=Downwards,Upwards }
    { 50006;  ;Replacement Field Type;Option      ;OnValidate=BEGIN
                                                                IF xRec."Replacement Field Type" <> Rec."Replacement Field Type" THEN
                                                                                    CLEAR(Rec."Replacement Field");
                                                              END;

                                                   CaptionML=[DEU=Ersatzfeld Art;
                                                              ENU=Replacement field type];
                                                   OptionCaptionML=[DEU=Kopf,Zeile;
                                                                    ENU=Header,Line];
                                                   OptionString=Header,Line }
    { 50007;  ;Copy Value from Previous Value;Boolean;
                                                   OnValidate=BEGIN
                                                                IF Rec."Copy Value from Previous Value" THEN
                                                                  CLEAR(Rec."Replacement Field");
                                                              END;

                                                   CaptionML=[DAN=Kopi?r v?rdi fra tidligere v?rdi;
                                                              DEU=Wert vom vorherigen Wert kopieren;
                                                              ENU=Copy value from previous value;
                                                              FRA=Copier la valeur depuis la valeur pr?c?dente;
                                                              NLD=Kopieer waarde van de vorige lijn] }
    { 50010;  ;Data version        ;Integer       ;CaptionML=[DEU=ALR Daten Version;
                                                              ENU=ALR Data version];
                                                   Editable=No }
    { 50011;  ;Advanced Line Recognition Type;Option;
                                                   CaptionML=[DAN=Avanceret linjegenkendelsestype;
                                                              DEU=Erw. Zeilenerkennung Art;
                                                              ENU=Advanced Line Recognition Type;
                                                              FRA=Type de reconnaissance avanc?e de ligne;
                                                              NLD=Geavanceerde lijnherkenningstype];
                                                   OptionCaptionML=[DAN=Standard,Anker-forbundet felt, Felts?gning med overskrift,Felts?gning med kolonneoverskrift,Gruppev?rdi med overskrift;
                                                                    DEU=Standard,Mit Anker verknÅpftes Feld,Feldsuche mit Caption,Feldsuche mit SpaltenÅberschrift,Gruppierungsfeld mit Caption;
                                                                    ENU=Standard,Anchor linked field,Field search with caption,Field search with column heading;
                                                                    FRA=Standard,Champ li? aux ancrages,Recherche de champ avec l?gende,Recherche de champ avec en-t?te de colonne,Valeur de groupe avec l?gende;
                                                                    NLD=standaard,anker gekoppeld veld,veld zoeken met bijschrift,veld zoeken met kolomhoofding, groepwaarde met bijschrift];
                                                   OptionString=Default,LinkedToAnchorField,FindFieldByCaptionInPosition,FindFieldByColumnHeading }
    { 50012;  ;Offset Top          ;Integer       ;CaptionML=[DAN=Forskydning top;
                                                              DEU=Offset Oben;
                                                              ENU=Offset Top;
                                                              FRA=Hauteur de d?calage;
                                                              NLD=Offset bovenkant] }
    { 50013;  ;Offset Bottom       ;Integer       ;CaptionML=[DAN=Forskydning bund;
                                                              DEU=Offset Unten;
                                                              ENU=Offset Height;
                                                              FRA=Hauteur de d?calage;
                                                              NLD=Offset hoogte] }
    { 50014;  ;Offset Left         ;Integer       ;CaptionML=[DAN=Forskydning venstre;
                                                              DEU=Offset Links;
                                                              ENU=Offset Left;
                                                              FRA=D?calage gauche;
                                                              NLD=Offset linkerkant] }
    { 50015;  ;Offset Right        ;Integer       ;CaptionML=[DAN=Forskydning h?jre;
                                                              DEU=Offset Rechts;
                                                              ENU=Offset Width;
                                                              FRA=Largeur de d?calage;
                                                              NLD=Offset breedte] }
    { 50020;  ;ALR Value Caption Offset X;Integer ;CaptionML=[DAN=Overskriftsforskydning X;
                                                              DEU=Wert Suchtext Offset X;
                                                              ENU=Caption Offset X;
                                                              FRA=D?calage de l?gende X;
                                                              NLD=Offset bijschrift X] }
    { 50021;  ;ALR Value Caption Offset Y;Integer ;CaptionML=[DAN=Overskriftsforskydning Y;
                                                              DEU=Wert Suchtext Offset Y;
                                                              ENU=Caption Offset Y;
                                                              FRA=D?calage de l?gende Y;
                                                              NLD=Offset bijschrift Y] }
    { 50022;  ;ALR Typical Value Field Width;Decimal;
                                                   CaptionML=[DAN=V?rdifeltets typiske bredde;
                                                              DEU=Typische Wert Feldbreite;
                                                              ENU=Field Width;
                                                              FRA=Largeur de champ;
                                                              NLD=Veldbreedte];
                                                   DecimalPlaces=0:5 }
  }
  KEYS
  {
    {    ;Template No.,Type,Code                  ;Clustered=Yes }
    {    ;Template No.,Type,Sort Order             }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Type,Code,Field Name,Required,Search for Value }
  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'ENU=It is not recommended to use space as a seperator in Date Validation Rules as they will be deleted before evaluation. Use a seperator line - or / instead.';
      Text002@161024012 : TextConst 'ENU=Do you also want to delete the field ''%1''?';
      Text003@161024013 : TextConst 'ENU=The field cannot be subtracted from itself';
      Text004@1160040000 : TextConst 'ENU=The record is not within the filters of the %1.';
      Text005@1160040001 : TextConst 'ENU=The %1 is not part of the primary key of the %2.';
      Text006@1160040002 : TextConst 'ENU=Field in %1';
      Text007@1160040011 : TextConst 'ENU=Destination Header Field';
      Text008@1160040010 : TextConst 'ENU=Destination Line Field';
      Text010@1003 : TextConst 'ENU=Updating templates\#1####################\@2@@@@@@@@@@@@@@@@@@@@';
      Text011@1002 : TextConst 'ENU=%1 of %2';
      EnableRuleActivateErr@6085573 : TextConst 'ENU=%1 can only be activated for Date Type %2 or %3.';
      AlwaysOneDecimal@6085574 : TextConst 'ENU=Always 1 decimal';
      AlwaysNoDecimals@6085575 : TextConst 'ENU=Always %1 decimals';
      RangeOfDecimals@6085576 : TextConst 'ENU=%1-%2 decimals';
      WrongExpressionFormat@6085577 : TextConst 'ENU=Enter one number or two numbers separated by a colon. The first number must be less or equal to the second number. Numbers must be between 0 and 9.';
      UnableToParseDecimalExpression@6085578 : TextConst 'ENU=Unable to translate typed expression.';
      InvalidFormulaErr@6085600 : TextConst 'ENU=Formula for Template Field ''%1'' is invalid. It must not end with ''+'', ''-'', ''*'', ''/'', ''^'', ''%''.';
      InvalidFormulaErr2@6085290 : TextConst 'ENU=Formula for Template Field ''%1'' is invalid. It must not begin with ''+'', ''*'', ''/'', ''^'', ''%''.';
      UpdateTemplateQst@1000 : TextConst 'ENU="This will copy the template field %1 (%2) to all templates created from %3 = %4 for the document category %5 where the field doesn''t exist already.\\Do you want to continue?"';
      TemplateUpdatedTxt@6085579 : TextConst 'ENU=1 template was updated.';
      TemplatesUpdatedTxt@6085580 : TextConst 'ENU=%1 templates were updated.';

    PROCEDURE SyncFieldFromMaster@2();
    VAR
      Template@1000 : Record 6085579;
      Field@1001 : Record 6085580;
      Window@1002 : Dialog;
      Total@1003 : Integer;
      FieldsUpdated@1005 : Integer;
      i@1004 : Integer;
      MessageHandler@6086000 : Codeunit 6086011;
    BEGIN
      Template.GET("Template No.");
      Template.TESTFIELD(Type,Template.Type::Master);

      IF NOT CONFIRM(STRSUBSTNO(UpdateTemplateQst,Code,"Field Name",Template.FIELDCAPTION("Master Template No."),Template."No.",
        Template."Category Code"))
      THEN
        EXIT;

      Template.SETFILTER(Type,'<>%1',Template.Type::Master);
      Template.SETRANGE("Master Template No.","Template No.");
      Total := Template.COUNT;

      Window.OPEN(Text010);
      IF Template.FINDSET THEN
        REPEAT
          i += 1;
          Window.UPDATE(1,STRSUBSTNO(Text011,i,Total));
          Window.UPDATE(2,(i / Total * 10000) DIV 1);

          IF NOT Field.GET(Template."No.",Type,Code) THEN BEGIN
            FieldsUpdated += 1;
            Field.Clone('',Rec,Template,TRUE);
          END ;
        UNTIL Template.NEXT = 0;

      Window.CLOSE;
      IF FieldsUpdated = 1 THEN
        MessageHandler.ShowMessageNotification(STRSUBSTNO(TemplateUpdatedTxt),FALSE)
      ELSE
        MessageHandler.ShowMessageNotification(STRSUBSTNO(TemplatesUpdatedTxt,FieldsUpdated),FALSE);
    END;

    PROCEDURE Clone@161024012(FromCompany@1160040002 : Text[30];FromField@1160040003 : Record 6085580;ToTemplate@161024013 : Record 6085579;CreatedFromMasterTemplate@6085581 : Boolean);
    VAR
      ToField@1000000002 : Record 6085580;
      FromFieldRule@1000000010 : Record 6085583;
      ToFieldRule@1000000009 : Record 6085583;
      FromFieldCapt@1000000003 : Record 6085581;
      ToFieldCaption@1000000004 : Record 6085581;
      FromFieldTransl@1000000005 : Record 6085582;
      ToFieldTransl@1000000006 : Record 6085582;
      FromTableFilterFields@1160040000 : Record 6085762;
      ToTableFilterFields@1160040001 : Record 6085762;
      RecIDMgt@1000 : Codeunit 6085604;
      NoOfFromFieldRule@6085573 : Integer;
      Handled@6085600 : Boolean;
    BEGIN
      OnBeforeClone(FromCompany,FromField,ToTemplate,CreatedFromMasterTemplate,Handled);
      IF Handled THEN
        EXIT;

      ToField := FromField;
      ToField."Template No." := ToTemplate."No.";
      IF ToField.FIND('=') THEN
        EXIT;

      IF FromField."Fixed Value (Rec. ID Tree ID)" <> 0 THEN
        ToField.SetFixedValue(RecIDMgt.GetFieldValueInCompany(FromCompany,FromField."Fixed Value (Rec. ID Tree ID)",
          FromField."Source Field No."));
      ToField.INSERT(TRUE);

      IF FromCompany <> '' THEN BEGIN
        FromFieldRule.CHANGECOMPANY(FromCompany);
        FromFieldCapt.CHANGECOMPANY(FromCompany);
        FromFieldTransl.CHANGECOMPANY(FromCompany);
        FromTableFilterFields.CHANGECOMPANY(FromCompany);
      END;

      FromFieldRule.SETRANGE("Template No.",FromField."Template No.");
      FromFieldRule.SETRANGE(Type,FromField.Type);
      FromFieldRule.SETRANGE(Code,FromField.Code);
      IF FromFieldRule.FINDSET THEN BEGIN
        NoOfFromFieldRule := FromFieldRule.COUNT;

        REPEAT
          ToFieldRule := FromFieldRule;
          ToFieldRule."Template No." := ToField."Template No.";
          IF (NoOfFromFieldRule > 1) AND CreatedFromMasterTemplate AND FromField."Enable Rule Generation" THEN
            ToFieldRule."Created from Master Template" := TRUE
          ELSE
            ToFieldRule."Created from Master Template" := FALSE;
          ToFieldRule.INSERT(TRUE);
        UNTIL FromFieldRule.NEXT = 0;
      END;

      FromFieldCapt.SETRANGE("Template No.",FromField."Template No.");
      FromFieldCapt.SETRANGE(Type,FromField.Type);
      FromFieldCapt.SETRANGE(Code,FromField.Code);
      IF FromFieldCapt.FINDSET THEN
        REPEAT
          ToFieldCaption := FromFieldCapt;
          ToFieldCaption."Template No." := ToField."Template No.";
          ToFieldCaption.INSERT(TRUE);
        UNTIL FromFieldCapt.NEXT = 0;

      FromFieldTransl.SETRANGE("Template No.",FromField."Template No.");
      FromFieldTransl.SETRANGE(Type,FromField.Type);
      FromFieldTransl.SETRANGE(Code,FromField.Code);
      IF FromFieldTransl.FINDSET THEN
        REPEAT
          ToFieldTransl := FromFieldTransl;
          ToFieldTransl."Template No." := ToField."Template No.";
          ToFieldTransl.INSERT(TRUE);
        UNTIL FromFieldTransl.NEXT = 0;

      FromTableFilterFields.SETRANGE("Table Filter GUID",FromField."Source Table Filter GUID");
      IF FromTableFilterFields.FINDSET THEN
        REPEAT
          ToTableFilterFields := FromTableFilterFields;
          ToTableFilterFields."Table Filter GUID" := ToField."Source Table Filter GUID";
          ToTableFilterFields.INSERT(TRUE);
        UNTIL FromTableFilterFields.NEXT = 0;
    END;

    PROCEDURE SetFixedValue@1000000000(Value@1000000000 : Text[250]);
    VAR
      RecIDMgt@161024013 : Codeunit 6085604;
      CaptureMgt@1160040001 : Codeunit 6085576;
      RecID@161024012 : Text[30];
      DCLogMgt@1000 : Codeunit 6085658;
    BEGIN
      IF ("Source Table No." <> 0) OR ("Data Type" = "Data Type"::Lookup) THEN BEGIN
        "Fixed Value (Text)" := '';
        IF Value <> '' THEN
          DCLogMgt.IsLogActive("Source Table No.",TRUE);
        "Fixed Value (Rec. ID Tree ID)" := RecIDMgt.SetKeyValueWithGUID("Source Table No.","Source Field No.",0,
          "Source Table Filter GUID",Value,TRUE);
      END;

      CASE "Data Type" OF
        "Data Type"::Text:
          EVALUATE("Fixed Value (Text)",Value);
        "Data Type"::Number:
          IF Value = '' THEN
            "Fixed Value (Decimal)" := 0
          ELSE
            EVALUATE("Fixed Value (Decimal)",Value);
        "Data Type"::Date:
          IF Value = 'TODAY' THEN
            EVALUATE("Fixed Value (Text)",Value)
          ELSE BEGIN
            "Fixed Value (Text)" := '';
            EVALUATE("Fixed Value (Date)",Value);
          END;
        "Data Type"::Boolean:
          IF Value = '' THEN
            "Fixed Value (Boolean)" := FALSE
          ELSE
            CaptureMgt.ParseBoolean(Value,"Fixed Value (Boolean)");
      END;

      IF Value <> '' THEN
        "Search for Value" := FALSE;
    END;

    PROCEDURE GetFixedValue@1000000001() : Text[250];
    VAR
      RecIDMgt@161024012 : Codeunit 6085604;
    BEGIN
      IF ("Source Table No." <> 0) OR ("Data Type" = "Data Type"::Lookup) THEN
        EXIT(RecIDMgt.GetKeyValue("Fixed Value (Rec. ID Tree ID)","Source Field No."));

      CASE "Data Type" OF
        "Data Type"::Text:
          EXIT(FORMAT("Fixed Value (Text)"));
        "Data Type"::Date:
          IF "Fixed Value (Date)" <> 0D THEN
            EXIT(FORMAT("Fixed Value (Date)"))
          ELSE
            EXIT("Fixed Value (Text)");
        "Data Type"::Number:
          IF "Fixed Value (Decimal)" <> 0 THEN
            EXIT(FORMAT("Fixed Value (Decimal)"));
        "Data Type"::Boolean:
          EXIT(FORMAT("Fixed Value (Boolean)"));
      END;
    END;

    PROCEDURE FormulaOnLookup@161024013(VAR Text@161024012 : Text[1024]) : Boolean;
    VAR
      TemplField@161024013 : Record 6085580;
    BEGIN
      TemplField.FILTERGROUP(2);
      TemplField.SETCURRENTKEY("Template No.",Type,"Sort Order");
      TemplField.SETRANGE("Template No.","Template No.");
      TemplField.SETRANGE(Type,Type);
      TemplField.SETFILTER(Code,'<>%1',Code);
      IF "Data Type" = "Data Type"::Number THEN
        TemplField.SETRANGE("Data Type","Data Type");
      TemplField.FILTERGROUP(0);
      IF STRLEN(Text) <= MAXSTRLEN(TemplField.Code) THEN
        IF TemplField.GET("Template No.",Type,Text) THEN;

      IF PAGE.RUNMODAL(0,TemplField) = ACTION::LookupOK THEN BEGIN
        Text := TemplField.Code;
        EXIT(TRUE);
      END;
    END;

    PROCEDURE GetDestFieldCaption@1160040000(FieldType@1160040002 : 'Header,Line') FieldCap : Text[250];
    VAR
      Template@1160040001 : Record 6085579;
      DocCat@1160040000 : Record 6085575;
      AllObjWithCaption@1160040004 : Record 2000000058;
      RecIDMgt@1160040003 : Codeunit 6085604;
    BEGIN
      IF Template.GET("Template No.") THEN
        DocCat.GET(Template."Category Code");

      IF FieldType = FieldType::Header THEN BEGIN
        FieldCap := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Table,DocCat."Destination Header Table No.");
        IF FieldCap = '' THEN
          FieldCap := Text007
        ELSE
          FieldCap := STRSUBSTNO(Text006,FieldCap);
      END ELSE BEGIN
        FieldCap := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Table,DocCat."Destination Line Table No.");
        IF FieldCap = '' THEN
          FieldCap := Text008
        ELSE
          FieldCap := STRSUBSTNO(Text006,FieldCap);
      END;
    END;

    LOCAL PROCEDURE SetOrderRecords@6085573();
    VAR
      SingleInstanceStorage@6085574 : Codeunit 6085789;
      TemplateField@6085573 : Record 6085580;
      TemplateField2@6085576 : Record 6085580;
      i@6085575 : Integer;
    BEGIN
      IF "Sort Order" <> 0 THEN
        EXIT;

      i := SingleInstanceStorage.GetActiveTemplFieldForP6085585;
      IF i = 0 THEN BEGIN
        TemplateField.SETCURRENTKEY("Template No.",Type,"Sort Order");
        TemplateField.SETRANGE("Template No.","Template No.");
        TemplateField.SETRANGE(Type,Type);
        IF TemplateField.FINDLAST THEN
          "Sort Order" := TemplateField."Sort Order" + 1
        ELSE
          "Sort Order" := 1;
      END ELSE BEGIN
        TemplateField.SETRANGE("Template No.","Template No.");
        TemplateField.SETRANGE(Type,Type);
        TemplateField.SETFILTER("Sort Order",'>%1',i);
        IF TemplateField.FINDSET(TRUE,FALSE) THEN
          REPEAT
            TemplateField2.GET(TemplateField."Template No.",TemplateField.Type,TemplateField.Code);
            TemplateField2."Sort Order" := TemplateField2."Sort Order" + 1;
            TemplateField2.MODIFY;
          UNTIL TemplateField.NEXT = 0;

        "Sort Order" := i + 1;
      END;
      SingleInstanceStorage.SetActiveTemplFieldForP6085585("Sort Order");
    END;

    PROCEDURE ValidateDecimalPlaces@6085575(DecimalPlacesDescriptionIn@6085573 : Text[5]) DecimalPlacesDescriptionOut : Text[50];
    VAR
      MinNoOfDecimals@6085578 : Integer;
      MinNoOfDecimalsText@6085580 : Text[10];
      MaxNoOfDecimals@6085579 : Integer;
      MaxNoOfDecimalsText@6085581 : Text[10];
      GenLedgerSetup@6085582 : Record 98;
      ColonPosition@6085583 : Integer;
    BEGIN
      IF NOT ("Data Type" = "Data Type"::Number) THEN
        EXIT('');

      IF NOT CheckDecimalPlacesFormat(DecimalPlacesDescriptionIn) THEN
        ERROR(WrongExpressionFormat);

      VALIDATE("Decimal Places",DecimalPlacesDescriptionIn);
      ColonPosition := STRPOS(DecimalPlacesDescriptionIn,':');
      IF ColonPosition = 0 THEN BEGIN
        IF "Decimal Places" = '1' THEN
          DecimalPlacesDescriptionOut := STRSUBSTNO(AlwaysOneDecimal)
        ELSE
          DecimalPlacesDescriptionOut := STRSUBSTNO(AlwaysNoDecimals,"Decimal Places");
      END ELSE BEGIN
        MinNoOfDecimalsText := COPYSTR(DecimalPlacesDescriptionIn,1,ColonPosition - 1);
        EVALUATE(MinNoOfDecimals,MinNoOfDecimalsText);
        MaxNoOfDecimalsText := COPYSTR(DecimalPlacesDescriptionIn,ColonPosition + 1,STRLEN(DecimalPlacesDescriptionIn));
        EVALUATE(MaxNoOfDecimals,MaxNoOfDecimalsText);
        IF (MinNoOfDecimals = MaxNoOfDecimals) THEN BEGIN
          IF MinNoOfDecimals = 1 THEN
            DecimalPlacesDescriptionOut := STRSUBSTNO(AlwaysOneDecimal)
          ELSE
            DecimalPlacesDescriptionOut := STRSUBSTNO(AlwaysNoDecimals,MinNoOfDecimals);
        END ELSE
          DecimalPlacesDescriptionOut := STRSUBSTNO(RangeOfDecimals,MinNoOfDecimals,MaxNoOfDecimals);
      END;
    END;

    PROCEDURE CheckDecimalPlacesFormat@1(VAR DecimalPlaces@1000 : Text[5]) OK : Boolean;
    VAR
      ColonPlace@1002 : Integer;
      DecimalPlacesPart1@1003 : Integer;
      DecimalPlacesPart2@1004 : Integer;
      Check@1005 : Text[5];
    BEGIN
      // Copied from T98 - need a local copy of the function due to wrong error handling in org. function
      OK := TRUE;
      ColonPlace := STRPOS(DecimalPlaces,':');

      IF ColonPlace = 0 THEN BEGIN
        IF NOT EVALUATE(DecimalPlacesPart1,DecimalPlaces) THEN
          OK := FALSE;
        IF (DecimalPlacesPart1 < 0) OR (DecimalPlacesPart1 > 9) THEN
          OK := FALSE;
      END ELSE BEGIN
        Check := COPYSTR(DecimalPlaces,1,ColonPlace - 1);
        IF Check = '' THEN
          OK := FALSE;
        IF NOT EVALUATE(DecimalPlacesPart1,Check) THEN
          OK := FALSE;
        Check := COPYSTR(DecimalPlaces,ColonPlace + 1,STRLEN(DecimalPlaces));
        IF Check = '' THEN
          OK := FALSE;
        IF NOT EVALUATE(DecimalPlacesPart2,Check) THEN
          OK := FALSE;
        IF DecimalPlacesPart1 > DecimalPlacesPart2 THEN
          OK := FALSE;
        IF (DecimalPlacesPart1 < 0) OR (DecimalPlacesPart1 > 9) THEN
          OK := FALSE;
        IF (DecimalPlacesPart2 < 0) OR (DecimalPlacesPart2 > 9) THEN
          OK := FALSE;
      END;
    END;

    PROCEDURE ParseDecimalPlacesDescription@6085574(DecimalPlacesDescriptionIn@6085573 : Text[50]) DecimalPlacesOut : Text[5];
    VAR
      IntegerVar@6085574 : Integer;
      MinNoOfDecimals@6085577 : Integer;
      MaxNoOfDecimals@6085576 : Integer;
      DashPosition@6085575 : Integer;
      FirstBlankPosition@6085578 : Integer;
      i@6085579 : Integer;
    BEGIN
      FirstBlankPosition := STRPOS(DecimalPlacesDescriptionIn,' ');

      // Expression is of form "blabla X blabla" -> Translate to X (=X:X)
      IF (DecimalPlacesDescriptionIn[FirstBlankPosition+2] = ' ') AND (DecimalPlacesDescriptionIn[FirstBlankPosition+1] IN
        ['0','1','2','3','4','5','6','7','8','9'])
      THEN BEGIN
        DecimalPlacesOut := FORMAT(DecimalPlacesDescriptionIn[FirstBlankPosition+1]);
        EXIT(DecimalPlacesOut);
      END;

      // Expression is of form "X", "X-", "X-Y", "-Y" -> Translate to X:X, X:Y, 0:Y
      DecimalPlacesOut := '';
      DecimalPlacesDescriptionIn := COPYSTR(DecimalPlacesDescriptionIn,1,3);
      FOR i := 1 TO 3 DO
        IF DecimalPlacesDescriptionIn[i] IN ['0','1','2','3','4','5','6','7','8','9','-',':'] THEN
          DecimalPlacesOut += FORMAT(DecimalPlacesDescriptionIn[i]);

      DecimalPlacesOut := CONVERTSTR(DecimalPlacesOut,'-',':');
      IF DecimalPlacesOut[1] = ':' THEN
        DecimalPlacesOut := '0' + DecimalPlacesOut;

      IF CheckDecimalPlacesFormat(DecimalPlacesOut) THEN
        EXIT(DecimalPlacesOut)
      ELSE
        ERROR(UnableToParseDecimalExpression);
    END;

    PROCEDURE SetFormula@6085577(FormulaTxt@6085576 : Text[250]);
    VAR
      CaptureMgt@6085575 : Codeunit 6085576;
      TempDec@6085573 : Decimal;
    BEGIN
      IF FormulaTxt = '' THEN BEGIN
        SetFixedValue(FormulaTxt);
        Formula := '';
        EXIT;
      END;

      IF ("Data Type" = "Data Type"::Number) THEN BEGIN
        CaptureMgt.ValidateNumberFormula("Template No.",FormulaTxt);
        IF EVALUATE(TempDec,FormulaTxt) THEN BEGIN
          SetFixedValue(FormulaTxt);
          Formula := '';
        END ELSE BEGIN
          SetFixedValue('');
          Formula := FormulaTxt;
        END;
      END ELSE
        IF CaptureMgt.ValidateTextFormula("Template No.",FormulaTxt) THEN BEGIN
          // FormulaTxt contains references to Template Fields
          SetFixedValue('');
          Formula := FormulaTxt;
        END ELSE BEGIN
          // No references, so must be Fixed Value
          SetFixedValue(FormulaTxt);
          Formula := '';
        END;

      "Search for Value" := FALSE;
    END;

    PROCEDURE IsFormulaValid@6085600(FormulaTxt@6085601 : Text[250];ShowError@6085600 : Boolean) : Boolean;
    BEGIN
      IF FormulaTxt = '' THEN
        EXIT(TRUE);
      IF "Data Type" <> "Data Type"::Text THEN BEGIN
        IF COPYSTR(FormulaTxt,STRLEN(FormulaTxt),1) IN ['+','-','*','/','^','%'] THEN BEGIN
          // Formula cannot end with an operator
          IF ShowError THEN
            ERROR(STRSUBSTNO(InvalidFormulaErr,Code));
          EXIT(FALSE);
        END;
        IF COPYSTR(FormulaTxt,1,1) IN ['+','*','/','^','%'] THEN BEGIN
          // Formula cannot begin with an operator (except '-')
          IF ShowError THEN
            ERROR(STRSUBSTNO(InvalidFormulaErr2,Code));
          EXIT(FALSE);
        END;
      END;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE OnBeforeClone@6085601(FromCompany@6085600 : Text[30];FromField@6085601 : Record 6085580;ToTemplate@6085602 : Record 6085579;CreatedFromMasterTemplate@6085603 : Boolean;VAR Handled@6085604 : Boolean);
    BEGIN
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 61000 Adv. Line Recognition Mgt.
{
  OBJECT-PROPERTIES
  {
    Date=14-04-22;
    Time=12:00:00;
    Modified=Yes;
    Version List=ALR1.15;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      FieldSetupCanceled@1000000000 : TextConst 'DAN=Feltopsëtning afbrudt fordi intet felt blev valgt!;DEU=Feldeinrichtung abgebrochen, da kein Feld ausgewÑhlt wurde!;ENU=Field setup aborted because no field was selected!;FRA=La configuration du champ a ÇtÇ interrompue car aucun champ n''a ÇtÇ sÇlectionnÇ!
    ;NLD=Veld instellen afgebroken, omdat er geen veld is geselecteerd!';
      FieldIsLinkedToSourceField@1000000001 : TextConst 'DAN=Feltet "%1" er nu forbundet med feltet "%2".;DEU=Das Feld "%1" ist nun mit dem Feld "%2" verknÅpft.;ENU=The field "%1" is now linked to field "%2".;FRA=Le champ "%1" est maintenant liÇ au champ "%2 ".;NLD=Het veld "%1" is nu gekoppeld aan het veld "%2".';
      MissingSourceFieldValue@1000000002 : TextConst 'DAN=Vërdien for kildefeltet %1 i linje %2 mangler! Trën venligst denne vërdi fõrst!;DEU=Der Wert fÅr Herkunftsfeld %1 in Zeile %2 fehlt! Bitte trainieren Sie zuerst diesen Wert an!;ENU=The value for source field %1 in line %2 is missing! Please train this value first!;FRA=La valeur du champ source %1 Ö la ligne %2 est manquante! Veuillez d''abord entraåner cette valeur!;NLD=De waarde voor het bronveld %1 in lijn %2 ontbreekt! train eerst deze waarde!';
      MissingFieldExampleValue@1000000003 : TextConst 'DAN=Vërdien for %1 (%2) i rëkke %3 mangler! Trën venligst denne vërdi fõrst!;DEU=Der Wert fÅr fÅr %1 (%2) Zeile %3 fehlt! Bitte trainieren Sie zuerst diesen Wert an!;ENU=The value for for %1 (%2) row %3 is missing! Please train this value first!;FRA=La valeur de %1 (%2) Ö la ligne %3 est manquante! Veuillez d''abord entraåner cette valeur!;NLD=De waarde voor %1 (%2) in rij %3 ontbreekt! train eerst deze waarde!';
      SelectOffsetSourceFieldFirst@1000000004 : TextConst 'DAN=Vëlg fõrst kildefeltet der skal vëre grundlag for positionen hvor vërdien skal findes.;DEU="Bitte wÑhlen Sie zuerst das Herkunftsfeld aus, an Hand dessen Position der Wert ermittelt werden soll. ";ENU="Please select first the source field on the basis of which position the value should be found. ";FRA=Veuillez d''abord sÇlectionner le champ source sur base duquel la position de la valeur doit àtre trouvÇe.;NLD=Selecteer eerst het bronveld op basis van welke positie de waarde moet worden gevonden.';
      CodeunitDoesNotExist@1000000005 : TextConst 'DAN=Codeunit %1 findes ikke! Er objektet omdõbt?;DEU=Die Standard Codeunit %1 existiert nicht! Wurde das Object ggf. umbenannt?;ENU=Codeunit %1 does not exist! Has the object been renamed?;FRA=Le Codeunit %1 n''existe pas ! L''objet a-t-il ÇtÇ renommÇ?;NLD=Codeunit %1 bestaat niet! Is het object hernoemd?';
      TrainCaptionFirstForField@1113400001 : TextConst 'DAN=Fejl! Feltet %1 er ikke forbundet med en overskrift! MarkÇr venligst overskriften fõrst.;DEU=Fehler! FÅr Feld %1 wurde noch keine Caption hinterlegt! Bitte pflegen Sie die Caption zuerst.;ENU=Error! For the field %1 hasn|t been trained a caption! Please train the caption first.;FRA=Erreur! Pour le champ %1 une lÇgende n''a pas ÇtÇ entraånÇe ! Veuillez d''abord entraåner la lÇgende.;NLD=Fout! Voor het veld %1 is het onderschrift getraind! Train het bijschrift eerst.';
      SelectTheOffsetField@1113400006 : TextConst 'DAN=Vëlg feltet som skal sammenkëdes med kildefeltet "%1".;DEU=WÑhlen Sie nun das Feld aus, welches Sie mit dem Herkunftsfeld "%1" verknÅpfen mîchten.;ENU=Please choose the field, which should be linked with the source field "%1".;FRA=Veuillez choisir le champ qui doit àtre liÇ au champ source "%1".;NLD=Kies het veld, welke gekoppeld moet zijn met het bronveld "%1".';
      ErrorDuringFieldSetup@1113400007 : TextConst 'DAN=Fejl under indstilling af felt.;DEU=Fehler bei Feldeinrichtung.;ENU=Error during field setup.;FRA=Erreur lors de la configuration du champ.;NLD=Fout tijdens het instellen van het veld.';
      SelectFieldForColumnHeaderSearch@1113400008 : TextConst 'DAN=Vëlg det felt der skal findes af kolonneoverskriften.;DEU=Bitte wÑhlen Sie das Feld aus, welches Åber die öberschrift gefunden werden soll.;ENU=Select the field that should be found by the column heading.;FRA=SÇlectionnez le champ qui doit àtre trouvÇ par l''en-tàte de colonne.;NLD=Selecteer het veld dat gevonden moet worden bij de koptekst van de kolom.';
      SelectFieldForCaptionSearch@1113400009 : TextConst 'DAN=Vëlg feltet hvis vërdi skal findes ved hjëlp af overskriften i den aktuelle linje.;DEU="Bitte wÑhlen Sie das Feld aus, welches innerhalb der Position mit Hilfe des Suchbegriffs gefunden werden soll. ";ENU=Choose the field whose value should be found by the caption in the current line.;FRA=Choisir le champ dont la valeur doit àtre trouvÇe par la lÇgende de la ligne actuelle.;NLD=Kies het veld waarvan de waarde in de huidige regel moet gevonden worden op basis van de koptekst.';
      FieldIsCapturedByColumnHeading@1160040001 : TextConst 'DAN=Feltet "%1" bliver nu fundet ved hjëlp af kolonneoverskriften "%2".;DEU="Das Feld ""%1"" wird nun innerhalb der Position Åber die SpaltenÅberschrift ""%2"" gesucht. ";ENU=The field "%1" will now be searched via the column heading "%2".;FRA=Le champ "%1" sera maintenant recherchÇ via l''en-tàte de colonne "%2".;NLD=Het veld "%1" zal nu worden doorzocht via de kolom koptekst "%2".';
      FieldIsCapturedByCaption@1113400010 : TextConst 'DAN=Vërdien i feltet "%1" bliver nu fundet ved hjëlp af kolonneoverskriften i den aktuelle linje.;DEU="Das Feld ""%1"" wird nun innerhalb der Position Åber den Suchtext/Caption gesucht. ";ENU=The value of field "%1" will now been searched via the caption in the current line.;FRA=La valeur du champ "%1" sera maintenant recherchÇe via la lÇgende dans la ligne actuelle.;NLD=De waarde van veld "%1" zal nu gezocht worden via het bijschrift in de huidige regel.';
      NoRequiredFieldFound@1000000006 : TextConst 'DAN=Intet obligatorisk felt med indstillingen "PÜkrëvet" blev fundet i linje %1! Konfigurer et obligatorisk felt fõrst.;DEU=Es wurde kein Zeilenfeld mit der aktivierten Option "Erforderlich" gefunden! Konfigurieren Sie zuerst ein Pflichtfeld.;ENU=No mandatory field with the option "Required" was found in line %1! Configure a mandatory field first.;FRA=Aucun champ obligatoire avec l''option "Requis" n''a ÇtÇ trouvÇ Ö la ligne %1! Configurez d''abord un champ obligatoire.;NLD=Er is geen verplicht veld met de optie "Vereist" gevonden in regel %1! Configureer eerst een verplicht veld.';
      ALRVersionNoText@1160040000 : TextConst 'DAN=ALR%1 (%2 Build %3);DEU=ALR%1 (%2 Build %3);ENU=ALR%1 (%2 Build %3);FRA=ALR%1 (%2 Build %3);NLD=ALR%1 (%2 Build %3)';
      NoALRFieldsForReset@1160040002 : TextConst 'DAN=Der er ikke konfigureret felter til avanceret linjegenkendelse, der kan nulstilles.;DEU=Es gibt keine Felder mit aktivierter erweiterter Zeilenerkennung, die zurÅckgesetzt werden kînnen.'';ENU=There are not fields configured for advanced line recognition, that can be reset.;FRA=Il n''y a pas de champs configurÇs pour la reconnaissance de ligne avancÇe, qui peuvent àtre rÇinitialisÇs.;NLD=Er zijn geen velden, geconfigureerd voor geavanceerde lijnherkenning, gevonden die kunnen worden gereset.';

    PROCEDURE SetToAnchorLinkedField@1000000010(VAR TempDocumentLine@1000000008 : Record 6085596);
    VAR
      AnchorField@1000000007 : Record 6085580;
      LinkedField@1000000005 : Record 6085580;
      AnchorFieldDocumentValue@1113400000 : Record 6085593;
      LinkedFieldDocumentValue@1000000001 : Record 6085593;
      FieldsLinked@1000000000 : Integer;
    BEGIN
      // Get the anchor field that defines the position
      MESSAGE(SelectOffsetSourceFieldFirst);
      IF NOT SelectField(AnchorField,TempDocumentLine."Template No.",'',FALSE) THEN
        EXIT;

      // Get document value of the anchor field => is mandatory
      AnchorFieldDocumentValue.SETRANGE("Document No.",TempDocumentLine."Document No.");
      AnchorFieldDocumentValue.SETRANGE("Is Value",TRUE);
      AnchorFieldDocumentValue.SETRANGE(Code,AnchorField.Code);
      //AnchorFieldDocumentValue.SETRANGE("Line No.",1);
      AnchorFieldDocumentValue.SETRANGE("Line No.",TempDocumentLine."Line No.");
      AnchorFieldDocumentValue.SETRANGE(Type,AnchorFieldDocumentValue.Type::Line);
      AnchorFieldDocumentValue.SETRANGE("Is Valid",TRUE);
      AnchorFieldDocumentValue.SETRANGE("Template No.",TempDocumentLine."Template No.");
      IF NOT AnchorFieldDocumentValue.FINDFIRST THEN
        ERROR(MissingSourceFieldValue,AnchorField.Code,TempDocumentLine."Line No.");

      // Select the field that should be linked with anchor field
      MESSAGE(SelectTheOffsetField, AnchorField."Field Name");
      IF NOT SelectField(LinkedField,TempDocumentLine."Template No.",AnchorField.Code,FALSE) THEN
        ERROR(FieldSetupCanceled);

      // Link the selected field to anchor field
      // Find the value of the selected field
      LinkedFieldDocumentValue.SETRANGE("Document No.",TempDocumentLine."Document No.");
      LinkedFieldDocumentValue.SETRANGE("Is Value",TRUE);
      LinkedFieldDocumentValue.SETRANGE(Code,LinkedField.Code);
      //LinkedFieldDocumentValue.SETRANGE("Line No.",1);
      LinkedFieldDocumentValue.SETRANGE("Line No.",TempDocumentLine."Line No.");
      LinkedFieldDocumentValue.SETRANGE(Type,LinkedFieldDocumentValue.Type::Line);
      LinkedFieldDocumentValue.SETRANGE("Is Valid",TRUE);
      LinkedFieldDocumentValue.SETRANGE("Template No.",TempDocumentLine."Template No.");
      IF NOT LinkedFieldDocumentValue.FINDFIRST THEN
        ERROR(MissingFieldExampleValue,LinkedField."Field Name",LinkedField.Code);  //value is mandatory

      ResetField(LinkedField);

      // Calculate and save the offset values at the linked field
      LinkedField."Offset Top" := LinkedFieldDocumentValue.Top - AnchorFieldDocumentValue.Top;
      LinkedField."Offset Left" := LinkedFieldDocumentValue.Left - AnchorFieldDocumentValue.Left;
      LinkedField."Offset Bottom" := LinkedFieldDocumentValue.Bottom - LinkedFieldDocumentValue.Top;
      LinkedField."Offset Right" := LinkedFieldDocumentValue.Right - LinkedFieldDocumentValue.Left;
      LinkedField."Advanced Line Recognition Type" := LinkedField."Advanced Line Recognition Type"::LinkedToAnchorField;
      LinkedField."Linked Field" := AnchorFieldDocumentValue.Code;

      UpdateExecutionSequence(LinkedField,LinkedField."Linked Field");

      IF LinkedField.MODIFY(TRUE) THEN BEGIN
        SetTemplateToALRProcessing(TempDocumentLine."Template No.");
        MESSAGE(FieldIsLinkedToSourceField,LinkedField."Field Name",AnchorField."Field Name");
      END ELSE
        MESSAGE(ErrorDuringFieldSetup);
    END;

    PROCEDURE SetToFieldSearchWithColumnHeding@1113400003(VAR TempDocumentLine@1113400002 : Record 6085596);
    VAR
      LineIdentFieldDocumentValue@1000000001 : Record 6085593;
      SelectedField@1113400001 : Record 6085580;
      SelectedFieldDocumentValue@1000000004 : Record 6085593;
      CDCTemplateFieldCaption@1000000000 : Record 6085581;
    BEGIN
      // Find field value of a normal position field
      GetLineIdentifierValue(TempDocumentLine,LineIdentFieldDocumentValue);

      // Select field
      MESSAGE(SelectFieldForColumnHeaderSearch);
      IF NOT SelectField(SelectedField,TempDocumentLine."Template No.",'',FALSE) THEN
        ERROR(FieldSetupCanceled);

      // Check that the selected field has at least one caption
      CDCTemplateFieldCaption.SETRANGE("Template No.",SelectedField."Template No.");
      CDCTemplateFieldCaption.SETRANGE(Code,SelectedField.Code);
      CDCTemplateFieldCaption.SETRANGE(Type,CDCTemplateFieldCaption.Type::Line);
      IF NOT CDCTemplateFieldCaption.FINDFIRST THEN
        ERROR(TrainCaptionFirstForField, SelectedField.Code);

      // Find the value of the selected field
      GetSelectedFieldValue(TempDocumentLine, SelectedFieldDocumentValue,SelectedField);

      ResetField(SelectedField);

      // Setup field for column heading search
      SelectedField."Advanced Line Recognition Type" := SelectedField."Advanced Line Recognition Type"::FindFieldByColumnHeading;

      IF SelectedFieldDocumentValue.Top < LineIdentFieldDocumentValue.Top THEN
        SelectedField."Field value position" := SelectedField."Field value position"::AboveStandardLine
      ELSE
        SelectedField."Field value position" := SelectedField."Field value position"::BelowStandardLine;

      IF SelectedField.MODIFY(TRUE) THEN BEGIN
        SetTemplateToALRProcessing(TempDocumentLine."Template No.");
        MESSAGE(FieldIsCapturedByColumnHeading, SelectedField."Field Name",CDCTemplateFieldCaption.Caption);
      END ELSE
        MESSAGE(ErrorDuringFieldSetup);
    END;

    PROCEDURE SetToFieldSearchWithCaption@1113400000(VAR TempDocumentLine@1113400000 : Record 6085596);
    VAR
      LineIdentFieldDocumentValue@1000000001 : Record 6085593;
      SelectedField@1113400001 : Record 6085580;
      SelectedFieldDocumentValue@1000000002 : Record 6085593;
      CDCTemplateFieldCaption@1000000000 : Record 6085581;
      DocumentPage@1000000004 : Record 6085591;
      CaptureEngine@1000000003 : Codeunit 6085575;
    BEGIN
      // Find field value of a normal position field
      GetLineIdentifierValue(TempDocumentLine,LineIdentFieldDocumentValue);

      // Select field
      MESSAGE(SelectFieldForCaptionSearch);
      IF NOT SelectField(SelectedField,TempDocumentLine."Template No.",'',FALSE) THEN
        ERROR(FieldSetupCanceled);

      // Check that the selected field has at least one caption
      CDCTemplateFieldCaption.SETRANGE("Template No.",SelectedField."Template No.");
      CDCTemplateFieldCaption.SETRANGE(Code,SelectedField.Code);
      CDCTemplateFieldCaption.SETRANGE(Type,CDCTemplateFieldCaption.Type::Line);
      IF NOT CDCTemplateFieldCaption.FINDFIRST THEN
        ERROR(TrainCaptionFirstForField,SelectedField.Code);

      // Find the value of the selected field
      GetSelectedFieldValue(TempDocumentLine, SelectedFieldDocumentValue,SelectedField);

      ResetField(SelectedField);

      IF (SelectedFieldDocumentValue.Right - SelectedFieldDocumentValue.Left) > 0 THEN BEGIN
        DocumentPage.GET(TempDocumentLine."Document No.",TempDocumentLine."Page No.");
        SelectedField."ALR Typical Value Field Width" := ROUND((SelectedFieldDocumentValue.Right - SelectedFieldDocumentValue.Left)
                                                               / CaptureEngine.GetDPIFactor(150,DocumentPage."TIFF Image Resolution"),1);
      END;

      IF (SelectedFieldDocumentValue.Top <> 0) AND (CDCTemplateFieldCaption.Top <> 0) AND (SelectedFieldDocumentValue.Left <> 0) AND (CDCTemplateFieldCaption.Left <> 0) THEN BEGIN
          SelectedField."ALR Value Caption Offset X" := SelectedFieldDocumentValue.Left - CDCTemplateFieldCaption.Left;
          SelectedField."ALR Value Caption Offset Y" := SelectedFieldDocumentValue.Top - CDCTemplateFieldCaption.Top;
      END;

      SelectedField."Caption Mandatory" := TRUE;

      // Setup field for field search by caption
      SelectedField."Advanced Line Recognition Type" := SelectedField."Advanced Line Recognition Type"::FindFieldByCaptionInPosition;

      IF SelectedFieldDocumentValue.Top < LineIdentFieldDocumentValue.Top THEN
        SelectedField."Field value position" := SelectedField."Field value position"::AboveStandardLine
      ELSE
        SelectedField."Field value position" := SelectedField."Field value position"::BelowStandardLine;

      IF SelectedField.MODIFY(TRUE) THEN BEGIN;
        SetTemplateToALRProcessing(TempDocumentLine."Template No.");
        MESSAGE(FieldIsCapturedByCaption,SelectedField."Field Name");
      END ELSE
        MESSAGE(ErrorDuringFieldSetup);
    END;

    PROCEDURE ResetFieldFromMenu@1(VAR TempDocumentLine@1001 : Record 6085596);
    VAR
      FieldToReset@1000 : Record 6085580;
    BEGIN
      IF SelectField(FieldToReset,TempDocumentLine."Template No.",'',TRUE) THEN BEGIN
        ResetField(FieldToReset);
        FieldToReset.MODIFY(TRUE);
      END;
    END;

    LOCAL PROCEDURE ResetField@1000000004(VAR TemplateField@1000000000 : Record 6085580);
    BEGIN
      // Reset the current field to default values
      TemplateField."Search for Value" := FALSE;
      TemplateField.Required := FALSE;
      CLEAR(TemplateField."Advanced Line Recognition Type");
      CLEAR(TemplateField."Linked Field");
      CLEAR(TemplateField."Offset Top");
      CLEAR(TemplateField."Offset Bottom");
      CLEAR(TemplateField."Offset Left");
      CLEAR(TemplateField."Offset Right");
      CLEAR(TemplateField."Field value position");
      CLEAR(TemplateField."Field value search direction");
      CLEAR(TemplateField.Sorting);
      CLEAR(TemplateField."Replacement Field");
      CLEAR(TemplateField."Replacement Field Type");
      CLEAR(TemplateField."Copy Value from Previous Value");
      CLEAR(TemplateField."ALR Typical Value Field Width");
      CLEAR(TemplateField."Typical Field Height");
      CLEAR(TemplateField."Caption Mandatory");
      CLEAR(TemplateField."ALR Value Caption Offset X");
      CLEAR(TemplateField."ALR Value Caption Offset Y");
    END;

    LOCAL PROCEDURE SelectField@1113400002(VAR TemplateField@1000000000 : Record 6085580;TemplateNo@1113400001 : Code[20];ExcludedFieldsFilter@1113400000 : Text[250];ALROnlyFields@1160040000 : Boolean) : Boolean;
    VAR
      lTemplateFieldList@1000000003 : Page 6085602;
    BEGIN
      TemplateField.SETRANGE("Template No.",TemplateNo);
      TemplateField.SETRANGE(Type,TemplateField.Type::Line);

      IF ExcludedFieldsFilter <> '' THEN
        TemplateField.SETFILTER(Code,'<>%1',ExcludedFieldsFilter);

      IF ALROnlyFields THEN BEGIN
        TemplateField.SETFILTER("Advanced Line Recognition Type",'<>%1',TemplateField."Advanced Line Recognition Type"::Default);
        IF TemplateField.ISEMPTY THEN
          ERROR(NoALRFieldsForReset);
      END;

      lTemplateFieldList.SETTABLEVIEW(TemplateField);
      lTemplateFieldList.LOOKUPMODE(TRUE);
      IF lTemplateFieldList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        lTemplateFieldList.GETRECORD(TemplateField);
        EXIT(TRUE);
      END;
    END;

    PROCEDURE SetTemplateToALRProcessing@1113400005(TemplateNo@1113400000 : Code[20]);
    VAR
      lTemplate@1113400001 : Record 6085579;
    BEGIN
      // Change Codeunit ID to the advanced line recognition codeunit on template
      IF lTemplate.GET(TemplateNo) THEN BEGIN
        lTemplate.VALIDATE("Codeunit ID: Line Capture",GetAdvLineRecCodeunit());
        lTemplate.MODIFY(TRUE);
      END;
    END;

    LOCAL PROCEDURE GetAdvLineRecCodeunit@1000000000() : Integer;
    VAR
      Object@1000000000 : Record 2000000001;
      AllObjWithCaption@1160040001 : Record 2000000058;
      ObjectList@1160040000 : Page 6086055;
    BEGIN
      Object.SETRANGE(Type,Object.Type::Codeunit);
      Object.SETRANGE(Name,'Adv. Purch/Sales Line Capture');
      IF NOT Object.ISEMPTY THEN BEGIN
        IF Object.FINDSET THEN BEGIN
          EXIT(Object.ID);
        END;
      END ELSE BEGIN
        ObjectList.LOOKUPMODE(TRUE);
        IF ObjectList.RUNMODAL = ACTION::LookupOK THEN BEGIN
          ObjectList.GETRECORD(AllObjWithCaption);
          EXIT(AllObjWithCaption."Object ID");
        END;

        ERROR(CodeunitDoesNotExist,'Adv. Purch/Sales Line Capture');
      END;
    END;

    LOCAL PROCEDURE GetLineIdentifierValue@1000000002(VAR TempDocumentLine@1160040000 : Record 6085596;VAR LineIdentFieldDocumentValue@1000000000 : Record 6085593);
    VAR
      LineIdentField@1000000003 : Record 6085580;
      LineIdentFieldFound@1000000004 : Boolean;
    BEGIN
      WITH LineIdentField DO BEGIN
        SETRANGE("Template No.",TempDocumentLine."Template No.");
        SETRANGE(Type,Type::Line);
        SETRANGE(Required,TRUE);
        SETRANGE("Advanced Line Recognition Type","Advanced Line Recognition Type"::Default);
        IF FINDSET THEN
          REPEAT
            //IF LineIdentFieldDocumentValue.GET(TempDocumentLine."Document No.",TRUE,LineIdentField.Code,1) THEN
            IF LineIdentFieldDocumentValue.GET(TempDocumentLine."Document No.",TRUE,LineIdentField.Code,TempDocumentLine."Line No.") THEN
              IF (LineIdentFieldDocumentValue."Template No." = TempDocumentLine."Template No.") AND
                 (LineIdentFieldDocumentValue.Type = LineIdentFieldDocumentValue.Type::Line)
              THEN
                LineIdentFieldFound := TRUE;
          UNTIL (NEXT = 0) OR LineIdentFieldFound;
      END;

      IF NOT LineIdentFieldFound THEN
        ERROR(NoRequiredFieldFound);
    END;

    LOCAL PROCEDURE GetSelectedFieldValue@1000000007(VAR TempDocumentLine@1160040000 : Record 6085596;VAR SelectedFieldDocumentValue@1000000000 : Record 6085593;SelectedField@1000000001 : Record 6085580);
    BEGIN
      SelectedFieldDocumentValue.SETRANGE("Document No.",TempDocumentLine."Document No.");
      SelectedFieldDocumentValue.SETRANGE("Is Value",TRUE);
      SelectedFieldDocumentValue.SETRANGE(Code,SelectedField.Code);
      //SelectedFieldDocumentValue.SETRANGE("Line No.",0,1);
      SelectedFieldDocumentValue.SETRANGE("Line No.",TempDocumentLine."Line No.");
      SelectedFieldDocumentValue.SETRANGE(Type,SelectedFieldDocumentValue.Type::Line);
      SelectedFieldDocumentValue.SETRANGE("Is Valid",TRUE);
      SelectedFieldDocumentValue.SETRANGE("Template No.",TempDocumentLine."Template No.");
      IF NOT SelectedFieldDocumentValue.FINDFIRST THEN
        ERROR(MissingFieldExampleValue,SelectedField."Field Name",SelectedField.Code);  //value is mandatory
    END;

    LOCAL PROCEDURE UpdateExecutionSequence@1000000001(VAR LinkedField@1000000000 : Record 6085580;PreviousFieldCode@1000000001 : Code[20]);
    VAR
      CurrField@1000000002 : Record 6085580;
      PrevField@1000000003 : Record 6085580;
      SortField@1000000004 : Record 6085580;
    BEGIN
      IF NOT PrevField.GET(LinkedField."Template No.",PrevField.Type::Line,PreviousFieldCode) THEN
        EXIT;

      IF LinkedField.Sorting <= PrevField.Sorting  THEN BEGIN
        SortField.SETRANGE("Template No.",LinkedField."Template No.");
        SortField.SETRANGE(Type,SortField.Type::Line);
        SortField.SETFILTER(Code,'<>%1',LinkedField.Code);
        SortField.SETFILTER(Sorting, '>=%1',LinkedField.Sorting  + 1);
        IF SortField.FINDSET THEN
          REPEAT
            SortField.Sorting := SortField.Sorting  + 1;
            SortField.MODIFY;
          UNTIL SortField.NEXT = 0;
        LinkedField.Sorting := LinkedField.Sorting + 1;
      END;
    END;

    PROCEDURE ShowVersionNo@1160040000() : Text;
    VAR
      ApplicationManagement@1160040000 : Codeunit 1;
    BEGIN
      MESSAGE(STRSUBSTNO(ALRVersionNoText,'15.01',ApplicationManagement.ApplicationVersion,ApplicationManagement.ApplicationBuild));
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 61001 Adv. Purch/Sales Line Capture
{
  OBJECT-PROPERTIES
  {
    Date=14-04-22;
    Time=12:00:00;
    Modified=Yes;
    Version List=ALR1.15.01;
  }
  PROPERTIES
  {
    TableNo=6085590;
    OnRun=VAR
            CDCTemplate@1000 : Record 6085579;
          BEGIN
            Document := Rec;
            Code(Document)
          END;

  }
  CODE
  {
    VAR
      Document@1003 : Record 6085590;
      TempMandatoryField@1001 : TEMPORARY Record 6085595;
      CaptureMgt@1160040001 : Codeunit 6085576;
      NoMandatoryFieldsFoundLbl@1000 : TextConst 'ENU=You cannot use the advanced line recognition option %1 when the template does not have at least one line field marked as required!';

    PROCEDURE Code@1000000000(VAR Document@1000 : Record 6085590);
    VAR
      TempDocLine@1000000001 : TEMPORARY Record 6085596;
      TemplateField@1000000000 : Record 6085580;
      TempSortedDocumentField@1113400000 : TEMPORARY Record 6085595;
      CDCTemplate@1002 : Record 6085579;
    BEGIN
      CleanupPrevValues(Document);

      IF NOT CDCTemplate.GET(Document."Template No.") THEN
        EXIT;

      //RUN STANDARD LINE CAPTURING CODEUNIT
      CODEUNIT.RUN(CODEUNIT::"CDC Purch./Sales - Line Capt.",Document);

      //BUILD TEMPORARY LINE TABLE AND LOOP LINES
      Document.BuildTempLinesTable(TempDocLine);

      IF TempDocLine.FINDSET THEN BEGIN
        FillSortedFieldBuffer(TempSortedDocumentField, TempMandatoryField, TempDocLine);
        REPEAT
          TempSortedDocumentField.SETCURRENTKEY("Document No.","Sort Order");
          IF TempSortedDocumentField.FINDFIRST THEN
            REPEAT
              WITH TemplateField DO BEGIN
                GET(TempDocLine."Template No.",TemplateField.Type::Line,TempSortedDocumentField."Field Code");
                CASE "Advanced Line Recognition Type" OF
                  "Advanced Line Recognition Type"::LinkedToAnchorField: FindValueFromOffsetField(TempDocLine,TemplateField);
                  "Advanced Line Recognition Type"::FindFieldByCaptionInPosition: FindValueByCaptionInPosition(TempDocLine,TemplateField,Document);
                  "Advanced Line Recognition Type"::FindFieldByColumnHeading: FindFieldByColumnHeading(TempDocLine,TemplateField,Document);
                END;
              END;
          UNTIL TempSortedDocumentField.NEXT = 0;

          FindSubstitutionFieldValue(TempDocLine);

          GetValueFromPreviousValue(TempDocLine);
        UNTIL TempDocLine.NEXT = 0;

        CleanupTempValues(Document);
      END;
    END;

    LOCAL PROCEDURE FindValueFromOffsetField@1210050000(TempDocLine@1210050009 : TEMPORARY Record 6085596;VAR OffsetField@1000000001 : Record 6085580);
    VAR
      OffsetSourceField@1113400000 : Record 6085580;
      OffsetSourceFieldValue@1113400001 : Record 6085593;
      DocumentValue@1113400002 : Record 6085593;
      CurrPage@1210050003 : Record 6085591;
      CurrTop@1000000002 : Integer;
      CurrLeft@1000000003 : Integer;
      CurrBottom@1000000004 : Integer;
      CurrRight@1000000005 : Integer;
    BEGIN
      //This function will capture the field value based on the offset/distance of a source field value

      //Get Line Identification Field Position
      IF NOT OffsetSourceField.GET(TempDocLine."Template No.",OffsetSourceField.Type::Line,OffsetField."Linked Field") THEN
        EXIT;

      // Get current value record of offset source field
      IF NOT OffsetSourceFieldValue.GET(TempDocLine."Document No.",TRUE,OffsetSourceField.Code,TempDocLine."Line No.") THEN
        EXIT;

      IF NOT CurrPage.GET(TempDocLine."Document No.",OffsetSourceFieldValue."Page No.") THEN
        EXIT;

      WITH OffsetSourceFieldValue DO BEGIN
        // Create offset area for value capturing
        CurrTop := Top + OffsetField."Offset Top";
        CurrLeft := Left + OffsetField."Offset Left";
        CurrBottom := CurrTop + OffsetField."Offset Bottom";
        CurrRight := CurrLeft + OffsetField."Offset Right";
        CaptureMgt.CaptureFromPos(CurrPage,OffsetField,TempDocLine."Line No.",TRUE,CurrTop,CurrLeft,CurrBottom,CurrRight,DocumentValue);
        IF DocumentValue.GET(TempDocLine."Document No.",TRUE,OffsetField.Code,TempDocLine."Line No.") THEN
          IF ((DocumentValue."Value (Text)" = '') AND (DocumentValue."Value (Decimal)" = 0)) OR (NOT DocumentValue."Is Valid" )THEN
            DocumentValue.DELETE;
      END;
    END;

    LOCAL PROCEDURE FindValueByCaptionInPosition@1113400000(VAR TempDocLine@1210050009 : TEMPORARY Record 6085596;VAR CurrField@1000000001 : Record 6085580;Document@1000 : Record 6085590) : Boolean;
    VAR
      DocumentValue@1113400000 : Record 6085593;
      DocumentValueCopy@1113400004 : Record 6085593;
      lCurrPage@1113400009 : Record 6085591;
      CaptureEngine@1113400002 : Codeunit 6085575;
      Word@1113400003 : Text[1024];
      FromTopPos@1113400008 : Integer;
      FromTopPage@1113400007 : Integer;
      ToBottomPos@1113400006 : Integer;
      ToBottomPage@1113400005 : Integer;
      i@1113400010 : Integer;
    BEGIN
      // We cannot proceed if there is no line field in the template defined as required=true
      IF TempMandatoryField.COUNT = 0 THEN
        ERROR(NoMandatoryFieldsFoundLbl, CurrField."Advanced Line Recognition Type");

      //This function will capture the field value based on the caption(s) in the area between the previous and next
      IF NOT Document.GET(TempDocLine."Document No.") THEN
        EXIT;

      //Delete current value
      IF DocumentValue.GET(TempDocLine."Document No.",TRUE,CurrField.Code,TempDocLine."Line No.") THEN
        DocumentValue.DELETE;

      CLEAR(Word);

      // Get valid range depended of search direction
      // 1. above the standard recognized line: range is between standard standard line and previous line
      // 2. below the standard recognized line: range is between standard standard line and next line
      IF (CurrField."Field value position" = CurrField."Field value position"::AboveStandardLine) THEN
        GetRangeToPrevLine(Document,TempDocLine,FromTopPage,FromTopPos,ToBottomPage,ToBottomPos)
      ELSE
        GetRangeToNextLine(Document,TempDocLine,FromTopPage,FromTopPos,ToBottomPage,ToBottomPos);

      IF (FromTopPage > 0) AND (ToBottomPage > 0) THEN
        FOR i := FromTopPage TO ToBottomPage DO BEGIN
          IF NOT lCurrPage.GET(Document."No.",i) THEN
            EXIT;

          CurrField."Caption Offset X" := CurrField."ALR Value Caption Offset X";
          CurrField."Caption Offset Y" := CurrField."ALR Value Caption Offset Y";
          CurrField."Typical Field Width" := CurrField."ALR Typical Value Field Width";

          IF i < ToBottomPage THEN BEGIN
            CaptureEngine.SetLineRegion(i,FromTopPos,i,lCurrPage."Bottom Word Pos.")
          END ELSE BEGIN
            IF (i > FromTopPage) AND (i < ToBottomPage) THEN BEGIN
              CaptureEngine.SetLineRegion(i,0,i,lCurrPage."Bottom Word Pos.")
            END ELSE BEGIN
              IF FromTopPos > ToBottomPos THEN BEGIN
                CaptureEngine.SetLineRegion(i,0,i,ToBottomPos)
              END ELSE BEGIN
                CaptureEngine.SetLineRegion(i,FromTopPos,i,ToBottomPos);
              END;
            END;
          END;

          Word := CaptureEngine.CaptureField(Document,lCurrPage."Page No.",CurrField,FALSE);

          IF Word <> '' THEN BEGIN
            IF (DocumentValue.GET(Document."No.",TRUE,CurrField.Code,0)) THEN BEGIN
              DocumentValueCopy := DocumentValue;
              DocumentValueCopy."Line No." := TempDocLine."Line No.";
              DocumentValueCopy.Type := DocumentValueCopy.Type::Line;
              DocumentValueCopy.INSERT;
              DocumentValue.DELETE;
            END;
            CaptureMgt.UpdateFieldValue(Document."No.",TempDocLine."Page No.",TempDocLine."Line No.",CurrField,Word,FALSE,FALSE);

            EXIT(TRUE);
          END;
        END;
    END;

    LOCAL PROCEDURE FindFieldByColumnHeading@1113400001(VAR TempDocLine@1210050009 : TEMPORARY Record 6085596;VAR CurrField@1000000001 : Record 6085580;Document@1000 : Record 6085590);
    VAR
      Template@1113400021 : Record 6085579;
      DocumentValue@1113400000 : Record 6085593;
      DocumentValueBuffer@1000000002 : TEMPORARY Record 6085593;
      DocumentValueNew@1113400022 : Record 6085593;
      CaptionStartWord@1113400004 : ARRAY [100] OF Record 6085592;
      CaptionEndWord@1113400003 : ARRAY [100] OF Record 6085592;
      CaptionPage@1113400005 : Record 6085591;
      CurrPage@1113400017 : Record 6085591;
      CaptionValue@1113400006 : Record 6085593;
      CaptionPageNo@1113400001 : Integer;
      CaptionFound@1113400002 : Boolean;
      PageStop@1113400016 : Boolean;
      FromTopPos@1113400010 : Integer;
      FromTopPage@1113400009 : Integer;
      ToBottomPos@1113400008 : Integer;
      ToBottomPage@1113400007 : Integer;
      NewBottom@1113400011 : Integer;
      LineNo@1113400012 : Integer;
      LineHeight@1113400013 : Integer;
      Top@1113400014 : Integer;
      Bottom@1113400015 : Integer;
      Right@1113400018 : Integer;
      FieldLeft@1113400019 : Integer;
      FieldWidth@1113400020 : Integer;
      LastFoundLineNo@1000000000 : Integer;
    BEGIN
      // We cannot proceed if there is no line field in the template defined as required=true
              IF TempMandatoryField.COUNT = 0 THEN
                  ERROR(NoMandatoryFieldsFoundLbl, CurrField."Advanced Line Recognition Type");

      //This function will capture the field value based on a column heading, actualy like the default line recognition but filtered on the area between the prev. and next line

      IF NOT Template.GET(TempDocLine."Template No.")THEN
        EXIT;

      // Delete old values
      IF DocumentValue.GET(TempDocLine."Document No.",TRUE,CurrField.Code,TempDocLine."Line No.") THEN
        DocumentValue.DELETE;

      // Find the Caption position on current or previous pages
      CaptionPageNo := TempDocLine."Page No.";
      REPEAT
        CaptionFound := GetStartAndEndCaption(CaptionStartWord,CaptionEndWord,CurrField,TempDocLine."Document No.",CaptionPageNo);
        IF NOT CaptionFound THEN
          CaptionPageNo -= 1;
      UNTIL (CaptionPageNo = 0) OR CaptionFound;

      IF (NOT CaptionFound) THEN
        EXIT;

      IF NOT CaptionPage.GET(TempDocLine."Document No.",CaptionPageNo) THEN
        EXIT;

      GetPositionOfCaption(CaptionPage,CurrField,CaptionStartWord[1],CaptionEndWord[1],CaptionValue,FieldLeft,FieldWidth,Bottom,Top);

      // Get position of next or previous line
      IF CurrField."Field value position" = CurrField."Field value position"::AboveStandardLine THEN BEGIN
        GetRangeToPrevLine(Document,TempDocLine,FromTopPage,FromTopPos,ToBottomPage,ToBottomPos);
        IF FromTopPos > Top THEN
          Top := FromTopPos;
      END ELSE BEGIN
        GetRangeToNextLine(Document,TempDocLine,FromTopPage,FromTopPos,ToBottomPage,ToBottomPos);
        Top := FromTopPos;
      END;

      NewBottom := 0;
      LineNo := 1000 * TempDocLine."Page No.";
      LineHeight := 12;


      Bottom := Top + LineHeight;

      PageStop := FALSE;
      IF NOT CurrPage.GET(TempDocLine."Document No.",FromTopPage) THEN
        EXIT;

      REPEAT
        LineNo += 1;
        Right := FieldLeft + FieldWidth;
        NewBottom := CaptureTableCell(Template,Document,CurrPage,CurrField,LineNo,Top,FieldLeft,Bottom,Right);
        IF NewBottom > 0 THEN BEGIN
          IF NewBottom > Bottom THEN
            Bottom := NewBottom;

          IF NOT IsFieldValid(CurrField,Document,LineNo)  THEN BEGIN
            DocumentValue.RESET;
            DocumentValue.SETRANGE("Document No.",Document."No.");
            DocumentValue.SETRANGE("Line No.",LineNo);
            DocumentValue.DELETEALL(TRUE);
          END ELSE BEGIN
            //PageStop := TRUE;
            LastFoundLineNo := LineNo;
            PageStop := (CurrField."Field value search direction" = CurrField."Field value search direction"::Downwards);
            IF DocumentValue.GET(TempDocLine."Document No.",TRUE,CurrField.Code,LastFoundLineNo) THEN BEGIN
              DocumentValueBuffer := DocumentValue;
              DocumentValueBuffer.INSERT;
              DocumentValue.DELETE;
            END;
          END;
        END;

        IF NOT PageStop THEN BEGIN
          Top := Bottom;
          Bottom := Top + LineHeight;

          IF (Bottom > CurrPage."Bottom Word Pos.") AND (CurrPage."Page No." < ToBottomPage) THEN BEGIN
            //New page - some variables must be reset
            IF CurrPage.GET(CurrPage."Document No.",CurrPage."Page No." + 1) THEN BEGIN
              CaptionPageNo  := CurrPage."Page No.";
              LineNo := 1000 * CurrPage."Page No.";
              IF GetStartAndEndCaption(CaptionStartWord,CaptionEndWord,CurrField,TempDocLine."Document No.",CaptionPageNo) THEN
                IF CaptionPage.GET(TempDocLine."Document No.",CurrPage."Page No.") THEN
                  IF GetPositionOfCaption(CaptionPage,CurrField,CaptionStartWord[1],CaptionEndWord[1],CaptionValue,FieldLeft,FieldWidth,Bottom,Top) THEN
                    Bottom := Top + LineHeight;
            END;
          END ELSE
            IF (Bottom > CurrPage."Bottom Word Pos.") OR ((Bottom > ToBottomPos) AND (CurrPage."Page No." = ToBottomPage)) THEN
              PageStop := TRUE;
        END;
      UNTIL PageStop;

      //Zeilennr. speichern
      IF DocumentValueBuffer.GET(TempDocLine."Document No.",TRUE,CurrField.Code,LastFoundLineNo) THEN BEGIN
        DocumentValueNew := DocumentValueBuffer;
        DocumentValueNew."Line No." := TempDocLine."Line No.";
        DocumentValueNew.INSERT;
        DocumentValueBuffer.DELETE;
        CaptureMgt.UpdateFieldValue(TempDocLine."Document No.",TempDocLine."Page No.",TempDocLine."Line No.",CurrField,DocumentValueNew."Value (Text)",FALSE,FALSE);
      END;
    END;

    LOCAL PROCEDURE FindSubstitutionFieldValue@1113400007(VAR TempDocLine@1000000001 : TEMPORARY Record 6085596);
    VAR
      TemplateField@1000000000 : Record 6085580;
      DocumentValue@1113400002 : Record 6085593;
      SubstitutionDocumentValue@1000000002 : Record 6085593;
      SubstitutionField@1113400003 : Record 6085580;
    BEGIN
      // Function goes through all field, setted up with substitution fields.
      // It checks if the value of the current field is empty and updates the value with the value of the substitution field (if exists).
      TemplateField.SETRANGE("Template No.",TempDocLine."Template No.");
      TemplateField.SETRANGE(Type, TemplateField.Type::Line);
      TemplateField.SETFILTER("Replacement Field",'<>%1','');
      IF TemplateField.ISEMPTY THEN
        EXIT;

        TemplateField.FINDSET;
        REPEAT
          IF NOT DocumentValue.GET(TempDocLine."Document No.",TRUE,TemplateField.Code,TempDocLine."Line No.") THEN
            IF SubstitutionField.GET(TempDocLine."Template No.",TemplateField."Replacement Field Type",TemplateField."Replacement Field") THEN
              IF SubstitutionDocumentValue.GET(TempDocLine."Document No.",TRUE,SubstitutionField.Code,TempDocLine."Line No.") THEN BEGIN
                CaptureMgt.UpdateFieldValue(TempDocLine."Document No.",TempDocLine."Page No.",TempDocLine."Line No.",TemplateField,SubstitutionDocumentValue."Value (Text)",FALSE,FALSE);
                IF DocumentValue.GET(TempDocLine."Document No.",TRUE,TemplateField.Code,TempDocLine."Line No.") THEN BEGIN
                  DocumentValue.Top := SubstitutionDocumentValue.Top;
                  DocumentValue.Bottom := SubstitutionDocumentValue.Bottom;
                  DocumentValue.Left := SubstitutionDocumentValue.Left;
                  DocumentValue.Right := SubstitutionDocumentValue.Right;
                  DocumentValue.MODIFY;
                END;
              END;
        UNTIL TemplateField.NEXT = 0;
    END;

    LOCAL PROCEDURE GetValueFromPreviousValue@1000000004(VAR TempDocLine@1000000001 : TEMPORARY Record 6085596);
    VAR
      TemplateField@1000000000 : Record 6085580;
      DocumentValue@1113400002 : Record 6085593;
    BEGIN
      // Function goes through all field, setted up with substitution fields.
      // It checks if the value of the current field is empty and updates the value with the value of the substitution field (if exists).
      TemplateField.SETRANGE("Template No.",TempDocLine."Template No.");
      TemplateField.SETRANGE("Copy Value from Previous Value",TRUE);
      IF TemplateField.FINDSET THEN
        REPEAT
          IF NOT DocumentValue.GET(TempDocLine."Document No.",TRUE,TemplateField.Code,TempDocLine."Line No.") THEN
            IF DocumentValue.GET(TempDocLine."Document No.",TRUE,TemplateField.Code,TempDocLine."Line No."-1) THEN
              CaptureMgt.UpdateFieldValue(TempDocLine."Document No.",TempDocLine."Page No.",TempDocLine."Line No.",TemplateField,DocumentValue."Value (Text)",FALSE,FALSE);
        UNTIL TemplateField.NEXT = 0;
    END;

    LOCAL PROCEDURE GetRangeToNextLine@1113400002(Document@1000 : Record 6085590;VAR TempDocLine@1000000000 : Record 6085596;VAR SearchFromPage@1113400002 : Integer;VAR SearchFromPos@1113400003 : Integer;VAR SearchToPage@1113400000 : Integer;VAR SearchToPos@1113400001 : Integer);
    VAR
      DocumentValue@1000000001 : Record 6085593;
      CurrPage@1113400004 : Record 6085591;
      StopPos@1000000002 : ARRAY [100] OF Integer;
    BEGIN
      // This function calculates the range until the next position/line
      CLEAR(SearchFromPage);
      CLEAR(SearchFromPos);
      CLEAR(SearchToPage);
      CLEAR(SearchToPos);


      DocumentValue.SETCURRENTKEY("Document No.","Is Value",Code,"Line No.");
      DocumentValue.SETRANGE("Document No.",TempDocLine."Document No.");
      DocumentValue.SETRANGE("Is Value",TRUE);
      DocumentValue.SETRANGE(Type,DocumentValue.Type::Line);
      DocumentValue.SETFILTER("Page No.", '>%1',0);

      GetCurrLinePosition(DocumentValue,TempDocLine."Line No.",SearchFromPage, SearchFromPos, SearchToPage, SearchToPos);

      // Filter for next line
      DocumentValue.SETRANGE("Line No.",TempDocLine."Line No." + 1);
      IF DocumentValue.FINDSET THEN BEGIN
        REPEAT
          IF (SearchToPage < DocumentValue."Page No.") OR (SearchToPage = 0)  THEN BEGIN
            SearchToPage := DocumentValue."Page No.";
            SearchToPos := 0;
          END;

          IF SearchToPage = DocumentValue."Page No." THEN BEGIN
            IF (SearchToPos < DocumentValue.Bottom) OR (SearchToPos = 0) THEN
                SearchToPos := DocumentValue.Bottom ;
          END;
        UNTIL DocumentValue.NEXT = 0;
      END ELSE BEGIN
        // As there is no next line, calculate to next header value or bottom of current page
        DocumentValue.SETCURRENTKEY("Document No.","Is Value",Code,"Line No.");
        DocumentValue.SETRANGE("Document No.",TempDocLine."Document No.");
        DocumentValue.SETRANGE("Is Value",FALSE);
        DocumentValue.SETRANGE(Type,DocumentValue.Type::Header);
        DocumentValue.SETRANGE("Page No.",SearchToPage);
        DocumentValue.SETFILTER(Top,'>%1',SearchToPos);
        DocumentValue.SETRANGE("Line No.", 0);
        IF DocumentValue.FINDSET(FALSE,FALSE) THEN BEGIN
          IF DocumentValue."Page No." > SearchToPage THEN BEGIN
            SearchToPage := DocumentValue."Page No.";
          END;
          SearchToPos := DocumentValue.Top
        END ELSE BEGIN
          DocumentValue.SETFILTER("Page No.",'>%1',SearchToPage);
          DocumentValue.SETRANGE(Top);
          IF DocumentValue.FINDSET(FALSE,FALSE) THEN BEGIN
            IF DocumentValue."Page No." > SearchToPage THEN BEGIN
              SearchToPage := DocumentValue."Page No.";
            END;
            SearchToPos := DocumentValue.Top
          END ELSE
            IF CurrPage.GET(TempDocLine."Document No.",SearchToPage) THEN
              SearchToPos := CurrPage."Bottom Word Pos.";
        END;
      END;

      GetStopLineRecognitionPositions(StopPos,SearchToPage,SearchToPos,Document);
      IF (StopPos[SearchToPage]>0) AND (StopPos[SearchToPage] <= SearchToPos) THEN
        SearchToPos := StopPos[SearchToPage];
    END;

    LOCAL PROCEDURE GetRangeToPrevLine@1113400009(Document@1000 : Record 6085590;VAR TempDocLine@1000000000 : Record 6085596;VAR RangeTopPage@1113400002 : Integer;VAR RangeTopPos@1113400003 : Integer;VAR RangeBottomPage@1113400000 : Integer;VAR RangeBottomPos@1113400001 : Integer);
    VAR
      DocumentValue@1000000001 : Record 6085593;
      CurrLineTopPage@1113400008 : Integer;
      CurrLineTopPos@1113400007 : Integer;
      CurrLineBottomPage@1113400006 : Integer;
      CurrLineBottomPos@1113400005 : Integer;
      PrevLineTopPage@1113400012 : Integer;
      PrevLineTopPos@1113400011 : Integer;
      PrevLineBottomPage@1113400010 : Integer;
      PrevLineBottomPos@1113400009 : Integer;
    BEGIN
      // This function calculates the range until the previous position/line
      CLEAR(PrevLineTopPage);
      CLEAR(PrevLineTopPos);
      CLEAR(PrevLineBottomPage);
      CLEAR(PrevLineBottomPos);

      WITH DocumentValue DO BEGIN
        SETCURRENTKEY("Document No.","Is Value",Code,"Line No.");
        SETRANGE("Document No.",Document."No.");
        SETRANGE("Is Value",TRUE);
        SETRANGE(Type,Type::Line);
        SETFILTER("Page No.", '>%1',0);

        GetCurrLinePosition(DocumentValue,TempDocLine."Line No.",CurrLineTopPage,CurrLineTopPos,CurrLineBottomPage,CurrLineBottomPos);

        // Filter for Prev line
        SETRANGE("Line No.",TempDocLine."Line No." - 1);
        IF FINDSET THEN BEGIN
          REPEAT
            IF ("Page No." < PrevLineTopPage) OR (PrevLineTopPage = 0) THEN BEGIN
              PrevLineTopPage := "Page No.";
              CLEAR(PrevLineTopPos);
            END;

            IF ("Page No." > PrevLineBottomPage) OR (PrevLineBottomPage = 0)  THEN BEGIN
              PrevLineBottomPage := "Page No.";
              CLEAR(PrevLineBottomPos);
            END;

            IF PrevLineTopPage = "Page No." THEN
              IF (Top < PrevLineTopPos) OR (PrevLineTopPos = 0) THEN
                PrevLineTopPos := Top;

            IF PrevLineBottomPage = "Page No." THEN
              IF (Bottom > PrevLineBottomPos) OR (PrevLineBottomPos = 0) THEN
                 PrevLineBottomPos := Bottom ;
          UNTIL NEXT = 0;
        END ELSE BEGIN
          // As there is no Prev line, calculate to Prev header value or bottom of current page
          SETCURRENTKEY("Document No.","Is Value",Code,"Line No.");
          SETRANGE("Document No.",Document."No.");
          SETRANGE("Is Value",FALSE);
          SETRANGE(Type,Type::Header);
          SETFILTER("Page No.",'<=%1',"Page No.");
          SETFILTER(Top,'<%1',CurrLineTopPos);
          IF FINDSET(FALSE,FALSE) THEN BEGIN
            PrevLineBottomPos := Bottom;
            PrevLineBottomPage := "Page No.";
          END ELSE BEGIN
            PrevLineBottomPos  := 0;
            PrevLineBottomPage := CurrLineTopPage;
          END;
        END;

        RangeTopPage := PrevLineBottomPage;
        RangeBottomPage := CurrLineTopPage;
        RangeTopPos := PrevLineBottomPos + 1;
        //RangeBottomPos := CurrLineTopPos - 1;
        RangeBottomPos := CurrLineBottomPos - 1;
      END;
    END;

    LOCAL PROCEDURE GetCurrLinePosition@1000000002(VAR DocumentValue@1000000000 : Record 6085593;LineNo@1000000001 : Integer;VAR CurrLineTopPage@1000000005 : Integer;VAR CurrLineTopPos@1000000004 : Integer;VAR CurrLineBottomPage@1000000003 : Integer;VAR CurrLineBottomPos@1000000002 : Integer);
    BEGIN
      WITH DocumentValue DO BEGIN
        // Filter for current line
        SETRANGE("Line No.",LineNo);
        IF FINDSET THEN
        REPEAT
          IF TempMandatoryField.GET(DocumentValue.GETFILTER("Document No."),Code) THEN BEGIN
            IF ("Page No." < CurrLineTopPage) OR (CurrLineTopPage = 0) THEN BEGIN
              CurrLineTopPage := "Page No.";
              CLEAR(CurrLineTopPos);
            END;

            IF ("Page No." > CurrLineBottomPage) OR (CurrLineBottomPage = 0)  THEN BEGIN
              CurrLineBottomPage := "Page No.";
              CLEAR(CurrLineBottomPos);
            END;

            IF CurrLineTopPage = "Page No." THEN
              IF (Top < CurrLineTopPos) OR (CurrLineTopPos = 0) THEN
                CurrLineTopPos := Top;

            IF CurrLineBottomPage = "Page No." THEN
              IF (Bottom > CurrLineBottomPos) OR (CurrLineBottomPos = 0) THEN
                CurrLineBottomPos := Bottom ;
          END;
        UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE GetStartAndEndCaption@1160040001(VAR CaptionStartWord@1160040002 : ARRAY [100] OF TEMPORARY Record 6085592;VAR CaptionEndWord@1160040001 : ARRAY [100] OF TEMPORARY Record 6085592;Field@1160040000 : Record 6085580;DocNo@1160040003 : Code[20];PageNo@1160040006 : Integer) : Boolean;
    VAR
      TemplateFieldCaption@1160040005 : Record 6085581;
      CaptureEngine@1160040004 : Codeunit 6085575;
      PrevCaptionStartWord@1113400000 : Record 6085592;
    BEGIN
      CLEAR(CaptionStartWord);
      CLEAR(CaptionEndWord);

      TemplateFieldCaption.SETRANGE("Template No.",Field."Template No.");
      TemplateFieldCaption.SETRANGE(Type,Field.Type);
      TemplateFieldCaption.SETRANGE(Code,Field.Code);
      IF TemplateFieldCaption.FINDSET THEN
        REPEAT
          IF CaptureEngine.FindCaption(DocNo,PageNo,Field,TemplateFieldCaption,CaptionStartWord,CaptionEndWord) THEN
            EXIT(TRUE);
        UNTIL (TemplateFieldCaption.NEXT = 0) OR ((CaptionStartWord[1].Word <> '') AND (CaptionEndWord[1].Word <> ''));
    END;

    LOCAL PROCEDURE GetPositionOfCaption@1113400003(CurrPage@1113400004 : Record 6085591;CaptionTemplateField@1113400001 : Record 6085580;CaptionStartWord@1113400003 : Record 6085592;CaptionEndWord@1113400002 : Record 6085592;DocumentValue@1113400000 : Record 6085593;VAR FieldLeft@1113400011 : Integer;VAR FieldWidth@1113400010 : Integer;VAR Bottom@1113400009 : Integer;VAR Top@1113400008 : Integer) CaptionValueFound : Boolean;
    VAR
      Template@1113400007 : Record 6085579;
      CaptureEngine@1113400006 : Codeunit 6085575;
    BEGIN
      Template.GET(CaptionTemplateField."Template No.");

      //Hole Positionen der caption
        CaptionValueFound := CaptureMgt.CaptureFromPos(CurrPage,CaptionTemplateField,0,FALSE,CaptionStartWord.Top,CaptionStartWord.Left,
          CaptionEndWord.Bottom,CaptionEndWord.Right,DocumentValue) <> '';

        IF CaptionValueFound THEN BEGIN
          FieldLeft := CaptionStartWord.Left +
          ROUND(CaptionTemplateField."Caption Offset X" * CaptureEngine.GetDPIFactor(CaptionTemplateField."Offset DPI",CurrPage."TIFF Image Resolution"),1);

          IF NOT Template."First Table Line Has Captions" THEN
            Bottom := CaptionStartWord.Top
          ELSE IF CaptionStartWord.Bottom > Bottom THEN
            Bottom := CaptionStartWord.Bottom;

          IF FieldWidth < CaptionEndWord.Right - CaptionStartWord.Left THEN
            FieldWidth := CaptionEndWord.Right - CaptionStartWord.Left;

          Top := CaptionStartWord.Top;
        END;
    END;

    LOCAL PROCEDURE CaptureTableCell@1000000005(VAR Template@161024014 : Record 6085579;VAR Document@1000000009 : Record 6085590;VAR Page@1000000000 : Record 6085591;VAR Field@1000000010 : Record 6085580;LineNo@1000000003 : Integer;Top@1000000007 : Integer;Left@1000000006 : Integer;Bottom@1000000005 : Integer;Right@1000000004 : Integer) : Integer;
    VAR
      Value@1000000008 : Record 6085593;
    BEGIN
      IF (Right - Left <= 0) OR (Bottom-Top <= 0) THEN
        EXIT;

      CaptureMgt.CaptureFromPos(Page,Field,LineNo,TRUE,Top,Left,Bottom,Right,Value);
      Value.FIND('=');

      IF (Value.IsBlank) OR TableCellAlreadyCaptured(Template,Page,Value) THEN
        Value.DELETE
      ELSE
        EXIT(Value.Bottom);
    END;

    LOCAL PROCEDURE TableCellAlreadyCaptured@1000000007(VAR Template@161024012 : Record 6085579;VAR Page@1000000002 : Record 6085591;VAR Value@1000000000 : Record 6085593) : Boolean;
    VAR
      Value2@1000000001 : Record 6085593;
      CaptureEngine@1113400000 : Codeunit 6085575;
    BEGIN
      Value2.SETCURRENTKEY("Document No.","Is Value",Type,"Page No.");
      IF NOT Template."First Table Line Has Captions" THEN
        Value2.SETRANGE("Is Value",TRUE);
      Value2.SETRANGE("Document No.",Page."Document No.");
      Value2.SETRANGE(Type,Value2.Type::Line);
      Value2.SETRANGE("Page No.",Value."Page No.");

      Value.Top := Value.Top + ROUND((Value.Bottom - Value.Top) / 2,1);
      Value.Left := Value.Left + 3;

      IF Value2.FINDSET(FALSE,FALSE) THEN
        REPEAT
          IF (NOT ((Value2.Code = Value.Code) AND (Value2."Line No." = Value."Line No."))) THEN
            IF CaptureEngine.IntersectsWith(Value,Value2) THEN
              EXIT(TRUE);
        UNTIL Value2.NEXT = 0;
    END;

    LOCAL PROCEDURE IsFieldValid@1113400005(VAR CaptionField@1113400000 : Record 6085580;Document@1000000001 : Record 6085590;LineNo@1000000002 : Integer) : Boolean;
    VAR
      Field@1000000000 : Record 6085580;
      Value@161024012 : Record 6085593;
    BEGIN
      CASE CaptionField."Data Type" OF
        Field."Data Type"::Number:
          BEGIN
            IF (NOT CaptionField.Required) THEN BEGIN
              IF Value.GET(Document."No.",TRUE,CaptionField.Code,LineNo) THEN BEGIN
                IF NOT Value."Is Valid" THEN BEGIN
                  EXIT;
                END ELSE BEGIN
                  EXIT(CaptureMgt.ParseNumber(Field,Value."Value (Text)",Value."Value (Decimal)"));
                END;
              END;
            END;
          END;
        Field."Data Type"::Text:
          IF Value.GET(Document."No.",TRUE,CaptionField.Code,LineNo) THEN BEGIN
            EXIT(IsValidText(CaptionField, Value."Value (Text)",Document."No."));
          END;
        Field."Data Type"::Date:
          IF Value.GET(Document."No.",TRUE,CaptionField.Code,LineNo) THEN
            EXIT(IsValidDate(CaptionField, Value."Value (Date)"));
        Field."Data Type"::Lookup:
          IF Value.GET(Document."No.",TRUE,CaptionField.Code,LineNo) THEN
            EXIT(IsValidLookup(CaptionField, Value."Value (Text)",Document."No."));
      END;
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE FillSortedFieldBuffer@1113400004(VAR TempSortedDocumentField@1113400000 : Record 6085595;VAR MandatoryField@1000000000 : Record 6085595;TempDocLine@1113400003 : TEMPORARY Record 6085596);
    VAR
      TemplateField@1113400001 : Record 6085580;
    BEGIN
      WITH TemplateField DO BEGIN
        SETRANGE("Template No.",TempDocLine."Template No.");
        SETRANGE(Type,Type::Line);
        IF FINDSET THEN
          REPEAT
            IF ("Advanced Line Recognition Type" <> "Advanced Line Recognition Type"::Default) AND
               (STRLEN(Formula)=0) AND (STRLEN(GetFixedValue)=0)  THEN
            BEGIN
              TempSortedDocumentField."Document No." := TempDocLine."Document No.";
              TempSortedDocumentField."Sort Order" := Sorting;
              TempSortedDocumentField."Field Code" := Code;
              TempSortedDocumentField.INSERT;
            END ELSE BEGIN
              IF Required THEN BEGIN
                MandatoryField."Document No." := TempDocLine."Document No.";
                MandatoryField."Sort Order" := Sorting;
                MandatoryField."Field Code" := Code;
                MandatoryField.INSERT;
              END;
            END;
          UNTIL NEXT = 0;
      END;
    END;

    LOCAL PROCEDURE GetStopLineRecognitionPositions@1000000001(VAR StopPos@1000000003 : ARRAY [100] OF Integer;CurrPageNo@1000000002 : Integer;Bottom@1000000004 : Integer;Document@1000 : Record 6085590);
    VAR
      Field@1000000000 : Record 6085580;
      Value@1000000001 : Record 6085593;
    BEGIN
      Field.RESET;
      Field.SETCURRENTKEY("Template No.",Type,"Sort Order");
      Field.SETRANGE("Template No.",Document."Template No.");
      Field.SETRANGE(Type,Field.Type::Header);
      Field.SETFILTER("Stop Lines Recognition",'>%1',Field."Stop Lines Recognition"::" ");
      IF Field.FINDSET THEN
        REPEAT
          Value.RESET;
          Value.SETRANGE("Document No.",Document."No.");
          Value.SETRANGE(Type,Field.Type);
          Value.SETRANGE(Code,Field.Code);
          Value.SETRANGE("Page No.",CurrPageNo);

          CASE Field."Stop Lines Recognition" OF
            Field."Stop Lines Recognition"::"If Caption is on same line",
            Field."Stop Lines Recognition"::"If Caption is on same line (continue on next page)":
              Value.SETRANGE("Is Value",FALSE);
            Field."Stop Lines Recognition"::"If Value is on same line",
            Field."Stop Lines Recognition"::"If Value is on same line (continue on next page)":
              Value.SETRANGE("Is Value",TRUE);
            Field."Stop Lines Recognition"::"If Caption or Value is on same line",
            Field."Stop Lines Recognition"::"If Caption or Value is on same line (continue on next page)":
              Value.SETRANGE("Is Value");
          END;

          Value.SETFILTER(Top,'>%1',0);
          IF Value.FINDFIRST THEN BEGIN
            IF (StopPos[Value."Page No."] = 0) OR (StopPos[Value."Page No."] > Value.Top) THEN
              IF (NOT (Value.Left = Value.Right) AND (Value.Bottom = Value.Top)) THEN
                StopPos[Value."Page No."] := Value.Top;
          END;
        UNTIL Field.NEXT = 0;
    END;

    LOCAL PROCEDURE CleanupPrevValues@100000000(Document@1000 : Record 6085590);
    VAR
      DocumentValue@100000000 : Record 6085593;
    BEGIN
      DocumentValue.SETRANGE("Document No.",Document."No.");
      DocumentValue.SETRANGE(Type,DocumentValue.Type::Line);
      DocumentValue.DELETEALL;
    END;

    LOCAL PROCEDURE CleanupTempValues@1160040000(Document@1000 : Record 6085590);
    VAR
      DocumentValue@1160040000 : Record 6085593;
    BEGIN
      // Clean up temporary created values
      DocumentValue.SETRANGE("Document No.",Document."No.");
      DocumentValue.SETRANGE(Type,DocumentValue.Type::Line);
      DocumentValue.SETFILTER("Line No.",'1000..');
      DocumentValue.DELETEALL;
    END;

    LOCAL PROCEDURE "--CopiesFromCaptureManagement--"@1160040009();
    BEGIN
      // The following functions are a copy of the same functions in the Capture Management Codeunit, where they are defined as "local"
    END;

    LOCAL PROCEDURE IsValidNumber@6085574(VAR Field@6085575 : Record 6085580;Number@6085574 : Decimal) : Boolean;
    VAR
      FieldRule@6085576 : Record 6085583;
      TempTemplateField@6085573 : TEMPORARY Record 6085580;
    BEGIN
      IF Field."Codeunit ID: Capture Value" <> 0 THEN
        EXIT(TestCaptureValue(Field,FieldRule,FORMAT(Number)));

      IF (Number = 0) AND Field.Required THEN
        EXIT(FALSE);

      CaptureMgt.FilterRule(Field,FieldRule);

      TempTemplateField."Fixed Value (Decimal)" := Number;
      TempTemplateField.INSERT;

      IF FieldRule.FINDSET THEN
        REPEAT
          IF FieldRule.Rule <> '' THEN BEGIN
            TempTemplateField.SETFILTER("Fixed Value (Decimal)",FieldRule.Rule);
            IF TempTemplateField.ISEMPTY THEN
              EXIT(FALSE);
          END;
        UNTIL FieldRule.NEXT = 0;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE IsValidDate@1000000014(VAR Field@1000000001 : Record 6085580;Date@1000000000 : Date) : Boolean;
    VAR
      FieldRule@161024012 : Record 6085583;
    BEGIN
      IF Field."Codeunit ID: Capture Value" <> 0 THEN
        EXIT(TestCaptureValue(Field,FieldRule,FORMAT(Date)));

      IF (Date = 0D) THEN
        EXIT(NOT Field.Required);

      IF FORMAT(Field."Validation Dateformula From") <> '' THEN
        IF Date < CALCDATE(Field."Validation Dateformula From",TODAY) THEN
          EXIT(FALSE);

      IF FORMAT(Field."Validation Dateformula To") <> '' THEN
        IF Date > CALCDATE(Field."Validation Dateformula To",TODAY) THEN
          EXIT(FALSE);

      IF Date < 01011754D THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE IsValidText@1000000015(VAR Field@1000000001 : Record 6085580;Text@1000000000 : Text[250];DocumentNo@6085573 : Code[20]) : Boolean;
    VAR
      FieldRule@1000000004 : Record 6085583;
      TempValue@161024012 : TEMPORARY Record 6085593;
      RegEx@1000000003 : Codeunit 6085585;
      IsValid@1000000002 : Boolean;
    BEGIN
      Text := UPPERCASE(Text);

      IF Field."Codeunit ID: Capture Value" <> 0 THEN
        IF TestCaptureValue(Field,FieldRule,Text) THEN
          EXIT(TRUE);

      CaptureMgt.FilterRule(Field,FieldRule);
      IF NOT FieldRule.FINDFIRST THEN
        EXIT((Text <> '') OR (NOT Field.Required));

      IF Text = '' THEN
        EXIT(NOT Field.Required);

      TempValue."Value (Text)" := Text;
      TempValue.INSERT;

      REPEAT
        FieldRule.Rule := UPPERCASE(FieldRule.Rule);
        IF (STRPOS(FieldRule.Rule,'<') <> 0) OR
          (STRPOS(FieldRule.Rule,'>') <> 0) OR
          (STRPOS(FieldRule.Rule,'|') <> 0) OR
          (STRPOS(FieldRule.Rule,'*') <> 0) OR
          (STRPOS(FieldRule.Rule,'&') <> 0)
        THEN BEGIN
          TempValue.SETFILTER("Value (Text)",FieldRule.Rule);
          IsValid := NOT TempValue.ISEMPTY;
        END ELSE BEGIN
          IF RegEx.IsMatch(Text,FieldRule.Rule) THEN BEGIN
            IF Field."Codeunit ID: Capture Value" <> 0 THEN
              IsValid := TestCaptureValue(Field,FieldRule,Text)
            ELSE
              IsValid := TRUE;

            IF IsValid AND Field."Enable Rule Generation" THEN BEGIN
              ClearFldRuleCreatedFromMaster(FieldRule,DocumentNo);

              // Several rules could have been copied from the master template. Delete these when a rule matches the found value
              DelFldRulesCreatedFromMaster(FieldRule."Entry No.");
            END;
          END;
        END;
      UNTIL (FieldRule.NEXT = 0) OR (IsValid);

      EXIT(IsValid);
    END;

    LOCAL PROCEDURE IsValidLookup@1000000031(Field@1000000001 : Record 6085580;Value@1160040000 : Text[250];DocumentNo@6085573 : Code[20]) : Boolean;
    VAR
      RecIDMgt@1160040001 : Codeunit 6085604;
    BEGIN
      EXIT(IsValidText(Field,Value,DocumentNo));
    END;

    LOCAL PROCEDURE IsValidBoolean@1160040016(VAR Field@1000000001 : Record 6085580;Boolean@1000000000 : Boolean) : Boolean;
    BEGIN
      EXIT(TRUE);
    END;

    LOCAL PROCEDURE TestCaptureValue@161024017(Field@161024012 : Record 6085580;Rule@161024013 : Record 6085583;Value@161024014 : Text[1024]) : Boolean;
    VAR
      TempCaptureFieldVal@161024015 : Record 6085597;
    BEGIN
      TempCaptureFieldVal."Field Type" := Field.Type;
      TempCaptureFieldVal."Field Code" := Field.Code;
      TempCaptureFieldVal."File Rule Entry No." := Rule."Entry No.";
      TempCaptureFieldVal.Rule := Rule.Rule;
      TempCaptureFieldVal.Value := Value;
      CODEUNIT.RUN(Field."Codeunit ID: Capture Value",TempCaptureFieldVal);
      EXIT(TempCaptureFieldVal."Is Valid");
    END;

    LOCAL PROCEDURE ClearFldRuleCreatedFromMaster@6085577(VAR FieldRule@6085573 : Record 6085583;DocumentNo@6085574 : Code[20]);
    BEGIN
      IF FieldRule."Created from Master Template" THEN BEGIN
        FieldRule."Created from Master Template" := FALSE;
        FieldRule."Document No." := DocumentNo;
        FieldRule.MODIFY(TRUE);
      END;
    END;

    LOCAL PROCEDURE DelFldRulesCreatedFromMaster@6085579(SkipEntryNo@6085574 : Integer);
    VAR
      FieldRule@6085573 : Record 6085583;
    BEGIN
      FieldRule.SETRANGE("Created from Master Template",TRUE);
      FieldRule.SETFILTER("Entry No.",'<>%1',SkipEntryNo);
      IF NOT FieldRule.ISEMPTY THEN
        FieldRule.DELETEALL(TRUE);
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 61002 Adv. Purch. - Line Validation
{
  OBJECT-PROPERTIES
  {
    Date=14-04-22;
    Time=12:00:00;
    Modified=Yes;
    Version List=ALR1.15;
  }
  PROPERTIES
  {
    TableNo=6085596;
    OnRun=BEGIN
            ALRLineValidation(Rec);
          END;

  }
  CODE
  {
    VAR
      LineAmountDiffCalcDiscAmtTxt@6085576 : TextConst 'DAN=I linje %1 er linjebelõb genkendt (%2) forskellig fra linjebelõb beregnet (%3) nÜr den genkendte rabat-% (%4) benyttes til beregning af rabatbelõb (%5).;DEU=Der erfasste Zeilenbetrag (%2) unterscheidet sich in Zeile %1 vom berechneten Zeilenbetrag (%3), der mit dem erfassten Rabatt % (%4) berechnet wurde, um den Rabattbetrag (%5) zu berechnen.;ENU=Line Amount captured (%2) is different from Line Amount calculated (%3) using captured Discount % (%4) to calculate Discount Amount (%5) on line %1.;FRA=Le montant de la ligne capturÇe (%2) est diffÇrent du montant de la ligne calculÇ (%3) Ö l''aide du % remise (%4) capturÇ pour calculer le montant de la remise (%5) Ö la ligne %1.;NLD=Herkend lijnbedrag (%2) is verschillend van berekend lijnbedrag (%3) met behulp van herkende korting % (%4) om korting (%5) op regel %1 te berekenen.';
      LineAmountDiffCapDiscAmtTxt@6085577 : TextConst 'DAN=I linje %1 er linjebelõb genkendt (%2) forskellig fra linjebelõb beregnet (%3) nÜr det genkendte rabatbelõb (%4) benyttes.;DEU=Der erfasste Zeilenbetrag (%2) unterscheidet sich in Zeile %1 von dem berechneten Zeilenbetrag (%3), der mit dem erfassten Rabattbetrag (%4) berechnet wurde.;ENU=Line Amount captured (%2) is different from Line Amount calculated (%3) using captured Discount Amount (%4) on line %1.;FRA=Line Amount captured (%2) is different from Line Amount calculated (%3) using captured Discount Amount (%4) on line %1.;NLD=Herkend lijnbedrag (%2) is verschillend van berekend lijnbedrag (%3) met behulp van herkende korting % (%4) op regel %1.';
      LineAmountDiffTxt@6085573 : TextConst 'DAN=I linje %1 er linjebelõb genkendt (%2) forskellig fra linjebelõb beregnet (%3).;DEU=Der erfasste Zeilenbetrag (%2) unterscheidet sich vom in Zeile %1 berechneten Zeilenbetrag (%3).;ENU=Line Amount captured (%2) is different from Line Amount calculated (%3) on line %1.;FRA=Le montant de la ligne capturÇe (%2) est diffÇrent du montant de ligne calculÇ (%3) Ö la ligne %1.;NLD=Herkend lijnbedrag (%2) is anders dan berekend lijnbedrag (%3) op regel %1.';
      WarningTxt@6085574 : TextConst 'DAN=ADVARSEL: %1;DEU=WARNUNG: %1;ENU=ATTENTION : %1;FRA=ATTENTION : %1;NLD=WAARSCHUWING: %1';

    LOCAL PROCEDURE ALRLineValidation@1(VAR TempDocumentLine@1000 : TEMPORARY Record 6085596);
    VAR
      Document@1001 : Record 6085590;
      Field@1022 : Record 6085580;
      DocumentComment@1021 : Record 6085594;
      EmptyField@1020 : Record 6085580;
      PurchDocMgt@1019 : Codeunit 6085709;
      CaptureMgt@1018 : Codeunit 6085576;
      DCAppMgt@1017 : Codeunit 6085722;
      Quantity@1016 : Decimal;
      UnitCost@1015 : Decimal;
      LineAmount@1014 : Decimal;
      DiscAmount@1013 : Decimal;
      DiscPct@1012 : Decimal;
      LineAmount2@1011 : Decimal;
      AmountRoundingPrecision@1010 : Decimal;
      OtherCharges@1009 : Decimal;
      UnitCharge@1008 : Decimal;
      LineDescription@1007 : Text[250];
      CommentText@1006 : Text[1024];
      CurrencyCode@1004 : Code[10];
      CommentType@1003 : 'Information,Warning,Error';
    BEGIN
      IF NOT Document.GET(TempDocumentLine."Document No.") THEN
        EXIT;

      //LineAccountNo := PurchDocMgt.GetLineAccountNo(Document,TempDocumentLine."Line No.");
      LineDescription := PurchDocMgt.GetLineDescription(Document,TempDocumentLine."Line No.");
      Quantity := PurchDocMgt.GetLineQuantity(Document,TempDocumentLine."Line No.");
      UnitCost := PurchDocMgt.GetLineUnitCost(Document,TempDocumentLine."Line No.");
      DiscPct := PurchDocMgt.GetLineDiscPct(Document,TempDocumentLine."Line No.");
      DiscAmount := PurchDocMgt.GetLineDiscAmount(Document,TempDocumentLine."Line No.");
      LineAmount := PurchDocMgt.GetLineAmount(Document,TempDocumentLine."Line No.");
      OtherCharges := PurchDocMgt.GetLineOtherCharges(Document,TempDocumentLine."Line No.");
      UnitCharge := PurchDocMgt.GetLineUnitCharge(Document,TempDocumentLine."Line No.");
      CurrencyCode := PurchDocMgt.GetCurrencyCode(Document);

      //ALR >>>
      //IF (LineAccountNo = '') AND (Quantity = 0) AND (UnitCost = 0) AND (LineAmount = 0) AND (DiscPct = 0) AND
      //  (DiscAmount = 0) AND (LineDescription = '')
      //THEN BEGIN
      //  Skip := TRUE;
      //  EXIT;
      //END;
      Field.SETRANGE("Template No.",TempDocumentLine."Template No.");
      Field.SETRANGE(Type,Field.Type::Line);
      Field.SETRANGE(Required,TRUE);
      IF Field.FINDSET THEN
      REPEAT
        IF STRLEN(CaptureMgt.GetValueAsText(TempDocumentLine."Document No.",TempDocumentLine."Line No.",Field)) = 0 THEN
          TempDocumentLine.Skip := TRUE;
      UNTIL Field.NEXT = 0;
      IF TempDocumentLine.Skip THEN
        EXIT;
      //ALR <<<

      Field.SETRANGE(Required);
      IF Field.FINDSET THEN
        REPEAT
          IF NOT CaptureMgt.IsValidValue(Field,TempDocumentLine."Document No.",TempDocumentLine."Line No.") THEN BEGIN
            // No need to write an error here as an error written in C6085580 - CDC Doc. - Field Validation
            TempDocumentLine.OK := FALSE;
            EXIT;
          END;
        UNTIL Field.NEXT = 0;

      IF NOT DCAppMgt.GetAmountRoundingPrecision(CurrencyCode,AmountRoundingPrecision) THEN BEGIN
        TempDocumentLine.OK := FALSE;
        EXIT;
      END;

      LineAmount2 := ROUND(Quantity * (UnitCost + UnitCharge),AmountRoundingPrecision);
      LineAmount2 += ROUND(OtherCharges,AmountRoundingPrecision);

      IF DiscAmount <> 0 THEN
        LineAmount2 := LineAmount2 - ROUND(DiscAmount,AmountRoundingPrecision)
      ELSE
        IF DiscPct <> 0 THEN BEGIN
          // We are rounding the discount amount before we subtract it from LineAmount as this is how standard NAV behaves on an Invoice
          DiscAmount :=  ROUND(LineAmount2 * DiscPct / 100,AmountRoundingPrecision);
          LineAmount2 := LineAmount2 - DiscAmount;
        END;

      // We use AmountRoundingPrecision as any roundings should be equal to AmountRoundingPrecision. In this situation,
      // we want the used to be able to register the document.
      // When a document is registered with a rounding difference, the
      TempDocumentLine.OK := (ABS(LineAmount - LineAmount2) <= AmountRoundingPrecision);

      IF TempDocumentLine."Create Comment" THEN
        IF LineAmount <> LineAmount2 THEN BEGIN
          IF TempDocumentLine.OK THEN BEGIN
            CommentType := CommentType::Warning;
            CommentText := WarningTxt;
          END ELSE BEGIN
            CommentType := CommentType::Error;
            CommentText := '%1';
          END;

          // LineAmount is Line Amount as captured/keyed in on the document line. We therefore want to show all decimals.
          IF (DiscPct = 0) AND (DiscAmount = 0) THEN
            DocumentComment.Add(Document,EmptyField,TempDocumentLine."Line No.",DocumentComment.Area::Validation,CommentType,
              STRSUBSTNO(CommentText,STRSUBSTNO(LineAmountDiffTxt,TempDocumentLine."Line No.",DCAppMgt.FormatAmountNoRounding(LineAmount,CurrencyCode),
                DCAppMgt.FormatAmount(LineAmount2,CurrencyCode))))
          ELSE
            IF DiscPct <> 0 THEN
              DocumentComment.Add(Document,EmptyField,TempDocumentLine."Line No.",DocumentComment.Area::Validation,CommentType,
                STRSUBSTNO(CommentText,STRSUBSTNO(LineAmountDiffCalcDiscAmtTxt,TempDocumentLine."Line No.",
                  DCAppMgt.FormatAmountNoRounding(LineAmount,CurrencyCode),
                  DCAppMgt.FormatAmount(LineAmount2,CurrencyCode),DiscPct,DCAppMgt.FormatAmount(DiscAmount,CurrencyCode))))
            ELSE
              DocumentComment.Add(Document,EmptyField,TempDocumentLine."Line No.",DocumentComment.Area::Validation,CommentType,
                STRSUBSTNO(CommentText,STRSUBSTNO(LineAmountDiffCapDiscAmtTxt,TempDocumentLine."Line No.",
                  DCAppMgt.FormatAmountNoRounding(LineAmount,CurrencyCode),
                  DCAppMgt.FormatAmount(LineAmount2,CurrencyCode),DCAppMgt.FormatAmount(DiscAmount,CurrencyCode))));
        END;
    END;

    BEGIN
    {
      This codeunit validates lines on purchase documents
    }
    END.
  }
}

OBJECT Codeunit 6085575 CDC Capture Engine
{
  OBJECT-PROPERTIES
  {
    Date=14-04-22;
    Time=12:00:00;
    Modified=Yes;
    Version List=DCW13.70.00.8.02,ALR1.15;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      GlobalWords@1000000001 : TEMPORARY Record 6085592;
      CaptureMgt@1000000000 : Codeunit 6085576;
      ContiniaLicenseMgt@1000 : Codeunit 6192771;
      Window@1000000004 : Dialog;
      BuffWordDocNo@1000000002 : Code[20];
      BuffWordPageNo@1000000003 : Integer;
      Text001@1000000005 : TextConst 'ENU=Processing Document\#1######################';
      Text002@1000000006 : TextConst 'ENU=Performing Identfication';
      Text003@1000000007 : TextConst 'ENU=Processing Header';
      Text004@1000000008 : TextConst 'ENU=Processing Lines';
      HideWindow@161024012 : Boolean;
      IdentificationFieldsTxt@6085573 : TextConst 'ENU=Identification Fields: %1';
      XmlDoc@6085574 : Codeunit 6192820;
      ObjType@1001 : 'TableData,Table,Form,Report,Dataport,Codeunit,XMLport,MenuSuite,Page,System,FieldNumber';
      ErrorNoXMLModule@1002 : TextConst 'ENU=You do not have access to the Document Capture XML Import module.';
      "<ALR Var>"@1003 : Integer;
      LineRegionFromPage@1004 : Integer;
      LineRegionFromPos@1005 : Integer;
      LineRegionToPage@1006 : Integer;
      LineRegionToPos@1007 : Integer;
      "</ALR Var>"@1008 : Integer;

    PROCEDURE CaptureDocument@1000000001(VAR Document@1000000000 : Record 6085590);
    VAR
      Template@1000000005 : Record 6085579;
      Field@1000000001 : Record 6085580;
      Value@1000000002 : Record 6085593;
      TemplateGroup@1000000004 : Record 6085575;
      Comment@1000000007 : Record 6085594;
      ModuleLicense@6085573 : Codeunit 6086008;
      DocumentComment@1000 : Record 6085594;
      Handled@6085600 : Boolean;
      DelgateDocumentMgt@6085574 : Codeunit 6086019;
      TelemetryLogging@1003 : Codeunit 6086032;
      TelemetryDimensions@1002 : Codeunit 6192809;
      TelemetryFormatMgt@1004 : Codeunit 6192796;
      FunctionalAreaMgt@1001 : Codeunit 6086033;
      DocCategory@1005 : Record 6085575;
    BEGIN
      Document.TESTFIELD(Status,Document.Status::Open);

      IF GUIALLOWED AND (NOT HideWindow) THEN BEGIN
        Window.OPEN(Text001);
        Window.UPDATE(1,Text002);
      END;

      TelemetryLogging.StartLogProcedure;

      IF (Document."File Type" = Document."File Type"::XML) AND NOT ContiniaLicenseMgt.HasLicenseAccessToDCXml THEN BEGIN
        Document.DeleteComments(DocumentComment.Area::Capture);
        DocumentComment.Add(Document,Field,0,DocumentComment.Area::Capture,DocumentComment."Comment Type"::Error,
          ErrorNoXMLModule);
      END;

      Document.CALCFIELDS("No. of Pages");
      TelemetryDimensions.Add('NoOfPages',TelemetryFormatMgt.Integer2Text(Document."No. of Pages"));

      IF (Document."Source Record ID Tree ID" = 0) OR (Document."Template No." = '') THEN BEGIN
        FindDocumentSource(Document);

        IF Document."Template No." = '' THEN BEGIN
          IF Document."Source Record ID Tree ID" <> 0 THEN BEGIN
            OnBeforeValidateDocument(Document,Handled);
            IF NOT Handled THEN
              Document.ValidateDocument;
          END;

          IF GUIALLOWED AND (NOT HideWindow) THEN
            Window.CLOSE;
          TelemetryDimensions.Add('HasTemplate',TelemetryFormatMgt.Boolean2Text(FALSE));
          TelemetryLogging.EndLogProcedure('0053','Capture document',FunctionalAreaMgt.DocAndTemplate,TelemetryDimensions);
          EXIT;
        END;
      END;
      Template.GET(Document."Template No.");

      Value.SETRANGE("Document No.",Document."No.");
      Value.SETRANGE("Is Value",TRUE);
      Value.DELETEALL(TRUE);

      IF GUIALLOWED AND (NOT HideWindow) THEN
        Window.UPDATE(1,Text003);

      Document."Match Status" := Document."Match Status"::Unmatched;
      Document.MODIFY;
      Document.DeleteComments(Comment.Area::Match);
      DelgateDocumentMgt.DeleteDocumentCommentLines(Document."No.");

      Field.SETCURRENTKEY("Template No.",Type,"Sort Order");
      Field.SETRANGE("Template No.",Document."Template No.");
      Field.SETRANGE(Type,Field.Type::Header);
      IF Field.FINDSET(FALSE,FALSE) THEN
        REPEAT
          IF (NOT UseFixedValue(Document,Field,0)) THEN
            IF Field."Search for Value" THEN
              IF CaptureField(Document,0,Field,TRUE) = '' THEN
                CaptureMgt.UpdateFieldValue(Document."No.",0,0,Field,'',TRUE,FALSE);
        UNTIL Field.NEXT = 0;

      IF ModuleLicense.IsAdvCaptureActivated(FALSE) THEN
        IF (Template."Recognize Lines" = Template."Recognize Lines"::Yes) THEN BEGIN
          IF GUIALLOWED AND (NOT HideWindow) THEN
            Window.UPDATE(1,Text004);

          OnBeforeRunLineCaptureCodeunit(Document,Handled);
          IF NOT Handled AND (Template."Codeunit ID: Line Capture" <> 0) THEN
            IF ContiniaLicenseMgt.HasExecutePermission(ObjType::Codeunit,Template."Codeunit ID: Line Capture") THEN
              CODEUNIT.RUN(Template."Codeunit ID: Line Capture",Document);
        END;

      OnBeforeAfterCapture(Document,Handled);
      IF NOT Handled THEN
        Document.AfterCapture;

      OnBeforeValidateDocument(Document,Handled);
      IF NOT Handled THEN
        Document.ValidateDocument;

      OnBeforeAutoDelegateDocument(Document,Handled);
      IF NOT Handled THEN
        DelgateDocumentMgt.AutoDelegateDocument(Document);

      TelemetryDimensions.Add('RecognizeLines',TelemetryFormatMgt.Boolean2Text(Template."Recognize Lines" =
        Template."Recognize Lines"::Yes));
      TelemetryDimensions.Add('HasTemplate',TelemetryFormatMgt.Boolean2Text(TRUE));

      IF DocCategory.GET(Document."Document Category Code") THEN
        TelemetryDimensions.Add('IsPurchaseCategory',TelemetryFormatMgt.Boolean2Text(DocCategory.IsPurchInvCrMemoCategory));

      TelemetryLogging.EndLogProcedure('0053','Capture document',FunctionalAreaMgt.DocAndTemplate,TelemetryDimensions);

      IF GUIALLOWED AND (NOT HideWindow) THEN
        Window.CLOSE;
    END;

    PROCEDURE CaptureField@1000000006(VAR Document@1000000001 : Record 6085590;PageNo@1160040001 : Integer;VAR Field@1000000000 : Record 6085580;UpdateFieldCaption@1160040000 : Boolean) Word : Text[1024];
    VAR
      DummyFieldCaption@1000000002 : Record 6085581;
    BEGIN
      EXIT(CaptureField2(Document,PageNo,Field,UpdateFieldCaption,DummyFieldCaption));
    END;

    PROCEDURE CaptureField2@6085573(VAR Document@1000000001 : Record 6085590;PageNo@1160040001 : Integer;VAR Field@1000000000 : Record 6085580;UpdateFieldCaption@1160040000 : Boolean;VAR FieldCaption@6085573 : Record 6085581) Word : Text[1024];
    VAR
      Page@1000000006 : Record 6085591;
      Value@1000000003 : Record 6085593;
      PrevPage@1160040002 : Record 6085591;
      PrevValue@1000000004 : Record 6085593;
      Top@1160040003 : Integer;
      Left@1160040004 : Integer;
      Bottom@1160040005 : Integer;
      Right@1160040006 : Integer;
      Handled@6085574 : Boolean;
    BEGIN
      OnBeforeCaptureField2(Document,PageNo,Field,UpdateFieldCaption,FieldCaption,Handled,Word);
      IF Handled THEN
        EXIT(Word);

      IF Document."File Type" = Document."File Type"::XML THEN BEGIN
        Word := CaptureMgt.CaptureFromXML(Document,Field,0,TRUE,Value,XmlDoc);
        EXIT(Word);
      END;

      FieldCaption.SETCURRENTKEY("Template No.",Type,Code,"Caption Length");
      FieldCaption.SETRANGE("Template No.",Field."Template No.");
      FieldCaption.SETRANGE(Type,Field.Type);
      FieldCaption.SETRANGE(Code,Field.Code);
      FieldCaption.SETFILTER(Caption,'<>%1','');
      FieldCaption.ASCENDING(FALSE);

      // *********************************************************************************************************************************
      // FIND THE VALUE BY OFFSETTING CAPTION
      // *********************************************************************************************************************************
      IF (Field."Caption Offset X" <> 0) OR (Field."Caption Offset Y" <> 0) OR (Field."Caption Is Part Of Value") THEN BEGIN
        IF FieldCaption.FIND('-') THEN
          REPEAT
            Word := FindWordFromCaption(Document."No.",PageNo,Field,FieldCaption,FALSE);
            IF Word <> '' THEN BEGIN
              IF UpdateFieldCaption THEN
                CaptureMgt.UpdateFieldCaption(Field,FieldCaption."Page No.",FieldCaption.Top,FieldCaption.Left,FieldCaption.DPI,
                  FieldCaption.Caption);
              EXIT(Word);
            END;
          UNTIL FieldCaption.NEXT = 0;
      END;

      // *********************************************************************************************************************************
      // FIND THE VALUE BY SEARCHING FROM THE CAPTION LIST
      // *********************************************************************************************************************************
      IF (Field."Caption Offset X" = 0) OR (Field."Caption Offset Y" = 0) THEN BEGIN
        IF FieldCaption.FIND('-') THEN
          REPEAT
            Word := FindWordFromCaption(Document."No.",PageNo,Field,FieldCaption,TRUE);
            IF Word <> '' THEN BEGIN
              IF UpdateFieldCaption THEN
                CaptureMgt.UpdateFieldCaption(Field,FieldCaption."Page No.",FieldCaption.Top,FieldCaption.Left,FieldCaption.DPI,
                  FieldCaption.Caption);
              EXIT(Word);
            END;
          UNTIL FieldCaption.NEXT = 0;
      END;

      // *********************************************************************************************************************************
      // FIND THE VALUE FROM THE REGION ALONE
      // *********************************************************************************************************************************
      IF NOT Field."Caption Mandatory" THEN BEGIN
        PrevValue.SETCURRENTKEY("Template No.","Is Value",Type,Code);
        PrevValue.SETRANGE("Template No.",Field."Template No.");
        PrevValue.SETRANGE("Is Value",TRUE);
        PrevValue.SETRANGE(Type,Field.Type);
        PrevValue.SETRANGE(Code,Field.Code);
        PrevValue.SETFILTER("Document No.",'<>%1',Document."No.");
        PrevValue.SETFILTER(Top,'>%1',0);
        PrevValue.SETFILTER(Left,'>%1',0);
        IF PrevValue.FINDLAST THEN BEGIN
          Page.SETRANGE("Document No.",Document."No.");
          IF PageNo > 0 THEN
            Page.SETRANGE("Page No.",PageNo);
          IF Field."Default Page Source" = Field."Default Page Source"::"First Page" THEN
            Page.FINDFIRST
          ELSE
            Page.FINDLAST;

          PrevPage.GET(PrevValue."Document No.",PrevValue."Page No.");

          Top := ROUND(PrevValue.Top * GetDPIFactor(PrevPage."TIFF Image Resolution",Page."TIFF Image Resolution"),1);
          Left := ROUND(PrevValue.Left * GetDPIFactor(PrevPage."TIFF Image Resolution",Page."TIFF Image Resolution"),1);
          Bottom := ROUND(PrevValue.Bottom * GetDPIFactor(PrevPage."TIFF Image Resolution",Page."TIFF Image Resolution"),1);

          IF Field."Typical Field Width" <> 0 THEN
            Right := Left + ROUND(Field."Typical Field Width" * GetDPIFactor(150,Page."TIFF Image Resolution"),1)
          ELSE
            Right := ROUND(PrevValue.Right * GetDPIFactor(PrevPage."TIFF Image Resolution",Page."TIFF Image Resolution"),1);

          Word := CaptureMgt.CaptureFromPos(Page,Field,0,TRUE,Top,Left,Bottom,Right,Value);

          IF CaptureMgt.ParseField(Field,Word,TRUE,Document."No.") THEN
            EXIT(Word);
        END;
      END;

      OnAfterCaptureField2(Document,PageNo,Field,UpdateFieldCaption,FieldCaption,Handled,Word);
      IF Handled THEN
        EXIT(Word);
    END;

    PROCEDURE FindDocumentSource@1160040002(VAR Document@1160040000 : Record 6085590);
    VAR
      IsHandled@1000 : Boolean;
    BEGIN
      // *********************************************************************************************************************************
      // FIND THE SOURCE ID OF A DOCUMENT
      // *********************************************************************************************************************************
      OnBeforeFindDocumentSource(Document,IsHandled);
      IF IsHandled THEN
        EXIT;

      IF Document."Temp Page No." = 0 THEN
        Document."Temp Page No." := 1;
      Document."Source Record ID Tree ID" := 0;

      // STEP 1: FIND SOURCE WITH SEARCH TEXTS
      IF FindSourceWithSearchTexts(Document) THEN
        EXIT;

      // STEP 2: FIND SOURCE WITH IDENTIFICATION TEMPLATE
      IF FindSourceWithIdentTemplate(Document) THEN
        EXIT;

      // STEP 3: FIND SOURCE WITH IDENTIFICATION FIELDS
      FindSourceWithIdentFields(Document);

      OnAfterFindDocumentSource(Document);
    END;

    PROCEDURE FindSourceWithSearchTexts@1160040001(VAR Document@1160040000 : Record 6085590) : Boolean;
    BEGIN
      CODEUNIT.RUN(CODEUNIT::"CDC Doc. - Search Word Ident.",Document);
      IF Document."Template No." <> '' THEN
        EXIT(TRUE);
    END;

    PROCEDURE FindSourceWithIdentTemplate@1160040000(VAR Document@1160040000 : Record 6085590) : Boolean;
    VAR
      DocCat@1160040006 : Record 6085575;
      Template@1160040005 : Record 6085579;
      IdentTemplate@1002 : Record 6085579;
      CDNDCMgt@6085574 : Codeunit 6086224;
      BestMatchPoints@6085573 : Integer;
      BestSourceRecTreeID@1004 : Integer;
      BestIdentifiedBy@1005 : Text[1024];
      CurrXmlMasterTemplate@1000 : Code[20];
      CurrSourceRecTreeID@1003 : Integer;
      Template2@1001 : Record 6085579;
      NewXmlDocument@6085290 : Boolean;
      EmptyGUID@6085575 : GUID;
      CDNTemplateCode@6086200 : Code[20];
    BEGIN
      Template.SETCURRENTKEY("Category Code",Type);
      Template.SETRANGE("Category Code",Document."Document Category Code");
      Template.SETRANGE(Type,Template.Type::Identification);

      IF Document."File Type" = Document."File Type"::XML THEN BEGIN
        IF NOT ContiniaLicenseMgt.HasLicenseAccessToDCXml THEN
          EXIT(FALSE);

        NewXmlDocument := Document."XML Ident. Template No." = '';

        IF Document."CDN GUID" <> EmptyGUID THEN BEGIN
          // Get template from Network profile
          CDNTemplateCode := CDNDCMgt.GetDCTemplate(Document."CDN GUID");
          IF CDNTemplateCode <> '' THEN
            Template.SETRANGE("No.",CDNTemplateCode);
        END;

        Template.SETRANGE("Data Type",Template."Data Type"::XML);
        Template.SETRANGE(Type,Template.Type::Master);

        CurrXmlMasterTemplate := Document."XML Master Template No.";
        CurrSourceRecTreeID := Document."Source Record ID Tree ID";

        IF Template.FINDSET(FALSE,FALSE) THEN
          REPEAT
            IdentTemplate.GET(Template."XML Ident. Template No.");
            IF IdentTemplate."Codeunit ID: After Capture" > 0 THEN BEGIN
              Document."Temp Ident. Template No." := IdentTemplate."No.";
              Document."Temp Master Template No." := Template."No.";
              IF CurrSourceRecTreeID = 0 THEN
                Document."Source Record ID Tree ID" := 0;

              CODEUNIT.RUN(IdentTemplate."Codeunit ID: After Capture",Document);
              IF Document."XML Identification Points" > BestMatchPoints THEN BEGIN
                BestMatchPoints := Document."XML Identification Points";
                Document."XML Master Template No." := Template."No.";
                Document."XML Ident. Template No." := Document."Temp Ident. Template No.";
                BestSourceRecTreeID := Document."Source Record ID Tree ID";
                BestIdentifiedBy := Document."Identified by";
              END;
            END;
          UNTIL (Template.NEXT = 0);

        IF (BestMatchPoints > 0) AND (CurrXmlMasterTemplate <> Document."XML Master Template No.") THEN BEGIN
          Document.VALIDATE("XML Master Template No.");
          Document."Temp Ident. Template No." := '';
          Document."Temp Master Template No." := '';
          Document."XML Identification Points" := 0;
          Document.MODIFY(TRUE);
        END;

        IF BestSourceRecTreeID <> 0 THEN BEGIN
          Document.VALIDATE("Identified by",BestIdentifiedBy);
          Document.VALIDATE("Source Record ID Tree ID",BestSourceRecTreeID);
          Document.MODIFY(TRUE);
        END;

        // Check if the source can be different based on template search texts.
        IF NewXmlDocument THEN
          IF FindSourceWithSearchTexts(Document) THEN
            EXIT(TRUE);

      END ELSE BEGIN
        Template.SETRANGE("Data Type",Template."Data Type"::PDF);
        IF Template.FINDSET(FALSE,FALSE) THEN
          REPEAT
            IF Template."Codeunit ID: After Capture" > 0 THEN
              CODEUNIT.RUN(Template."Codeunit ID: After Capture",Document);
          UNTIL (Document."Source Record ID Tree ID" <> 0) OR (Template.NEXT = 0);
      END;

      EXIT(Document."Source Record ID Tree ID" <> 0);
    END;

    PROCEDURE FindSourceWithIdentFields@1160040007(VAR Document@1160040000 : Record 6085590) : Boolean;
    VAR
      DocCat@1160040005 : Record 6085575;
      RecIDMgt@1160040004 : Codeunit 6085604;
      RecRef@1160040003 : RecordRef;
      RecID@1160040002 : RecordID;
      MatchPoints@1160040001 : Integer;
      SourceID@6085573 : Integer;
      IdentFieldNameValue@6085574 : Text[1024];
    BEGIN
      GetRecFromIdentField(Document,Document."Temp Page No.",RecID,MatchPoints,IdentFieldNameValue);
      IF MatchPoints >= 15 THEN BEGIN
        DocCat.GET(Document."Document Category Code");
        IF DocCat."Source Table No." <> 0 THEN BEGIN
          RecRef.GET(RecID);
          SourceID := RecIDMgt.GetRecIDTreeID(RecRef,TRUE);
          COMMIT;

          Document.VALIDATE("Source Record ID Tree ID",SourceID);
          Document."Identified by" := COPYSTR(STRSUBSTNO(IdentificationFieldsTxt,IdentFieldNameValue),1,
            MAXSTRLEN(Document."Identified by"));
          Document.MODIFY(TRUE);
          EXIT(TRUE);
        END;
      END ELSE
        Document."Identified by" := '';
    END;

    PROCEDURE FindWordFromCaption@1000000013(DocumentNo@1000000003 : Code[20];PageNo@1160040000 : Integer;VAR Field@1000000001 : Record 6085580;VAR FieldCaption@1000000000 : Record 6085581;DynamicsSearch@1000000018 : Boolean) Word : Text[1024];
    VAR
      CaptionStartWord@1000000005 : ARRAY [100] OF Record 6085592;
      CaptionEndWord@1000000004 : ARRAY [100] OF Record 6085592;
      Page@1000000009 : Record 6085591;
      LeftWord@1000000019 : TEMPORARY Record 6085592;
      TopWord@1000000020 : TEMPORARY Record 6085592;
      Value@1000000012 : Record 6085593;
      WordFunc@1000000011 : Codeunit 6085574;
      Length@1000000002 : Integer;
      Height@1000000006 : Integer;
      OffsetX@1000000007 : Integer;
      OffsetY@1000000008 : Integer;
      Top@1000000014 : Integer;
      Left@1000000015 : Integer;
      Bottom@1000000016 : Integer;
      Right@1000000017 : Integer;
      i@1000000010 : Integer;
      Stop@1000000013 : Boolean;
    BEGIN
      IF NOT FindCaption(DocumentNo,PageNo,Field,FieldCaption,CaptionStartWord,CaptionEndWord) THEN
        EXIT;

      i := 1;
      REPEAT
        Page.GET(DocumentNo,CaptionStartWord[i]."Page No.");

        Length := ROUND(IIFInt(Field."Typical Field Width" <> 0,Field."Typical Field Width",40) *
          GetDPIFactor(150,Page."TIFF Image Resolution"),1);
        Height := ROUND(IIFInt(Field."Typical Field Height" <> 0,Field."Typical Field Height",20) *
          GetDPIFactor(150,Page."TIFF Image Resolution"),1);

        // STORE THE CAPTION
        CaptureMgt.CaptureFromPos(Page,Field,0,FALSE,
          CaptionStartWord[i].Top,CaptionStartWord[i].Left,CaptionEndWord[i].Bottom,CaptionEndWord[i].Right,Value);

        IF NOT DynamicsSearch THEN BEGIN
          Top := IIFInt(Field."Caption Is Part Of Value",CaptionStartWord[i].Top,CaptionStartWord[i].Top +
            ROUND(Field."Caption Offset Y" * GetDPIFactor(Field."Offset DPI",Page."TIFF Image Resolution"),1));
          Left := IIFInt(Field."Caption Is Part Of Value",CaptionStartWord[i].Left,CaptionStartWord[i].Left +
            ROUND(Field."Caption Offset X" * GetDPIFactor(Field."Offset DPI",Page."TIFF Image Resolution"),1));
          Bottom := Top + Height;
          Right := Left + Length;

          Word := CaptureMgt.CaptureFromPos(Page,Field,0,TRUE,Top,Left,Bottom,Right,Value);
          CaptureMgt.ParseField(Field,Word,TRUE,DocumentNo);
          EXIT(Word);
        END;

      // *******************************************************************************************************************************
      // IF DATATYPE IS NUMBER THEN TRY TO FIND THE VALUE BELOW CAPTION
      // *******************************************************************************************************************************
        IF Field."Data Type" = Field."Data Type"::Number THEN BEGIN
          Top := CaptionStartWord[i].Bottom + ROUND(((CaptionStartWord[i].Bottom - CaptionStartWord[i].Top) / 2),1);
          Left := CaptionStartWord[i].Left;
          Bottom := Top + ((CaptionStartWord[i].Bottom - CaptionStartWord[i].Top));
          Right := CaptionEndWord[i].Right;

          Word := CaptureMgt.CaptureFromPos(Page,Field,0,TRUE,Top,Left,Bottom,Right,Value);

          IF CaptureMgt.ParseField(Field,Word,TRUE,DocumentNo) THEN
            EXIT(Word);
        END;

      // *******************************************************************************************************************************
      // SEARCH TO THE RIGHT OF CAPTION
      // *******************************************************************************************************************************
        Top := CaptionStartWord[i].Top + ROUND(((CaptionStartWord[i].Bottom - CaptionStartWord[i].Top) / 2),1);

        Bottom := Top + 1;
        Left := IIFInt(Field."Caption Is Part Of Value",CaptionStartWord[i].Left,
          CaptionEndWord[i].Right + ROUND(10 * GetDPIFactor(0,Page."TIFF Image Resolution"),1));
        Right := Left + ROUND(4000 * GetDPIFactor(0,Page."TIFF Image Resolution"),1);

        IF WordFunc.GetFirstWordFromLeft(Page,Top,Left,Bottom,Right,LeftWord) THEN BEGIN
          Left := LeftWord.Left;
          Right := Left + Length;

          Word := CaptureMgt.CaptureFromPos(Page,Field,0,TRUE,Top,Left,Bottom,Right,Value);
          IF CaptureMgt.ParseField(Field,Word,TRUE,DocumentNo) THEN
            EXIT(Word);
        END;

      // *******************************************************************************************************************************
      // SEARCH BELOW CAPTION
      // *******************************************************************************************************************************
        Top := IIFInt(Field."Caption Is Part Of Value",CaptionStartWord[i].Top +
          ROUND(((CaptionStartWord[i].Bottom - CaptionStartWord[i].Top) / 2),1),
          ROUND(CaptionStartWord[i].Bottom + ((CaptionStartWord[i].Bottom - CaptionStartWord[i].Top) / 2),1));
        Left := CaptionStartWord[i].Left;
        Bottom := Top + ROUND(80 * GetDPIFactor(0,Page."TIFF Image Resolution"),1);
        Right := CaptionEndWord[i].Right;

        IF WordFunc.GetFirstWordFromTop(Page,Top,Left,Bottom,Right,TopWord) THEN BEGIN
          Top := TopWord.Top;
          Bottom := TopWord.Bottom;

          Word := CaptureMgt.CaptureFromPos(Page,Field,0,TRUE,Top,Left,Bottom,Right,Value);

          IF CaptureMgt.ParseField(Field,Word,TRUE,DocumentNo) THEN
            EXIT(Word);
        END;

        IF i = 10 THEN
          Stop := TRUE
        ELSE BEGIN
          i := i + 1;
          Stop := CaptionStartWord[i].Word = '';
        END;
      UNTIL Stop;

      Word := '';
    END;

    PROCEDURE FindCaption@1000000016(DocumentNo@1000000006 : Code[20];PageNo@1000000004 : Integer;VAR Field@1000000001 : Record 6085580;FieldCaption@1000000000 : Record 6085581;VAR CaptionStartWord@1000000002 : ARRAY [100] OF Record 6085592;VAR CaptionEndWord@1000000016 : ARRAY [100] OF Record 6085592) : Boolean;
    VAR
      Doc@1160040000 : Record 6085590;
      Page@1160040004 : Record 6085591;
      PrevPage@1160040005 : Record 6085591;
      PrevCaption@1000000003 : Record 6085593;
      StartWord@1000000009 : Record 6085592;
      EndWord@1000000008 : Record 6085592;
      TempResultWord@1000000014 : ARRAY [100,2] OF Record 6085592;
      Sorter@1000000005 : TEMPORARY Record 283;
      WordFunc@1000000017 : Codeunit 6085574;
      CurrWord@1000000007 : Text[1024];
      WordFound@1000000011 : Text[1024];
      TempStr@1000000012 : Text[1024];
      I@1000000013 : Integer;
      NoOfCaptions@1000000015 : Integer;
      Found@1000000010 : Boolean;
      Stop@1000000018 : Boolean;
      PriorityTop@1160040001 : Integer;
      PriorityLeft@1160040002 : Integer;
      PagePriorityTop@1160040009 : Integer;
      PagePriorityLeft@1160040008 : Integer;
      PriorityPageNo@1160040003 : Integer;
      PrevDPIFactor@1160040006 : Integer;
      DPIFactor@1160040007 : Decimal;
    BEGIN
      BufferWords(DocumentNo,PageNo);
      CLEAR(CaptionStartWord);
      CLEAR(CaptionEndWord);

      FieldCaption.Caption := UPPERCASE(DELCHR(FieldCaption.Caption,'=',' '));
      GlobalWords.RESET;
      IF PageNo <> 0 THEN
        GlobalWords.SETRANGE("Page No.",PageNo);
      IF GlobalWords.FINDSET(FALSE,FALSE) THEN
        REPEAT
          CurrWord := UPPERCASE(DELCHR(GlobalWords.Word,'=',' '));

          IF (StartWord.Word <> '') THEN BEGIN
            IF NOT WordFunc.IsWordsOnSameLine(GlobalWords,StartWord) THEN BEGIN
              CLEAR(StartWord);
              WordFound := '';
            END;
          END;

          IF STRPOS(CurrWord,FieldCaption.Caption) > 0 THEN BEGIN
            StartWord := GlobalWords;
            EndWord := GlobalWords;
            WordFound := FieldCaption.Caption;
          END ELSE
            IF ((StartWord.Word <> '') AND (EndWord.Word = '')) THEN BEGIN
              IF (STRLEN(WordFound) + STRLEN(CurrWord) < STRLEN(FieldCaption.Caption)) THEN BEGIN
                IF (CurrWord = COPYSTR(FieldCaption.Caption,STRLEN(WordFound)+1,STRLEN(CurrWord))) THEN
                  WordFound := WordFound + CurrWord
                ELSE BEGIN
                  CLEAR(StartWord);
                  WordFound := '';
                END;
              END ELSE
                IF (COPYSTR(CurrWord,1,STRLEN(FieldCaption.Caption) - STRLEN(WordFound)) =
                  COPYSTR(FieldCaption.Caption,STRLEN(WordFound)+1))
                THEN BEGIN
                  EndWord := GlobalWords;
                  WordFound := FieldCaption.Caption;
                END ELSE BEGIN
                  CLEAR(StartWord);
                  WordFound := '';
                END;
            END ELSE BEGIN
              CLEAR(StartWord);
              WordFound := '';
            END;

          // This will search the current word, and see if it ends with part of the string to search for
          IF WordFound = '' THEN BEGIN
            TempStr := FieldCaption.Caption;
            I := 0;
            Stop := FALSE;
            WHILE (I < STRLEN(FieldCaption.Caption)) AND NOT Stop DO BEGIN
              I := I + 1;
              TempStr := COPYSTR(FieldCaption.Caption,I,1);
              IF (STRPOS(CurrWord,WordFound + TempStr) > 0) THEN BEGIN
                WordFound := WordFound + TempStr;
                StartWord := GlobalWords;
              END ELSE BEGIN
                IF STRLEN(CurrWord) > I THEN BEGIN
                  WordFound := '';
                  CLEAR(StartWord);
                END;
                Stop := TRUE;
              END;
            END;
          END;

          IF (StartWord.Word <> '') AND (EndWord.Word <> '') THEN BEGIN
            // Save the result for later comparision to other potential hits.
            NoOfCaptions := NoOfCaptions + 1;
            TempResultWord[NoOfCaptions,1] := StartWord;
            TempResultWord[NoOfCaptions,2] := EndWord;

            CLEAR(StartWord);
            CLEAR(EndWord);
            WordFound := '';
          END;
        UNTIL (GlobalWords.NEXT = 0) OR (NoOfCaptions = 100);

      // *******************************************************************************************************************
      // SELECT THE CAPTION THAT IS CLOSEST TO THE CAPTION THAT WAS ORIGINALLY SELECTED BY THE USER MANUALLY.
      // IF THE USER NEVER SELECTED THE CAPTION MANUALLY, THEN FIND THE LAST CAPTION AND PRIORITISE THE POSITION OF THAT.
      // *******************************************************************************************************************
      IF (FieldCaption.Top <> 0) OR (FieldCaption.Left <> 0) THEN BEGIN
        PrevDPIFactor := Field."Offset DPI";

        PriorityTop := FieldCaption.Top;
        PriorityLeft := FieldCaption.Left;
        PriorityPageNo := FieldCaption."Page No.";
      END ELSE BEGIN
        PrevCaption.SETCURRENTKEY("Template No.","Is Value",Type,Code);
        PrevCaption.SETRANGE("Template No.",Field."Template No.");
        PrevCaption.SETRANGE("Is Value",FALSE);
        PrevCaption.SETRANGE(Type,Field.Type);
        PrevCaption.SETRANGE(Code,Field.Code);
        PrevCaption.SETFILTER(Top,'>%1',0);
        PrevCaption.SETFILTER(Left,'>%1',0);
        IF NOT PrevCaption.FINDLAST THEN
          CLEAR(PrevCaption);

        IF PrevPage.GET(PrevCaption."Document No.",PrevCaption."Page No.") THEN
          PrevDPIFactor := PrevPage."TIFF Image Resolution"
        ELSE
          PrevDPIFactor := 0;

        PriorityTop := PrevCaption.Top;
        PriorityLeft := PrevCaption.Left;
        PriorityPageNo := PrevCaption."Page No.";
      END;

      FOR I := 1 TO NoOfCaptions DO BEGIN
        Doc.GET(DocumentNo);
        Doc.CALCFIELDS("No. of Pages");

        Page.GET(DocumentNo,TempResultWord[I,1]."Page No.");
        IF PrevDPIFactor <> 0 THEN
          DPIFactor := GetDPIFactor(PrevDPIFactor,Page."TIFF Image Resolution")
        ELSE
          DPIFactor := 1;
        PagePriorityTop := ROUND(PriorityTop * DPIFactor,1);
        PagePriorityLeft := ROUND(PriorityLeft * DPIFactor,1);

        Sorter."New Line Number" := I;
        Sorter."Old Line Number" := ABS((TempResultWord[I,1].Top - PagePriorityTop) + (TempResultWord[I,1].Left - PagePriorityLeft));
        IF (TempResultWord[I,1]."Page No." = Doc."No. of Pages") AND
          (Field."Default Page Source" = Field."Default Page Source"::"Last Page")
        THEN
          Sorter."Old Line Number" := Sorter."Old Line Number" - 15000
        ELSE
          IF TempResultWord[I,1]."Page No." = PriorityPageNo THEN
            Sorter."Old Line Number" := Sorter."Old Line Number" - 10000 // Give words on same page as previous the higher priority
          ELSE
            IF (TempResultWord[I,1]."Page No." = 1) AND (Field."Default Page Source" = Field."Default Page Source"::"First Page") THEN
              Sorter."Old Line Number" := Sorter."Old Line Number" - 5000;
        IF Sorter.INSERT THEN;
      END;

      I := 0;
      IF Sorter.FINDSET(FALSE,FALSE) THEN
        REPEAT
          I := I + 1;
          CaptionStartWord[I]:= TempResultWord[Sorter."New Line Number",1];
          CaptionEndWord[I]:= TempResultWord[Sorter."New Line Number",2];
        UNTIL (Sorter.NEXT = 0) OR (I = 10);

      EXIT(CaptionStartWord[1].Word <> '');
    END;

    PROCEDURE UseFixedValue@1000000002(VAR Document@1000000002 : Record 6085590;VAR Field@1000000000 : Record 6085580;LineNo@1000000003 : Integer) : Boolean;
    VAR
      RecIDMgt@161024012 : Codeunit 6085604;
    BEGIN
      CASE Field."Data Type" OF
        Field."Data Type"::Text:
          BEGIN
            IF Field."Fixed Value (Text)" <> '' THEN BEGIN
              CaptureMgt.UpdateFieldValue(Document."No.",0,LineNo,Field,Field."Fixed Value (Text)",TRUE,FALSE);
              EXIT(TRUE);
            END
          END;

        Field."Data Type"::Number:
          BEGIN
            IF Field."Fixed Value (Decimal)" <> 0 THEN BEGIN
              IF Field."Decimal Places" = '' THEN
                CaptureMgt.UpdateFieldValue(Document."No.",0,LineNo,Field,FORMAT(Field."Fixed Value (Decimal)"),TRUE,FALSE)
              ELSE
                CaptureMgt.UpdateFieldValue(Document."No.",0,LineNo,Field,
                  FORMAT(Field."Fixed Value (Decimal)",0,STRSUBSTNO('<Precision,%1><Standard Format,0>',Field."Decimal Places")),TRUE,
                    FALSE);

              EXIT(TRUE);
            END;
          END;

        Field."Data Type"::Date:
          BEGIN
            IF Field."Fixed Value (Date)" <> 0D THEN BEGIN
              CaptureMgt.UpdateFieldValue(Document."No.",0,LineNo,Field,FORMAT(Field."Fixed Value (Date)"),TRUE,FALSE);
              EXIT(TRUE);
            END ELSE
              IF Field."Fixed Value (Text)" = 'TODAY' THEN BEGIN
                CaptureMgt.UpdateFieldValue(Document."No.",0,LineNo,Field,FORMAT(TODAY),TRUE,FALSE);
                EXIT(TRUE);
              END;
          END;

        Field."Data Type"::Lookup:
          BEGIN
            IF Field."Fixed Value (Rec. ID Tree ID)" <> 0 THEN BEGIN
              CaptureMgt.UpdateFieldValue(Document."No.",0,LineNo,Field,
                RecIDMgt.GetKeyValue(Field."Fixed Value (Rec. ID Tree ID)",Field."Source Field No."),TRUE,FALSE);
              EXIT(TRUE);
            END;
          END;

        Field."Data Type"::Boolean:
          BEGIN
            IF Field."Fixed Value (Boolean)" THEN BEGIN
              CaptureMgt.UpdateFieldValue(Document."No.",0,LineNo,Field,FORMAT(Field."Fixed Value (Boolean)"),TRUE,FALSE);
              EXIT(TRUE);
            END;
          END;
      END;
    END;

    PROCEDURE IIFInt@1000000000(TestValue@1000000000 : Boolean;ValueIfTrue@1000000001 : Integer;ValueIfFalse@1000000002 : Integer) : Decimal;
    BEGIN
      IF TestValue THEN
        EXIT(ValueIfTrue)
      ELSE
        EXIT(ValueIfFalse);
    END;

    PROCEDURE IntersectsWith@1000000008(VAR Value@1000000008 : Record 6085593;VAR Value2@1000000009 : Record 6085593) : Boolean;
    BEGIN
      IF (Value.Left = Value2.Left) AND (Value.Right = Value2.Right) AND
        (Value.Top = Value2.Top) AND (Value.Bottom = Value2.Bottom)
      THEN
        EXIT(TRUE);

      EXIT(
        (Value.Left <= Value2.Right) AND (Value2.Left <= Value.Right) AND
        (Value.Top <= Value2.Bottom) AND (Value2.Top <= Value.Bottom));
    END;

    PROCEDURE BufferWords@1000000014(DocumentNo@1000000000 : Code[20];PageNo@1000000001 : Integer);
    VAR
      Words@1000000002 : Record 6085592;
      Handled@6085573 : Boolean;
      ALRDocumentPage@1000 : Record 6085591;
    BEGIN
      IF (BuffWordDocNo = DocumentNo) AND ((BuffWordPageNo = PageNo) OR (BuffWordPageNo = 0)) THEN
        EXIT;

      GlobalWords.RESET;
      GlobalWords.DELETEALL;

      OnBeforeBufferWords(DocumentNo,PageNo,Words,GlobalWords,Handled);
      IF NOT Handled THEN BEGIN
        Words.SETRANGE("Document No.",DocumentNo);
        //<ALR>
        IF (LineRegionFromPage > 0) OR (LineRegionToPage > 0) THEN BEGIN
          ALRDocumentPage.SETRANGE("Document No.",DocumentNo);
          ALRDocumentPage.SETRANGE("Page No.",LineRegionFromPage,LineRegionToPage);
          IF ALRDocumentPage.FINDSET THEN
            REPEAT
              IF LineRegionToPos = 0 THEN
                Words.SETFILTER(Top,STRSUBSTNO('%1..%2',LineRegionFromPos,ALRDocumentPage."Bottom Word Pos."))
              ELSE
                Words.SETFILTER(Top,DELCHR(STRSUBSTNO('%1..%2',LineRegionFromPos,LineRegionToPos),'=',' '));

              IF Words.FINDSET(FALSE,FALSE) THEN
                REPEAT
                  GlobalWords := Words;
                  GlobalWords.INSERT;
                UNTIL Words.NEXT = 0;
            UNTIL ALRDocumentPage.NEXT = 0;
        END ELSE BEGIN
        //</ALR>
        IF PageNo <> 0 THEN
          Words.SETRANGE("Page No.",PageNo);
        IF Words.FINDSET(FALSE,FALSE) THEN
          REPEAT
            GlobalWords := Words;
            GlobalWords.INSERT;
          UNTIL Words.NEXT = 0;
        //<ALR>
        END;
        //</ALR>

      END;

      BuffWordDocNo := DocumentNo;
      BuffWordPageNo := PageNo;
    END;

    PROCEDURE GetNextBottom@1000000004(VAR Page@1000000000 : Record 6085591;VAR Bottom@1000000001 : Integer;VAR Height@161024012 : Integer;VAR MinLeft@6085573 : Integer;VAR MaxRight@6085574 : Integer) : Boolean;
    BEGIN
      GlobalWords.SETCURRENTKEY("Document No.","Page No.",Bottom);
      GlobalWords.SETRANGE("Document No.",Page."Document No.");
      GlobalWords.SETRANGE("Page No.",Page."Page No.");
      GlobalWords.SETFILTER(Bottom,'>%1',Bottom);
      GlobalWords.SETFILTER(Left,'>=%1',MinLeft);
      GlobalWords.SETFILTER(Right,'<=%1',MaxRight);
      IF GlobalWords.FINDSET(FALSE,FALSE) THEN BEGIN
        Bottom := GlobalWords.Bottom;
        Height := ROUND(GlobalWords.Bottom - GlobalWords.Top,1);
        EXIT(TRUE);
      END ELSE BEGIN
        Bottom := 99999;
        EXIT(FALSE);
      END;
    END;

    PROCEDURE SetHideWindow@161024012(NewHideWindow@161024012 : Boolean);
    BEGIN
      HideWindow := NewHideWindow
    END;

    PROCEDURE GetRecFromIdentField@1160040006(VAR Document@1160040000 : Record 6085590;PageNo@1160040011 : Integer;VAR RecID@1160040012 : RecordID;VAR Points@1160040014 : Integer;VAR IdentFields@6085573 : Text[1024]);
    VAR
      DocCat@1160040009 : Record 6085575;
      IdentifierField@1160040006 : Record 6085759;
      DocWord@1160040005 : Record 6085592;
      SourceExcl@1160040002 : Record 6085598;
      TempLookupRecID@161024013 : Record 6085760;
      BigString@1160040010 : Codeunit 6085587;
      RecIDMgt@1160040013 : Codeunit 6085604;
      RecRef@1160040007 : RecordRef;
      BestRecRef@1160040003 : RecordRef;
      BestIdentificationFields@6085676 : Text[1024];
      FieldRef@1160040001 : FieldRef;
      IdentificationFields@6085576 : Text[1024];
      IdentFieldNameAndValue@6085575 : Text[1024];
      BestRecMatchPoint@1160040008 : Integer;
      RecMatchPoint@1160040004 : Integer;
      RecIDTreeID@161024014 : Integer;
      RecPoints@6085574 : Integer;
      XMLBuffer@6085577 : Record 6086200;
    BEGIN
      IdentifierField.SETRANGE("Document Category Code",Document."Document Category Code");
      IF NOT IdentifierField.FINDFIRST THEN
        EXIT;

      DocCat.GET(Document."Document Category Code");
      TempLookupRecID."Table No." := IdentifierField."Table No.";
      TempLookupRecID."Table Filter GUID" := DocCat."Document Category GUID";
      RecRef.OPEN(IdentifierField."Table No.");
      RecIDMgt.GetView(RecRef,TempLookupRecID);

      IF Document."File Type" = Document."File Type"::XML THEN BEGIN
        Document.BuildXmlBuffer(XMLBuffer);
        XMLBuffer.SETFILTER(Type,'%1|%2',XMLBuffer.Type::Element,XMLBuffer.Type::Attribute);
        IF NOT XMLBuffer.FINDSET(FALSE,FALSE) THEN
          EXIT;

        REPEAT
          BigString.Append(UPPERCASE(DELCHR(XMLBuffer.Value,'=',' ,.-;:/\*+')));
        UNTIL XMLBuffer.NEXT = 0;
      END ELSE BEGIN
        DocWord.SETRANGE("Document No.",Document."No.");
        DocWord.SETRANGE("Page No.",PageNo);
        IF NOT DocWord.FINDSET(FALSE,FALSE) THEN
          EXIT;

        REPEAT
          BigString.Append(UPPERCASE(DELCHR(DocWord.Word,'=',' ,.-;:/\*+-')));
        UNTIL DocWord.NEXT = 0;
      END;

      REPEAT
        RecIDTreeID := RecIDMgt.GetRecIDTreeID(RecRef,FALSE);
        IF NOT SourceExcl.GET(Document."Document Category Code",RecIDTreeID) THEN BEGIN
          RecMatchPoint := 0;
          IdentificationFields := '';
          IF IdentifierField.FINDSET THEN
            REPEAT
              FieldRef := RecRef.FIELD(IdentifierField."Field No.");
              RecPoints := GetPoints(FORMAT(FieldRef.VALUE),BigString,STRLEN(FORMAT(FieldRef.VALUE))) * IdentifierField.Rating;
              IF RecPoints > 0 THEN BEGIN
                RecMatchPoint += RecPoints;
                IdentifierField.CALCFIELDS("Field Caption");
                IdentFieldNameAndValue := IdentifierField."Field Caption" + ': ' + FORMAT(FieldRef.VALUE);

                IF IdentificationFields <> '' THEN
                  IdentificationFields := IdentificationFields + ', ';

                IF STRLEN(IdentificationFields + IdentFieldNameAndValue) <= 1024 THEN
                  IdentificationFields := IdentificationFields + IdentFieldNameAndValue;
              END;
            UNTIL IdentifierField.NEXT = 0;

            IF BestRecMatchPoint < RecMatchPoint THEN BEGIN
              BestRecMatchPoint := RecMatchPoint;
              BestRecRef := RecRef.DUPLICATE;
              BestIdentificationFields := IdentificationFields;
            END;
        END;
      UNTIL RecRef.NEXT = 0;

      CLEAR(RecRef);

      IF FORMAT(BestRecRef) = '' THEN
        EXIT;

      RecID := BestRecRef.RECORDID;
      Points := BestRecMatchPoint;
      IdentFields := BestIdentificationFields;
      CLEAR(BestRecRef);
    END;

    PROCEDURE GetPoints@161024013(Text@161024013 : Text[250];VAR BigString@161024012 : Codeunit 6085587;Points@161024015 : Integer) : Integer;
    BEGIN
      Text := UPPERCASE(DELCHR(Text,'=',' ,.-;:/\*+-'));
      IF (Text <> '') AND (BigString.IndexOf(Text) <> -1) THEN
        EXIT(Points);
    END;

    PROCEDURE GetDPIFactor@1160040003(OldDPI@1160040000 : Integer;NewDPI@1160040001 : Integer) : Decimal;
    BEGIN
      IF OldDPI = NewDPI THEN
        EXIT(1);

      IF OldDPI = 0 THEN
        OldDPI := 150;

      IF NewDPI = 0 THEN
        NewDPI := 150;

      EXIT(NewDPI / OldDPI);
    END;

    LOCAL PROCEDURE OnBeforeRunLineCaptureCodeunit@6085600(VAR Document@6085600 : Record 6085590;VAR Handled@6085601 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE OnBeforeCaptureField2@6085574(VAR Document@6085577 : Record 6085590;PageNo@6085576 : Integer;VAR Field@6085575 : Record 6085580;UpdateFieldCaption@6085574 : Boolean;VAR FieldCaption@6085573 : Record 6085581;VAR Handled@6085578 : Boolean;VAR Word@6085579 : Text[1024]);
    BEGIN
    END;

    LOCAL PROCEDURE OnAfterCaptureField2@6085576(VAR Document@6085579 : Record 6085590;PageNo@6085578 : Integer;VAR Field@6085577 : Record 6085580;UpdateFieldCaption@6085576 : Boolean;VAR FieldCaption@6085575 : Record 6085581;VAR Handled@6085574 : Boolean;VAR Word@6085573 : Text[1024]);
    BEGIN
    END;

    LOCAL PROCEDURE OnBeforeBufferWords@6085575(DocumentNo@6085573 : Code[20];PageNo@6085574 : Integer;VAR Words@6085577 : Record 6085592;VAR GlobalWords@6085575 : Record 6085592;VAR Handled@6085576 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE OnBeforeFindDocumentSource@1(VAR Document@1000 : Record 6085590;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE OnAfterFindDocumentSource@2(VAR Document@1000 : Record 6085590);
    BEGIN
    END;

    LOCAL PROCEDURE OnBeforeAfterCapture@25(VAR Document@1000 : Record 6085590;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE OnBeforeValidateDocument@26(VAR Document@1000 : Record 6085590;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE OnBeforeAutoDelegateDocument@27(VAR Document@1000 : Record 6085590;VAR IsHandled@1001 : Boolean);
    BEGIN
    END;

    LOCAL PROCEDURE "<ALR Function>"@5();
    BEGIN
    END;

    PROCEDURE SetLineRegion@3(FromPage@1000 : Integer;FromPos@1001 : Integer;ToPage@1002 : Integer;ToPos@1003 : Integer);
    BEGIN
      LineRegionFromPage := FromPage;
      LineRegionFromPos := FromPos;
      LineRegionToPage := ToPage;
      LineRegionToPos := ToPos;
      CLEAR(BuffWordDocNo);
      CLEAR(BuffWordPageNo);
    END;

    LOCAL PROCEDURE "</ALR Function>"@4();
    BEGIN
    END;

    BEGIN
    END.
  }
}

OBJECT Page 6085584 CDC Template Card
{
  OBJECT-PROPERTIES
  {
    Date=14-04-22;
    Time=12:00:00;
    Modified=Yes;
    Version List=DCW17.00.00.8.01,ALR1.15;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Vorlagenkarte;
               ENU=Template Card];
    InsertAllowed=No;
    SourceTable=Table6085579;
    DataCaptionExpr=GetCaption;
    PageType=Card;
    RefreshOnActivate=Yes;
    OnOpenPage=VAR
                 DCApprovalsBridge@6085574 : Codeunit 6085790;
                 PurchaseHeader@6085573 : Record 38;
                 CDCModuleLicense@6085575 : Codeunit 6086008;
                 DocCat@6085576 : Record 6085575;
               BEGIN
                 IF "No." <> '' THEN
                   CategoryCodeVisible := FALSE
                 ELSE
                   CategoryCodeVisible := TRUE;

                 ShowApproval := ((DCApprovalsBridge.IsPurchApprovalEnabledDocType(PurchaseHeader."Document Type"::Invoice)) OR
                   (DCApprovalsBridge.IsPurchApprovalEnabledDocType(PurchaseHeader."Document Type"::"Credit Memo"))) AND CDCModuleLicense.
                 IsApprovalActivated(FALSE);

                 AdvCaptureActivated := CDCModuleLicense.IsAdvCaptureActivated(FALSE);

                 IF NOT DocCat.GET("Category Code") THEN
                   CLEAR(DocCat);

                 HasSourceTableNo := DocCat."Source Table No." <> 0;
               END;

    OnAfterGetRecord=VAR
                       DocCat@1160040000 : Record 6085575;
                       TemplateSearchText@1160040001 : Record 6085588;
                     BEGIN
                       SETRANGE("No.");
                       SourceID := GetSourceID;
                       SourceName := GetSourceName;

                       CodeunitLineCapture := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Line Capture");
                       CodeunitAfterCapture := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: After Capture");
                       CodeunitLineVal := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Line Validation");
                       CodeunitDocVal := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Doc. Validation");
                       CodeunitRegister := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Register");
                       CodeunitRegisterYN := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Register (Y/N)");
                       CodeunitAfterStep1 := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: After Step 1");
                       CodeunitAfterStep2 := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: After Step 2");
                       CodeunitTransl := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Translations");
                       CodeunitShowMatch := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Show Match");

                       LineRecognitionEnabled := "Recognize Lines" = "Recognize Lines"::Yes;
                       RecognizeLinesBoolean := LineRecognitionEnabled;
                       PurchUpdateOrder := "Purch. Inv. Reg. Step 1" = "Purch. Inv. Reg. Step 1"::"Match & Update Order";
                       PurchUpdateRetOrder := "Purch. Cr.Memo Reg. Step 1" = "Purch. Cr.Memo Reg. Step 1"::"Match & Update Return Order";

                       IF NOT DocCat.GET("Category Code") THEN
                         CLEAR(DocCat);
                       IsSales := DocCat."Destination Header Table No." = DATABASE::"Sales Header";
                       IsPurchases := DocCat."Destination Header Table No." = DATABASE::"Purchase Header";
                       ShowInteractionTemplateCode := "Codeunit ID: Register" = CODEUNIT::"CDC Doc. - Reg. (Log Interact)";
                       ShowFirstLineHasCaptions := ("Recognize Lines" = "Recognize Lines"::Yes) OR (Type = Type::Master);
                       ShowDescription := SetShowDescription;
                       IsMasterTemplate := Type = Type::Master;
                       IsIdentificationTemplate := Type = Type::Identification;
                       PageIsEditable := CurrPage.EDITABLE;

                       HasSourceTableNo := DocCat."Source Table No." <> 0;

                       CurrPage.Fields.PAGE.SetTemplateNo("No.");
                       ShowMatching := ShowMatchingGroup;
                       ShowAutoOrderVarianceInv := "Purch. Inv. Reg. Step 1" = "Purch. Inv. Reg. Step 1"::"Match & Update Order";
                       ShowAutoOrderVarianceCrM := "Purch. Cr.Memo Reg. Step 1" = "Purch. Cr.Memo Reg. Step 1"::"Match & Update Return Order";

                       SearchTextEditable := TRUE AND PageIsEditable;
                       SearchText := "Search Text";
                       TemplateSearchText.SETRANGE("Template No.","No.");
                       IF NOT TemplateSearchText.ISEMPTY THEN BEGIN
                         SearchTextEditable := FALSE;
                         TemplateSearchText.FINDFIRST;
                         SearchText := TemplateSearchText."Search Text" + ' ' + STRSUBSTNO(TotalSearchTextsTxt,TemplateSearchText.COUNT);
                       END;

                       ShowXMLFields := "Data Type" = "Data Type"::XML;
                       StylesheetImported := "XML Stylesheet File".HASVALUE;
                       ShowUnitCostVariance := "Purch. Match Unit Cost" <> "Purch. Match Unit Cost"::No;
                     END;

    OnNewRecord=BEGIN
                  IF GETFILTER("Category Code") <> '' THEN
                    "Category Code" := GETRANGEMIN("Category Code");
                  SourceID := '';

                  CodeunitLineCapture := '';
                  CodeunitAfterCapture := '';
                  CodeunitLineVal := '';
                  CodeunitDocVal := '';
                  CodeunitRegister := '';
                  CodeunitRegisterYN := '';
                  CodeunitAfterStep1 := '';
                  CodeunitAfterStep2 := '';
                  CodeunitTransl := '';
                  CodeunitShowMatch := '';
                END;

    ActionList=ACTIONS
    {
      { 161024038;   ;ActionContainer;
                      Name=ActionItems;
                      ActionContainerType=ActionItems }
      { 161024037;1  ;ActionGroup;
                      Name=Functions;
                      CaptionML=[DEU=F&unktionen;
                                 ENU=F&unctions] }
      { 161024036;2  ;Action    ;
                      Name=Copy;
                      Ellipsis=Yes;
                      CaptionML=[DEU=&Kopie;
                                 ENU=&Copy];
                      ToolTipML=[DEU="ôffnen Sie ein Fenster, um eine neue Vorlage basierend auf dieser Vorlage zu erstellen. ";
                                 ENU="Open a window to create a new template based on this template. "];
                      Image=Copy;
                      OnAction=VAR
                                 CopyTempl@161024012 : Report 6085583;
                               BEGIN
                                 CopyTempl.SetFromTemplate(Rec);
                                 CopyTempl.RUNMODAL;
                               END;
                                }
      { 6085589 ;1   ;ActionGroup;
                      Name=Xml;
                      CaptionML=[DEU=Xml;
                                 ENU=Xml] }
      { 6085590 ;2   ;Action    ;
                      Name=ImportXslt;
                      CaptionML=[DEU=Stylesheet importieren;
                                 ENU=Import Stylesheet];
                      ToolTipML=[DEU=ôffnen Sie ein Fenster, um eine Stylesheet-Datei zu importieren.;
                                 ENU=Open a window to import a Stylesheet file.];
                      Visible=ShowXMLFields AND IsMasterTemplate;
                      Image=Import;
                      OnAction=BEGIN
                                 ImportStylesheet;
                               END;
                                }
      { 6085591 ;2   ;Action    ;
                      Name=ExportXslt;
                      CaptionML=[DEU=Stylesheet exportieren;
                                 ENU=Export Stylesheet];
                      ToolTipML=[DEU=ôffnen Sie ein Fenster, um die Stylesheet-Datei der Vorlage zu exportieren.;
                                 ENU=Open a window to export the Template's Stylesheet file.];
                      Visible=ShowXMLFields AND IsMasterTemplate;
                      Enabled=StylesheetImported;
                      Image=Export;
                      OnAction=BEGIN
                                 ExportStylesheet;
                               END;
                                }
      { 161024025;   ;ActionContainer;
                      Name=RelatedInformation;
                      ActionContainerType=RelatedInformation }
      { 161024024;1  ;ActionGroup;
                      Name=Template;
                      CaptionML=[DEU=&Vorlage;
                                 ENU=&Template] }
      { 6085599 ;2   ;Action    ;
                      Name=Network Profile;
                      CaptionML=[DEU=Netzwerkprofile;
                                 ENU=Network Profiles];
                      Image=Relationship;
                      OnAction=BEGIN
                                 ShowCDNNetworkProfiles;
                               END;
                                }
      { 161024022;2  ;ActionGroup;
                      Name=TranslationsGr;
                      CaptionML=[DEU=öbersetzungen;
                                 ENU=&Translations];
                      Image=Track }
      { 6       ;3   ;Action    ;
                      Name=Accounts for Amounts;
                      ShortCutKey=Ctrl+T;
                      CaptionML=[DEU=Konten fÅr BetrÑge;
                                 ENU=Accounts for Amounts];
                      ToolTipML=[DEU=öbersetzungen fÅr Konten fÅr BetrÑge anzeigen oder bearbeiten.;
                                 ENU=View or edit Account for Amounts translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSaleTranslTempl@1000 : Codeunit 6085710;
                               BEGIN
                                 PurchSaleTranslTempl.ShowAccountsForAmountsTrans(Rec);
                               END;
                                }
      { 7       ;3   ;Action    ;
                      Name=Salesperson/Purchaser;
                      CaptionML=[DEU=VerkÑufer/EinkÑufer;
                                 ENU=Salesperson/Purchaser];
                      ToolTipML=[DEU=öbersetzungen fÅr VerkÑufer/EinkÑufer anzeigen oder bearbeiten.;
                                 ENU=View or edit Salesperson/Purchaser translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSaleTranslTempl@1000 : Codeunit 6085710;
                               BEGIN
                                 PurchSaleTranslTempl.ShowSalespersonPurchaserTrans(Rec);
                               END;
                                }
      { 4       ;3   ;Action    ;
                      Name=NoTranslation;
                      CaptionML=[DEU=Nr.;
                                 ENU=No.];
                      ToolTipML=[DEU=öbersetzungen fÅr Nr. anzeigen oder bearbeiten.;
                                 ENU=View or edit No. translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSaleTranslTempl@1000 : Codeunit 6085710;
                               BEGIN
                                 PurchSaleTranslTempl.ShowItemNoTrans(Rec);
                               END;
                                }
      { 5       ;3   ;Action    ;
                      Name=DescriptionTranslation;
                      CaptionML=[DEU=Beschreibung;
                                 ENU=Description];
                      ToolTipML=[DEU=öbersetzungen fÅr Beschreibung anzeigen oder bearbeiten.;
                                 ENU=View or edit Description translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSaleTranslTempl@1000 : Codeunit 6085710;
                               BEGIN
                                 PurchSaleTranslTempl.ShowDescriptionTrans(Rec);
                               END;
                                }
      { 9       ;3   ;Action    ;
                      Name=UOM;
                      CaptionML=[DEU=Einheit;
                                 ENU=Unit of Measure];
                      ToolTipML=[DEU=öbersetzungen fÅr Einheit anzeigen oder bearbeiten.;
                                 ENU=View or edit Unit of Measure translations.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSaleTranslTempl@1000 : Codeunit 6085710;
                               BEGIN
                                 PurchSaleTranslTempl.ShowUOMTrans(Rec);
                               END;
                                }
      { 1       ;3   ;Action    ;
                      Name=CrossReferences;
                      CaptionML=[DEU=Artikelre&ferenzen;
                                 ENU=Cross Re&ferences];
                      ToolTipML=[DEU=Richtet eine eigene öbersetzung des ausgewÑhlten Artikel fÅr den Debitor oder Kreditor ein. Artikelreferenzen auf die Artikelnummer des Debitors bedeuten, dass ihre Artikelnummer automatisch anstelle der von Ihnen verwendeten Nummer auf den Verkaufsbelegen angezeigt wird.;
                                 ENU=Set up a customer's or vendor's own identification of the selected item. Cross-references to the customer's item number means that the item number is automatically shown on sales documents instead of the number that you use.];
                      Image=Change;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ItemReferenceMgt@6085574 : Codeunit 6086026;
                               BEGIN
                                 ItemReferenceMgt.ShowItemReference("Source Record Table ID","Source Record No.");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                Name=ContentArea;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                CaptionML=[DEU=Allgemein;
                           ENU=General];
                GroupType=Group }

    { 1000000002;2;Field  ;
                Name=No.;
                SourceExpr="No.";
                Visible=FALSE }

    { 1160040020;2;Field  ;
                Name=Category Code;
                ToolTipML=[DEU=Gibt die Belegkategorie an, zu der die Vorlage gehîrt.;
                           ENU=Specifies the category that the template belongs to.];
                SourceExpr="Category Code";
                Visible=CategoryCodeVisible }

    { 6085575;2;Field     ;
                Name=SourceID;
                ToolTipML=[DEU=Gibt den PrimÑrschlÅssel des Datensatzes an, zu dem diese Vorlage gehîrt. Bei Einkaufsvorlagen wird die Kreditorennummer angezeigt.;
                           ENU=Specifies the primary key of the record this template belong. For purchase related templates this will show the number of the vendor.];
                SourceExpr=SourceID;
                CaptionClass=GetSourceIDCaption;
                Importance=Promoted;
                Visible=FALSE;
                Editable=NOT IsMasterTemplate;
                OnValidate=BEGIN
                             SetSourceID(SourceID);
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           IF Type = Type::Master THEN
                             EXIT;

                           EXIT(RecIDMgt.LookupRecordID("Category Code",Text));
                         END;
                          }

    { 161024031;2;Field   ;
                Name=SourceName;
                ToolTipML=[DEU=Gibt den Namen des Datensatzes an, zu dem diese Vorlage gehîrt. Bei Einkaufsvorlagen wird der Name des Lieferanten angezeigt.;
                           ENU=Specifies the name of the record this template belong. For purchase related templates this will show the name of the vendor.];
                SourceExpr=SourceName;
                CaptionClass=GetSourceIDCaption;
                Visible=HasSourceTableNo;
                Editable=NOT IsMasterTemplate AND PageIsEditable;
                OnValidate=BEGIN
                             SetSourceID(SourceName);
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=VAR
                           Text2@6085573 : Text[250];
                         BEGIN
                           IF Type = Type::Master THEN
                             EXIT;

                           Text2 := GetSourceID;
                           IF NOT RecIDMgt.LookupRecordID("Category Code",Text2) THEN
                             EXIT;

                           SetSourceID(Text2);
                           CurrPage.UPDATE(TRUE);
                         END;
                          }

    { 6085578;2;Group     ;
                Name=DescriptionGroup;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowDescription;
                GroupType=Group }

    { 1000000007;3;Field  ;
                Name=Description;
                ToolTipML=[DEU=Gibt eine Beschreibung der Vorlage an.;
                           ENU=Specifies the description of the template.];
                SourceExpr=Description }

    { 1000000010;3;Field  ;
                Name=Default;
                ToolTipML=[DEU=Gibt an, ob dies die Standardvorlage fÅr diesen Datensatz ist.;
                           ENU=Specifies whether this is the default template for this record.];
                SourceExpr=Default }

    { 6085588;2;Field     ;
                Name=Data Type;
                SourceExpr="Data Type";
                Editable=IsIdentificationTemplate OR IsMasterTemplate }

    { 6085587;2;Group     ;
                Name=XML Data;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowXMLFields;
                GroupType=Group }

    { 6085585;3;Group     ;
                Name=Control6085585;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=IsMasterTemplate;
                GroupType=Group }

    { 6085586;4;Field     ;
                Name=XML Identification Template No.;
                ToolTipML=[DEU=Gibt die XML-Master-Vorlage an, die sich auf die aktuelle Identifikationsvorlage bezieht.;
                           ENU=Specifies the XML Identification Template related to the current Master Template.];
                SourceExpr="XML Ident. Template No.";
                Editable=IsMasterTemplate }

    { 6085595;3;Group     ;
                Name=Control6085595;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=IsMasterTemplate;
                GroupType=Group }

    { 6085593;4;Field     ;
                Name=StylesheetImported;
                CaptionML=[DEU=Stylesheet importiert;
                           ENU=Stylesheet Imported];
                ToolTipML=[DEU=Gibt an, ob fÅr die Vorlage ein XML-Stylesheet importiert wurde.;
                           ENU=Specifies whether the Template has a XML Stylesheet imported.];
                SourceExpr=StylesheetImported;
                Editable=FALSE }

    { 6085592;2;Group     ;
                Name=Invoice;
                CaptionML=[DEU=Rechnung;
                           ENU=Invoice];
                Visible=ShowXMLFields;
                GroupType=Group }

    { 6085584;3;Field     ;
                Name=Invoice XML Header Tag;
                CaptionML=[DEU=XML-Header-Tag;
                           ENU=XML Header Tag];
                ToolTipML=[DEU=Gibt das XML-Header-Tag fÅr Rechnungen an.;
                           ENU=Specifies the XML Header tag for Invoice Documents.];
                SourceExpr="Invoice XML Header Tag";
                OnAssistEdit=BEGIN
                               CaptureMgt.XmlPathAssistEdit(DocumentNo,"No.",0,'',"Invoice XML Header Tag");
                             END;
                              }

    { 6085583;3;Field     ;
                Name=Invoice XML Line Tag;
                CaptionML=[DEU=XML-Zeilen-Tag;
                           ENU=XML Line Tag];
                ToolTipML=[DEU="Gibt das XML-Zeilen-Tag fÅr Rechnungen an. Hiermit wird angegeben, wo die Rechnungszeilen im XML-Dokument platziert werden. ";
                           ENU="Specifies the XML Line tag for Invoice Documents. This will be used to indicate where the Invoice lines are placed in the XML Document. "];
                SourceExpr="Invoice XML Line Tag";
                OnAssistEdit=BEGIN
                               CaptureMgt.XmlPathAssistEdit(DocumentNo,"No.",0,'',"Invoice XML Line Tag");
                             END;
                              }

    { 6085698;3;Field     ;
                Name=Split XML at XPath Invoice;
                CaptionML=[DEU=Bei XML-Pfad teilen;
                           ENU=Split at XML Path];
                ToolTipML=[DEU=Gibt den XML-Pfad an, bei dem die Rechnungsdokumente aufgeteilt werden sollen.;
                           ENU=Specifies the XML Path where the invoice documents will be split.];
                SourceExpr="Split XML at XPath Invoice" }

    { 6085594;2;Group     ;
                Name=Cr.Memo;
                CaptionML=[DEU=Gutschrift;
                           ENU=Credit Memo];
                Visible=ShowXMLFields;
                GroupType=Group }

    { 2   ;3   ;Field     ;
                Name=Cr.Memo XML Header Tag;
                CaptionML=[DEU=XML-Header-Tag;
                           ENU=XML Header Tag];
                ToolTipML=[DEU=Gibt das XML-Header-Tag fÅr Gutschriften an.;
                           ENU=Specifies the XML Header tag for Credit Memo Documents.];
                SourceExpr="Cr.Memo XML Header Tag";
                OnAssistEdit=BEGIN
                               CaptureMgt.XmlPathAssistEdit(DocumentNo,"No.",0,'',"Cr.Memo XML Header Tag");
                             END;
                              }

    { 3   ;3   ;Field     ;
                Name=Cr.Memo XML Line Tag;
                CaptionML=[DEU=XML-Zeilen-Tag;
                           ENU=XML Line Tag];
                ToolTipML=[DEU="Gibt das XML-Zeilen-Tag fÅr Gutschriften an. Hiermit wird angegeben, wo die Gutschriftszeilen im XML-Dokument platziert werden. ";
                           ENU="Specifies the XML Line tag for Credit Memo Documents. This will be used to indicate where the Credit Memo lines are placed in the XML Document. "];
                SourceExpr="Cr.Memo XML Line Tag";
                OnAssistEdit=BEGIN
                               CaptureMgt.XmlPathAssistEdit(DocumentNo,"No.",0,'',"Cr.Memo XML Line Tag");
                             END;
                              }

    { 6085699;3;Field     ;
                Name=Split XML at XPath Cr. Memo;
                CaptionML=[DEU=Bei XML-Pfad teilen;
                           ENU=Split at XML Path];
                ToolTipML=[DEU=Gibt den XML-Pfad an, bei dem die Gutschriftsdokumente aufgeteilt werden sollen.;
                           ENU=Specifies the XML Path where the credit memo documents will be split.];
                SourceExpr="Split XML at XPath Cr. Memo" }

    { 1000000012;2;Field  ;
                Name=SearchTexts;
                ToolTipML=[DEU=Gibt einen oder mehrere eindeutige Texte an, die beim Identifizieren der Vorlage fÅr ein Dokument verwendet werden. Wenn alle Texte in einem Dokument vorhanden sind, wird die Vorlage automatisch auf dieses Dokument angewendet.;
                           ENU=Specifies one or more unique texts used when identifying the template for a document. If all texts exist in a document, then the template will automatically be applied to that document.];
                SourceExpr=SearchText;
                CaptionClass=FIELDCAPTION("Search Text");
                Visible=NOT IsMasterTemplate;
                Editable=SearchTextEditable;
                OnValidate=BEGIN
                             IF SearchTextEditable THEN BEGIN
                               "Search Text" := SearchText;
                               CurrPage.UPDATE(TRUE);
                             END ELSE
                               CurrPage.UPDATE(FALSE);
                           END;

                OnDrillDown=BEGIN
                              DrillDownSearchTexts;
                              CurrPage.UPDATE(FALSE);
                            END;
                             }

    { 1000000027;2;Field  ;
                Name=Language Code;
                ToolTipML=[DEU=Gibt die Sprache an, in der Datumsangaben erkannt werden, wenn Monate in Worten und nicht in Zahlen geschrieben werden. Um beispielsweise "October" zu erkennen, muss die Sprache Englisch sein. Bei allen Vorlagenfeldern wird die Sprache von der Vorlage Åbernommen.;
                           ENU=Specifies the language used to recognize dates when months are written in words and not numerical. For example, to recognize "Oktober" the language must be Danish. All template fields will have the language inherited from the template.];
                SourceExpr="Language Code";
                Importance=Additional }

    { 161024035;2;Field   ;
                Name=Date Format;
                ToolTipML=[DEU=Gibt das Datumsformat an, das zum Erkennen von Datumsangaben in Dokumenten verwendet wird. Alle Vorlagenfelder nutzen das von der Vorlage Åbernommene Datumsformat.;
                           ENU=Specifies the date format used to recognize dates in documents. All template fields will have the date format inherited from the template.];
                SourceExpr="Date Format";
                Importance=Additional }

    { 6085577;2;Group     ;
                Name=Lines;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowFirstLineHasCaptions AND AdvCaptureActivated AND NOT ShowXMLFields;
                GroupType=Group }

    { 161024015;3;Field   ;
                Name=First Table Line Has Captions;
                ToolTipML=[DEU=Gibt an, ob die erste Zeile der erfassten Belegzeilen die Suchtexte enthÑlt.;
                           ENU=Specifies whether the first line of captured document lines is a caption line.];
                SourceExpr="First Table Line Has Captions";
                Importance=Additional }

    { 1000000008;2;Field  ;
                Name=Show Document After Register;
                ToolTipML=[DEU=Gibt an, ob Dokumente nach der Registrierung angezeigt werden sollen.;
                           ENU=Specifies whether to show documents after registration.];
                SourceExpr="Show Document After Register" }

    { 6085576;2;Group     ;
                Name=Interactions;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowInteractionTemplateCode;
                GroupType=Group }

    { 1000000026;3;Field  ;
                Name=Interaction Template Code;
                ToolTipML=[DEU=Gibt den Code der AktivitÑtenvorlage an, die beim Erstellen von AktivitÑtenprotokollposten verwendet wird.;
                           ENU=Specifies the code of the interaction template used when creating interaction log entries.];
                SourceExpr="Interaction Template Code";
                Importance=Additional }

    { 6085581;2;Group     ;
                Name=MergeEMailGroup;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=AdvCaptureActivated AND NOT ShowXMLFields;
                GroupType=Group }

    { 1160040013;3;Field  ;
                Name=Merge from same E-mail;
                ToolTipML=[DEU=Gibt an, ob beim Importieren von Dokumenten alle angehÑngten PDF Dokumente aus derselben E-Mail in ein Dokument zusammengefÅhrt werden sollen.;
                           ENU=Specifies whether to merge all documents from the same email when importing documents.];
                SourceExpr="Merge from same E-mail";
                Importance=Additional }

    { 6085574;2;Group     ;
                Name=RecognizeLines;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=AdvCaptureActivated;
                GroupType=Group }

    { 6085582;3;Field     ;
                Name=RecognizeLinesBoolean;
                CaptionML=[DEU=Zeilen erkennen;
                           ENU=Recognize Lines];
                ToolTipML=[DEU=Gibt an, ob Dokumentenzeilen erfasst werden sollen. Dies wird automatisch aktiviert, wenn Sie die Zeilenerkennung in einem Dokument einrichten.;
                           ENU=Specifies whether to capture document lines. This is automatically enabled when you set up line capturing in a document.];
                SourceExpr=RecognizeLinesBoolean;
                Importance=Promoted;
                OnValidate=BEGIN
                             IF RecognizeLinesBoolean THEN
                               VALIDATE("Recognize Lines","Recognize Lines"::Yes)
                             ELSE
                               VALIDATE("Recognize Lines","Recognize Lines"::No);
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1160040025;2;Group  ;
                Name=Line Recognition;
                CaptionML=[DEU=Zeilenerkennung;
                           ENU=Line Recognition];
                Visible=LineRecognitionEnabled OR IsMasterTemplate;
                GroupType=Group }

    { 1160040001;3;Field  ;
                Name=Use Vendor/Customer Item Nos.;
                CaptionML=[DEU=Kreditor nutzt unsere Artikelnummern;
                           ENU=Vendor uses your Item Nos.];
                ToolTipML=[DEU=Gibt an, ob der Kreditor die gleichen Nummern wie Ihre Artikelnummern verwendet und Sie daher keine öbersetzung von der Kreditor-Artikelnr. in Ihre Artikelnummer erstellen mÅssen.;
                           ENU=Specifies if the vendor is using the same numbers as your item numbers and thereby you do not need to create a translation from the vendor item number to your item number.];
                SourceExpr="Use Vendor/Customer Item Nos." }

    { 12  ;3   ;Field     ;
                Name=ALRValidateLineTotals;
                Description=Needed until field is implemented by default;
                SourceExpr="Validate Line Totals" }

    { 1000000015;1;Group  ;
                Name=Purchase Documents;
                CaptionML=[DEU=Einkaufsbelege;
                           ENU=Purchase Documents];
                Visible=IsPurchases;
                GroupType=Group }

    { 1160040022;2;Group  ;
                Name=Registration;
                CaptionML=[DEU=Registrierung;
                           ENU=Registration];
                GroupType=Group }

    { 161024027;3;Field   ;
                Name=Purch. Inv. Reg. Step 1;
                ToolTipML=[DEU=Gibt den ersten Schritt an, der bei der Registrierung von Einkaufsrechnungen ausgefÅhrt werden muss.;
                           ENU=Specifies the first step to perform when registering purchase invoices.];
                SourceExpr="Purch. Inv. Reg. Step 1";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 161024026;3;Field   ;
                Name=Purch. Inv. Reg. Step 2;
                ToolTipML=[DEU=Gibt den zweiten Schritt an, der bei der Registrierung von Einkaufsrechnungen ausgefÅhrt werden muss.;
                           ENU=Specifies the second step to perform when registering purchase invoices.];
                SourceExpr="Purch. Inv. Reg. Step 2";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 161024019;3;Field   ;
                Name=Purch. Cr.Memo Reg. Step 1;
                ToolTipML=[DEU=Gibt den ersten Schritt an, der bei der Registrierung von Einkaufsgutschriften ausgefÅhrt werden muss.;
                           ENU=Specifies the first step to perform when registering purchase credit memos.];
                SourceExpr="Purch. Cr.Memo Reg. Step 1";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 161024018;3;Field   ;
                Name=Purch. Cr.Memo Reg. Step 2;
                ToolTipML=[DEU=Gibt den zweiten Schritt an, der bei der Registrierung von Einkaufsgutschriften ausgefÅhrt werden muss.;
                           ENU=Specifies the second step to perform when registering purchase credit memos.];
                SourceExpr="Purch. Cr.Memo Reg. Step 2" }

    { 161024034;3;Field   ;
                Name=Posting Date;
                ToolTipML=[DEU=Gibt an, welches Datum bei der Registrierung von Einkaufsbelegen als Buchungsdatum verwendet werden soll.;
                           ENU=Specifies which date to use as the posting date when registering purchase documents.];
                SourceExpr="Posting Date" }

    { 161024039;3;Field   ;
                Name=Prices Including VAT;
                ToolTipML=[DEU=Gibt an, ob Einkaufsbelege mit Preisen inkl. MwSt. erstellt werden sollen. Wenn eine Vorlage erstellt wird, wird diese Einstellung vom Kreditor Åbernommen.;
                           ENU=Specifies whether to create purchase documents with prices including VAT. When a template is created this setting defaults from the vendor.];
                SourceExpr="Prices Including VAT" }

    { 161024020;3;Field   ;
                Name=Allow Register without Amounts;
                ToolTipML=[DEU=Gibt an, ob Dokumente ohne Auswahl eines Sachkontos, einer Anlage, eines Artikels oder eines Artikel Zu-/Abschlag registriert werden dÅrfen. Dadurch werden Einkaufsbelege ohne Zeilen erstellt.;
                           ENU=Specifies whether it should be allowed to register documents without assigning any G/L account, fixed asset, item or item charge before registering. Doing so will create purchase documents without any lines.];
                SourceExpr="Allow Register without Amounts" }

    { 1000000014;3;Field  ;
                Name=Purch. Validate VAT Calc.;
                ToolTipML=[DEU=Gibt an, ob die MwSt.-Berechnung ÅberprÅft wird, wenn Einkaufsbelege registriert werden. Document Capture prÅft, ob der Betrag ohne MwSt. und der MwSt.-Betrag gleich dem Betrag inkl. MwSt. entspricht und erlaubt nur die Registrierung, wenn er gÅltig ist.;
                           ENU=Specifies whether to validate the VAT calculation when registering purchase documents. Document Capture checks if the amount excl. VAT and the VAT amount equal to the amount incl. VAT, and only allows you to register if it is valid.];
                SourceExpr="Purch. Validate VAT Calc.";
                Importance=Promoted }

    { 1160040024;2;Group  ;
                Name=Approval;
                CaptionML=[DEU=Genehmigung;
                           ENU=Approval];
                Visible=ShowApproval;
                GroupType=Group }

    { 161024041;3;Field   ;
                Name=Approval Flow Code;
                ToolTipML=[DEU=Gibt einen Genehmigungsablaufcode an, der fÅr alle mit dieser Vorlage erstellten Einkaufsbelege verwendet werden soll.;
                           ENU=Specifies an approval flow code to use on all purchase documents created with this template.];
                SourceExpr="Approval Flow Code" }

    { 161024016;3;Field   ;
                Name=Amount Validation;
                ToolTipML=[DEU=Gibt an, ob wÑhrend der Genehmigung die Gesamt-ZeilenbetrÑge bei der Registrierung oder Genehmigung ÅberprÅft werden sollen, um sicherzustellen, dass sie mit den ursprÅnglichen BetrÑgen auf den importierten Dokumenten Åbereinstimmen.;
                           ENU=Specifies whether to check the sum of line amounts when registering or approving purchase documents to ensure they match the original amounts on imported documents.];
                SourceExpr="Amount Validation" }

    { 161024014;3;Field   ;
                Name=Purch. Auto App. within Var.;
                ToolTipML=[DEU=Gibt an, ob Einkaufsbelege bei der Registrierung automatisch genehmigt werden sollen, wenn sie mit einer Bestellung oder einer RÅcklieferung innerhalb der erlaubten Abweichung Åbereinstimmen.;
                           ENU=Specifies whether to automatically approve purchase documents when registering if they match with a purchase order or a purchase return order within the allowed variance.];
                SourceExpr="Purch. Auto App. within Var." }

    { 1160040023;2;Group  ;
                Name=Matching;
                CaptionML=[DEU=Bestellabgleich;
                           ENU=Matching];
                Visible=ShowMatching;
                GroupType=Group }

    { 6085573;3;Field     ;
                Name=Purch. Auto Match;
                ToolTipML=[DEU=Gibt an, ob Dokumente bei der Verarbeitung automatisch abgeglichen werden.;
                           ENU=Specifies whether to match documents automatically when processed.];
                SourceExpr="Purch. Auto Match" }

    { 161024028;3;Field   ;
                Name=Purch. Match Invoice;
                ToolTipML=[DEU=Gibt an, welche Art von Dokumenten mit Rechnungen abgeglichen werden sollen.;
                           ENU=Specifies which type of documents to match invoices.];
                SourceExpr="Purch. Match Invoice" }

    { 1160040019;3;Field  ;
                Name=Purch. Match Credit Memo;
                ToolTipML=[DEU=Gibt an, welche Art von Dokumenten mit Gutschriften abgeglichen werden sollen.;
                           ENU=Specifies which type of documents to match credit memos.];
                SourceExpr="Purch. Match Credit Memo" }

    { 1000000019;3;Field  ;
                Name=Max. Variance Amt Allowed LCY;
                ToolTipML=[DEU=Gibt die maximal zulÑssige Differenz an, wenn eine Rechnung oder Gutschrift automatisch einer Lieferung oder RÅcklieferung zugeordnet wird. Document Capture akzeptiert einen automatischen Abgleich, auch wenn zwischen dem Betrag auf der importierten Rechnung oder Gutschrift und dem abgeglichenen Beleg eine Abweichung besteht, sofern er innerhalb dieses Betrags liegt.;
                           ENU=Specifies the maximum difference allowed when automatically matching an invoice or credit memo to either a receivable or deliverable document. Document Capture accepts an automatic match, even if there is a discrepancy between the amount on the imported invoice or credit memo and the matched document, if it is within this amount.];
                SourceExpr="Max. Variance Amt Allowed LCY" }

    { 1160040011;3;Field  ;
                Name=Allowed Variance %;
                ToolTipML=[DEU=Gibt die maximal zulÑssige Differenz in % an, wenn eine Rechnung oder Gutschrift automatisch einer Lieferung oder RÅcklieferung zugeordnet wird. Document Capture akzeptiert einen automatischen Abgleich, auch wenn zwischen dem Betrag auf der importierten Rechnung oder Gutschrift und dem abgeglichenen Beleg eine Abweichung besteht, sofern er innerhalb dieses Prozentsatzes liegt.;
                           ENU=Specifies the maximum percentage difference allowed when automatically matching an invoice or credit memo to either a receivable or deliverable document. Document Capture accepts an automatic match, even if there is a discrepancy between the amount on the imported invoice or credit memo and the matched document, if it is within the allowed percentage.];
                SourceExpr="Allowed Variance %" }

    { 161024023;3;Field   ;
                Name=Variance Posting Account;
                ToolTipML=[DEU=Gibt das Sachkonto an, das zum Buchen eines potenziellen Abweichungsbetrags verwendet wird.;
                           ENU=Specifies the G/L account used to post a potential variance amount.];
                SourceExpr="Variance Posting Account" }

    { 1160040016;3;Field  ;
                Name=Copy Matched Header Dimensions;
                ToolTipML=[DEU=Gibt an, ob die Kopfdimensionen des abgeglichenen Belegs bei der Registrierung in die Einkaufsrechnung oder -gutschrift kopiert werden sollen.;
                           ENU=Specifies whether to copy the header dimensions of the matched document to the purchase invoice or credit memo when registering.];
                SourceExpr="Copy Matched Header Dimensions" }

    { 6085579;3;Group     ;
                Name=ShowAutoOrderVarianceInv;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowAutoOrderVarianceInv;
                GroupType=Group }

    { 161024032;4;Field   ;
                Name=Auto Receive Order Variance;
                ToolTipML=[DEU=Gibt an, ob die mit der erlaubten Abweichung hinzugefÅgte Bestellzeile automatisch geliefert werden soll.;
                           ENU=Specifies whether to automatically receive the allowed variance line created on a purchase order.];
                SourceExpr="Auto Receive Order Variance" }

    { 6085580;3;Group     ;
                Name=ShowAutoOrderVarianceCrM;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowAutoOrderVarianceCrM;
                GroupType=Group }

    { 161024033;4;Field   ;
                Name=Auto Ship Return Order Var.;
                ToolTipML=[DEU=Gibt an, ob die mit der erlaubten Abweichung hinzugefÅgte Reklamationzeile automatisch geliefert werden soll.;
                           ENU=Specifies whether to automatically ship the allowed variance line created on a purchase return order.];
                SourceExpr="Auto Ship Return Order Var." }

    { 1160040021;2;Group  ;
                Name=Line Matching;
                CaptionML=[DEU=Zeilen matching;
                           ENU=Line Matching];
                Visible=LineRecognitionEnabled;
                GroupType=Group }

    { 1000000022;3;Field  ;
                Name=Purch. Match Order No.;
                ToolTipML=[DEU=Gibt an, ob die im Kopf oder in den Belegzeilen angegebene Bestellnummer Åbereinstimmen soll, wenn die Rechnung oder Gutschrift automatisch abgeglichen wird.;
                           ENU=Specifies whether to match the order number identified in the document header or lines, when automatically matching the invoice or credit memo.];
                SourceExpr="Purch. Match Order No." }

    { 1000000023;3;Field  ;
                Name=Purch. Match Item No.;
                ToolTipML=[DEU=Gibt an, ob die erkannte Artikelnr. in den Zeilen Åbereinstimmen soll, wenn die Rechnung oder Gutschrift automatisch abgeglichen wird. Die Artikelnr. muss bereits einem internen Konto / Artikel zugeordnet sein, bevor dies funktioniert.;
                           ENU=Specifies whether to match the vendor item number on the lines when automatically matching the invoice or credit memo. The vendor item number must already be mapped to an internal account/item before this works.];
                SourceExpr="Purch. Match Item No." }

    { 1000000024;3;Field  ;
                Name=Purch. Match Quantity;
                ToolTipML=[DEU=Gibt an, ob die Menge in den Zeilen abgeglichen werden soll, wenn die Rechnung oder Gutschrift automatisch abgeglichen wird.;
                           ENU=Specifies whether to match the quantity on the lines when automatically matching the invoice or credit memo.];
                SourceExpr="Purch. Match Quantity" }

    { 1000000025;3;Field  ;
                Name=Purch. Match Unit Cost>;
                ToolTipML=[DEU=Gibt an, ob der EK-Preis in den Zeilen abgeglichen werden soll, wenn die Rechnung oder Gutschrift automatisch abgeglichen wird.;
                           ENU=Specifies whether to match the unit cost on the lines when automatically matching the invoice or credit memo.];
                SourceExpr="Purch. Match Unit Cost";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 6085596;3;Group     ;
                Name=Unit Cost - Variance;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowUnitCostVariance;
                GroupType=Group }

    { 6085597;4;Field     ;
                ToolTipML=[DEU=Gibt die maximal erlaubte Abweichung zwischen dem erkannten Einstandspreis und dem Einstandspreis in der Bestellung an. Der Toleranzbetrag wird in MW angegeben, jedoch in die FremdwÑhrung umgerechnet, wenn die Bestellung in FremdwÑhrung erfolgt.;
                           ENU=Specifies the maximum variance between the recognized Unit Cost and the Unit Cost on the Purchase Order(PO). The variance amount is specified in LCY but it is converted to FCY if the PO is in foreign currency.];
                SourceExpr="Unit Cost - Variance Amt (LCY)" }

    { 6085598;4;Field     ;
                ToolTipML=[DEU="Gibt die maximale Abweichung zwischen dem erkannten Einstandspreis und dem Einstandspreis in der Bestellung als Prozentsatz des erkannten Werts an (""Einstandspreis"" auf der Rechnung). Beispiel: Wenn auf der Rechnung ein Einstandspreis von 100, - erfasst wurde und die Vorlage ""Einstandspreis - Toleranz %"" = 10% enthÑlt, stimmt der ""Bestellabgleich"" mit Bestellpositionen mit Einstandspreisen zwischen 90,- und 110,- Åberein. Wenn sowohl ""Einstandspreis - Toleranz %"" als auch ""Einstandspreis - Toleranzbetrag (MW)"" mit Werten gefÅllt sind, die sich von 0 (Null) unterscheiden, wird der kleinere der beiden Werte verwendet. ";
                           ENU="Specifies the maximum variance between the recognized Unit Cost and the Unit Cost on the Purchase Order(PO) as a percentage of the recognized value (""Unit Cost"" on the invoice). As an example: If a Unit Cost of 100,- has been recognized on the invoice, and the template has ""Unit Cost - Variance %"" = 10%, then ""Auto Match"" will match against PO lines with Unit Cost between 90,- and 110,-. If both ""Unit Cost - Variance %"" and ""Unit Cost - Variance Amt (LCY)"" are populated with values different from 0 (zero) the lesser of the two is used. "];
                SourceExpr="Unit Cost - Variance %" }

    { 1160040003;1;Group  ;
                Name=Sales Documents;
                CaptionML=[DEU=Verkaufsbelege;
                           ENU=Sales Documents];
                Visible=IsSales;
                GroupType=Group }

    { 1160040026;2;Group  ;
                Name=Registration2;
                CaptionML=[DEU=Registrierung;
                           ENU=Registration];
                GroupType=Group }

    { 1160040002;3;Field  ;
                Name=Sales Order Reg. Step 1;
                ToolTipML=[DEU=Gibt den ersten Schritt an, der bei der Registrierung von VerkaufsauftrÑgen ausgefÅhrt werden muss.;
                           ENU=Specifies the first step to perform when registering sales orders.];
                SourceExpr="Sales Order Reg. Step 1";
                Importance=Promoted }

    { 1160040004;3;Field  ;
                Name=Sales Order Reg. Step 2;
                ToolTipML=[DEU=Gibt den zweiten Schritt an, der bei der Registrierung von VerkaufsauftrÑgen ausgefÅhrt werden muss.;
                           ENU=Specifies the second step to perform when registering sales orders.];
                SourceExpr="Sales Order Reg. Step 2" }

    { 1160040017;3;Field  ;
                Name=Sales Cr.Memo Reg. Step 1;
                ToolTipML=[DEU=Gibt den ersten Schritt an, der bei der Registrierung von Verkaufsgutschriften ausgefÅhrt werden muss.;
                           ENU=Specifies the first step to perform when registering sales credit memos.];
                SourceExpr="Sales Cr.Memo Reg. Step 1" }

    { 1160040018;3;Field  ;
                Name=Sales Cr.Memo Reg. Step 2;
                ToolTipML=[DEU=Gibt den zweiten Schritt an, der bei der Registrierung von Verkaufsgutschriften ausgefÅhrt werden muss.;
                           ENU=Specifies the second step to perform when registering sales credit memos.];
                SourceExpr="Sales Cr.Memo Reg. Step 2" }

    { 1160040005;3;Field  ;
                Name=SalesPostingDate;
                ToolTipML=[DEU=Gibt an, welches Datum bei der Registrierung von Verkaufsbelegen als Buchungsdatum verwendet werden soll.;
                           ENU=Specifies which date to use as the posting date when registering sales documents.];
                SourceExpr="Posting Date" }

    { 1160040027;2;Group  ;
                Name=Line Recognition2;
                CaptionML=[DEU=Zeilenerkennung;
                           ENU=Line Recognition];
                Visible=LineRecognitionEnabled;
                GroupType=Group }

    { 1160040007;3;Field  ;
                Name=SalesUseVendorCustomerItemNos;
                CaptionML=[DEU=Debitor nutzt unsere Artikelnummern;
                           ENU=Customer uses your Item Nos.];
                ToolTipML=[DEU=Gibt an, ob der Debitor die gleichen Nummern wie Ihre Artikelnummern verwendet und Sie daher keine öbersetzung von der Debitor-Artikelnr. in Ihre Artikelnummer erstellen mÅssen.;
                           ENU=Specifies if the customer is using the same numbers as your item numbers and thereby you do not need to create a translation from the customer item number to your item number.];
                SourceExpr="Use Vendor/Customer Item Nos." }

    { 1160040010;3;Field  ;
                Name=SalesValidateLineTotals;
                ToolTipML=[DEU=Gibt an, ob der Betrag aller erkannten Zeilen gegen das Feld Betrag ohne MwSt. geprÅft werden soll. Bei einer erkannten Differenz wird damit die Registrierung eines Dokuments verhindert.;
                           ENU=Specifies whether to validate the amount of all recognized lines against the field amount excl. VAT and thereby prevent from registering a document there is a difference.];
                SourceExpr="Validate Line Totals";
                Importance=Promoted }

    { 161024040;1;Part    ;
                Name=Fields;
                CaptionML=[DEU=Felder;
                           ENU=Fields];
                PagePartID=Page6085585 }

    { 1000000017;1;Group  ;
                Name=Codeunits;
                CaptionML=[DEU=Codeunits;
                           ENU=Codeunits];
                Visible=AdvCaptureActivated;
                Editable=PageIsEditable;
                GroupType=Group }

    { 161024017;2;Field   ;
                Name=CodeunitLineCapture;
                CaptionML=[DEU=Zeilencapture;
                           ENU=Line Capture];
                ToolTipML=[DEU=Gibt eine Codeunit an, die beim Capturen von Dokumenten ausgefÅhrt werden soll.;
                           ENU=Specifies a codeunit to run when capturing lines of documents.];
                SourceExpr=CodeunitLineCapture;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Line Capture",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitLineCapture));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;
                          }

    { 1000000034;2;Field  ;
                Name=CodeunitAfterCapture;
                CaptionML=[DEU=Nach Capture;
                           ENU=After Capture];
                ToolTipML=[DEU=Gibt eine Codeunit an, die nach der Erkennung von Feldern und Zeilen ausgefÅhrt werden soll, jedoch bevor dem Benutzer Werte angezeigt werden.;
                           ENU=Specifies a codeunit to run after capturing fields and lines, but before values are shown to the user.];
                SourceExpr=CodeunitAfterCapture;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: After Capture",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitAfterCapture));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;
                          }

    { 1000000035;2;Field  ;
                Name=CodeunitLineVal;
                CaptionML=[DEU=Zeilenvalidierung;
                           ENU=Line Validation];
                ToolTipML=[DEU=Gibt eine Codeunit an, die ausgefÅhrt werden soll, um die Werte von erkannten Zeilen zu ÅberprÅfen.;
                           ENU=Specifies a codeunit to run to validate values of captured lines.];
                SourceExpr=CodeunitLineVal;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Line Validation",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitLineVal));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;
                          }

    { 1000000036;2;Field  ;
                Name=CodeunitDocVal;
                CaptionML=[DEU=Belegvalidierung;
                           ENU=Document Validation];
                ToolTipML=[DEU=Gibt eine Codeunit an, die ausgefÅhrt werden soll, um zu ÅberprÅfen, ob ein Dokument fÅr die Registrierung gÅltig ist.;
                           ENU=Specifies a codeunit to run to check if a document is valid for registration.];
                SourceExpr=CodeunitDocVal;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Doc. Validation",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitDocVal));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;
                          }

    { 1000000037;2;Field  ;
                Name=CodeunitRegister;
                CaptionML=[DEU=Registrierung;
                           ENU=Register];
                ToolTipML=[DEU=Gibt eine Codeunit an, die beim Registrieren von Dokumenten ausgefÅhrt werden soll.;
                           ENU=Specifies a codeunit to run when registering documents.];
                SourceExpr=CodeunitRegister;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Register",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitRegister));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;
                          }

    { 1000000038;2;Field  ;
                Name=CodeunitRegisterYN;
                CaptionML=[DEU=Registrieren (Ja/Nein);
                           ENU=Register (Y/N)];
                ToolTipML=[DEU=Gibt eine Codeunit an, die ausgefÅhrt werden soll, wenn die Dokumentregistrierung manuell aktiviert wird, jedoch bevor die Codeunit zum Registrieren von Dokumenten ausgefÅhrt wird.;
                           ENU=Specifies a codeunit to run when manually activating document registration but before the codeunit to register documents is run.];
                SourceExpr=CodeunitRegisterYN;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Register (Y/N)",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitRegisterYN));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;
                          }

    { 161024012;2;Field   ;
                Name=CodeunitAfterStep1;
                CaptionML=[DEU=Nach Schritt 1;
                           ENU=After Step 1];
                ToolTipML=[DEU=Gibt eine Codeunit an, die nach dem ersten Registrierungsschritt ausgefÅhrt werden soll.;
                           ENU=Specifies a codeunit to run after performing the first registration step.];
                SourceExpr=CodeunitAfterStep1;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: After Step 1",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitAfterStep1));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;
                          }

    { 161024013;2;Field   ;
                Name=CodeunitAfterStep2;
                CaptionML=[DEU=Nach Schritt 2;
                           ENU=After Step 2];
                ToolTipML=[DEU=Gibt eine Codeunit an, die nach dem zweiten Registrierungsschritt ausgefÅhrt werden soll.;
                           ENU=Specifies a codeunit to run after performing the second registration step.];
                SourceExpr=CodeunitAfterStep2;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: After Step 2",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitAfterStep2));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;
                          }

    { 1000000040;2;Field  ;
                Name=CodeunitTranslations;
                CaptionML=[DEU=öbersetzungen anzeigen;
                           ENU=Show Translations];
                ToolTipML=[DEU=Gibt eine Codeunit an, die zum Anzeigen von VorlagenÅbersetzungen ausgefÅhrt werden soll.;
                           ENU=Specifies a codeunit to run to show template translations.];
                SourceExpr=CodeunitTransl;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Translations",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitTransl));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;
                          }

    { 1000000041;2;Field  ;
                Name=CodeunitShowMatch;
                CaptionML=[DEU=Zuordnung zeigen;
                           ENU=Show Match];
                ToolTipML=[DEU=Gibt eine Codeunit an, die ausgefÅhrt werden soll, um Åbereinstimmende Zeilen anzuzeigen.;
                           ENU=Specifies a codeunit to run to show matched lines.];
                SourceExpr=CodeunitShowMatch;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Show Match",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitShowMatch));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;
                          }

  }
  CODE
  {
    VAR
      AllObjWithCaption@1000 : Record 2000000058;
      RecIDMgt@1001 : Codeunit 6085604;
      CaptureMgt@6085588 : Codeunit 6085576;
      SourceID@161024012 : Text[250];
      SourceName@6085578 : Text[250];
      SearchText@1160040013 : Text[250] INDATASET;
      CodeunitLineCapture@1160040001 : Text[250];
      CodeunitAfterCapture@1160040002 : Text[250];
      CodeunitLineVal@1160040003 : Text[250];
      CodeunitDocVal@1160040004 : Text[250];
      CodeunitRegister@1160040005 : Text[250];
      CodeunitRegisterYN@1160040006 : Text[250];
      CodeunitAfterStep1@1160040007 : Text[250];
      CodeunitAfterStep2@1160040008 : Text[250];
      CodeunitTransl@1160040010 : Text[250];
      CodeunitShowMatch@1160040011 : Text[250];
      CategoryCodeVisible@1160040000 : Boolean INDATASET;
      IsSales@1160040015 : Boolean INDATASET;
      IsPurchases@6085590 : Boolean INDATASET;
      PurchUpdateOrder@1160040014 : Boolean INDATASET;
      PurchUpdateRetOrder@1160040016 : Boolean INDATASET;
      LineRecognitionEnabled@1160040017 : Boolean INDATASET;
      ShowInteractionTemplateCode@6085573 : Boolean INDATASET;
      ShowFirstLineHasCaptions@6085574 : Boolean INDATASET;
      ShowApproval@6085575 : Boolean INDATASET;
      ShowMatching@6085576 : Boolean INDATASET;
      ShowDescription@6085580 : Boolean INDATASET;
      IsMasterTemplate@6085577 : Boolean INDATASET;
      PageIsEditable@6085579 : Boolean INDATASET;
      TotalSearchTextsTxt@1160040012 : TextConst 'DEU=(%1 Texte insgesamt);ENU=(%1 texts in total)';
      SearchTextEditable@1160040018 : Boolean INDATASET;
      ShowAutoOrderVarianceInv@6085581 : Boolean INDATASET;
      ShowAutoOrderVarianceCrM@6085582 : Boolean INDATASET;
      AdvCaptureActivated@6085583 : Boolean INDATASET;
      RecognizeLinesBoolean@6085584 : Boolean INDATASET;
      HasSourceTableNo@6085585 : Boolean INDATASET;
      ShowXMLFields@6085586 : Boolean INDATASET;
      IsIdentificationTemplate@6085587 : Boolean INDATASET;
      StylesheetImported@6085589 : Boolean INDATASET;
      DocumentNo@6085600 : Code[20];
      ShowUnitCostVariance@6085591 : Boolean INDATASET;

    LOCAL PROCEDURE SetShowDescription@6085574() : Boolean;
    VAR
      Template@6085573 : Record 6085579;
    BEGIN
      CASE Type OF
        Type::Identification:
          BEGIN
            IF "Data Type" = "Data Type"::XML THEN BEGIN
              Template.SETCURRENTKEY("Category Code",Type);
              Template.SETRANGE("Category Code","Category Code");
              Template.SETRANGE(Type,Type);
            END ELSE
              EXIT(FALSE);
          END;
        Type::Master:
          BEGIN
            Template.SETCURRENTKEY("Category Code",Type);
            Template.SETRANGE("Category Code","Category Code");
            Template.SETRANGE(Type,Type);
          END;
        Type::" ":
          BEGIN
            Template.SETCURRENTKEY("Category Code","Source Record ID Tree ID");
            Template.SETRANGE("Category Code","Category Code");
            Template.SETRANGE("Source Record ID Tree ID","Source Record ID Tree ID");
          END;
      END;
      EXIT(Template.COUNT > 1);
    END;

    PROCEDURE GetCaption@1160040000() : Text[250];
    BEGIN
      CASE Type OF
        Type::Identification,Type::Master:
          EXIT(STRSUBSTNO('%1 - %2',Type,"No."));
        Type::" ":
          EXIT(STRSUBSTNO('%1 - %2 - %3',"No.",GetSourceID,GetSourceName));
      END;
    END;

    PROCEDURE SetDocumentNo@6085600(NewDocumentNo@6085600 : Code[20]);
    BEGIN
      DocumentNo := NewDocumentNo;
      CurrPage.Fields.PAGE.SetDocumentNo(DocumentNo);
    END;

    LOCAL PROCEDURE ShowCDNNetworkProfiles@1();
    VAR
      TemplateProfileRel@1001 : Record 6086235;
    BEGIN
      TemplateProfileRel.FILTERGROUP := 2;

      TemplateProfileRel.SETRANGE("Document Category",Rec."Category Code");
      TemplateProfileRel.SETRANGE("XML Master Template",Rec."No.");

      PAGE.RUN(PAGE::"CTS-CDN DC Templ. Profile Rel.",TemplateProfileRel);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 6085586 CDC Template Field Card
{
  OBJECT-PROPERTIES
  {
    Date=14-04-22;
    Time=12:00:00;
    Modified=Yes;
    Version List=DCW17.00.00.8.00,ALR1.15;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Vorlage Feld Karte;
               ENU=Template Field Card];
    SourceTable=Table6085580;
    DataCaptionExpr=STRSUBSTNO('%1 - %2 - %3 - %4',"Template No.",Type,Code,"Field Name");
    PageType=Card;
    OnOpenPage=BEGIN
                 UpdateControls;
               END;

    OnAfterGetRecord=VAR
                       Template@6085574 : Record 6085579;
                       DocCat@6085573 : Record 6085575;
                     BEGIN
                       UpdateControls;

                       Template.GET("Template No.");
                       DocCat.GET(Template."Category Code");

                       CodeunitLookup := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Lookup");
                       CodeunitCaptureVal := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Capture Value");
                       CodeunitIsValid := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Is OK");
                       CodeunitValidate := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Validate");

                       SourceTable := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Table,"Source Table No.");
                       SourceField := RecIDMgt.GetFieldCaption("Source Table No.","Source Field No.");

                       DestHeaderField := RecIDMgt.GetFieldCaption(DocCat."Destination Header Table No.","Destination Header Field No.");
                       DestLineField := RecIDMgt.GetFieldCaption(DocCat."Destination Line Table No.","Destination Line Field No.");

                       FormulaTxt := '';
                       IF Formula <> '' THEN
                         FormulaTxt := Formula
                       ELSE BEGIN
                         FormulaTxt := GetFixedValue;
                         IF FormulaTxt <> '' THEN
                           FormulaTxt := '''' + FormulaTxt + '''';
                       END;

                       UpdateALRFields();
                     END;

    OnNewRecord=BEGIN
                  FILTERGROUP(4);
                  SETRANGE(Type);
                  SETRANGE(Code);

                  CLEAR(Type);
                  Code := '';
                  FILTERGROUP(0);

                  UpdateControls;

                  CodeunitLookup := '';
                  CodeunitCaptureVal := '';
                  CodeunitIsValid := '';
                  CodeunitValidate := '';

                  SourceTable := '';
                  SourceField := '';

                  DestHeaderField := '';
                  DestLineField := '';
                END;

    OnQueryClosePage=BEGIN
                       EXIT(IsFormulaValid(FormulaTxt,TRUE));
                     END;

    ActionList=ACTIONS
    {
      { 6085575 ;    ;ActionContainer;
                      Name=RelatedInformation;
                      ActionContainerType=RelatedInformation }
      { 6085574 ;1   ;ActionGroup;
                      Name=Functions;
                      CaptionML=[DEU=F&unktionen;
                                 ENU=F&unctions] }
      { 6085576 ;2   ;Action    ;
                      Name=Captions;
                      CaptionML=[DEU=Suchtexte;
                                 ENU=Captions];
                      ToolTipML=[DEU=Anzeigen oder Bearbeiten der Suchtexte, die in Dokumenten verwendet werden, um einen entsprechenden Wert zu finden.;
                                 ENU=View or edit captions searched for in documents to find a corresponding value.];
                      Promoted=Yes;
                      Visible=NOT ShowXmlPath;
                      Image=Comment;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowCaptions;
                               END;
                                }
      { 6085573 ;2   ;Action    ;
                      Name=Rules;
                      CaptionML=[DEU=Regeln;
                                 ENU=Rules];
                      ToolTipML=[DEU=Zeigen Sie die Regeln an oder bearbeiten Sie sie, um zu ÅberprÅfen, ob ein Feld einen gÅltigen Wert enthÑlt.;
                                 ENU=View or edit the rules used to check if a field contains a valid value.];
                      Promoted=Yes;
                      Image=ViewCheck;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowRules;
                               END;
                                }
      { 6085577 ;2   ;Action    ;
                      Name=Codeunits;
                      CaptionML=[DEU=Codeunits;
                                 ENU=Codeunits];
                      ToolTipML=[DEU=Anzeigen oder Bearbeiten von Codeunits, die zum AusfÅhren erweiterter Feldaktionen verwendet werden.;
                                 ENU=View or edit codeunits used to perform advanced field actions.];
                      Promoted=Yes;
                      Image=CodesList;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowCodeunits;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                Name=ContentArea;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                CaptionML=[DEU=Allgemein;
                           ENU=General];
                GroupType=Group }

    { 1160040016;2;Field  ;
                Name=Type;
                ToolTipML=[DEU=Gibt an, ob es sich um ein Kopf- oder Zeilenfeld handelt.;
                           ENU=Specifies whether this is a header or line field.];
                SourceExpr=Type;
                Visible=ShowCodeAndType }

    { 1160040017;2;Field  ;
                Name=Code;
                ToolTipML=[DEU=Gibt einen Vorlagenfeldcode an.;
                           ENU=Specifies a template field code.];
                SourceExpr=Code;
                Visible=ShowCodeAndType;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 1000000026;2;Field  ;
                Name=Field Name;
                ToolTipML=[DEU=Gibt den Namen des Felds an, das bei der Verarbeitung von Dokumenten angezeigt wird.;
                           ENU=Specifies the name of the field shown when processing documents.];
                SourceExpr="Field Name";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 6085585;2;Group     ;
                Name=XmlPathGroup;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowXmlPath;
                GroupType=Group }

    { 6085584;3;Field     ;
                Name=XMLPath;
                ToolTipML=[DEU=Gibt den XML-Pfad an, unter dem sich der Wert fÅr dieses Feld im XML-Dokument befindet.;
                           ENU=Specifies the XML Path where the value for this field is to be found in the XML Document.];
                SourceExpr="XML Path";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                OnAssistEdit=VAR
                               CaptureMgt@6085573 : Codeunit 6085576;
                             BEGIN
                               IF CaptureMgt.XmlPathAssistEdit(CurrentDocumentNo,"Template No.",Type,Code,"XML Path") THEN
                                 VALIDATE("XML Path");
                             END;
                              }

    { 6085601;2;Group     ;
                Name=ShowFieldGroup;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowXmlPath AND ShowXMLShowField;
                GroupType=Group }

    { 1   ;3   ;Field     ;
                ToolTipML=[DEU=Gibt an, ob das Zeilenfeld in der Dokumentenkarte angezeigt werden soll.;
                           ENU=Specifies wheather to show the Line Template Field in the Document Card.];
                SourceExpr="Show Field" }

    { 1000000008;2;Field  ;
                Name=Caption;
                CaptionML=[DEU=Suchtext;
                           ENU=Caption];
                ToolTipML=[DEU=Gibt den Suchtext an, nach dem in Dokumenten gesucht wird, um das Feld und den Wert zu identifizieren. Verwenden Sie den Drilldown, um weitere Suchtexte anzugeben.;
                           ENU=Specifies the caption that is searched for in documents to identify the field and value. Use drill down to specify alternative captions.];
                SourceExpr=CaptionText;
                Visible=NOT ShowXmlPath;
                Editable=EditCaption;
                OnValidate=VAR
                             TemplateFieldCaption@6085573 : Record 6085581;
                           BEGIN
                             TemplateFieldCaption.SETRANGE("Template No.","Template No.");
                             TemplateFieldCaption.SETRANGE(Type,Type);
                             TemplateFieldCaption.SETRANGE(Code,Code);
                             IF TemplateFieldCaption.FINDFIRST THEN BEGIN
                               IF CaptionText = '' THEN
                                 TemplateFieldCaption.DELETE
                               ELSE BEGIN
                                 TemplateFieldCaption.Caption := CaptionText;
                                 TemplateFieldCaption."Caption Length" := STRLEN(TemplateFieldCaption.Caption);
                                 TemplateFieldCaption.MODIFY;
                               END;
                             END ELSE BEGIN
                               TemplateFieldCaption.INIT;
                               TemplateFieldCaption."Template No." := "Template No.";
                               TemplateFieldCaption.Type := Type;
                               TemplateFieldCaption.Code := Code;
                               TemplateFieldCaption."Line No." := 10000;
                               TemplateFieldCaption.Caption := CaptionText;
                               TemplateFieldCaption."Caption Length" := STRLEN(TemplateFieldCaption.Caption);
                               TemplateFieldCaption.INSERT;
                             END;
                           END;

                OnDrillDown=BEGIN
                              ShowCaptions;
                            END;
                             }

    { 1000000025;2;Field  ;
                Name=Rule;
                CaptionML=[DEU=Regel;
                           ENU=Rule];
                ToolTipML=[DEU=Gibt die Regel an, mit der geprÅft wird, ob der Wert des Felds ein korrektes Format hat. Verwenden Sie den Drilldown, um mehrere Regeln anzugeben.;
                           ENU=Specifies the rule used to check if the value of the field has a correct format. Use drill down to specify multiple rules.];
                SourceExpr=RuleText;
                Editable=EditRule;
                OnValidate=VAR
                             TemplateFieldRule@6085573 : Record 6085583;
                           BEGIN
                             TemplateFieldRule.SETRANGE("Template No.","Template No.");
                             TemplateFieldRule.SETRANGE(Type,Type);
                             TemplateFieldRule.SETRANGE(Code,Code);
                             IF TemplateFieldRule.FINDFIRST THEN BEGIN
                               IF RuleText = '' THEN
                                 TemplateFieldRule.DELETE
                               ELSE BEGIN
                                 TemplateFieldRule.Rule := RuleText;
                                 TemplateFieldRule.MODIFY;
                               END;
                             END ELSE BEGIN
                               TemplateFieldRule.INIT;
                               TemplateFieldRule."Template No." := "Template No.";
                               TemplateFieldRule.Type := Type;
                               TemplateFieldRule.Code := Code;
                               TemplateFieldRule."Entry No." := 10000;
                               TemplateFieldRule.Rule := RuleText;
                               TemplateFieldRule.INSERT;
                             END;
                           END;

                OnDrillDown=BEGIN
                              ShowRules;
                            END;
                             }

    { 1000000003;2;Field  ;
                Name=Required;
                ToolTipML=[DEU=Gibt an, ob das Feld ein Pflichtfeld ist. Wenn im Dokument kein Wert erkannt werden kann, muss der Wert manuell angegeben werden, um das Dokument registrieren zu kînnen.;
                           ENU=Specifies whether a value is required for the field before a document can be registered. If a value cannot be recognized in the document, then the value must be specified manually to register the document.];
                SourceExpr=Required;
                Importance=Additional }

    { 1000000004;2;Field  ;
                Name=Search for Value;
                ToolTipML=[DEU=Gibt an, ob wÑhrend der Erkennung nach dem Feld gesucht werden soll.;
                           ENU=Specifies whether to search for the field during recognition.];
                SourceExpr="Search for Value";
                Importance=Additional;
                Editable=SearchForValueEditable }

    { 6085583;2;Field     ;
                Name=Formula Text;
                CaptionML=[DEU=Formel;
                           ENU=Formula];
                ToolTipML=[DEU=Gibt eine Formel an, die zur Berechnung des Feldwerts verwendet wird. Wenn es sich um ein Zahlenfeld handelt, kînnen Sie die Formel mit anderen Zahlenfeldern aus der Vorlage oder mit konstanten Zahlenwerten erstellen und Operatoren wie * / + - verwenden. Wenn es sich um ein Textfeld handelt, kînnen Sie alle Felder aus der Vorlage verwenden und die Werte mithilfe des Pluszeichens verketten.;
                           ENU=Specifies a formula used to calculate the field value. If it is a number-field, you can construct the formula with other number-fields from the template, or with constant number values, and use operators such as * / + -. If it is a text field, you can use all fields from the template, and concatenate the values using the + sign.];
                SourceExpr=FormulaTxt;
                OnValidate=BEGIN
                             FormulaTxt := RemoveQuotationMarks(FormulaTxt);
                             SetFormula(FormulaTxt);
                             SearchForValueEditable := (Formula = '') AND (FixedValue = '');
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=VAR
                           PrevText@6085573 : Text[1024];
                         BEGIN
                           PrevText := Text;
                           IF FormulaOnLookup(Text) THEN BEGIN
                             Text := PrevText + Text;
                             EXIT(TRUE);
                           END;
                         END;
                          }

    { 161024016;2;Field   ;
                Name=Insert on new Templates;
                ToolTipML=[DEU=Gibt an, ob das Feld in alle neuen Vorlagen eingefÅgt werden soll. Wenn dies nicht aktiviert ist, kann das Feld bei Bedarf manuell zu einzelnen Dokumenten und Vorlagen hinzugefÅgt werden.;
                           ENU=Specifies whether to insert the field on all new templates. If this is not enabled, then the field can be manually added to individual documents and templates when needed.];
                SourceExpr="Insert on new Templates";
                Importance=Additional;
                Visible=IsMasterTemplate }

    { 1000000022;2;Field  ;
                Name=Default Page Source;
                ToolTipML=[DEU=Gibt an, ob bei der Suche nach dem Wert des Felds mit der ersten oder letzten Seite begonnen werden soll. Wenn auf der ersten oder letzten Seite kein Wert erkannt wird, wird der Rest des Dokuments durchsucht.;
                           ENU=Specifies whether to start on the first or last page when searching for the value of the field. If a value is not recognized on either the first or last page, then the rest of the document is searched.];
                SourceExpr="Default Page Source";
                Importance=Additional;
                Visible=NOT ShowXmlPath }

    { 1000000002;2;Field  ;
                Name=Data Type;
                ToolTipML=[DEU=Gibt den Datentyp der in diesem Feld gespeicherten Werte an.;
                           ENU=Specifies the data type of the values saved in this field.];
                SourceExpr="Data Type";
                Importance=Additional;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;
                            }

    { 6085581;2;Group     ;
                Name=StopLineRecognition;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowStopLineRecognition AND NOT ShowXmlPath;
                GroupType=Group }

    { 1000000015;3;Field  ;
                Name=Stop Lines Recognition;
                ToolTipML=[DEU=Gibt an, wann die Zeilenerkennung in Dokumenten gestoppt werden soll.;
                           ENU=Specifies when to stop recognizing lines in documents.];
                SourceExpr="Stop Lines Recognition";
                Importance=Additional;
                Visible=LineRecognitionEnabled }

    { 1160040015;2;Field  ;
                Name=Use as Doc. Separator;
                ToolTipML=[DEU=Gibt an, ob das Feld ein Belegtrennzeichen ist und ob Dokumente automatisch aufgeteilt werden sollen, wenn sich der Wert des Felds in einer PDF-Datei zwischen einer Seite und der nÑchsten Ñndert. Wird in Kombination mit der Konfiguration der Belegtrennung auf der Belegkategorie verwendet.;
                           ENU=Specifies whether the field is a document separator and if documents should be split automatically if the value of the field changes between one page and the next in a PDF file. Used in combination with the configuration of document splitting on the document category.];
                SourceExpr="Use as Doc. Separator";
                Importance=Additional;
                Visible=NOT ShowXmlPath }

    { 1160040011;2;Group  ;
                Name=Date Settings;
                CaptionML=[DEU=Datumseinstellungen;
                           ENU=Date Settings];
                Visible=IsDate;
                GroupType=Group }

    { 1000000011;3;Field  ;
                Name=Language Code;
                ToolTipML=[DEU=Gibt die Sprache an, in der Datumsangaben erkannt werden, wenn Monate in Worten und nicht in Zahlen geschrieben werden. Um beispielsweise "October" zu erkennen, muss die Sprache Englisch sein. Bei allen Vorlagenfeldern wird die Sprache von der Vorlage Åbernommen.;
                           ENU=Specifies the language used to recognize dates when months are written in words and not numerical. For example, to recognize "Oktober" the language must be Danish. All template fields will have the language inherited from the template.];
                SourceExpr="Language Code";
                Editable=IsDate }

    { 161024025;3;Field   ;
                Name=Date Format;
                ToolTipML=[DEU=Gibt das Datumsformat an, das zum Erkennen von Datumsangaben in Dokumenten verwendet wird. Alle Vorlagenfelder nutzen das von der Vorlage Åbernommene Datumsformat.;
                           ENU=Specifies the date format used to recognize dates in documents. All template fields have the date format inherited from the template.];
                SourceExpr="Date Format";
                Editable=IsDate }

    { 1160040005;3;Field  ;
                Name=Validation Dateformula From;
                ToolTipML=[DEU=Gibt eine Datumsformel an, um das frÅheste zulÑssige Datum fÅr ein Feld zu definieren. Die Berechnung erfolgt in Bezug auf das heutige Datum.;
                           ENU=Specifies a date formula to define the earliest allowed date for a field. The calculation will be made in relation to today's date.];
                SourceExpr="Validation Dateformula From";
                Importance=Additional;
                Editable=IsDate }

    { 1160040004;3;Field  ;
                Name=Validation Dateformula To;
                ToolTipML=[DEU=Gibt eine Datumsformel zum Definieren des letzten zulÑssigen Datums fÅr ein Feld an. Die Berechnung der Formel erfolgt nach heutigem Datum.;
                           ENU=Specifies a date formula for defining the latest allowed date for a field. Calculating the formula will be done according to today's date.];
                SourceExpr="Validation Dateformula To";
                Importance=Additional;
                Editable=IsDate }

    { 6085586;3;Field     ;
                ToolTipML=[DEU=Gibt eine Datumsformel (zum Bsp. CM-1D) an, die auf den erfassten Datumswert angewendet wird.;
                           ENU=Specifies a date formula (e.g. CM-1D) that will be applied to the captured date value.];
                SourceExpr="Calculate Date (Date Formula)";
                Importance=Additional;
                Editable=IsDate }

    { 1160040014;2;Group  ;
                Name=Number Settings;
                CaptionML=[DEU=Nummerierung Einstellungen;
                           ENU=Number Settings];
                Visible=IsNumber;
                GroupType=Group }

    { 1160040013;3;Field  ;
                Name=Make Absolute Number;
                ToolTipML=[DEU=Gibt an, ob negative Zahlen in positive Zahlen umgewandelt werden sollen.;
                           ENU=Specifies whether to convert negative numbers into positive numbers.];
                SourceExpr="Make Absolute Number";
                Editable=IsNumber }

    { 6085582;3;Field     ;
                Name=DecimalPlacesDescription;
                CaptionML=[DEU=Dezimalstellen;
                           ENU=Decimal Places];
                ToolTipML=[DEU=Gibt die Anzahl der Dezimalstellen fÅr Werte an. Zum Beispiel bedeutet 2: 5, dass das Feld immer 2 Dezimalstellen und maximal 5 Dezimalstellen enthÑlt.;
                           ENU=Specifies the number of decimal places for values. E.g. 2:5 means that the field will always show 2 decimals and a maximum of 5 decimals.];
                SourceExpr=DecimalPlacesDescription;
                Editable=IsNumber;
                OnValidate=BEGIN
                             DecimalPlacesDescription := ParseDecimalPlacesDescription(DecimalPlacesDescription);
                             DecimalPlacesDescription := ValidateDecimalPlaces(DecimalPlacesDescription);
                             MODIFY;
                             CurrPage.UPDATE(TRUE);
                           END;

                OnAssistEdit=BEGIN
                               PAGE.RUNMODAL(PAGE::"CDC Decimal Places Lookup",Rec);
                               CurrPage.UPDATE(TRUE);
                             END;
                              }

    { 1160040001;3;Field  ;
                Name=Blank Zero;
                ToolTipML=[DEU=Gibt an, ob das Feld leer bleiben soll, anstatt "0" anzuzeigen, wenn der Wert Null ist.;
                           ENU=Specifies whether the field should be left empty, instead of showing "0", if the value is zero.];
                SourceExpr="Blank Zero";
                Importance=Additional;
                Editable=IsNumber }

    { 61099;3  ;Field     ;
                Name=ALRChangeSign;
                ToolTipML=[DEU=Dreht das Vorzeichen einer Zahl um.;
                           ENU=Flips the sign of a number.];
                Description=Needed until field is implemented by default;
                SourceExpr="Change Sign" }

    { 1160040010;2;Group  ;
                Name=Lookup Values;
                CaptionML=[DEU=Lookup Werte;
                           ENU=Lookup Values];
                Visible=IsLookup;
                GroupType=Group }

    { 161024015;3;Field   ;
                Name=SourceTable;
                CaptionML=[DEU=Herkunftstabellen;
                           ENU=Source Table];
                ToolTipML=[DEU=Gibt die Tabelle an, die alle gÅltigen Werte fÅr das Feld enthÑlt.;
                           ENU=Specifies the table that contains all valid values for the field.];
                SourceExpr=SourceTable;
                Editable=IsLookup;
                OnValidate=BEGIN
                             VALIDATE("Source Table No.",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Table,SourceTable));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Table,Text));
                         END;
                          }

    { 161024028;3;Field   ;
                Name=SourceField;
                CaptionML=[DEU=Herkunftsfeld;
                           ENU=Source Field];
                ToolTipML=[DEU=Gibt das Feld der Herkunftstabelle an, das die Werte enthÑlt, die im Feld gespeichert werden sollen.;
                           ENU=Specifies the field of the source table which contains the values to be saved in the field.];
                SourceExpr=SourceField;
                Editable=IsLookup;
                LookupPageID=Field List;
                OnValidate=BEGIN
                             VALIDATE("Source Field No.",RecIDMgt.GetFieldID("Source Table No.",SourceField));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupField(Text,"Source Table No.",TRUE));
                         END;
                          }

    { 161024029;3;Field   ;
                Name=No. of Source Table Filters;
                ToolTipML=[DEU="Gibt die Anzahl der auf die Herkunftstabelle angewendeten Filter an, wenn einige DatensÑtze aus der Herkunftstabelle herausgefiltert werden sollen. ";
                           ENU="Specifies the number of filters applied to the source table if some records from the source table should be filtered out. "];
                SourceExpr="No. of Source Table Filters";
                OnDrillDown=BEGIN
                              RecIDMgt.ShowTableFields("Source Table No.","Template No.",Type,TRUE,"Source Table Filter GUID");
                              CurrPage.UPDATE(TRUE);
                            END;
                             }

    { 1160040009;2;Group  ;
                Name=Transfer Value to...;
                CaptionML=[DEU=Wert Åbertragen nach...;
                           ENU=Transfer Value to...];
                Visible=ShowTransferValue;
                GroupType=Group }

    { 161024030;3;Field   ;
                Name=DestHeaderField;
                ToolTipML=[DEU=Gibt das Feld in der Kopftabelle an, in das der Wert beim Registrieren von Dokumenten Åbertragen werden soll.;
                           ENU=Specifies the field in the header table where to transfer the value when registering documents.];
                SourceExpr=DestHeaderField;
                CaptionClass=GetDestFieldCaption(0);
                Editable=IsDestHeader;
                OnValidate=VAR
                             Template@1160040001 : Record 6085579;
                             DocCat@1160040002 : Record 6085575;
                           BEGIN
                             Template.GET("Template No.");
                             DocCat.GET(Template."Category Code");
                             VALIDATE("Destination Header Field No.",RecIDMgt.GetFieldID(DocCat."Destination Header Table No.",DestHeaderField));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=VAR
                           DocCat@161024014 : Record 6085575;
                           Template@161024013 : Record 6085579;
                         BEGIN
                           IF Type = Type::Line THEN
                             EXIT;

                           Template.GET("Template No.");
                           DocCat.GET(Template."Category Code");
                           EXIT(RecIDMgt.LookupField(Text,DocCat."Destination Header Table No.",FALSE));
                         END;
                          }

    { 1160040000;3;Field  ;
                Name=DestLineField;
                ToolTipML=[DEU=Gibt das Feld in der Zeilentabelle an, in das der Wert beim Registrieren von Dokumenten Åbertragen werden soll.;
                           ENU=Specifies the field in the line table where to transfer the value when registering documents.];
                SourceExpr=DestLineField;
                CaptionClass=GetDestFieldCaption(1);
                Editable=IsDestLine;
                OnValidate=VAR
                             Template@1160040001 : Record 6085579;
                             DocCat@1160040002 : Record 6085575;
                           BEGIN
                             Template.GET("Template No.");
                             DocCat.GET(Template."Category Code");
                             VALIDATE("Destination Line Field No.",RecIDMgt.GetFieldID(DocCat."Destination Line Table No.",DestLineField));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=VAR
                           DocCat@1160040003 : Record 6085575;
                           Template@1160040002 : Record 6085579;
                         BEGIN
                           Template.GET("Template No.");
                           DocCat.GET(Template."Category Code");
                           EXIT(RecIDMgt.LookupField(Text,DocCat."Destination Line Table No.",FALSE));
                         END;
                          }

    { 1160040003;3;Field  ;
                Name=Transfer Blank Values;
                ToolTipML=[DEU=Gibt an, ob Felder ohne Wert in einem Dokument wÑhrend der Registrierung in die Kopf- oder Zeilentabelle Åbertragen werden mÅssen, wodurch der Wert des Felds im neu erstellten Dokument ausgeblendet wird. Wenn dies nicht aktiviert ist, werden Feldwerte wÑhrend der Registrierung nur in die Kopf- oder Zeilentabelle Åbertragen, wenn das Dokument einen Wert enthÑlt.;
                           ENU=Specifies whether fields without a value in a document must be transferred to the header or line table during registration, thereby blanking the value of the field in the newly created document. If this is not enabled, field values will only be transferred to the header or line table during registration, if there is a value in the field in the document.];
                SourceExpr="Transfer Blank Values";
                Importance=Additional }

    { 1160040007;2;Group  ;
                Name=Advanced Recognition Settings;
                CaptionML=[DEU=Erweiterte Erkennungseinstellungen;
                           ENU=Advanced Recognition Settings];
                GroupType=Group }

    { 1160040012;3;Field  ;
                Name=Delete Blanks;
                ToolTipML=[DEU=Gibt an, ob alle Leerzeichen aus dem erkannten Wert gelîscht werden sollen.;
                           ENU=Specifies whether to delete all spaces from the recognized value.];
                SourceExpr="Delete Blanks";
                Importance=Additional }

    { 6085578;3;Group     ;
                Name=MultiLineGroup;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowMultiline AND NOT ShowXmlPath;
                GroupType=Group }

    { 161024027;4;Field   ;
                Name=Multiline;
                ToolTipML=[DEU=Gibt an, ob es sich um ein mehrzeiliges Feld handelt und der Wert sich Åber mehrere Zeilen erstreckt.;
                           ENU=Specifies whether this is a multiline field and the value is on multiple lines.];
                SourceExpr=Multiline;
                Importance=Additional }

    { 1000000019;3;Field  ;
                Name=Typical Field Width;
                ToolTipML=[DEU=Gibt die typische Breite der erkannten Feldwerte an.;
                           ENU=Specifies the typical width of recognized field values.];
                SourceExpr="Typical Field Width";
                Importance=Additional;
                Visible=NOT ShowXmlPath }

    { 1000000021;3;Field  ;
                Name=Typical Field Height;
                ToolTipML=[DEU=Gibt die typische Hîhe der erkannten Feldwerte an.;
                           ENU=Specifies the typical height of recognized field values.];
                SourceExpr="Typical Field Height";
                Importance=Additional;
                Visible=NOT ShowXmlPath }

    { 1160040006;2;Group  ;
                Name=Rules and Captions;
                CaptionML=[DEU=Regeln und Suchbegriffe;
                           ENU=Rules and Captions];
                GroupType=Group }

    { 6085579;3;Group     ;
                Name=EnableRuleGroup;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowEnableGenRule;
                GroupType=Group }

    { 1000000009;4;Field  ;
                Name=Enable Rule Generation;
                ToolTipML=[DEU=Gibt an, ob die Liste der Regeln automatisch verwaltet werden soll. Wenn aktiviert, wird beim Erfassen eines Werts automatisch eine neue Regel mit regulÑren AusdrÅcken generiert, die dem erfassten Wert entsprechen.;
                           ENU=Specifies whether to maintain the list of rules automatically. When enabled, a new rule will automatically be generated, when capturing a value (by manually updating the field caption and value), with a regular expressions that matches the captured value.];
                SourceExpr="Enable Rule Generation";
                Importance=Additional }

    { 1000000016;3;Field  ;
                Name=Auto Update Caption;
                ToolTipML=[DEU=Gibt an, ob der Suchtext automatisch aktualisiert werden soll, wenn Sie einen neuen Suchtext in einem Dokument auswÑhlen.;
                           ENU=Specifies whether to automatically update the captions when you select a new caption in a document.];
                SourceExpr="Auto Update Caption";
                Importance=Additional;
                Visible=NOT ShowXmlPath }

    { 1000000017;3;Field  ;
                Name=Caption Is Part Of Value;
                ToolTipML=[DEU=Gibt an, ob der Suchtext Teil des Werts ist. Ein Suchtext fÅr die dÑnische Zahlungs-ID lautet beispielsweise +71. Da der Feldwert +71 enthÑlt, ist der Suchtext jedoch Teil des Feldwerts.;
                           ENU=Specifies whether the caption is part of the value. E.g., a caption for the Danish payment ID is +71, but since the field value contains +71 the caption is part of the field value.];
                SourceExpr="Caption Is Part Of Value";
                Importance=Additional;
                Visible=NOT ShowXmlPath }

    { 1160040002;3;Field  ;
                Name=Caption Mandatory;
                ToolTipML=[DEU=Gibt an, ob ein Feldwert nur aus dem Dokument erkannt werden kann, wenn eine entsprechender Suchtext vorhanden ist. Wenn die Option deaktiviert ist und im Dokument kein Suchtext erkannt wird, wird der Wert aus dem gleichen Bereich im Dokument wie das zuletzt mit derselben Vorlage erkannte Dokument Åbernommen. Dabei wird davon ausgegangen, dass der Wert in diesem Bereich den richtigen Datentyp hat und den Feldregeln entspricht.;
                           ENU=Specifies whether a field value can only be recognized from the document if there is a corresponding caption. If disabled and no caption is recognized in the document, then the value will be taken from the same area in the document as on the last document recognized with the same template, under the condition that the value in that area is of the correct data type and complies to the field rules.];
                SourceExpr="Caption Mandatory";
                Importance=Additional;
                Visible=NOT ShowXmlPath }

    { 161024026;1;Group   ;
                Name=Purchase;
                CaptionML=[DEU=Einkauf;
                           ENU=Purchase];
                Visible=ShowPurchaseTab;
                GroupType=Group }

    { 161024024;2;Field   ;
                Name=Transfer Amount to Document;
                ToolTipML=[DEU=Gibt an, ob der Wert des Felds bei der Registrierung in eine Einkaufszeile Åbertragen werden soll.;
                           ENU=Specifies whether to transfer the value of the field to a purchase line when registering.];
                SourceExpr="Transfer Amount to Document";
                Editable=IsNumberAndHeader }

    { 161024023;2;Field   ;
                Name=G/L Account Field Code;
                ToolTipML=[DEU=Gibt ein optionales Vorlagenfeld an, das die Sachkontonummer enthÑlt, die beim Erstellen einer Einkaufszeile fÅr den Wert dieses Felds verwendet wird.;
                           ENU=Specifies an optional template field which contains the G/L account number used when creating a purchase line for the value of this field.];
                SourceExpr="G/L Account Field Code";
                Editable=IsNumberAndHeader }

    { 161024019;2;Field   ;
                Name=Subtract from Amount Field;
                ToolTipML=[DEU=Gibt ein anderes Feld an, dessen Wert vom Wert dieses Felds abgezogen werden muss. Wenn der Gesamtbetrag inkl. Fracht in einem Feld dargestellt wird, aber der Frachtbetrag auch in einem anderen Feld separat angezeigt. In diesem Fall kînnen Sie den Frachtbetrag in einem Feld angeben und den Wert vom Gesamtbetrag abziehen, sodass die Versandkosten nicht doppelt Åbertragen werden.;
                           ENU=Specifies another field which must have its value subtracted by the value of this field. Eg. if total amount, incl. freight is in a field, but the freight amount is also shown separately in another field. In this case, you can choose to recognize freight amount in a field, then deduct the value from the total amount, so shipping costs are not transferred twice.];
                SourceExpr="Subtract from Amount Field";
                Editable=IsNumberAndHeader;
                OnLookup=VAR
                           TemplateField@6085573 : Record 6085580;
                         BEGIN
                           TemplateField.FILTERGROUP(4);
                           TemplateField.SETRANGE("Template No.","Template No.");
                           TemplateField.SETRANGE(Type,Type);
                           TemplateField.SETFILTER("Transfer Amount to Document",'<>%1',"Transfer Amount to Document"::" ");
                           TemplateField.SETFILTER(Code,'<>%1',Code);
                           TemplateField.FILTERGROUP(0);
                           IF PAGE.RUNMODAL(0,TemplateField) = ACTION::LookupOK THEN BEGIN
                             Text := TemplateField.Code;
                             EXIT(TRUE);
                           END;
                         END;
                          }

    { 161024018;2;Field   ;
                Name=Purch. Alloc. G/L Account No.;
                ToolTipML=[DEU=Gibt das Sachkonto an, das fÅr automatisch erstellte Einkaufszuordnungen verwendet werden soll.;
                           ENU=Specifies the G/L cost account number to use when automatically creating purchase allocations.];
                SourceExpr="Purch. Alloc. G/L Account No.";
                Visible=ShowAllocations;
                Editable=IsNumberAndHeader }

    { 61000;1  ;Group     ;
                Name=ALR;
                CaptionML=[DAN=Avanceret Linjegenkendelse;
                           DEU=Erweiterte Zeilenerkennung;
                           ENU=Advanced Line Recognition;
                           FRA=Reconnaissance avancÇe de ligne;
                           NLD=Geavanceerde lijnherkenning];
                GroupType=Group }

    { 61001;2  ;Field     ;
                ToolTipML=[DAN=Angiver hvordan feltvërdien genkendes. Med Standard fremsõges vërdien ved hjëlp af standardlinjegenkendelse.;
                           DEU=Gibt an, wie der Feldwert gefunden werden soll. Bei Standard wird das Feld Åber die Standard Zeilenerkennung gesucht.;
                           ENU=Specifies how the field value is to be found. With Standard, the field is searched for using the standard row recognition.;
                           FRA=SpÇcifie comment la valeur du champ doit àtre trouvÇe. Avec Standard, le champ est recherchÇ en utilisant la reconnaissance de ligne standard.;
                           NLD=Hiermee geeft u aan hoe de waarde van het veld wordt gevonden. Met standaardwaarde wordt het veld gezocht naar het gebruik van de standaard lijnherkenning.];
                SourceExpr="Advanced Line Recognition Type" }

    { 61002;2  ;Group     ;
                Name=ALRLinkedFieldGroup;
                Visible=IsLinkedFieldSearch;
                GroupType=Group }

    { 61003;3  ;Field     ;
                ToolTipML=[DAN=Angiver kildefeltet der bruges til at beregne feltvërdien ved hjëlp af afstande/forskydninger.
                           ;
                           DEU=Gibt das Herkunftsfeld an, welches zur Berechnung des Feldwerts Åber AbstÑnde/Offsets genutzt wird.;
                           ENU=Specifies the source field used to calculate the field value via distances/offsets.;
                           FRA=SpÇcifie le champ source utilisÇ pour calculer la valeur du champ via des distances/dÇcalages.;
                           NLD=Geeft het bronveld in dat gebruikt wordt om de waarde van het veld te bepalen via afstanden/offsets.];
                SourceExpr="Linked Field" }

    { 61004;2  ;Field     ;
                ToolTipML=[DAN=Angiver positionen for rëkkefõlgen, i hvilken feltet behandles.
                           ;
                           DEU=Gibt die Stelle der Reihenfolge an, in der das Feld verarbeitet wird.;
                           ENU=Specifies the position of the sequence in which the field is processed.;
                           FRA=Bepaalt de positie van de volgorde waarin het veld wordt verwerkt.
                           ;
                           NLD=Bepaalt de positie van de volgorde waarin het veld wordt verwerkt.];
                SourceExpr=Sorting;
                Importance=Additional }

    { 61005;2  ;Group     ;
                Name=ALRCaptionBasedFieldGroup;
                Visible=ShowPositionDependendFields;
                GroupType=Group }

    { 61006;3  ;Field     ;
                ToolTipML=[DAN=Angiver om det genkendte felt sõges over eller under den linje hvor vërdierne for standardlinjegenkendelsen blev fundet.;
                           DEU=Gibt an, ob das gesuchte Feld ober- oder unterhalb der Zeile gesucht wird, in welcher die Werte der Standard Zeilenerkennung gefunden wurden.;
                           ENU=Specifies whether the searched field is searched above or below the line in which the values of the standard line recognition were found.;
                           FRA=SpÇcifie si le champ recherchÇ est recherchÇ au-dessus ou en dessous de la ligne dans laquelle les valeurs de la reconnaissance de ligne standard ont ÇtÇ trouvÇes.;
                           NLD=Geeft aan of het zoekveld boven of onder de regel wordt gezocht waarin de waarden van de standaardregelherkenning werden gevonden.];
                SourceExpr="Field value position" }

    { 61007;3  ;Field     ;
                SourceExpr="Field value search direction" }

    { 61008;2  ;Group     ;
                Name=ALRNoValueFound;
                CaptionML=[DEU=Wenn Wert leer ist;
                           ENU=When value is empty];
                GroupType=Group }

    { 61009;3  ;Field     ;
                SourceExpr="Replacement Field Type" }

    { 61010;3  ;Field     ;
                ToolTipML=[DAN=Angiver linjefeltet hvor indholdet benyttes som vërdi, hvis vërdien af det aktuelle felt ikke kan genkendes.;
                           DEU=Gibt das Zeilenfeld an, dessen Inhalt als Wert verwendet wird, wenn der Wert des aktuellen Feldes nicht gefunden werden kann.;
                           ENU=Specifies the line field whose content will be used as value if the value of the current field cannot be found.;
                           FRA=SpÇcifie le champ de ligne dont le contenu sera utilisÇ comme valeur si la valeur du champ actuel est introuvable.;
                           NLD=Geeft het regelveld aan waarvan de inhoud als waarde wordt gebruikt indien de waarde van het huidige veld niet kan worden gevonden.];
                SourceExpr="Replacement Field" }

    { 61011;3  ;Field     ;
                ToolTipML=[DAN=Hvis vërdien af det aktuelle felt ikke findes, kopieres vërdien til den aktuelle linje fra det samme felt i den forrige linje.;
                           DEU=Wenn der Wert des aktuellen Feldes nicht gefunden wird, wird vom gleichen Feld aus der vorherigen Zeile dessen Wert in die aktuelle Zeile kopiert.;
                           ENU=If the value of the current field is not found, the value is copied to the current line from the same field from the previous line.;
                           FRA=Si la valeur du champ actuel n'est pas trouvÇe, la valeur est copiÇe dans la ligne actuelle Ö partir du màme champ de la ligne prÇcÇdente.;
                           NLD=Als de waarde van dit veld niet wordt gevonden op de huidige regel, wordt de waarde overgenomen van de vorige regel.];
                SourceExpr="Copy Value from Previous Value" }

    { 61012;2  ;Group     ;
                CaptionML=[DAN=Forskydninger;
                           DEU=AbstÑnde;
                           ENU=Offsets;
                           FRA=DÇcalages;
                           NLD=Verschuivingen];
                GroupType=Group }

    { 61013;3  ;Field     ;
                ToolTipML=[DAN=Angiver afstanden til top.;
                           DEU=Gibt den Abstand nach oben an.;
                           ENU=Specifies the distance to the top.;
                           FRA=SpÇcifie la distance par rapport au haut.;
                           NLD=Bepaalt de afstand naar de bovenkant.];
                SourceExpr="Offset Top";
                Importance=Additional }

    { 61014;3  ;Field     ;
                ToolTipML=[DAN=Angiver afstanden til bund.;
                           DEU=Gibt den Abstand nach unten an.;
                           ENU=Specifies the distance to the bottom.;
                           FRA=SpÇcifie la distance par rapport au bas.;
                           NLD=Bepaalt de afstand naar de onderkant.];
                SourceExpr="Offset Bottom";
                Importance=Additional }

    { 61015;3  ;Field     ;
                ToolTipML=[DAN=Angiver afstanden til venstre.;
                           DEU=Gibt den Abstand nach links an.;
                           ENU=Specifies the distance to the left.;
                           FRA=SpÇcifie la distance par rapport Ö la gauche.;
                           NLD=Bepaalt de afstand naar de linkerkant.];
                SourceExpr="Offset Left";
                Importance=Additional }

    { 61016;3  ;Field     ;
                ToolTipML=[DAN=Angiver afstanden til hõjre.;
                           DEU=Gibt den Abstand nach rechts an.;
                           ENU=Specifies the distance to the right.;
                           FRA=SpÇcifie la distance par rapport Ö la droite.;
                           NLD=Bepaalt de afstand naar de rechterkant.];
                SourceExpr="Offset Right";
                Importance=Additional }

    { 61017;3  ;Field     ;
                ToolTipML=[DAN=Angiver afstanden til sõgetekst/overskrift pÜ X- aksen.
                           ;
                           DEU=Gibt den Abstand zum Suchtext an auf der X-Achse an.;
                           ENU=Specifies the distance to the search text/caption on the X axis.;
                           FRA=SpÇcifie la distance avec le texte/lÇgende de la recherche sur l'axe X.;
                           NLD=Specificeert de afstand naar de zoektekst/bijschrift op de X-as.];
                SourceExpr="ALR Value Caption Offset X";
                Importance=Additional }

    { 61018;3  ;Field     ;
                ToolTipML=[DAN=Angiver afstanden til sõgetekst/oerskrift pÜ Y-aksen.
                           ;
                           DEU=Gibt den Abstand zum Suchtext an auf der Y-Achse an.;
                           ENU=Specifies the distance to the search text/caption on the Y axis.;
                           FRA=SpÇcifie la distance avec le texte/lÇgende de la recherche sur l'axe Y.;
                           NLD=Bepaalt de afstand naar de zoektekst/bijschrift op de X-as.];
                SourceExpr="ALR Value Caption Offset Y";
                Importance=Additional }

    { 61019;3  ;Field     ;
                ToolTipML=[DAN=Angiver den forventede feltbredde for feltet.;
                           DEU=Gibt die erwartete Feldbreite des Feldes an.;
                           ENU=Specifies the expected field width of the field.;
                           FRA=SpÇcifie la largeur attendue du champ.;
                           NLD=Specificeert de verwachte veldbreedte.];
                SourceExpr="ALR Typical Value Field Width";
                Importance=Additional }

    { 61020;3  ;Field     ;
                SourceExpr="Data version";
                Visible=FALSE }

    { 6085580;1;Part      ;
                Name=Template Field Translations;
                SubPageLink=Template No.=FIELD(Template No.),
                            Type=FIELD(Type),
                            Code=FIELD(Code);
                PagePartID=Page6085588;
                PartType=Page }

  }
  CODE
  {
    VAR
      AllObjWithCaption@1160040000 : Record 2000000058;
      RecIDMgt@1001 : Codeunit 6085604;
      IsMasterTemplate@1160040010 : Boolean INDATASET;
      IsDate@161024012 : Boolean INDATASET;
      IsNumber@161024013 : Boolean INDATASET;
      IsNumberAndHeader@161024014 : Boolean INDATASET;
      IsLookup@1161054000 : Boolean INDATASET;
      SearchForValueEditable@161024015 : Boolean INDATASET;
      IsDestHeader@161024016 : Boolean INDATASET;
      IsDestLine@1004 : Boolean INDATASET;
      IsNewField@1160040011 : Boolean INDATASET;
      ShowCodeAndType@6085583 : Boolean INDATASET;
      LineRecognitionEnabled@1160040005 : Boolean INDATASET;
      CodeunitLookup@1160040001 : Text[250];
      CodeunitCaptureVal@1160040004 : Text[250];
      CodeunitIsValid@1160040003 : Text[250];
      CodeunitValidate@1160040002 : Text[250];
      SourceTable@1160040006 : Text[250];
      SourceField@1160040009 : Text[250];
      DestHeaderField@1160040007 : Text[250];
      DestLineField@1160040008 : Text[250];
      FixedValue@1000 : Text[250];
      ShowTransferValue@6085573 : Boolean INDATASET;
      ShowPurchaseTab@6085574 : Boolean INDATASET;
      CaptionText@6085575 : Text[300];
      RuleText@6085576 : Text[300];
      TotalCaptions@6085577 : TextConst 'DEU=(%1 Suchtexte gesamt);ENU=(%1 captions in total)';
      TotalRules@6085578 : TextConst 'DEU=(%1 Regeln gesamt);ENU=(%1 rules in total)';
      EditCaption@6085579 : Boolean INDATASET;
      EditRule@6085580 : Boolean INDATASET;
      ShowMultiline@6085581 : Boolean INDATASET;
      ShowEnableGenRule@6085582 : Boolean INDATASET;
      IsPageEditable@1002 : Boolean INDATASET;
      ShowStopLineRecognition@6085584 : Boolean INDATASET;
      ShowAllocations@6085585 : Boolean INDATASET;
      DecimalPlacesDescription@6085586 : Text[50];
      FormulaTxt@6085587 : Text[1024];
      ShowXmlPath@6085588 : Boolean INDATASET;
      CurrentDocumentNo@6085589 : Code[20];
      ShowXMLShowField@6085600 : Boolean INDATASET;
      IsLinkedFieldSearch@1003 : Boolean INDATASET;
      ShowPositionDependendFields@1005 : Boolean INDATASET;

    LOCAL PROCEDURE UpdateControls@6085573();
    VAR
      Template@6085574 : Record 6085579;
      DocCat@6085573 : Record 6085575;
      TemplateFieldCaption@6085577 : Record 6085581;
      TemplateFieldRule@6085576 : Record 6085583;
      ContiniaVersionMgt@6085578 : Codeunit 6192775;
      i@6085575 : Integer;
      CDCModuleLicense@6085579 : Codeunit 6086008;
      DCSetup@6085581 : Record 6085573;
      TemplateCode@6085600 : Code[20];
    BEGIN
      IsPageEditable := CurrPage.EDITABLE;

      DCSetup.GET;

      TemplateCode := "Template No.";
      IF TemplateCode = '' THEN
        TemplateCode := GETFILTER("Template No.");

      IF Template.GET(TemplateCode) THEN
        DocCat.GET(Template."Category Code");

      FixedValue := GetFixedValue;

      SearchForValueEditable := (Formula = '') AND (FixedValue = '');

      IsMasterTemplate := Template.Type = Template.Type::Master;
      IsDate := "Data Type" = "Data Type"::Date;
      IsNumber := "Data Type" = "Data Type"::Number;
      IsNumberAndHeader := ("Data Type" = "Data Type"::Number) AND (Type = Type::Header);
      IsLookup := ("Data Type" = "Data Type"::Lookup) AND IsPageEditable;
      IsDestHeader := (Type = Type::Header) AND (DocCat."Destination Header Table No." <> 0) AND IsPageEditable;
      IsDestLine := (DocCat."Destination Line Table No." <> 0) AND IsPageEditable;
      LineRecognitionEnabled := Template."Recognize Lines" = Template."Recognize Lines"::Yes;
      IsNewField := Code = '';
      ShowCodeAndType := IsNewField OR (ContiniaVersionMgt.NAVVersion < 100000);
      ShowPurchaseTab := DocCat.IsPurchInvCrMemoCategory AND ("Data Type" = "Data Type"::Number) AND (Type = Type::Header);
      ShowTransferValue := NOT ((DocCat."Destination Header Table No." = 0) AND (DocCat."Destination Line Table No." = 0));
      ShowMultiline := Type = Type::Header;
      ShowEnableGenRule := ("Data Type" = "Data Type"::Text) OR ("Data Type" = "Data Type"::Date);
      ShowStopLineRecognition := CDCModuleLicense.IsAdvCaptureActivated(FALSE);
      ShowAllocations := DCSetup."Enable Purchase Allocation" AND CDCModuleLicense.IsApprovalActivated(FALSE);

      EditCaption := IsPageEditable AND NOT IsNewField;
      IF NOT IsNewField THEN BEGIN
        TemplateFieldCaption.SETRANGE("Template No.","Template No.");
        TemplateFieldCaption.SETRANGE(Type,Type);
        TemplateFieldCaption.SETRANGE(Code,Code);
        IF TemplateFieldCaption.FIND('-') THEN BEGIN
          i := TemplateFieldCaption.COUNT;
          IF i = 1 THEN
            CaptionText := TemplateFieldCaption.Caption
          ELSE BEGIN
            CaptionText := TemplateFieldCaption.Caption + ' ' + STRSUBSTNO(TotalCaptions,i);
            EditCaption := FALSE;
          END;
        END ELSE
          CaptionText := '';
      END ELSE
        CaptionText := '';

      EditRule := IsPageEditable AND NOT IsNewField;
      IF NOT IsNewField THEN BEGIN
        TemplateFieldRule.SETRANGE("Template No.","Template No.");
        TemplateFieldRule.SETRANGE(Type,Type);
        TemplateFieldRule.SETRANGE(Code,Code);
        IF TemplateFieldRule.FIND('-') THEN BEGIN
          i := TemplateFieldRule.COUNT;
          IF i = 1 THEN
            RuleText := TemplateFieldRule.Rule
          ELSE BEGIN
            RuleText := TemplateFieldRule.Rule + ' ' + STRSUBSTNO(TotalRules,i);
            EditRule := FALSE;
          END;
        END ELSE
          RuleText := '';
      END ELSE
        RuleText := '';

      DecimalPlacesDescription := ValidateDecimalPlaces("Decimal Places");
      ShowXmlPath := Template."Data Type" = Template."Data Type"::XML;
      ShowXMLShowField := Type = Type::Line;
    END;

    LOCAL PROCEDURE ShowCaptions@6085575();
    VAR
      TemplateFieldCaption@6085573 : Record 6085581;
    BEGIN
      TemplateFieldCaption.FILTERGROUP(2);
      TemplateFieldCaption.SETRANGE("Template No.","Template No.");
      TemplateFieldCaption.SETRANGE(Type,Type);
      TemplateFieldCaption.SETRANGE(Code,Code);
      TemplateFieldCaption.FILTERGROUP(0);
      PAGE.RUNMODAL(PAGE::"CDC Template Field Captions",TemplateFieldCaption);
      UpdateControls;
    END;

    LOCAL PROCEDURE ShowRules@6085579();
    VAR
      TemplateFieldRule@6085573 : Record 6085583;
    BEGIN
      TemplateFieldRule.FILTERGROUP(2);
      TemplateFieldRule.SETRANGE("Template No.","Template No.");
      TemplateFieldRule.SETRANGE(Type,Type);
      TemplateFieldRule.SETRANGE(Code,Code);
      TemplateFieldRule.FILTERGROUP(0);
      PAGE.RUNMODAL(PAGE::"CDC Template Field Rules",TemplateFieldRule);
      UpdateControls;
    END;

    LOCAL PROCEDURE ShowCodeunits@6085580();
    VAR
      TemplateField@6085574 : Record 6085580;
    BEGIN
      TemplateField.FILTERGROUP(2);
      TemplateField.SETRANGE("Template No.","Template No.");
      TemplateField.SETRANGE(Type,Type);
      TemplateField.SETRANGE(Code,Code);
      TemplateField.FILTERGROUP(0);
      PAGE.RUNMODAL(PAGE::"CDC Template Field Codeunits",TemplateField);
    END;

    LOCAL PROCEDURE RemoveQuotationMarks@6085574(FormulaString@6085573 : Text[1024]) : Text[1024];
    VAR
      FormulaLength@6085575 : Integer;
    BEGIN
      IF FormulaString = '' THEN
        EXIT;

      FormulaLength := STRLEN(FormulaString);
      IF (FormulaString[1] = '''') AND (FormulaString[FormulaLength] = '''') THEN BEGIN
        FormulaString := COPYSTR(FormulaString,2,FormulaLength);
        FormulaString := COPYSTR(FormulaString,1,FormulaLength-2);
      END;
      EXIT(FormulaString);
    END;

    PROCEDURE SetDocumentNo@6085576(DocumentNo@6085573 : Code[20]);
    BEGIN
      CurrentDocumentNo := DocumentNo;
    END;

    LOCAL PROCEDURE UpdateALRFields@6();
    BEGIN
      IsLinkedFieldSearch := Rec."Advanced Line Recognition Type" = Rec."Advanced Line Recognition Type"::LinkedToAnchorField;
      ShowPositionDependendFields := (Rec."Advanced Line Recognition Type" IN [Rec."Advanced Line Recognition Type"::FindFieldByColumnHeading, Rec."Advanced Line Recognition Type"::FindFieldByCaptionInPosition]);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 6085597 CDC Document Lines ListPart
{
  OBJECT-PROPERTIES
  {
    Date=14-04-22;
    Time=12:00:00;
    Modified=Yes;
    Version List=DCW17.00.00.8.02,ALR1.15;
  }
  PROPERTIES
  {
    CaptionML=[DEU=CDC Document Lines ListPart;
               ENU=CDC Document Lines ListPart];
    LinksAllowed=No;
    SourceTable=Table6085596;
    PageType=ListPart;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             IdentifierVisible := TRUE;
           END;

    OnOpenPage=BEGIN
                 IdentifierVisible := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       UpdateTranslInfo;
                       FillSortingBuffer;
                     END;

    OnNewRecord=BEGIN
                  "Document No." := Document."No.";
                  "Template No." := Document."Template No.";
                  "Translate to Type" := 0;
                  "Translate to No." := '';

                  IF NOT BelowxRec THEN BEGIN
                    xRecLineNo := xRec."Line No.";
                    "Line No." := 0
                  END ELSE
                    "Line No." := GetLastLineNo + 1;

                  CurrLineNo := "Line No.";
                END;

    OnInsertRecord=BEGIN
                     xRecLineNo := 0;

                     IF NOT BelowxRec THEN
                       ManuallyInsertLine(xRec."Line No.");
                     EXIT(TRUE);
                   END;

    OnDeleteRecord=VAR
                     Value@1000000000 : Record 6085593;
                   BEGIN
                     Value.SETCURRENTKEY("Document No.","Is Value",Type,"Page No.","Line No.");
                     Value.SETRANGE("Document No.",Document."No.");
                     Value.SETRANGE("Is Value",TRUE);
                     Value.SETRANGE(Type,Value.Type::Line);
                     Value.SETRANGE("Line No.","Line No.");
                     Value.DELETEALL;
                     EXIT(TRUE);
                   END;

    OnAfterGetCurrRecord=BEGIN
                           CurrLineNo := "Line No.";
                         END;

    ActionList=ACTIONS
    {
      { 1160040000;  ;ActionContainer;
                      Name=ActionItems;
                      ActionContainerType=ActionItems }
      { 1160040002;1 ;ActionGroup;
                      Name=Line;
                      CaptionML=[DEU=&Zeile;
                                 ENU=&Line];
                      Image=Line }
      { 1160040001;2 ;Action    ;
                      Name=Card;
                      CaptionML=[DEU=Karte;
                                 ENU=Card];
                      ToolTipML=[DEU=Zeigt detaillierte Informationen Åber den in der Belegzeile oder Buchungsblattzeile befindlichen Datensatz an oder Ñndert diese.;
                                 ENU=View or change detailed information about the record on the document or journal line.];
                      Image=EditLines;
                      OnAction=BEGIN
                                 Rec.ShowCard;
                               END;
                                }
      { 3       ;1   ;ActionGroup;
                      Name=TranslationsGr;
                      CaptionML=[DEU=öbersetzungen;
                                 ENU=&Translations];
                      Image=Track }
      { 6       ;2   ;Action    ;
                      Name=NoTranslation;
                      CaptionML=[DEU=Nr.;
                                 ENU=No.];
                      ToolTipML=[DEU=öbersetzungen fÅr Nr. anzeigen oder bearbeiten.;
                                 ENU=View or edit No. translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSalesTransl@1001 : Codeunit 6085707;
                               BEGIN
                                 PurchSalesTransl.ShowItemNoTrans(Document);
                               END;
                                }
      { 5       ;2   ;Action    ;
                      Name=DescriptionTranslation;
                      CaptionML=[DEU=Beschreibung;
                                 ENU=Description];
                      ToolTipML=[DEU=öbersetzungen fÅr Beschreibung anzeigen oder bearbeiten.;
                                 ENU=View or edit Description translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSalesTransl@1001 : Codeunit 6085707;
                               BEGIN
                                 PurchSalesTransl.ShowDescriptionTrans(Document);
                               END;
                                }
      { 4       ;2   ;Action    ;
                      Name=UOM;
                      CaptionML=[DEU=Einheit;
                                 ENU=Unit of Measure];
                      ToolTipML=[DEU=öbersetzungen fÅr Einheit anzeigen oder bearbeiten.;
                                 ENU=View or edit Unit of Measure translations.];
                      Visible=ShowUOMTranslation;
                      Image=Track;
                      OnAction=VAR
                                 PurchSalesTransl@1001 : Codeunit 6085707;
                               BEGIN
                                 IF "Translate to Type" = "Translate to Type"::Item THEN
                                   PurchSalesTransl.ShowUOMTrans(Document,"Translate to No.")
                                 ELSE
                                   PurchSalesTransl.ShowUOMTrans(Document,'');
                               END;
                                }
      { 8       ;2   ;Action    ;
                      Name=CrossReferences;
                      CaptionML=[DEU=Artikelreferenzen;
                                 ENU=Cross References];
                      ToolTipML=[DEU=Richtet eine eigene öbersetzung des ausgewÑhlten Artikel fÅr den Debitor oder Kreditor ein. Artikelreferenzen auf die Artikelnummer des Debitors bedeuten, dass ihre Artikelnummer automatisch anstelle der von Ihnen verwendeten Nummer auf den Verkaufsbelegen angezeigt wird.;
                                 ENU=Set up a customer's or vendor's own identification of the selected item. Cross-references to the customer's item number means that the item number is automatically shown on sales documents instead of the number that you use.];
                      Image=Change;
                      OnAction=VAR
                                 ItemReferenceMgt@6085574 : Codeunit 6086026;
                               BEGIN
                                 ItemReferenceMgt.ShowItemReference(Document."Source Record Table ID",Document."Source Record No.");
                               END;
                                }
      { 61000   ;1   ;ActionGroup;
                      Name=AdvancedLineRecognition;
                      CaptionML=[DAN=Avanceret linjegenkendelse;
                                 DEU=Erw. Zeilenerkennung;
                                 ENU=Adv. line recognition;
                                 FRA=Recon. avancÇe de ligne;
                                 NLD=Geavanceerde lijnherkenning];
                      Image=SetupLines }
      { 61001   ;2   ;Action    ;
                      Name=SearchByLinkedField;
                      CaptionML=[DAN=Find vërdi ved hjëlp af forbundet felt;
                                 DEU=Suche Åber verknÅpftes Feld;
                                 ENU=Find value by linked field;
                                 FRA=Trouver valeur par champ liÇ;
                                 NLD=Vind waarde via gekoppeld veld];
                      ToolTipML=[DAN=Det õnskede felt bliver fundet via en fast forskydning (afstand) fra et andet felt.;
                                 DEU=Das gewÅnschte Feld wird Åber einen fest definiertes Offset (Abstand) von einem anderen Feld gefunden.;
                                 ENU=The desired field is found via a fixed offset (distance) from another field.;
                                 FRA=Le champ dÇsirÇ est trouvÇ via un dÇcalage fixe (distance) Ö partir d'un autre champ.;
                                 NLD=Het gewenste veld wordt gevonden via een vaste offset (afstand) uit een ander veld.
                                 ];
                      Promoted=Yes;
                      Image=Link;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1000000000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.SetToAnchorLinkedField(Rec);
                               END;
                                }
      { 61002   ;2   ;Action    ;
                      Name=SearchByColumnHeading;
                      CaptionML=[DAN=Find vërdi ved hjëlp af kolonneoverskrift;
                                 DEU=Feld mit SpaltenÅberschrift;
                                 ENU=Find value by column heading;
                                 FRA=Rechercher valeur par en-tàte de colonne;
                                 NLD=Vind waarde via kolomkoptekst];
                      ToolTipML=[DAN=Der sõges efter det õnskede felt ved hjëlp af en tidligere anvendt kolonneoverskrift i omrÜdet for den aktuelle position.;
                                 DEU=Das gewÅnschte Feld wird Åber eine vorher trainierte SpaltenÅberschrift im Bereich der aktuellen Position gesucht.;
                                 ENU=The desired field is searched for using a previously trained column heading in the range of the current position.;
                                 FRA=Le champ dÇsirÇ est recherchÇ en utilisant un texte/lÇgende de recherche prÇalablement entraånÇ dans la zone de la position courante.;
                                 NLD=Het gewenste veld wordt gezocht via een eerder getrainde kolomkop binnen het bereik van de huidige positie.];
                      Promoted=Yes;
                      Image=Table;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1113400000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.SetToFieldSearchWithColumnHeding(Rec);
                               END;
                                }
      { 61003   ;2   ;Action    ;
                      Name=SearchByCaption;
                      CaptionML=[DAN=Find vërdi ved hjëlp af overskrift;
                                 DEU=Feld mit Suchtext;
                                 ENU=Find value by caption;
                                 FRA=Trouver valeur par lÇgende;
                                 NLD=Vind waarde via bijschrift];
                      ToolTipML=[DAN=Der sõges efter det õnskede felt ved hjëlp af en tidligere anvendt sõgetekst/overskrift i omrÜdet for den aktuelle position.;
                                 DEU=Das gewÅnschte Feld wird Åber einen vorher trainierten Suchtext/Caption im Bereich der aktuellen Position gesucht.;
                                 ENU=The desired field is searched for using a previously trained search text/caption in the area of the current position.;
                                 FRA=Le champ dÇsirÇ est recherchÇ en utilisant un texte/lÇgende de recherche prÇalablement entraånÇ dans la zone de la position courante.;
                                 NLD=Het gewenste veld wordt gezocht via een eerder getrainde zoektekst/bijschrift in het gebied van de huidige positie.];
                      Promoted=Yes;
                      Image=Find;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1113400000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.SetToFieldSearchWithCaption(Rec);
                               END;
                                }
      { 61004   ;2   ;Separator  }
      { 61005   ;2   ;Action    ;
                      Name=ResetFieldToDefault;
                      CaptionML=[DAN=Nulstil felt;
                                 DEU=Feld zurÅcksetzen;
                                 ENU=Reset field;
                                 FRA=RÇinitialiser le champ;
                                 NLD=Veld opnieuw instellen];
                      ToolTipML=[DAN=De avancerede linjegenkendelsesindstillinger nulstilles til det õnskede felt.
                                 ;
                                 DEU=Die Einstellungen der erweiterten Zeilenerkennung werden fÅr das gewÅnschte Feld zurÅckgesetzt.;
                                 ENU=The advanced line recognition settings are reset for the desired field.;
                                 FRA=Les paramätres de reconnaissance avancÇs de ligne sont rÇinitialisÇs pour le champ dÇsirÇ.;
                                 NLD=De geavanceerde lijnherkenning instellingen voor het gewenste veld zijn gereset.];
                      Image=ResetStatus;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.ResetFieldFromMenu(Rec);
                               END;
                                }
      { 61006   ;2   ;Action    ;
                      Name=ShowVersionNo;
                      CaptionML=[DAN=Version;
                                 DEU=Version;
                                 ENU=Version;
                                 FRA=Version;
                                 NLD=Versie];
                      ToolTipML=[DAN=Viser den aktuelt benyttede version af avancerede linjegenkendelse.;
                                 DEU=Zeigt die aktuell verwendete Version der erweiterten Zeilenerkennung an.;
                                 ENU=Displays the currently used version of the advanced line detection.;
                                 FRA=Affiche la version actuellement utilisÇe de la dÇtection avancÇe de ligne.;
                                 NLD=Toont de momenteel gebruikte versie van de geavanceerde lijnherkenning.];
                      Image=Info;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1160040000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.ShowVersionNo();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                Name=ContentArea;
                ContainerType=ContentArea }

    { 6085600;1;Field     ;
                Name=CDC Document Lines ListPart;
                SourceExpr='';
                Visible=IdentifierVisible }

    { 1000000001;1;Group  ;
                Name=Repeater;
                IndentationColumnName=1;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                Name=OK;
                ToolTipML=[DEU=Gibt an, ob die Zeile gÅltig ist.;
                           ENU=Specifies whether the line is valid.];
                SourceExpr=OK;
                Editable=FALSE }

    { 1   ;2   ;Field     ;
                Name=Translate to Type;
                ToolTipML=[DEU=Gibt die interne Art an, in den die erkannte Nummer Åbersetzt werden soll.;
                           ENU=Specifies the internal type to translate the recognized number value to.];
                SourceExpr="Translate to Type";
                Editable=AllowEdit }

    { 2   ;2   ;Field     ;
                Name=Translate to No.;
                ToolTipML=[DEU=Gibt die interne Nummer an, in die die erkannte Nummer Åbersetzt werden soll.;
                           ENU=Specifies the internal number to translate the recognized number value to.];
                SourceExpr="Translate to No.";
                Editable=AllowEdit;
                OnValidate=BEGIN
                             FillSortingBuffer;
                             Document.FIND('=');
                             Document.ValidateDocument;
                           END;

                OnLookup=BEGIN
                           EXIT(LookupTranslToNo(Text));
                         END;
                          }

    { 1000000013;2;Field  ;
                Name=Control1000000013;
                CaptionML=[DEU=Zugeordnete Menge;
                           ENU=Matched Quantity];
                ToolTipML=[DEU=Gibt die mit der Zeile Åbereinstimmende Menge an.;
                           ENU=Specifies the quantity matched to the line.];
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr=GetMatchedQty;
                Visible=ShowMatchedQty;
                Editable=AllowEdit;
                OnDrillDown=BEGIN
                              ShowMatchSpec;
                            END;
                             }

    { 161024012;2;Field   ;
                Name=Line No.;
                ToolTipML=[DEU=Gibt die Zeilennummer an.;
                           ENU=Specifies the line number.];
                SourceExpr="Line No.";
                Visible=FALSE;
                Editable=FALSE }

    { 1100000000;2;Field  ;
                Name=Field Value 1;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 1";
                CaptionClass=FieldCaptions[1];
                Visible=NoOfColumns >= 1;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(1,"Field Value 1");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(1,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(1);
                             END;
                              }

    { 1100000001;2;Field  ;
                Name=Field Value 2;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 2";
                CaptionClass=FieldCaptions[2];
                Visible=NoOfColumns >= 2;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(2,"Field Value 2");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(2,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(2);
                             END;
                              }

    { 1100000002;2;Field  ;
                Name=Field Value 3;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 3";
                CaptionClass=FieldCaptions[3];
                Visible=NoOfColumns >= 3;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(3,"Field Value 3");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(3,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(3);
                             END;
                              }

    { 1100000003;2;Field  ;
                Name=Field Value 4;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 4";
                CaptionClass=FieldCaptions[4];
                Visible=NoOfColumns >= 4;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(4,"Field Value 4");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(4,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(4);
                             END;
                              }

    { 1100000004;2;Field  ;
                Name=Field Value 5;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 5";
                CaptionClass=FieldCaptions[5];
                Visible=NoOfColumns >= 5;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(5,"Field Value 5");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(5,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(5);
                             END;
                              }

    { 1100000005;2;Field  ;
                Name=Field Value 6;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 6";
                CaptionClass=FieldCaptions[6];
                Visible=NoOfColumns >= 6;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(6,"Field Value 6");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(6,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(6);
                             END;
                              }

    { 1100000006;2;Field  ;
                Name=Field Value 7;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 7";
                CaptionClass=FieldCaptions[7];
                Visible=NoOfColumns >= 7;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(7,"Field Value 7");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(7,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(7);
                             END;
                              }

    { 1100000007;2;Field  ;
                Name=Field Value 8;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 8";
                CaptionClass=FieldCaptions[8];
                Visible=NoOfColumns >= 8;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(8,"Field Value 8");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(8,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(8);
                             END;
                              }

    { 1100000008;2;Field  ;
                Name=Field Value 9;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 9";
                CaptionClass=FieldCaptions[9];
                Visible=NoOfColumns >= 9;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(9,"Field Value 9");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(9,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(9);
                             END;
                              }

    { 1100000009;2;Field  ;
                Name=Field Value 10;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 10";
                CaptionClass=FieldCaptions[10];
                Visible=NoOfColumns >= 10;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(10,"Field Value 10");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(10,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(10);
                             END;
                              }

    { 1000000003;2;Field  ;
                Name=Field Value 11;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 11";
                CaptionClass=FieldCaptions[11];
                Visible=NoOfColumns >= 11;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(11,"Field Value 11");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(11,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(11);
                             END;
                              }

    { 1000000004;2;Field  ;
                Name=Field Value 12;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 12";
                CaptionClass=FieldCaptions[12];
                Visible=NoOfColumns >= 12;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(12,"Field Value 12");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(12,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(12);
                             END;
                              }

    { 1000000005;2;Field  ;
                Name=Field Value 13;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 13";
                CaptionClass=FieldCaptions[13];
                Visible=NoOfColumns >= 13;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(13,"Field Value 13");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(13,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(13);
                             END;
                              }

    { 1000000006;2;Field  ;
                Name=Field Value 14;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 14";
                CaptionClass=FieldCaptions[14];
                Visible=NoOfColumns >= 14;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(14,"Field Value 14");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(14,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(14);
                             END;
                              }

    { 1000000007;2;Field  ;
                Name=Field Value 15;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 15";
                CaptionClass=FieldCaptions[15];
                Visible=NoOfColumns >= 15;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(15,"Field Value 15");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(15,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(15);
                             END;
                              }

    { 1000000008;2;Field  ;
                Name=Field Value 16;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 16";
                CaptionClass=FieldCaptions[16];
                Visible=NoOfColumns >= 16;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(16,"Field Value 16");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(16,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(16);
                             END;
                              }

    { 1000000009;2;Field  ;
                Name=Field Value 17;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 17";
                CaptionClass=FieldCaptions[17];
                Visible=NoOfColumns >= 17;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(17,"Field Value 17");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(17,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(17);
                             END;
                              }

    { 1000000010;2;Field  ;
                Name=Field Value 18;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 18";
                CaptionClass=FieldCaptions[18];
                Visible=NoOfColumns >= 18;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(18,"Field Value 18");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(18,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(18);
                             END;
                              }

    { 1000000011;2;Field  ;
                Name=Field Value 19;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 19";
                CaptionClass=FieldCaptions[19];
                Visible=NoOfColumns >= 19;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(19,"Field Value 19");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(19,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(19);
                             END;
                              }

    { 1000000012;2;Field  ;
                Name=Field Value 20;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 20";
                CaptionClass=FieldCaptions[20];
                Visible=NoOfColumns >= 20;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(20,"Field Value 20");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(20,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(20);
                             END;
                              }

  }
  CODE
  {
    VAR
      Document@1000000010 : Record 6085590;
      DocCat@1160040002 : Record 6085575;
      CaptureMgt@1000000008 : Codeunit 6085576;
      WebClientMgt@6085575 : Codeunit 6085662;
      ShowMatchedQty@1000000001 : Boolean INDATASET;
      AllowEdit@1000000002 : Boolean INDATASET;
      IdentifierVisible@6085600 : Boolean;
      FieldCodes@1001 : ARRAY [20] OF Code[20];
      FieldCaptions@1000 : ARRAY [20] OF Text[250];
      xRecLineNo@6085573 : Integer;
      CurrLineNo@6085574 : Integer;
      NoOfColumns@6085577 : Integer INDATASET;
      ShowUOMTranslation@6085576 : Boolean INDATASET;

    PROCEDURE GetCaptions@1000000002();
    VAR
      Field@1000000003 : Record 6085580;
      Template@1000000001 : Record 6085579;
      I@1000000002 : Integer;
      AddField@1000 : Boolean;
    BEGIN
      CLEAR(FieldCodes);
      CLEAR(FieldCaptions);
      NoOfColumns := 0;

      Field.SETCURRENTKEY("Template No.",Type,"Sort Order");
      Field.SETRANGE("Template No.",Document."Template No.");
      Field.SETRANGE(Type,Field.Type::Line);
      IF Field.FINDSET THEN
        REPEAT
          AddField := TRUE;
          IF Document."File Type" = Document."File Type"::XML THEN BEGIN
            IF Field."Show Field" = Field."Show Field"::IfValue THEN
              IF NOT CaptureMgt.LineFieldHasAnyValues(Document,Field.Code) THEN
                AddField := FALSE;

            IF Field."Show Field" = Field."Show Field"::Never THEN
              AddField := FALSE;
          END;

          IF AddField THEN BEGIN
            I := I + 1;
            FieldCodes[I] := Field.Code;
            FieldCaptions[I] := Field."Field Name";
            NoOfColumns += 1;
          END;
        UNTIL (Field.NEXT = 0) OR (I = 20);

      FOR I := 1 TO 20 DO
        IF FieldCaptions[I] = '' THEN
          FieldCaptions[I] := '-';
    END;

    PROCEDURE SetDocument@1000000003(VAR NewDocument@1000000001 : Record 6085590;BuildTempLines@1000 : Boolean);
    VAR
      Value@1000000003 : Record 6085593;
      Template@1000000005 : Record 6085579;
      i@1000000000 : Integer;
      NoOfLines@1000000004 : Integer;
    BEGIN
      Document := NewDocument;
      ShowUOMTranslation := Document.GetSourceTableNo = DATABASE::Vendor;

      IF NOT DocCat.GET(Document."Document Category Code") THEN
        CLEAR(DocCat);

      DELETEALL;

      GetCaptions;

      IF BuildTempLines THEN
        Document.BuildTempLinesTable(Rec);

      CurrPage.UPDATE(FALSE);
    END;

    PROCEDURE GoToFirstLine@2();
    BEGIN
      IF FINDFIRST THEN;
    END;

    PROCEDURE UpdatePage@1000000000();
    BEGIN
      UpdateFieldValues;
    END;

    PROCEDURE UpdateFieldValues@1000000006();
    VAR
      Template@1000000002 : Record 6085579;
      Field@1000000000 : Record 6085580;
      i@1000000001 : Integer;
      Update@6085573 : Boolean;
    BEGIN
      IF CurrLineNo > 0 THEN // We store the line number OnAfterGetCurrRecord as the Rec point might be invalid in NAV2017 at the point of invocation (UpdatePage).
        Update := NOT GET("Document No.",CurrLineNo);

      "Field Value 1" := GetValueAsText(FieldCodes[1]);
      "Field Value 2" := GetValueAsText(FieldCodes[2]);
      "Field Value 3" := GetValueAsText(FieldCodes[3]);
      "Field Value 4" := GetValueAsText(FieldCodes[4]);
      "Field Value 5" := GetValueAsText(FieldCodes[5]);
      "Field Value 6" := GetValueAsText(FieldCodes[6]);
      "Field Value 7" := GetValueAsText(FieldCodes[7]);
      "Field Value 8" := GetValueAsText(FieldCodes[8]);
      "Field Value 9" := GetValueAsText(FieldCodes[9]);
      "Field Value 10" := GetValueAsText(FieldCodes[10]);
      "Field Value 11" := GetValueAsText(FieldCodes[11]);
      "Field Value 12" := GetValueAsText(FieldCodes[12]);
      "Field Value 13" := GetValueAsText(FieldCodes[13]);
      "Field Value 14" := GetValueAsText(FieldCodes[14]);
      "Field Value 15" := GetValueAsText(FieldCodes[15]);
      "Field Value 16" := GetValueAsText(FieldCodes[16]);
      "Field Value 17" := GetValueAsText(FieldCodes[17]);
      "Field Value 18" := GetValueAsText(FieldCodes[18]);
      "Field Value 19" := GetValueAsText(FieldCodes[19]);
      "Field Value 20" := GetValueAsText(FieldCodes[20]);

      AllowEdit := Document.Status = Document.Status::Open;

      IF WebClientMgt.IsWebClient AND Update THEN BEGIN
        DELETEALL;
        Document.BuildTempLinesTable(Rec);
        CurrPage.UPDATE(FALSE);
      END ELSE
        IF LineIsInserted("Document No.",CurrLineNo) THEN
          CurrPage.UPDATE(TRUE);
    END;

    LOCAL PROCEDURE LineIsInserted@1(DocumentNo@1001 : Code[20];LineNo@1002 : Integer) : Boolean;
    VAR
      TempDocumentLine@1000 : TEMPORARY Record 6085596;
    BEGIN
      TempDocumentLine.COPY(Rec,TRUE);
      EXIT(TempDocumentLine.GET(DocumentNo,LineNo));
    END;

    PROCEDURE GetValueAsText@1000000008(FieldCode@1000000000 : Code[20]) : Text[250];
    VAR
      Field@1000000001 : Record 6085580;
    BEGIN
      IF Field.GET(Document."Template No.",Field.Type::Line,FieldCode) THEN
        EXIT(CaptureMgt.GetValueAsText(Document."No.","Line No.",Field));
    END;

    PROCEDURE UpdateFieldValue@1000000007(ActiveFieldIndex@1000000003 : Integer;VAR NewValue@1000000000 : Text[250]);
    VAR
      Field@1000000004 : Record 6085580;
      Value@1000000002 : Record 6085593;
    BEGIN
      IF xRecLineNo <> 0 THEN BEGIN
        ManuallyInsertLine(xRecLineNo);
        xRecLineNo := 0;
      END;

      Field.GET(Document."Template No.",Field.Type::Line,FieldCodes[ActiveFieldIndex]);
      CaptureMgt.UpdateFieldValue(Document."No.","Page No.","Line No.",Field,NewValue,TRUE,TRUE);
      NewValue := GetValueAsText(FieldCodes[ActiveFieldIndex]);

      ValidateLine;
      IF MODIFY THEN;

      UpdatePage;
    END;

    PROCEDURE Assist@1000000011(ActiveFieldIndex@1000000001 : Integer);
    VAR
      TemplateFieldCard@6085573 : Page 6085586;
      Field@1000000000 : Record 6085580;
    BEGIN
      Field.GET(Document."Template No.",Field.Type::Line,FieldCodes[ActiveFieldIndex]);
      Field.SETRECFILTER;
      TemplateFieldCard.SetDocumentNo(Document."No.");
      TemplateFieldCard.SETTABLEVIEW(Field);
      TemplateFieldCard.RUN;
    END;

    PROCEDURE LookupValue@1000000004(ActiveFieldIndex@1000000001 : Integer;VAR Text@1000000002 : Text[1024]) : Boolean;
    VAR
      Field@1000000000 : Record 6085580;
      NewText@1000000003 : Text[1024];
    BEGIN
      Field.GET(Document."Template No.",Field.Type::Line,FieldCodes[ActiveFieldIndex]);
      NewText := CaptureMgt.LookupValue("Document No.",Field,"Line No.",Text);
      IF NewText <> '' THEN BEGIN
        Text := NewText;
        EXIT(TRUE);
      END;
    END;

    PROCEDURE GetMatchedQty@1000000005() : Decimal;
    VAR
      PurchDocMgt@1001 : Codeunit 6085709;
    BEGIN
      EXIT(PurchDocMgt.GetDocLineMatchedQty(Rec));
    END;

    PROCEDURE SetShowMatchedQty@1000000001(NewShowMatchedQty@1000000000 : Boolean);
    BEGIN
      ShowMatchedQty := NewShowMatchedQty;
    END;

    PROCEDURE ValidateLine@1160040000();
    VAR
      Template@1160040000 : Record 6085579;
    BEGIN
      IF Template.GET(Document."Template No.") AND (Template."Codeunit ID: Line Validation" <> 0) THEN
        CODEUNIT.RUN(Template."Codeunit ID: Line Validation",Rec)
      ELSE
        OK := TRUE;
    END;

    PROCEDURE HasLines@6085573() : Boolean;
    BEGIN
      IF COUNT = 0 THEN
        EXIT(FALSE)
      ELSE
        IF COUNT = 1 THEN BEGIN
          IF ("Field Value 1" = '') AND
            ("Field Value 2" = '') AND
            ("Field Value 3" = '') AND
            ("Field Value 4" = '') AND
            ("Field Value 5" = '') AND
            ("Field Value 6" = '') AND
            ("Field Value 7" = '') AND
            ("Field Value 8" = '') AND
            ("Field Value 9" = '') AND
            ("Field Value 10" = '') AND
            ("Field Value 11" = '') AND
            ("Field Value 12" = '') AND
            ("Field Value 13" = '') AND
            ("Field Value 14" = '') AND
            ("Field Value 15" = '') AND
            ("Field Value 16" = '') AND
            ("Field Value 17" = '') AND
            ("Field Value 18" = '') AND
            ("Field Value 19" = '') AND
            ("Field Value 20" = '')
          THEN
            EXIT(FALSE);
        END;
      EXIT(TRUE);
    END;

    BEGIN
    END.
  }
}

