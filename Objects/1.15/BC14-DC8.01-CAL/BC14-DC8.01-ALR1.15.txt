OBJECT Table 6085579 CDC Template
{
  OBJECT-PROPERTIES
  {
    Date=01/05/22;
    Time=10:00:18 PM;
    Modified=Yes;
    Version List=DCW13.70.00.8.01,ALR1.15;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Type;
    OnInsert=VAR
               DCSetup@1000 : Record 6085573;
               NoSeriesMgt@1001 : Codeunit 396;
             BEGIN
               IF "No." = '' THEN BEGIN
                 DCSetup.GET;
                 DCSetup.TESTFIELD("Template Nos.");
                 NoSeriesMgt.InitSeries(DCSetup."Template Nos.",xRec."No. Series",0D,"No.","No. Series");
               END;
             END;

    OnDelete=VAR
               Field@1000000000 : Record 6085580;
               Document@1000000001 : Record 6085590;
               DataTransl@1000000003 : Record 6085584;
               SearchText@161024012 : Record 6085588;
             BEGIN
               IF Type <> Type::" " THEN
                 IF NOT CONFIRM(STRSUBSTNO(Text005,"No.")) THEN
                   ERROR('');

               Document.SETRANGE("Template No.","No.");
               Document.SETFILTER(Status,'>%1',Document.Status::Open);
               IF NOT Document.ISEMPTY THEN
                 ERROR(Text001);

               Document.SETRANGE(Status,Document.Status::Open);
               IF Document.COUNT > 0 THEN BEGIN
                 IF NOT CONFIRM(Text002,FALSE,Document.COUNT) THEN
                   ERROR('');
                 Document.MODIFYALL("Template No.",'',TRUE);
               END;

               DataTransl.SETRANGE("Template No.","No.");
               DataTransl.DELETEALL(TRUE);

               Field.SETRANGE("Template No.","No.");
               Field.DELETEALL(TRUE);

               SearchText.SETRANGE("Template No.","No.");
               SearchText.DELETEALL(TRUE);
             END;

    CaptionML=[DEU=Vorlage;
               ENU=Template];
    LookupPageID=Page6085591;
    DrillDownPageID=Page6085591;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;CaptionML=[DEU=Nr.;
                                                              ENU=No.];
                                                   NotBlank=Yes }
    { 2   ;   ;Category Code       ;Code10        ;TableRelation="CDC Document Category";
                                                   OnValidate=BEGIN
                                                                CheckDuplicIdentTemplates;
                                                              END;

                                                   CaptionML=[DEU=Kategoriencode;
                                                              ENU=Category Code] }
    { 5   ;   ;Source Record ID Tree ID;Integer   ;TableRelation="CDC Record ID Tree";
                                                   OnValidate=VAR
                                                                RecIDMgt@1160040000 : Codeunit 6085604;
                                                                RecRef@1160040002 : RecordRef;
                                                                RecID@1160040001 : RecordID;
                                                              BEGIN
                                                                "Source Record Table ID" := 0;
                                                                "Source Record No." := '';
                                                                "Source Record Name" := '';

                                                                IF RecIDMgt.GetRecIDFromTreeID("Source Record ID Tree ID",RecID) THEN BEGIN
                                                                  RecRef := RecID.GETRECORD;
                                                                  IF RecIDMgt.KeyIsOneFieldCodeType(RecRef) THEN BEGIN
                                                                    "Source Record Table ID" := RecRef.NUMBER;
                                                                    "Source Record No." := COPYSTR(GetSourceID,1,MAXSTRLEN("Source Record No."));
                                                                    "Source Record Name" := GetSourceName;
                                                                  END;
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=Herkunftsdatensatz-ID;
                                                              ENU=Source Record ID] }
    { 6   ;   ;Default             ;Boolean       ;CaptionML=[DEU=Standard;
                                                              ENU=Default] }
    { 7   ;   ;Type                ;Option        ;OnValidate=BEGIN
                                                                CheckDuplicIdentTemplates;
                                                              END;

                                                   CaptionML=[DEU=Art;
                                                              ENU=Type];
                                                   OptionCaptionML=[DEU=" ,Identifikation,Master";
                                                                    ENU=" ,Identification,Master"];
                                                   OptionString=[ ,Identification,Master] }
    { 8   ;   ;Codeunit ID: After Capture;Integer ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Codeunit ID: After Capture"),FIELDNO("Codeunit ID: After Capture"));
                                                              END;

                                                   CaptionML=[DEU=Codeunit ID: Nach Capture;
                                                              ENU=Codeunit ID: After Capture];
                                                   BlankZero=Yes }
    { 9   ;   ;Recognize Lines     ;Option        ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Recognize Lines",FIELDNO("Recognize Lines"));
                                                              END;

                                                   CaptionML=[DEU=Zeilen erkennen;
                                                              ENU=Recognize Lines];
                                                   OptionCaptionML=[DEU=Nein,Ja;
                                                                    ENU=No,Yes];
                                                   OptionString=No,Yes }
    { 10  ;   ;Description         ;Text30        ;CaptionML=[DEU=Beschreibung;
                                                              ENU=Description] }
    { 11  ;   ;No. Series          ;Code20        ;TableRelation="No. Series";
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("No. Series"),FIELDNO("No. Series"));
                                                              END;

                                                   CaptionML=[DEU=Nummernserie;
                                                              ENU=No. Series];
                                                   Editable=No }
    { 12  ;   ;Codeunit ID: Line Validation;Integer;
                                                   TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Codeunit ID: Line Validation"),FIELDNO("Codeunit ID: Line Validation"));
                                                              END;

                                                   CaptionML=[DEU=Codeunit ID: Zeilenvalidierung;
                                                              ENU=Codeunit ID: Line Validation];
                                                   BlankZero=Yes }
    { 13  ;   ;Codeunit ID: Doc. Validation;Integer;
                                                   TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Codeunit ID: Doc. Validation"),FIELDNO("Codeunit ID: Doc. Validation"));
                                                              END;

                                                   CaptionML=[DEU=Codeunit ID: Belegvalidierung;
                                                              ENU=Codeunit ID: Doc. Validation];
                                                   BlankZero=Yes }
    { 14  ;   ;Codeunit ID: Register;Integer      ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Codeunit ID: Register"),FIELDNO("Codeunit ID: Register"));
                                                              END;

                                                   CaptionML=[DEU=Codeunit ID: Registrierung;
                                                              ENU=Codeunit ID: Register];
                                                   BlankZero=Yes }
    { 19  ;   ;Search Text         ;Code200       ;OnValidate=BEGIN
                                                                TESTFIELD(Type,Type::" ");
                                                              END;

                                                   CaptionML=[DEU=Identifikationstext;
                                                              ENU=Search Text] }
    { 22  ;   ;Codeunit ID: Show Match;Integer    ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Codeunit ID: Show Match"),FIELDNO("Codeunit ID: Show Match"));
                                                              END;

                                                   CaptionML=[DEU=Codeunit ID: Abgleich zeigen;
                                                              ENU=Codeunit ID: Show Match];
                                                   BlankZero=Yes }
    { 24  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   OnValidate=VAR
                                                                Field@1000000000 : Record 6085580;
                                                              BEGIN
                                                                IF "Language Code" = xRec."Language Code" THEN
                                                                  EXIT;

                                                                IF GUIALLOWED THEN
                                                                  IF NOT CONFIRM(Text004,TRUE,FIELDCAPTION("Language Code")) THEN
                                                                    EXIT;

                                                                Field.SETRANGE("Template No.","No.");
                                                                Field.MODIFYALL("Language Code","Language Code");

                                                                ModifyAllTemplates(FORMAT("Language Code"),FIELDNO("Language Code"));
                                                              END;

                                                   CaptionML=[DEU=Sprachcode;
                                                              ENU=Language Code] }
    { 25  ;   ;Codeunit ID: Translations;Integer  ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Codeunit ID: Translations"),FIELDNO("Codeunit ID: Translations"));
                                                              END;

                                                   CaptionML=[DEU=Codeunit ID: öbersetzungen;
                                                              ENU=Codeunit ID: Translations];
                                                   BlankZero=Yes }
    { 27  ;   ;Codeunit ID: Register (Y/N);Integer;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Codeunit ID: Register (Y/N)"),FIELDNO("Codeunit ID: Register (Y/N)"));
                                                              END;

                                                   CaptionML=[DEU=Codeunit ID: Registrieren (Ja/Nein);
                                                              ENU=Codeunit ID: Register (Y/N)];
                                                   BlankZero=Yes }
    { 29  ;   ;Hide Registration Messages;Boolean ;OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Hide Registration Messages",0,9),FIELDNO("Hide Registration Messages"));
                                                              END;

                                                   CaptionML=[DEU=Registrierungsbemerkungen nicht anzeigen;
                                                              ENU=Hide Registration Messages] }
    { 30  ;   ;Show Document After Register;Option;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Show Document After Register",FIELDNO("Show Document After Register"));
                                                              END;

                                                   CaptionML=[DEU=Beleg nach Registrierung anzeigen;
                                                              ENU=Show Document After Register];
                                                   OptionCaptionML=[DEU=Fragen,Immer,Nie;
                                                                    ENU=Ask,Always,Never];
                                                   OptionString=Ask,Always,Never }
    { 31  ;   ;Codeunit ID: After Step 1;Integer  ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Codeunit ID: After Step 1"),FIELDNO("Codeunit ID: After Step 1"));
                                                              END;

                                                   CaptionML=[DEU=Codeunit ID: Nach Schritt 1;
                                                              ENU=Codeunit ID: After Step 1];
                                                   BlankZero=Yes }
    { 32  ;   ;Codeunit ID: After Step 2;Integer  ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Codeunit ID: After Step 2"),FIELDNO("Codeunit ID: After Step 2"));
                                                              END;

                                                   CaptionML=[DEU=Codeunit ID: Nach Schritt 2;
                                                              ENU=Codeunit ID: After Step 2];
                                                   BlankZero=Yes }
    { 35  ;   ;First Table Line Has Captions;Boolean;
                                                   InitValue=Yes;
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("First Table Line Has Captions",0,9),FIELDNO("First Table Line Has Captions"));
                                                              END;

                                                   CaptionML=[DEU=Erste Tabellenzeile enthÑlt Suchbegriffe;
                                                              ENU=First Table Line Has Captions] }
    { 36  ;   ;Codeunit ID: Line Capture;Integer  ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Codeunit ID: Line Capture"),FIELDNO("Codeunit ID: Line Capture"));
                                                              END;

                                                   CaptionML=[DEU=Codeunit ID: Zeilencapture;
                                                              ENU=Codeunit ID: Line Capture];
                                                   BlankZero=Yes }
    { 39  ;   ;Auto Receive Order Variance;Boolean;OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Auto Receive Order Variance",0,9),FIELDNO("Auto Receive Order Variance"));
                                                              END;

                                                   CaptionML=[DEU=Autom. Eingangsbest. innerhalb Abweichung;
                                                              ENU=Auto Receive Order Variance] }
    { 40  ;   ;Auto Ship Return Order Var.;Boolean;OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Auto Ship Return Order Var.",0,9),FIELDNO("Auto Ship Return Order Var."));
                                                              END;

                                                   CaptionML=[DEU=Autom. Reklamation innerhalb Abweichung;
                                                              ENU=Auto Ship Return Order Variance] }
    { 41  ;   ;Posting Date        ;Option        ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Posting Date",FIELDNO("Posting Date"));
                                                              END;

                                                   CaptionML=[DEU=Buchungsdatum;
                                                              ENU=Posting Date];
                                                   OptionCaptionML=[DEU=Benutze Belegdatum,Benutze Heute,Benutze Arbeitsdatum;
                                                                    ENU=Use Document Date (recognized on document),Use Today,Use Work Date];
                                                   OptionString=Use Document Date (recognized on document),Use Today,Use Work Date }
    { 42  ;   ;Date Format         ;Option        ;OnValidate=VAR
                                                                Field@161024012 : Record 6085580;
                                                              BEGIN
                                                                IF "Date Format" = xRec."Date Format" THEN
                                                                  EXIT;

                                                                IF GUIALLOWED THEN
                                                                  IF NOT CONFIRM(Text004,TRUE,FIELDCAPTION("Date Format")) THEN
                                                                    EXIT;

                                                                Field.SETRANGE("Template No.","No.");
                                                                Field.SETRANGE("Data Type",Field."Data Type"::Date);
                                                                Field.MODIFYALL("Date Format","Date Format" + 1);

                                                                ModifyAllTemplatesOptions("Date Format",FIELDNO("Date Format"));
                                                              END;

                                                   CaptionML=[DEU=Datumsformat;
                                                              ENU=Date Format];
                                                   OptionCaptionML=[DEU=Tag / Monat / Jahr,Monat / Tag / Jahr,Jahr / Tag / Monat,Jahr / Monat / Tag,Tag / Jahr / Monat,Monat / Jahr / Tag;
                                                                    ENU=Day / Month / Year,Month / Day / Year,Year / Day / Month,Year / Month / Day,Day / Year / Month,Month / Year / Day];
                                                   OptionString=Day / Month / Year,Month / Day / Year,Year / Day / Month,Year / Month / Day,Day / Year / Month,Month / Year / Day }
    { 43  ;   ;Master Template No. ;Code20        ;TableRelation="CDC Template";
                                                   CaptionML=[DEU=Master-Vorlage Nr.;
                                                              ENU=Master Template No.] }
    { 44  ;   ;Prices Including VAT;Boolean       ;OnValidate=VAR
                                                                DocCat@1160040000 : Record 6085575;
                                                                Customer@1160040001 : Record 18;
                                                                Vendor@1160040002 : Record 23;
                                                              BEGIN
                                                                IF Type = Type::Master THEN BEGIN
                                                                  DocCat.GET("Category Code");
                                                                  CASE DocCat."Source Table No." OF
                                                                    DATABASE::Customer:
                                                                      MESSAGE(Text015,FIELDCAPTION("Prices Including VAT"),Customer.TABLECAPTION);
                                                                    DATABASE::Vendor:
                                                                      MESSAGE(Text015,FIELDCAPTION("Prices Including VAT"),Vendor.TABLECAPTION);
                                                                  END;
                                                                END;

                                                                ModifyAllTemplates(FORMAT("Prices Including VAT",0,9),FIELDNO("Prices Including VAT"));

                                                                IF NOT "Prices Including VAT" THEN
                                                                  EXIT;

                                                                IF CurrFieldNo <> 0 THEN
                                                                  IF NOT CONFIRM(Text013,TRUE,FIELDCAPTION("Amount Validation")) THEN
                                                                    EXIT;

                                                                "Amount Validation" := "Amount Validation"::"Only Amount Incl. VAT must match imported amounts";
                                                              END;

                                                   CaptionML=[DEU=EK-Preise inkl. MwSt.;
                                                              ENU=Prices Including VAT] }
    { 45  ;   ;Source Record Table ID;Integer     ;CaptionML=[DEU=Herkunftsdatensatz Tabelle ID;
                                                              ENU=Source Record Table ID] }
    { 46  ;   ;Source Record No.   ;Code50        ;CaptionML=[DEU=Herkunftsdatensatz Nr.;
                                                              ENU=Source Record No.] }
    { 47  ;   ;Source Record Name  ;Text100       ;CaptionML=[DEU=Herkunftsdatensatz Name;
                                                              ENU=Source Record Name] }
    { 100 ;   ;Purch. Auto Match   ;Boolean       ;OnValidate=BEGIN
                                                                IF "Purch. Auto Match" THEN BEGIN
                                                                  IF "Purch. Match Invoice" = "Purch. Match Invoice"::No THEN
                                                                    "Purch. Match Invoice" := "Purch. Match Invoice"::"Receipt Only";
                                                                  IF "Purch. Match Credit Memo" = "Purch. Match Credit Memo"::No THEN
                                                                    "Purch. Match Credit Memo" := "Purch. Match Credit Memo"::"Return Shipment Only";
                                                                END;

                                                                ModifyAllTemplates(FORMAT("Purch. Auto Match",0,9),FIELDNO("Purch. Auto Match"));
                                                              END;

                                                   CaptionML=[DEU=Automatischer Bestellabgleich;
                                                              ENU=Auto Match] }
    { 101 ;   ;Purch. Match Invoice;Option        ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Purch. Match Invoice",FIELDNO("Purch. Match Invoice"));
                                                              END;

                                                   CaptionML=[DEU=Rechnung abgleichen mit;
                                                              ENU=Match Invoice];
                                                   OptionCaptionML=[DEU=Nein,Lieferungen,Bestellungen,Lieferungen und Bestellungen;
                                                                    ENU=No,Receipt Only,Order Only,Receipt or Order];
                                                   OptionString=No,Receipt Only,Order Only,Receipt or Order }
    { 102 ;   ;Purch. Validate VAT Calc.;Boolean  ;OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Purch. Validate VAT Calc.",0,9),FIELDNO("Purch. Validate VAT Calc."));
                                                              END;

                                                   CaptionML=[DEU=Mwst. Berechnung validieren;
                                                              ENU=Validate VAT Calculation] }
    { 103 ;   ;Validate Line Totals;Boolean       ;OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Validate Line Totals",0,9),FIELDNO("Validate Line Totals"));
                                                              END;

                                                   CaptionML=[DEU=Zeilengesamtwerte validieren;
                                                              ENU=Validate Line Totals] }
    { 104 ;   ;Purch. Inv. Reg. Step 1;Option     ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Purch. Inv. Reg. Step 1",FIELDNO("Purch. Inv. Reg. Step 1"));
                                                              END;

                                                   CaptionML=[DEU=Rechnungs Reg. Schritt 1;
                                                              ENU=Invoice Reg. Step 1];
                                                   OptionCaptionML=[DEU=" ,Rechnung erzeugen,Bestellung zuordnen & Rechnung erzeugen,Bestellung zuordnen und aktualisieren";
                                                                    ENU=" ,Create Invoice,Match Order & Create Invoice,Match & Update Order"];
                                                   OptionString=[ ,Create Invoice,Match Order & Create Invoice,Match & Update Order] }
    { 105 ;   ;Purch. Inv. Reg. Step 2;Option     ;OnValidate=VAR
                                                                CDCModuleLicense@6085573 : Codeunit 6086008;
                                                              BEGIN
                                                                IF ("Purch. Inv. Reg. Step 2" IN ["Purch. Inv. Reg. Step 2"::Release,"Purch. Inv. Reg. Step 2"::Post]) THEN
                                                                  IF NOT "Purch. Auto App. within Var." THEN
                                                                    VALIDATE("Purch. Auto App. within Var.",TRUE);

                                                                IF "Purch. Inv. Reg. Step 2" = "Purch. Inv. Reg. Step 2"::"Submit for Approval" THEN
                                                                  CDCModuleLicense.IsApprovalActivated(TRUE);

                                                                ModifyAllTemplatesOptions("Purch. Inv. Reg. Step 2",FIELDNO("Purch. Inv. Reg. Step 2"));
                                                              END;

                                                   CaptionML=[DEU=Rechnungs Reg. Schritt 2;
                                                              ENU=Invoice Reg. Step 2];
                                                   OptionCaptionML=[DEU=" ,Bereitstellen fÅr Genehmigung,Freigeben,Buchen";
                                                                    ENU=" ,Submit for Approval,Release,Post"];
                                                   OptionString=[ ,Submit for Approval,Release,Post] }
    { 106 ;   ;Max. Variance Amt Allowed LCY;Decimal;
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Max. Variance Amt Allowed LCY"),FIELDNO("Max. Variance Amt Allowed LCY"));
                                                              END;

                                                   CaptionML=[DEU=Max. erlaubter Abweichungsbetrag (MW);
                                                              ENU=Max. Variance Amount Allowed (LCY)] }
    { 107 ;   ;Purch. Match Order No.;Option      ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Purch. Match Order No.",FIELDNO("Purch. Match Order No."));
                                                              END;

                                                   CaptionML=[DEU=Bestellnr. abgleichen;
                                                              ENU=Match Order No.];
                                                   OptionCaptionML=[DEU=Nein,Ja - immer,Ja - falls vorhanden;
                                                                    ENU=No,Yes - always,Yes - if present];
                                                   OptionString=No,Yes - always,Yes - if present }
    { 108 ;   ;Purch. Match Item No.;Option       ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Purch. Match Item No.",FIELDNO("Purch. Match Item No."));
                                                              END;

                                                   CaptionML=[DEU=Artikelnr. abgleichen;
                                                              ENU=Match Item No.];
                                                   OptionCaptionML=[DEU=Nein,Ja - immer,Ja - falls vorhanden;
                                                                    ENU=No,Yes - always,Yes - if present];
                                                   OptionString=No,Yes - always,Yes - if present }
    { 109 ;   ;Purch. Match Quantity;Option       ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Purch. Match Quantity",FIELDNO("Purch. Match Quantity"));
                                                              END;

                                                   CaptionML=[DEU=Menge abgleichen;
                                                              ENU=Match Quantity];
                                                   OptionCaptionML=[DEU=Nein,Ja - immer,Ja - falls vorhanden;
                                                                    ENU=No,Yes - always,Yes - if present];
                                                   OptionString=No,Yes - always,Yes - if present }
    { 110 ;   ;Purch. Match Unit Cost;Option      ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Purch. Match Unit Cost",FIELDNO("Purch. Match Unit Cost"));
                                                              END;

                                                   CaptionML=[DEU=EK-Preis abgleichen;
                                                              ENU=Match Unit Cost];
                                                   OptionCaptionML=[DEU=Nein,Ja - immer,Ja - falls vorhanden;
                                                                    ENU=No,Yes - always,Yes - if present];
                                                   OptionString=No,Yes - always,Yes - if present }
    { 112 ;   ;Purch. Cr.Memo Reg. Step 1;Option  ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Purch. Cr.Memo Reg. Step 1",FIELDNO("Purch. Cr.Memo Reg. Step 1"));
                                                              END;

                                                   CaptionML=[DEU=Gutschrift Reg. Schritt 1;
                                                              ENU=Credit Memo Reg. Step 1];
                                                   OptionCaptionML=[DEU=" ,Gutschrift erzeugen,Reklamation abgleichen & Gutschrift erzeugen,Reklamation abgleichen und aktualisieren";
                                                                    ENU=" ,Create Credit Memo,Match Return Order & Create Credit Memo,Match & Update Return Order"];
                                                   OptionString=[ ,Create Credit Memo,Match Return Order & Create Credit Memo,Match & Update Return Order] }
    { 113 ;   ;Purch. Cr.Memo Reg. Step 2;Option  ;OnValidate=VAR
                                                                CDCModuleLicense@6085573 : Codeunit 6086008;
                                                              BEGIN
                                                                IF ("Purch. Cr.Memo Reg. Step 2" IN ["Purch. Cr.Memo Reg. Step 2"::Release,"Purch. Cr.Memo Reg. Step 2"::Post]) THEN
                                                                  IF NOT "Purch. Auto App. within Var." THEN
                                                                    VALIDATE("Purch. Auto App. within Var.",TRUE);

                                                                IF "Purch. Cr.Memo Reg. Step 2" = "Purch. Cr.Memo Reg. Step 2"::"Submit for Approval" THEN
                                                                  CDCModuleLicense.IsApprovalActivated(TRUE);

                                                                ModifyAllTemplatesOptions("Purch. Cr.Memo Reg. Step 2",FIELDNO("Purch. Cr.Memo Reg. Step 2"));
                                                              END;

                                                   CaptionML=[DEU=Gutschrift Reg. Schritt 2;
                                                              ENU=Credit Memo Reg. Step 2];
                                                   OptionCaptionML=[DEU=" ,Bereitstellen fÅr Genehmigung,Freigeben,Buchen";
                                                                    ENU=" ,Submit for Approval,Release,Post"];
                                                   OptionString=[ ,Submit for Approval,Release,Post] }
    { 114 ;   ;Line Total Header Formula;Code250  ;CaptionML=[DEU=Zeilengesamt Kopfformel;
                                                              ENU=Line Total Header Formula] }
    { 115 ;   ;Allow Register without Amounts;Boolean;
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Allow Register without Amounts",0,9),FIELDNO("Allow Register without Amounts"));
                                                              END;

                                                   CaptionML=[DEU=Erlaube Registrierung ohne BetrÑge;
                                                              ENU=Allow Register w/o Amounts] }
    { 116 ;   ;Amount Validation   ;Option        ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Amount Validation",FIELDNO("Amount Validation"));
                                                              END;

                                                   CaptionML=[DEU=Betragsvalidierung;
                                                              ENU=Amount Validation];
                                                   OptionCaptionML=[DEU=Keine öbereinstimmung erforderlich,Betrag ohne MwSt. und Betrag inkl. MwSt. mÅssen zu den importierten BetrÑgen passen,Nur Betrag inkl. MwSt. muss zum importierten Betrag passen,Nur Betrag ohne MwSt. muss zum importierten Betrag passen;
                                                                    ENU=Not Required,Amount Excl. VAT and Amount Incl. VAT must match imported amounts,Only Amount Incl. VAT must match imported amounts,Only Amount Excl. VAT must match imported amounts];
                                                   OptionString=Not Required,Amount Excl. VAT and Amount Incl. VAT must match imported amounts,Only Amount Incl. VAT must match imported amounts,Only Amount Excl. VAT must match imported amounts }
    { 117 ;   ;Variance Posting Account;Code20    ;TableRelation="G/L Account";
                                                   OnValidate=VAR
                                                                GLAcc@161024012 : Record 15;
                                                              BEGIN
                                                                IF "Variance Posting Account" = '' THEN
                                                                  EXIT;

                                                                GLAcc.GET("Variance Posting Account");
                                                                GLAcc.TESTFIELD("Direct Posting",TRUE);
                                                                GLAcc.TESTFIELD(Blocked,FALSE);

                                                                ModifyAllTemplates(FORMAT("Variance Posting Account"),FIELDNO("Variance Posting Account"));
                                                              END;

                                                   CaptionML=[DEU=Abweichungsbuchungskonto;
                                                              ENU=Variance Posting Account] }
    { 118 ;   ;Purch. Auto App. within Var.;Boolean;
                                                   OnValidate=BEGIN
                                                                IF NOT "Purch. Auto App. within Var." THEN BEGIN
                                                                  IF ("Purch. Inv. Reg. Step 2" IN ["Purch. Inv. Reg. Step 2"::Release,"Purch. Inv. Reg. Step 2"::Post]) THEN
                                                                    ERROR(PurchAutoAppErr,FIELDCAPTION("Purch. Auto App. within Var."),NOT "Purch. Auto App. within Var.",
                                                                      FIELDCAPTION("Purch. Inv. Reg. Step 2"),"Purch. Inv. Reg. Step 2",TABLECAPTION,"No.");

                                                                  IF ("Purch. Cr.Memo Reg. Step 2" IN ["Purch. Cr.Memo Reg. Step 2"::Release,"Purch. Cr.Memo Reg. Step 2"::Post]) THEN
                                                                    ERROR(PurchAutoAppErr,FIELDCAPTION("Purch. Auto App. within Var."),NOT "Purch. Auto App. within Var.",
                                                                      FIELDCAPTION("Purch. Cr.Memo Reg. Step 2"),"Purch. Cr.Memo Reg. Step 2",TABLECAPTION,"No.");
                                                                END;

                                                                ModifyAllTemplates(FORMAT("Purch. Auto App. within Var.",0,9),FIELDNO("Purch. Auto App. within Var."));
                                                              END;

                                                   CaptionML=[DEU=Autom. Freigabe innerhalb der Toleranz;
                                                              ENU=Auto Approve within Variance] }
    { 119 ;   ;Approval Flow Code  ;Code10        ;TableRelation="CDC Approval Flow";
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Approval Flow Code"),FIELDNO("Approval Flow Code"));
                                                              END;

                                                   CaptionML=[DEU=Genehmigungsablaufcode;
                                                              ENU=Approval Flow Code] }
    { 120 ;   ;Use Vendor/Customer Item Nos.;Boolean;
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Use Vendor/Customer Item Nos.",0,9),FIELDNO("Use Vendor/Customer Item Nos."));
                                                              END;

                                                   CaptionML=[DEU=Kreditor/Debitor nutzt unsere Artikelnummern;
                                                              ENU=Vendor/Customer uses your Item Nos.] }
    { 122 ;   ;Allowed Variance %  ;Decimal       ;OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Allowed Variance %"),FIELDNO("Allowed Variance %"));
                                                              END;

                                                   CaptionML=[DEU=Max. erlaubte Abweichung %;
                                                              ENU=Max. Variance % Allowed];
                                                   DecimalPlaces=0:2;
                                                   MinValue=0 }
    { 123 ;   ;Copy Matched Header Dimensions;Boolean;
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Copy Matched Header Dimensions",0,9),FIELDNO("Copy Matched Header Dimensions"));
                                                              END;

                                                   CaptionML=[DEU=Abgeglichene Dimensionen vom Belegkopf kopieren;
                                                              ENU=Copy Matched Header Dimensions] }
    { 124 ;   ;Purch. Match Credit Memo;Option    ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Purch. Match Credit Memo",FIELDNO("Purch. Match Credit Memo"));
                                                              END;

                                                   CaptionML=[DEU=Gutschrift abgleichen mit;
                                                              ENU=Match Credit Memo];
                                                   OptionCaptionML=[DEU=Nein,RÅcklieferungen,Reklamationen,RÅcklieferungen und Reklamationen;
                                                                    ENU=No,Return Shipment Only,Return Order Only,Return Shipment or Return Order];
                                                   OptionString=No,Return Shipment Only,Return Order Only,Return Shipment or Return Order }
    { 200 ;   ;Interaction Template Code;Code10   ;TableRelation="Interaction Template";
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Interaction Template Code"),FIELDNO("Interaction Template Code"));
                                                              END;

                                                   CaptionML=[DEU=AktivitÑtenvorlagencode;
                                                              ENU=Interaction Template Code] }
    { 300 ;   ;Sales Order Reg. Step 1;Option     ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Sales Order Reg. Step 1",FIELDNO("Sales Order Reg. Step 1"));
                                                              END;

                                                   CaptionML=[DEU=Bestellung Reg. Schritt 1;
                                                              ENU=Order Reg. Step 1];
                                                   OptionCaptionML=[DEU=" ,,Bestellung erzeugen";
                                                                    ENU=" ,,Create Order"];
                                                   OptionString=[ ,,Create Order] }
    { 301 ;   ;Sales Order Reg. Step 2;Option     ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Sales Order Reg. Step 2",FIELDNO("Sales Order Reg. Step 2"));
                                                              END;

                                                   CaptionML=[DEU=Bestellung Reg. Schritt 2;
                                                              ENU=Order Reg. Step 2];
                                                   OptionCaptionML=[DEU=" ,Bereitstellen fÅr Genehmigung,Freigeben";
                                                                    ENU=" ,Submit for Approval,Release"];
                                                   OptionString=[ ,Submit for Approval,Release] }
    { 302 ;   ;Merge from same E-mail;Boolean     ;OnValidate=VAR
                                                                DCDocumentCategory@6085573 : Record 6085575;
                                                              BEGIN
                                                                // "Merge from same E-mail" only works when "Archive E-mails on Document" is populated
                                                                // so makes no sence to allow it to be set when "Archive E-mails on Document" = No
                                                                IF "Merge from same E-mail" THEN BEGIN
                                                                  TESTFIELD("Category Code");
                                                                  DCDocumentCategory.GET("Category Code");
                                                                  DCDocumentCategory.TESTFIELD("Import and Archive E-Mails",TRUE);
                                                                END;

                                                                ModifyAllTemplates(FORMAT("Merge from same E-mail",0,9),FIELDNO("Merge from same E-mail"));
                                                              END;

                                                   CaptionML=[DEU=Aus der gleichen E-Mail zusammenfÅhren;
                                                              ENU=Merge from same Email] }
    { 303 ;   ;Sales Cr.Memo Reg. Step 1;Option   ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Sales Cr.Memo Reg. Step 1",FIELDNO("Sales Cr.Memo Reg. Step 1"));
                                                              END;

                                                   CaptionML=[DEU=Gutschrift Reg. Schritt 1;
                                                              ENU=Credit Memo Reg. Step 1];
                                                   OptionCaptionML=[DEU=" ,Gutschrift erzeugen";
                                                                    ENU=" ,Create Credit Memo"];
                                                   OptionString=[ ,Create Credit Memo] }
    { 304 ;   ;Sales Cr.Memo Reg. Step 2;Option   ;OnValidate=BEGIN
                                                                ModifyAllTemplatesOptions("Sales Cr.Memo Reg. Step 2",FIELDNO("Sales Cr.Memo Reg. Step 2"));
                                                              END;

                                                   CaptionML=[DEU=Gutschrift Reg. Schritt 2;
                                                              ENU=Credit Memo Reg. Step 2];
                                                   OptionCaptionML=[DEU=" ,Bereitstellen fÅr Genehmigung,Freigeben";
                                                                    ENU=" ,Submit for Approval,Release"];
                                                   OptionString=[ ,Submit for Approval,Release] }
    { 305 ;   ;Unit Cost - Variance Amt (LCY);Decimal;
                                                   OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Unit Cost - Variance Amt (LCY)"),FIELDNO("Unit Cost - Variance Amt (LCY)"));
                                                              END;

                                                   CaptionML=[DEU=Einstandspreis - Toleranzbetrag (MW);
                                                              ENU=Unit Cost - Variance Amt (LCY)] }
    { 306 ;   ;Unit Cost - Variance %;Decimal     ;OnValidate=BEGIN
                                                                ModifyAllTemplates(FORMAT("Unit Cost - Variance %"),FIELDNO("Unit Cost - Variance %"));
                                                              END;

                                                   CaptionML=[DEU=Einstandspreis - Toleranz %;
                                                              ENU=Unit Cost - Variance %];
                                                   DecimalPlaces=0:2;
                                                   MinValue=0 }
    { 400 ;   ;Data Type           ;Option        ;CaptionML=[DEU=Datentyp;
                                                              ENU=Data Type];
                                                   OptionCaptionML=[DEU=PDF,XML;
                                                                    ENU=PDF,XML];
                                                   OptionString=PDF,XML }
    { 402 ;   ;XML Ident. Template No.;Code20     ;TableRelation="CDC Template".No. WHERE (Type=CONST(Identification),
                                                                                           Category Code=FIELD(Category Code),
                                                                                           Data Type=CONST(XML));
                                                   OnValidate=BEGIN
                                                                IF "XML Ident. Template No." = "No." THEN
                                                                  ERROR(NoIdentOnIdentErr);
                                                              END;

                                                   CaptionML=[DEU=XML Identifikationsvorlage;
                                                              ENU=XML Identification Template] }
    { 403 ;   ;Invoice XML Header Tag;Text150     ;OnValidate=BEGIN
                                                                XmlLibrary.FormatXmlPath("Invoice XML Header Tag");
                                                                ModifyRelatedTemplates;
                                                              END;

                                                   CaptionML=[DEU=XML-Rechnung Header Tag;
                                                              ENU=Invoice XML Header Tag] }
    { 404 ;   ;Invoice XML Line Tag;Text150       ;OnValidate=BEGIN
                                                                XmlLibrary.FormatXmlPath("Invoice XML Line Tag");
                                                                ModifyRelatedTemplates;
                                                              END;

                                                   CaptionML=[DEU=XML-Rechnung Zeilen Tag;
                                                              ENU=Invoice XML Line Tag] }
    { 411 ;   ;Cr.Memo XML Header Tag;Text150     ;OnValidate=BEGIN
                                                                XmlLibrary.FormatXmlPath("Cr.Memo XML Header Tag");
                                                                ModifyRelatedTemplates;
                                                              END;

                                                   CaptionML=[DEU=XML-Gutschrift Header Tag;
                                                              ENU=Cr.Memo XML Header Tag] }
    { 412 ;   ;Cr.Memo XML Line Tag;Text150       ;OnValidate=BEGIN
                                                                XmlLibrary.FormatXmlPath("Cr.Memo XML Line Tag");
                                                                ModifyRelatedTemplates;
                                                              END;

                                                   CaptionML=[DEU=XML-Gutschrift Zeilen Tag;
                                                              ENU=Cr.Memo XML Line Tag] }
    { 420 ;   ;XML Stylesheet File ;BLOB          ;CaptionML=[DEU=XML-Stylesheet-Datei;
                                                              ENU=XML Stylesheet File] }
    { 421 ;   ;XML Stylesheet File Extension;Text30;
                                                   CaptionML=[DEU=XML Stylesheet Dateiendung;
                                                              ENU=XML Stylesheet File Extension] }
    { 422 ;   ;XML Stylesheet Main Filename;Text250;
                                                   CaptionML=[DEU=XML-Stylesheets Hauptdateiname;
                                                              ENU=XML Stylesheet Main Filename] }
    { 423 ;   ;XML Stylesheet Main Filename C;Text250;
                                                   CaptionML=[DEU=XML-Stylesheets Hauptdateiname Gutschriften;
                                                              ENU=XML Stylesheet Main Filename Cr.Memo] }
    { 424 ;   ;Split XML at XPath Invoice;Text250 ;CaptionML=[DEU=Bei XML-Pfad teilen;
                                                              ENU=Split at XML Path] }
    { 425 ;   ;Split XML at XPath Cr. Memo;Text250;CaptionML=[DEU=Bei XML-Pfad teilen;
                                                              ENU=Split at XML Path] }
    { 61000;  ;ALR Line Validation Type;Option    ;DataClassification=ToBeClassified;
                                                   CaptionML=[DEU=Zeilenvalidierung Art;
                                                              ENU=Line validation type];
                                                   OptionCaptionML=[DEU=Standard Vorlagencodeunit,Erweiterte Zeilenerkennung;
                                                                    ENU=Default template codeunit,Advanced Line Recognition];
                                                   OptionString=TemplateCodeunit,AdvancedLineRecognition }
    { 61001;  ;Autom. PO search    ;Boolean       ;DataClassification=ToBeClassified;
                                                   CaptionML=[DEU=Auto. Bestellnr.-Suche;
                                                              ENU=Automatic PO search] }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Category Code,Type                       }
    {    ;Search Text                              }
    {    ;Category Code,Source Record ID Tree ID   }
    {    ;Source Record Table ID,Source Record No.,Category Code }
  }
  FIELDGROUPS
  {
  }
  CODE
  {
    VAR
      Text001@1000000001 : TextConst 'DEU=Diese Vorlage kann nicht gelîscht werden. Sie wurde in einem oder mehreren registrierten oder abgelehnten Belegen verwendet.;ENU=This template cannot be deleted because it has been used on one or more registered or rejected documents.';
      Text002@1000000002 : TextConst 'DEU=Diese Vorlagen wird in %1 offenen Belegen benutzt.\\Wenn Sie diese Vorlage lîschen, wird sie aus diesen Belegen entfernt und Sie mÅssen manuell neue Vorlagen zuordnen.\\Mîchten Sie fortfahren?;ENU=This template is used on %1 open documents.\\If you delete this template it will be removed from these documents and you must manually select another template.\\Do you want to continue?';
      Text003@1000000003 : TextConst 'DEU=&Neue erstellen;ENU=&Create New';
      Text004@1000000005 : TextConst 'DEU=Mîchten Sie in allen Feldern %1 aktualisieren?;ENU=Do you want to update %1 on all fields?';
      Text005@1000000006 : TextConst 'DEU=ACHTUNG\\Sie sind im Begriff Systemvorlage %1 zu lîschen.\\Mîchten Sie fortfahren?;ENU=WARNING\\Your are about to delete system template %1.\\Do you want to continue?';
      Text006@161024012 : TextConst 'DEU=N/A;ENU=N/A';
      Text007@161024013 : TextConst 'DEU=Sie mÅssen die Herkunfts-ID angeben.;ENU=You must specify Source ID.';
      Text008@1160040000 : TextConst 'DEU=Herkunfts-ID;ENU=Source ID';
      UpdateTemplateQst@1000 : TextConst 'DEU=Mîchten Sie fÅr die Belegkategorie %4 %1 in allen Vorlagen von %2 auf %3 aktualisieren?;ENU="Do you want to update %1 on all templates created from %2 = %3 for the document category %4?"';
      Text010@1001 : TextConst 'DEU=Aktualisiere Vorlagen\#1####################\@2@@@@@@@@@@@@@@@@@@@@;ENU=Updating templates\#1####################\@2@@@@@@@@@@@@@@@@@@@@';
      Text011@1002 : TextConst 'DEU=%1 von %2;ENU=%1 of %2';
      Text012@1003 : TextConst 'DEU=Vorlagen aktualisiert: %1;ENU=Templates updated: %1';
      Text013@1160040001 : TextConst 'DEU=Mîchten Sie in %1 aktivieren das nur der Bruttobetrag und nicht der Nettobetrag geprÅft wird?;ENU=Do you want to set %1 to only check amounts including VAT and not amounts excluding VAT?';
      Text014@1160040002 : TextConst 'DEU=Mîchten Sie das Feld ''%1'' aus dieser Vorlage entfernen?;ENU=Do you want to remove the field ''%1'' from this template?';
      Text015@1160040003 : TextConst 'DEU=Wenn eine neue Vorlage erstellt wird, wird %1 automatisch auf die gleichen Werte eingestellt, wie auf der %2.;ENU=When a new template is created, %1 is automatically set to the same values as on the %2.';
      PurchAutoAppErr@6085573 : TextConst 'DEU=''%1'' muss %2 sein, wenn in %5 %6 ''%3'' den Wert %4 hat;ENU=''%1'' must be %2 when ''%3'' is %4 in %5 %6';
      ChangeSourceIDErr@6085574 : TextConst 'DEU=Sie kînnen %1 nicht Ñndern, da diese Vorlage auf einem oder mehreren Dokumenten verwendet wurde.;ENU=You cannot change %1 because this template has been used on one or more documents.';
      SourceIDText@6085576 : TextConst 'DEU=Herkunfts-ID;ENU=Source ID';
      SourceNameText@6085575 : TextConst 'DEU=Herkunftsname;ENU=Source Name';
      SourceIDNotExistErr@6085577 : TextConst 'DEU=%1 %2 existiert nicht.;ENU=%1 %2 does not exist.';
      DuplicIdentTempErr@6085578 : TextConst 'DEU=Sie kînnen nur eine Identifikationsvorlage je Belegkategorie verwenden.;ENU=You can only have one identification template for a document category.';
      HeaderText@6085579 : TextConst 'DEU=Kopffelder;ENU=Header Fields';
      LineText@6085580 : TextConst 'DEU=Zeilenfelder;ENU=Line Fields';
      LineTextHidden@1006 : TextConst 'DEU=Zeilenfelder (aktuell ausgeblendet);ENU=Line Fields (Currently Hidden)';
      XmlLibrary@1004 : Codeunit 6085573;
      OverwriteStylesheetQst@6085582 : TextConst 'DEU=FÅr diese Vorlage wurde bereits eine XML-Stylesheet-Datei importiert. Mîchten Sie diese ersetzen?;ENU=There is already an XML Stylesheet file imported for this Template. Do you want to replace it?';
      NoStylesheetMsg@6085583 : TextConst 'DEU=FÅr diese Vorlage wurde keine XML-Stylesheet-Datei importiert.;ENU=There is no XML Stylesheet file imported for this Template.';
      RefreshHtmlQst@6085584 : TextConst 'DEU=Alle offenen Dokumente, die diese Vorlage verwenden, mÅssen aktualisiert werden, um das neue XML-Stylesheet wiederzugeben. Dieser Vorgang kann je nach Anzahl der Dokumente eine Weile dauern. Mîchten Sie fortfahren?;ENU=All Open Documents using this Template must be refreshed to reflect the new XML Stylesheet. This process might take a while, depending on the number of Documents. Do you want continue?';
      UpdStylesheetMsg@6085587 : TextConst 'DEU=Aktualisiere Vorlagen\#1####################\#2####################\@3@@@@@@@@@@@@@@@@@@@@;ENU=Updating Stylesheets\#1####################\@2@@@@@@@@@@@@@@@@@@@@';
      WindowXSLT@6085585 : Dialog;
      UpdStylesheetMsg2@6085588 : TextConst 'DEU=%1 von %2;ENU=%1 %2 of %3';
      ImportStylesheetMsg@6085586 : TextConst 'DEU=Vorlagen-Stylesheet in Datei importieren;ENU=Import Template Stylesheet file';
      ExportStylesheetMsg@6085590 : TextConst 'DEU=Vorlagen-Stylesheet in Datei exportieren;ENU=Export Template Stylesheet file';
      ReviewDiscChrgQst@6086200 : TextConst 'DEU="Es gibt %1 im XML-Dokument, die nicht in der Vorlage zugeordnet sind.\\Mîchten Sie sie jetzt ÅberprÅfen und hinzufÅgen? ";ENU="There are %1 in the XML document that are not mapped in the Template.\\Would you like to review and add them now? "';
      DiscountsTxt@6086203 : TextConst 'DEU=Rabatte;ENU=discounts';
      ChargesTxt@6086202 : TextConst 'DEU=ZuschlÑge;ENU=charges';
      DiscAndChargesTxt@6086201 : TextConst 'DEU=Rabatte und ZuschlÑge;ENU=discounts and charges';
      CaptureMgt@6086204 : Codeunit 6085576;
      NoIdentOnIdentErr@1005 : TextConst 'DEU="Sie kînnen eine Identifikationsvorlage nicht als eigene XML-Identifikationsvorlage festlegen. ";ENU="You cannot set a Identification Template to be its own XML Identification Template. "';
      OneDocumentUpdated@1007 : TextConst 'DEU=Stylesheet wurde fÅr ein Dokument aktualisiert.;ENU=Stylesheet updated for one Document.';
      MultipleDocumentsUpdated@1008 : TextConst 'DEU=Stylesheet wurde fÅr %1 Dokumente aktualisiert.;ENU=Stylesheet updated for %1 Documents.';

    [External]
    [LineStart(33)]
    PROCEDURE CreateNew@1000000008(DocCatCode@1000000000 : Code[20];NewRecIDTreeID@1000000004 : Integer;CopyAllFields@161024019 : Boolean) : Code[20];
    VAR
      DocCat@161024018 : Record 6085575;
      Template@1000000001 : Record 6085579;
      Template2@1000000002 : Record 6085579;
      TempTemplate@161024012 : TEMPORARY Record 6085579;
      Vendor@161024013 : Record 23;
      Customer@161024014 : Record 18;
      Field@161024016 : Record 6085580;
      TemplateNos@1000000007 : ARRAY [500] OF Code[20];
      NewLanguageCode@161024015 : Code[20];
      OptionString@1000000005 : Text[1024];
      i@1000000006 : Integer;
      OptionNumber@1000000008 : Integer;
    BEGIN
      DocCat.GET(DocCatCode);
      IF DocCat."Source Table No." <> 0 THEN
        IF (NewRecIDTreeID = 0) THEN
          ERROR(Text007);

      Template.SETCURRENTKEY("Category Code","Source Record ID Tree ID");
      Template.SETRANGE("Category Code",DocCatCode);
      Template.SETRANGE(Type,Type::" ");
      Template.SETRANGE("Source Record ID Tree ID",NewRecIDTreeID);
      // For XML Document this method is called on the XML Master Template record, and not on a blank Template record.
      IF "Data Type" = "Data Type"::XML THEN BEGIN
        Template.SETRANGE("Data Type",Template."Data Type"::XML);
        Template.SETRANGE("XML Ident. Template No.","XML Ident. Template No.");
      END ELSE
        Template.SETRANGE("Data Type",Template."Data Type"::PDF);

      MakeUniqueNames(Template,TempTemplate);
      IF TempTemplate.FINDSET THEN BEGIN
        REPEAT
          i := i + 1;
          TemplateNos[i] := TempTemplate."No.";

          IF OptionString = '' THEN
            OptionString := TempTemplate.Description
          ELSE
            OptionString := OptionString + ',' + TempTemplate.Description;
        UNTIL (TempTemplate.NEXT = 0) OR (STRLEN(OptionString) >= 290); // STRMENU can only handle Optionstrings of up to lenght 290
        OptionString := OptionString + ',' + Text003;

        IF STRLEN(OptionString) < 290 THEN BEGIN // Ok to use STRMENU
          OptionNumber := STRMENU(OptionString);

          IF OptionNumber = 0 THEN
            EXIT;

          IF TemplateNos[OptionNumber] <> '' THEN
            EXIT(TemplateNos[OptionNumber]);
        END ELSE BEGIN  // Choose using page in stead of STRMENU
          TempTemplate.INIT;
          TempTemplate."No." := 'CREATE';
          TempTemplate.Description := DELCHR(Text003,'=','&');
          TempTemplate.INSERT;

          IF PAGE.RUNMODAL(0,TempTemplate) <> ACTION::LookupOK THEN
            EXIT;

          IF TempTemplate."No." <> 'CREATE' THEN
            EXIT(TempTemplate."No.");
        END;
      END;

      Template.RESET;
      Template.SETCURRENTKEY("Category Code",Type);
      Template.SETRANGE("Category Code",DocCatCode);
      Template.SETRANGE(Type,Template.Type::Master);
      IF "Data Type" = "Data Type"::XML THEN BEGIN
        Template.SETRANGE("Data Type",Template."Data Type"::XML);
        Template.SETRANGE("XML Ident. Template No.","XML Ident. Template No.");
      END ELSE
        Template.SETRANGE("Data Type",Template."Data Type"::PDF);
      Template.FINDFIRST;
      IF Template.COUNT > 1 THEN
        IF PAGE.RUNMODAL(0,Template) <> ACTION::LookupOK THEN
          ERROR('');

      Template2.GET(Template.Clone('',Template,Template."Category Code",'',Template.Type,CopyAllFields,TRUE));

      Template2.VALIDATE("Source Record ID Tree ID",NewRecIDTreeID);
      Template2.Type := Template2.Type::" ";
      Template2.Default := OptionNumber = 0;
      Template2."Master Template No." := Template."No.";

      IF Template2."Data Type" = Template2."Data Type"::XML THEN BEGIN
        Template2."XML Stylesheet File Extension" := '';
        Template2."XML Stylesheet Main Filename" := '';
        Template2."XML Stylesheet Main Filename C" := '';
        CLEAR(Template2."XML Stylesheet File");
      END;

      IF DocCat."Source Table No." = DATABASE::Vendor THEN BEGIN
        Vendor.GET(Template2.GetSourceID);

        IF Vendor."Language Code" <> Template2."Language Code" THEN
          NewLanguageCode := Vendor."Language Code";

        Template2.VALIDATE("Prices Including VAT",Vendor."Prices Including VAT");
      END ELSE
        IF DocCat."Source Table No." = DATABASE::Customer THEN BEGIN
          Customer.GET(Template2.GetSourceID);

          IF Customer."Language Code" <> Template2."Language Code" THEN
            NewLanguageCode := Customer."Language Code";

          Template2.VALIDATE("Prices Including VAT",Customer."Prices Including VAT");
        END;

      IF NewLanguageCode <> '' THEN BEGIN
        Template2."Language Code" := NewLanguageCode;
        Field.SETRANGE("Template No.",Template2."No.");
        Field.MODIFYALL("Language Code",NewLanguageCode);
      END;

      Template2.MODIFY(TRUE);
      EXIT(Template2."No.");
    END;

    [LineStart(139)]
    PROCEDURE MakeUniqueNames@161024015(VAR Template@161024012 : Record 6085579;VAR TempTemplate@161024013 : Record 6085579);
    VAR
      CaptureMgt@6085573 : Codeunit 6085576;
      Desc@161024014 : Text[50];
      i@161024015 : Integer;
    BEGIN
      IF Template.FINDSET THEN
        REPEAT
          Desc := CaptureMgt.ReplaceIllegalFilterCharacters(Template.Description,FALSE,MAXSTRLEN(Template.Description));
          Desc := CaptureMgt.Replace(Desc,',','',FALSE);
          TempTemplate.SETRANGE(Description,Desc);
          WHILE TempTemplate.FINDFIRST DO BEGIN
            i := i + 1;
            Desc := CaptureMgt.ReplaceIllegalFilterCharacters(
              Template.Description,FALSE,
              MAXSTRLEN(Template.Description) - 3 - STRLEN(FORMAT(i))) + ' (' + FORMAT(i) + ')';
            TempTemplate.SETRANGE(Description,Desc);
          END;

          TempTemplate := Template;
          TempTemplate.Description := Desc;
          TempTemplate.INSERT;
        UNTIL Template.NEXT = 0;

      TempTemplate.SETRANGE(Description);
    END;

    [LineStart(160)]
    PROCEDURE Clone@1000000000(FromCompany@1160040001 : Text[30];VAR FromTemplate@161024012 : Record 6085579;ToDocCatCode@1160040000 : Code[10];ToTemplNo@1160040002 : Code[20];ToTemplateType@1002 : ' ,Identification,Master';IncludeAllFields@161024014 : Boolean;CreatedFromMasterTemplate@6085573 : Boolean) : Code[20];
    VAR
      ToTemplate@1000000001 : Record 6085579;
      FromField@1000000000 : Record 6085580;
      FromDataTransl@1000000007 : Record 6085584;
      ToDataTransl@1000000008 : Record 6085584;
      FromDataTranslDim@1001 : Record 6085586;
      ToDataTranslDim@1000 : Record 6085586;
    BEGIN
      IF FromTemplate."Data Type" = FromTemplate."Data Type"::XML THEN
        IF ToTemplateType = ToTemplateType::Master THEN
          FromTemplate.CALCFIELDS("XML Stylesheet File");

      ToTemplate := FromTemplate;
      ToTemplate."Category Code" := ToDocCatCode;
      ToTemplate."No." := ToTemplNo;
      ToTemplate.VALIDATE(Type,ToTemplateType);
      IF (FromTemplate."Category Code" = ToDocCatCode) AND
        (FromTemplate.Type = FromTemplate.Type::Master) AND
        (ToTemplateType = ToTemplateType::" ")
      THEN
        ToTemplate."Master Template No." := FromTemplate."No.";
      ToTemplate.INSERT(TRUE);

      IF FromCompany <> '' THEN BEGIN
        FromField.CHANGECOMPANY(FromCompany);
        FromDataTransl.CHANGECOMPANY(FromCompany);
        FromDataTranslDim.CHANGECOMPANY(FromCompany);
      END;

      FromField.SETRANGE("Template No.",FromTemplate."No.");
      IF NOT IncludeAllFields THEN
        FromField.SETRANGE("Insert on new Templates",TRUE);

      IF FromField.FINDSET THEN
        REPEAT
          FromField.Clone(FromCompany,FromField,ToTemplate,CreatedFromMasterTemplate);
        UNTIL FromField.NEXT = 0;

      FromDataTransl.SETRANGE("Template No.",FromTemplate."No.");
      IF FromDataTransl.FINDSET THEN
        REPEAT
          ToDataTransl := FromDataTransl;
          ToDataTransl."Template No." := ToTemplate."No.";
          ToDataTransl.INSERT(TRUE);

          FromDataTranslDim.SETRANGE("Template No.",FromDataTransl."Template No.");
          FromDataTranslDim.SETRANGE("Field Type",FromDataTransl.Type);
          FromDataTranslDim.SETRANGE("Field Code",FromDataTransl."Field Code");
          FromDataTranslDim.SETRANGE("Translate From",FromDataTransl."Translate From");
          IF FromDataTranslDim.FINDSET THEN
            REPEAT
              ToDataTranslDim := FromDataTranslDim;
              ToDataTranslDim."Template No." := ToTemplate."No.";
              ToDataTranslDim.INSERT(TRUE);
            UNTIL FromDataTranslDim.NEXT = 0;
        UNTIL FromDataTransl.NEXT = 0;

      EXIT(ToTemplate."No.");
    END;

    [LineStart(212)]
    PROCEDURE AssistEdit@2(OldTemplate@1000 : Record 6085579) : Boolean;
    VAR
      DCSetup@1002 : Record 6085573;
      Template@1001 : Record 6085579;
      NoSeriesMgt@1003 : Codeunit 396;
    BEGIN
      WITH Template DO BEGIN
        Template := Rec;
        DCSetup.GET;
        DCSetup.TESTFIELD("Template Nos.");

        IF NoSeriesMgt.SelectSeries(DCSetup."Template Nos.",OldTemplate."No. Series","No. Series") THEN BEGIN
          NoSeriesMgt.SetSeries("No.");
          Rec := Template;
          EXIT(TRUE);
        END;
      END;
    END;

    [LineStart(225)]
    PROCEDURE GetSourceName@161024012() : Text[1024];
    VAR
      DocCat@1160040001 : Record 6085575;
      RecIDMgt@1160040000 : Codeunit 6085604;
      SourceName@1000 : Text[1024];
    BEGIN
      IF DocCat.GET("Category Code") THEN BEGIN
        SourceName := RecIDMgt.GetFieldValue("Source Record ID Tree ID",DocCat."Source Field No. (Name)");
        EXIT(COPYSTR(SourceName,1,MAXSTRLEN("Source Record Name")));
      END;
    END;

    [LineStart(231)]
    PROCEDURE GetSourceIDCaption@6085574() Caption : Text[250];
    VAR
      DocCat@1160040001 : Record 6085575;
      AllObjWithCaption@1160040000 : Record 2000000058;
      RecIDMgt@1160040002 : Codeunit 6085604;
    BEGIN
      Caption := SourceIDText;
      IF DocCat.GET("Category Code") THEN
        IF DocCat."Source Table No." <> 0 THEN
          Caption := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Table,DocCat."Source Table No.");
    END;

    [LineStart(237)]
    PROCEDURE GetSourceNameCaption@6085573() Caption : Text[250];
    VAR
      DocCat@1160040002 : Record 6085575;
      AllObjWithCaption@1160040001 : Record 2000000058;
      RecIDMgt@1160040000 : Codeunit 6085604;
    BEGIN
      Caption := SourceNameText;
      IF DocCat.GET("Category Code") THEN
        IF (DocCat."Source Table No." <> 0) AND (DocCat."Source Field No. (Name)" <> 0) THEN
          Caption := RecIDMgt.GetFieldCaption(DocCat."Source Table No.",DocCat."Source Field No. (Name)");
    END;

    [LineStart(243)]
    PROCEDURE ManuallyAddTemplField@161024013(DocumentNo@6086200 : Code[20]) : Boolean;
    VAR
      Template@161024013 : Record 6085579;
      Field@161024014 : Record 6085580;
      Field2@161024016 : Record 6085580;
      TempField@161024015 : TEMPORARY Record 6085580;
      Document@6086204 : Record 6085590;
      LastType@1000 : Text[50];
      TempSubStr@6086203 : Text[1024];
      FoundDiscounts@6086201 : Boolean;
      FoundCharges@6086202 : Boolean;
    BEGIN
      IF Document.GET(DocumentNo) THEN BEGIN
        FoundDiscounts := CreateMissingDiscChargeField(Document,TempField,TRUE);
        FoundCharges := CreateMissingDiscChargeField(Document,TempField,FALSE);
        IF FoundCharges OR FoundDiscounts THEN BEGIN
          CASE TRUE OF
            FoundDiscounts AND FoundCharges : TempSubStr := DiscAndChargesTxt;
            FoundDiscounts : TempSubStr := DiscountsTxt;
            FoundCharges : TempSubStr := ChargesTxt;
          END;

          IF CONFIRM(STRSUBSTNO(ReviewDiscChrgQst,TempSubStr)) THEN BEGIN
            IF OpenTemplateFieldLookup(TempField) THEN BEGIN
              IF TempField.FINDSET THEN BEGIN
                REPEAT
                  AddDiscChargeFieldToTemplate(Document,TempField);
                UNTIL TempField.NEXT = 0;

                EXIT(TRUE);
              END;
            END;
            EXIT(FALSE);
          END;
          TempField.RESET;
          TempField.DELETEALL;
        END;
      END;

      Template.SETRANGE("Category Code","Category Code");
      Template.SETRANGE(Type,Template.Type::Master);
      IF "Master Template No." <> '' THEN
        Template.SETRANGE("No.","Master Template No.");
      IF Document."No." <> '' THEN BEGIN
        IF Document."File Type" = Document."File Type"::XML THEN
          Template.SETRANGE("Data Type",Template."Data Type"::XML)
        ELSE
          Template.SETRANGE("Data Type",Template."Data Type"::PDF);
      END;

      IF Template.FINDSET THEN
        REPEAT
          Field.SETCURRENTKEY("Template No.",Type,"Sort Order");
          Field.SETRANGE("Template No.",Template."No.");
          IF "Recognize Lines" = "Recognize Lines"::No THEN
            Field.SETRANGE(Type,Field.Type::Header);
          IF Field.FINDSET THEN
            REPEAT
              IF NOT Field2.GET("No.",Field.Type,Field.Code) THEN BEGIN
                IF LastType <> FORMAT(Field.Type) THEN BEGIN
                  TempField.INIT;
                  TempField."Template No." := Template."No.";
                  TempField.Type := Field.Type;
                  IF Field.Type = 0 THEN BEGIN
                    TempField.Code := '#%&HEADERTYPE#%&';
                    TempField."Field Name" := HeaderText;
                  END ELSE BEGIN
                    TempField.Code := '#%&LINETYPE#%&';
                    TempField."Field Name" := LineText;
                  END;
                  TempField."Sort Order" := 0;
                  TempField.INSERT;
                  LastType := FORMAT(Field.Type);
                END;
                TempField.TRANSFERFIELDS(Field);
                TempField."Field Name" := '     '  + Field."Field Name";
                TempField.INSERT;
              END;
            UNTIL Field.NEXT = 0;
        UNTIL Template.NEXT = 0;

      IF "Recognize Lines" = "Recognize Lines"::Yes THEN
        CreateHiddenLineTempFields(Document,TempField);

      IF OpenTemplateFieldLookup(TempField) THEN BEGIN
        IF TempField.FINDSET THEN BEGIN
          REPEAT
            IF NOT (TempField.Code IN ['#%&HEADERTYPE#%&','#%&LINETYPE#%&','#%&LINETYPEHIDDEN#%&']) THEN
              IF TempField."Template No." = 'ZZZHIDENFIELDS' THEN BEGIN // Hidden Fields
                Field.GET(Document."Template No.",TempField.Type,TempField.Code);
                Field."Show Field" := Field."Show Field"::Always;
                Field.MODIFY;
              END ELSE BEGIN
                Field.GET(TempField."Template No.",TempField.Type,TempField.Code);
                Field.Clone('',Field,Rec,FALSE);

                IF TempField."G/L Account Field Code" <> '' THEN
                  IF Field.GET(TempField."Template No.",TempField.Type,TempField."G/L Account Field Code") THEN BEGIN
                    Field.Clone('',Field,Rec,FALSE);

                    CaptureXmlFieldValue(Document,Field);
                  END;
              END;
          UNTIL TempField.NEXT = 0;

          EXIT(TRUE);
        END;
      END;
    END;

    [LineStart(341)]
    LOCAL PROCEDURE CreateMissingDiscChargeField@6086200(VAR Document@6086200 : Record 6085590;VAR TempField@6086224 : TEMPORARY Record 6085580;Discount@6086204 : Boolean) Found : Boolean;
    VAR
      XmlBuffer@6086202 : TEMPORARY Record 6086200;
      MasterTemplate@6086208 : Record 6085579;
      MainField@6086207 : Record 6085580;
      XmlLibrary@6086210 : Codeunit 6085573;
      LogExprMgt@6086217 : Codeunit 6086212;
      CaptureMgt@6086227 : Codeunit 6085576;
      MainFieldCode@6086206 : Code[20];
      XmlPath@6086205 : Text[1024];
      MainXmlPath@6086203 : Text[1024];
      ReasonCode@6086211 : Text[1024];
      ReasonText@6086212 : Text[1024];
      NodeLogicalExpressions@6086214 : ARRAY [100] OF Text[1024];
      PossibleNodeIDs@6086213 : ARRAY [100] OF Integer;
      NoOfPossibleNodes@6086209 : Integer;
      Result@6086215 : Boolean;
      i@6086216 : Integer;
      TempParentEntryNo@6086218 : Integer;
      NewFieldXmlPath@6086219 : Text[1024];
      ReasonCodeNodeName@6086221 : Text[1024];
      ReasonTextNodeName@6086220 : Text[1024];
      TempCreatedLogicalExpr@6086222 : Text[1024];
      Field@6086223 : Record 6085580;
      TempFieldCode@6086226 : Text[1024];
      TempFieldName@6086225 : Text[1024];
      Count@6086201 : Integer;
    BEGIN
      IF Document."No." = '' THEN
        EXIT;
      IF NOT Document.BuildXmlBuffer(XmlBuffer) THEN
        EXIT;

      MasterTemplate.GET(Document."XML Master Template No.");
      IF Discount THEN
        MainFieldCode := 'DISCOUNTS'
      ELSE
        MainFieldCode := 'CHARGES';

      IF MainField.GET(MasterTemplate."No.",MainField.Type::Header,MainFieldCode) THEN
        XmlPath := MainField."XML Path"
      ELSE
        EXIT;

      XmlLibrary.AddHeaderLineTags(Document."XML Document Type",Document."Template No.",MainField.Type::Header,XmlPath,TRUE);

      NoOfPossibleNodes := XmlLibrary.GetPossibleXmlNodes(XmlPath,XmlBuffer,NodeLogicalExpressions,PossibleNodeIDs);
      FOR i := 1 TO NoOfPossibleNodes DO BEGIN
        Result := LogExprMgt.CalcLogicalExpression(NodeLogicalExpressions[i]);
        IF Result THEN BEGIN
          ReasonText := '';
          ReasonCode := '';

          XmlBuffer.RESET;
          XmlBuffer.SETRANGE("Entry No.",PossibleNodeIDs[i]);
          IF XmlBuffer.FINDFIRST THEN BEGIN
            TempParentEntryNo := XmlBuffer."Parent Entry No.";
            XmlBuffer.SETRANGE("Entry No.");
            XmlBuffer.NEXT;

            IF XmlBuffer."Parent Entry No." < TempParentEntryNo THEN
              TempParentEntryNo := XmlBuffer."Parent Entry No.";
            REPEAT
              CASE Document."XML Master Template No." OF
                'OIOXML' :
                  BEGIN
                    IF LOWERCASE(XmlBuffer.Name) = 'id' THEN BEGIN
                      ReasonCode := XmlBuffer.Value;
                      ReasonCodeNodeName := XmlBuffer.Name;
                    END;
                  END;
                'EBINTERFACE' :
                  BEGIN
                    IF LOWERCASE(XmlBuffer.Name) = 'comment' THEN BEGIN
                      ReasonText := XmlBuffer.Value;
                      ReasonTextNodeName := XmlBuffer.Name;
                    END;
                  END;
                ELSE BEGIN
                  IF STRPOS(LOWERCASE(XmlBuffer.Name),'reason') > 0 THEN BEGIN
                    IF STRPOS(LOWERCASE(XmlBuffer.Name),'reasoncode') > 0 THEN BEGIN
                      ReasonCode := XmlBuffer.Value;
                      ReasonCodeNodeName := XmlBuffer.Name;
                    END ELSE BEGIN
                      ReasonText := XmlBuffer.Value;
                      ReasonTextNodeName := XmlBuffer.Name;
                    END;
                  END;
                END;
              END;
            UNTIL (XmlBuffer."Parent Entry No." = TempParentEntryNo) OR (XmlBuffer.NEXT = 0);

            IF STRPOS(XmlPath,']') > 0 THEN
              NewFieldXmlPath := COPYSTR(XmlPath,1,STRPOS(XmlPath,']')-1)
            ELSE
              NewFieldXmlPath := XmlLibrary.GetXmlPathToLastElement(XmlPath);

            IF (ReasonCode <> '') AND (ReasonText <> '') THEN
              TempCreatedLogicalExpr := STRSUBSTNO('(%1=''%2'' and %3=''%4'')',ReasonCodeNodeName,ReasonCode,
                ReasonTextNodeName,ReasonText);

            IF (ReasonCode <> '') THEN
              TempCreatedLogicalExpr := STRSUBSTNO('%1=''%2''',ReasonCodeNodeName,ReasonCode)
            ELSE
              IF (ReasonText <> '') THEN
                TempCreatedLogicalExpr := STRSUBSTNO('%1=''%2''',ReasonTextNodeName,ReasonText);

            Field.RESET;
            Field.SETRANGE("Template No.",Document."Template No.");
            Field.SETRANGE(Type,Field.Type::Header);

            IF TempCreatedLogicalExpr <> '' THEN BEGIN
              IF STRPOS(XmlPath,']') > 0 THEN BEGIN
                NewFieldXmlPath += STRSUBSTNO(' and %1',TempCreatedLogicalExpr);
                NewFieldXmlPath += COPYSTR(XmlPath,STRPOS(XmlPath,']'));
              END ELSE BEGIN
                NewFieldXmlPath += STRSUBSTNO('[%1]',TempCreatedLogicalExpr);
                NewFieldXmlPath += STRSUBSTNO('/%1',XmlLibrary.GetXmlPathLastElement(XmlPath));
              END;
              Field.SETFILTER("XML Path",'%1',STRSUBSTNO('*%1*',TempCreatedLogicalExpr));
            END ELSE BEGIN
              IF STRPOS(NewFieldXmlPath,']') <= 0 THEN
                NewFieldXmlPath += ']';

              NewFieldXmlPath += STRSUBSTNO('/%1',XmlLibrary.GetXmlPathLastElement(XmlPath));
              Field.SETFILTER("XML Path",'%1',STRSUBSTNO('*%1*',XmlLibrary.StripHeaderLineTag(MainField,NewFieldXmlPath)));
              IF Discount THEN
                ReasonText := UPPERCASE(COPYSTR(DiscountsTxt,1,1)) + COPYSTR(DiscountsTxt,2)
              ELSE
                ReasonText := UPPERCASE(COPYSTR(ChargesTxt,1,1)) + COPYSTR(ChargesTxt,2);
            END;

            TempField.COPYFILTERS(Field);
            IF Field.ISEMPTY AND TempField.ISEMPTY THEN BEGIN
              CreateDiscChargeHeaders(TempField,Document."Template No.",Discount,MainField."Sort Order");
              TempField.COPYFILTERS(Field);
              IF TempField.ISEMPTY THEN BEGIN
                TempFieldName := '     ';
                IF Discount THEN BEGIN
                  TempFieldCode := 'DISC';
                  TempField."Change Sign" := TRUE;
                END ELSE
                  TempFieldCode := 'CHRG';

                IF ReasonCode <> '' THEN BEGIN
                  TempFieldName += ReasonCode;
                  IF ReasonText <> '' THEN
                    TempFieldName += ' - ' + ReasonText;
                  TempFieldCode += ReasonCode;
                END ELSE
                  IF ReasonText <> '' THEN BEGIN
                    TempFieldCode += ReasonText;
                    TempFieldName += ReasonText;
                  END;

                TempFieldCode := DELCHR(TempFieldCode,'=',' ');
                TempFieldCode := COPYSTR(TempFieldCode,1,18);

                TempFieldCode := CaptureMgt.ReplaceIllegalFilterCharacters(TempFieldCode,FALSE,18);

                TempField.SETRANGE("XML Path");
                TempField.SETFILTER(Code,STRSUBSTNO('%1*',TempFieldCode));
                Count := TempField.COUNT;
                IF Count > 0 THEN
                  TempFieldCode += FORMAT(Count);

                TempField.RESET;
                TempField.INIT;
                TempField.TRANSFERFIELDS(MainField);
                TempField."Template No." := Document."Template No.";
                TempField.VALIDATE("XML Path",STRSUBSTNO('SUM(%1)',NewFieldXmlPath));
                TempField."Sort Order" := MainField."Sort Order";
                TempField.Code := COPYSTR(TempFieldCode,1,20);
                TempField."Field Name" := COPYSTR(TempFieldName,1,50);
                TempField."Transfer Amount to Document" := TempField."Transfer Amount to Document"::Always;
                TempField.INSERT;
                Found := TRUE;
              END;
            END;
          END;
        END;
      END;
      TempField.RESET;
    END;

    [LineStart(498)]
    LOCAL PROCEDURE CreateDiscChargeHeaders@6086204(VAR TempField@6086200 : TEMPORARY Record 6085580;TemplateNo@6086202 : Code[20];Discount@6086201 : Boolean;SortOrder@6086203 : Integer);
    BEGIN
      TempField.RESET;
      IF Discount THEN
        TempField.SETRANGE(Code,'#%&DISCHEADERTYPE#%&')
      ELSE
        TempField.SETRANGE(Code,'#%&CHRGHEADERTYPE#%&');

      IF TempField.ISEMPTY THEN BEGIN
        TempField.INIT;
        TempField."Template No." := TemplateNo;
        TempField.Type := TempField.Type::Header;
        IF Discount THEN BEGIN
          TempField.Code := '#%&DISCHEADERTYPE#%&';
          TempField."Field Name" := UPPERCASE(COPYSTR(DiscountsTxt,1,1)) + COPYSTR(DiscountsTxt,2);
          TempField."Sort Order" := SortOrder;
        END ELSE BEGIN
          TempField.Code := '#%&CHRGHEADERTYPE#%&';
          TempField."Field Name" := UPPERCASE(COPYSTR(ChargesTxt,1,1)) + COPYSTR(ChargesTxt,2);
          TempField."Sort Order" := SortOrder;
        END;
        TempField.INSERT;
      END;
      TempField.RESET;
    END;

    [LineStart(522)]
    LOCAL PROCEDURE CreateHiddenLineTempFields@6085618(Document@6085601 : Record 6085590;VAR TempField@6085600 : TEMPORARY Record 6085580);
    VAR
      Field@6085602 : Record 6085580;
    BEGIN
      IF Document."File Type" = Document."File Type"::XML THEN BEGIN
        Field.SETCURRENTKEY("Template No.",Type,"Sort Order");
        Field.SETRANGE("Template No.",Document."Template No.");
        Field.SETRANGE(Type,Field.Type::Line);
        Field.SETRANGE("Show Field",Field."Show Field"::Never);
        IF Field.FINDSET THEN BEGIN
          IF NOT TempField.GET(Document."Template No.",TempField.Type::Line,'#%&LINETYPEHIDDEN#%&') THEN BEGIN
            TempField.INIT;
            // We choose this template no. so that the Hidden Fields are always last and we can distingush them after the RUNMODAL
            TempField."Template No." := 'ZZZHIDENFIELDS';
            TempField.Type := Field.Type;
            TempField.Code := '#%&LINETYPEHIDDEN#%&';
            TempField."Field Name" := LineTextHidden;
            TempField."Sort Order" := 0;
            TempField.INSERT;
          END;

          REPEAT
            IF NOT TempField.GET(Field."Template No.",TempField.Type::Line,Field.Code) THEN BEGIN
              TempField.TRANSFERFIELDS(Field);
              TempField."Sort Order" := 999;
              TempField."Template No." := 'ZZZHIDENFIELDS';
              TempField."Field Name" := '     '  + Field."Field Name";
              TempField.INSERT;
            END;
          UNTIL Field.NEXT = 0;
        END;
      END;
    END;

    [LineStart(552)]
    LOCAL PROCEDURE AddDiscChargeFieldToTemplate@6085622(Document@6085601 : Record 6085590;VAR TempField@6085600 : TEMPORARY Record 6085580);
    VAR
      Field@6085602 : Record 6085580;
      FieldCount@6085603 : Integer;
    BEGIN
      IF NOT (TempField.Code IN ['#%&DISCHEADERTYPE#%&','#%&CHRGHEADERTYPE#%&']) THEN BEGIN
        TempField."Field Name" := COPYSTR(TempField."Field Name",6);
        // Check if we might have the same code
        TempField.Code := COPYSTR(TempField.Code,1,18);
        Field.SETRANGE("Template No.",TempField."Template No.");
        Field.SETFILTER(Code,STRSUBSTNO('%1*',TempField.Code));
        FieldCount += Field.COUNT;
        IF FieldCount > 0 THEN
          TempField.Code += FORMAT(FieldCount);

        Field.Clone('',TempField,Rec,FALSE);
        Field.GET(TempField."Template No.",TempField.Type,TempField.Code);

        CaptureXmlFieldValue(Document,Field);
        UpdFormulaOfRelatedField(Field);
      END;
    END;

    [LineStart(570)]
    PROCEDURE ManuallyRemoveTemplField@1160040002() : Boolean;
    VAR
      Field@161024014 : Record 6085580;
      TempField@6085573 : TEMPORARY Record 6085580;
      LastType@6085574 : Text[50];
    BEGIN
      Field.SETCURRENTKEY("Template No.",Type,"Sort Order");
      Field.SETRANGE("Template No.","No.");
      IF "Recognize Lines" = "Recognize Lines"::No THEN
        Field.SETRANGE(Type,Field.Type::Header);

      IF Field.FINDSET THEN BEGIN
        REPEAT
          IF LastType <> FORMAT(Field.Type) THEN BEGIN
            INIT;
            TempField."Template No." := "No.";
            TempField.Type := Field.Type;
            IF Field.Type = 0 THEN BEGIN
              TempField.Code := '#%&HEADERTYPE#%&';
              TempField."Field Name" := HeaderText;
            END ELSE BEGIN
              TempField.Code := '#%&LINETYPE#%&';
              TempField."Field Name" := LineText;
            END;
            TempField."Sort Order" := 0;
            TempField.INSERT;
            LastType := FORMAT(Field.Type);
          END;
          TempField.TRANSFERFIELDS(Field);
          TempField."Field Name" := '     '  + Field."Field Name";
          TempField.INSERT;
        UNTIL Field.NEXT = 0;
      END;

      IF OpenTemplateFieldLookup(TempField) THEN BEGIN
        IF TempField.FINDSET THEN BEGIN
          REPEAT
            IF Field.GET(TempField."Template No.",TempField.Type,TempField.Code) THEN
              IF CONFIRM(Text014,FALSE,Field."Field Name") THEN BEGIN
                IF Field."Show Field" <> Field."Show Field"::Never THEN BEGIN
                  Field."Show Field" := Field."Show Field"::Never;
                  Field.MODIFY;
                END ELSE
                  Field.DELETE(TRUE);
              END;
          UNTIL TempField.NEXT = 0;
          EXIT(TRUE);
        END;
      END;
    END;

    [LineStart(615)]
    LOCAL PROCEDURE OpenTemplateFieldLookup@6085610(VAR TemplateField@6085600 : TEMPORARY Record 6085580) : Boolean;
    VAR
      TemplateFieldListTemp@6085601 : Page 6085635;
    BEGIN
      TemplateField.SETCURRENTKEY("Template No.",Type,"Sort Order");
      IF TemplateField.FINDFIRST THEN
        IF TemplateField.NEXT = 0 THEN ;

      TemplateFieldListTemp.LOOKUPMODE(TRUE);
      TemplateFieldListTemp.SetRecords(TemplateField);
      IF TemplateFieldListTemp.RUNMODAL = ACTION::LookupOK THEN BEGIN
        TemplateFieldListTemp.GetSelectedRecords(TemplateField);
        EXIT(TRUE);
      END;

      EXIT(FALSE);
    END;

    [LineStart(629)]
    PROCEDURE FormulaOnLookup@161024014(VAR Text@161024012 : Text[1024]) : Boolean;
    VAR
      TemplField@161024013 : Record 6085580;
    BEGIN
      TemplField.FILTERGROUP(2);
      TemplField.SETCURRENTKEY("Template No.",Type,"Sort Order");
      TemplField.SETRANGE("Template No.","No.");
      TemplField.SETRANGE(Type,TemplField.Type::Header);
      TemplField.SETRANGE("Data Type",TemplField."Data Type"::Number);
      TemplField.FILTERGROUP(0);
      IF PAGE.RUNMODAL(0,TemplField) = ACTION::LookupOK THEN BEGIN
        Text := TemplField.Code;
        EXIT(TRUE);
      END;
    END;

    [LineStart(641)]
    PROCEDURE SetSourceID@1160040001(KeyValues@1160040000 : Text[250]);
    VAR
      DocCat@6085575 : Record 6085575;
      Document@6085573 : Record 6085590;
      RecIDMgt@6085576 : Codeunit 6085604;
      NewSourceRecordIDTreeID@6085574 : Integer;
    BEGIN
      TESTFIELD(Type,Type::" ");
      TESTFIELD("Category Code");
      DocCat.GET("Category Code");
      NewSourceRecordIDTreeID :=
        RecIDMgt.GetRecIDTreeID2(DocCat."Source Table No.",DocCat."Source Field No.",DocCat."Document Category GUID",KeyValues);

      IF (NewSourceRecordIDTreeID = 0) AND (KeyValues <> '') THEN
        ERROR(SourceIDNotExistErr,GetSourceIDCaption,KeyValues);

      IF "Source Record ID Tree ID" = NewSourceRecordIDTreeID THEN
        EXIT;

      Document.SETRANGE("Template No.","No.");
      IF NOT Document.ISEMPTY THEN
        ERROR(ChangeSourceIDErr,GetSourceIDCaption);

      VALIDATE("Source Record ID Tree ID",NewSourceRecordIDTreeID);
      IF MODIFY THEN;
    END;

    [External]
    [LineStart(661)]
    PROCEDURE GetSourceID@1160040000() : Text[250];
    VAR
      DocCat@1160040001 : Record 6085575;
      RecIDMgt@1160040000 : Codeunit 6085604;
    BEGIN
      IF DocCat.GET("Category Code") THEN
        EXIT(RecIDMgt.GetKeyValue("Source Record ID Tree ID",DocCat."Source Field No."))
      ELSE
        EXIT(RecIDMgt.GetKeyValue("Source Record ID Tree ID",1));
    END;

    [LineStart(667)]
    LOCAL PROCEDURE ModifyAllTemplates@1(FieldValue@1000 : Text[250];FieldNumber@6085573 : Integer);
    VAR
      Field@1002 : Record 2000000041;
      RecIDMgt@1004 : Codeunit 6085604;
      COConfigMgt@1003 : Codeunit 6086502;
      Window@1007 : Dialog;
      ToRecRef@1001 : RecordRef;
      ToFieldRef@1005 : FieldRef;
      Total@1006 : Integer;
      i@1008 : Integer;
      MessageHandler@6085574 : Codeunit 6086011;
    BEGIN
      IF NOT GUIALLOWED THEN
        EXIT;

      IF FieldNumber = 0 THEN
        EXIT;

      IF Type <> Type::Master THEN
        EXIT;

      ToRecRef.OPEN(DATABASE::"CDC Template");
      RecIDMgt.FilterRecRef(ToRecRef,FIELDNO("Category Code"),"Category Code");
      RecIDMgt.FilterRecRef(ToRecRef,FIELDNO(Type),'0');
      RecIDMgt.FilterRecRef(ToRecRef,FIELDNO("Master Template No."),"No.");
      IF NOT ToRecRef.FINDSET(TRUE,FALSE) THEN
        EXIT;

      IF NOT CONFIRM(STRSUBSTNO(UpdateTemplateQst,RecIDMgt.GetFieldCaption(DATABASE::"CDC Template",FieldNumber),FIELDCAPTION(
        "Master Template No."),"No.","Category Code"))
      THEN
        EXIT;

      Window.OPEN(Text010);

      Total := ToRecRef.COUNT;
      Field.GET(DATABASE::"CDC Template",FieldNumber);

      REPEAT
        ToFieldRef := ToRecRef.FIELD(FieldNumber);

        IF FORMAT(ToFieldRef.VALUE) <> FieldValue THEN BEGIN
          i += 1;
          Window.UPDATE(1,STRSUBSTNO(Text011,i,Total));
          Window.UPDATE(2,(i / Total * 10000) DIV 1);

          COConfigMgt.AddFieldValue(ToFieldRef,Field,FieldValue,TRUE);
          ToRecRef.MODIFY;
        END;
      UNTIL ToRecRef.NEXT = 0;

      Window.CLOSE;
      MessageHandler.ShowMessageNotification(STRSUBSTNO(Text012,i),FALSE);
    END;

    [LineStart(710)]
    LOCAL PROCEDURE ModifyAllTemplatesOptions@7(FieldValue@1000 : Integer;FieldNumber@6085573 : Integer);
    BEGIN
      ModifyAllTemplates(FORMAT(FieldValue),FieldNumber);
    END;

    [LineStart(713)]
    PROCEDURE ShowMatchingGroup@6085584() : Boolean;
    VAR
      VendorNo@6085573 : Code[20];
      PurchaseHeader@6085574 : Record 38;
      PurchRcptHeader@6085575 : Record 120;
      ReturnShipmentHeader@6085576 : Record 6650;
      CDCModuleLicense@6085577 : Codeunit 6086008;
    BEGIN
      IF NOT CDCModuleLicense.IsMatchingActivated(FALSE) THEN
        EXIT(FALSE);

      PurchaseHeader.SETRANGE("Document Type",PurchaseHeader."Document Type"::Order);
      IF NOT PurchaseHeader.ISEMPTY THEN
        EXIT(TRUE);

      PurchaseHeader.SETRANGE("Document Type",PurchaseHeader."Document Type"::"Return Order");
      IF NOT PurchaseHeader.ISEMPTY THEN
        EXIT(TRUE);

      IF NOT PurchRcptHeader.ISEMPTY THEN
        EXIT(TRUE);

      IF NOT ReturnShipmentHeader.ISEMPTY THEN
        EXIT(TRUE);

      EXIT(FALSE);
    END;

    [LineStart(733)]
    LOCAL PROCEDURE CheckDuplicIdentTemplates@6085575();
    VAR
      Template@6085573 : Record 6085579;
    BEGIN
      IF Type <> Type::Identification THEN
        EXIT;
      IF "Data Type" = "Data Type"::XML THEN
        EXIT;

      Template.SETCURRENTKEY("Category Code",Type);
      Template.SETRANGE("Category Code","Category Code");
      Template.SETRANGE(Type,Template.Type::Identification);
      Template.SETFILTER("No.",'<>%1',"No.");
      IF NOT Template.ISEMPTY THEN
        ERROR(DuplicIdentTempErr);
    END;

    [LineStart(746)]
    PROCEDURE DrillDownSearchTexts@1160040003();
    VAR
      TemplateSearchText@1160040000 : Record 6085588;
      TempTemplateSearchText@1160040001 : TEMPORARY Record 6085588;
      EntryNo@1160040002 : Integer;
    BEGIN
      IF "Search Text" <> '' THEN BEGIN
        TempTemplateSearchText."Template No." := "No.";
        TempTemplateSearchText."Entry No." := 0;
        TempTemplateSearchText."Search Text" := "Search Text";
        TempTemplateSearchText.INSERT;
      END;

      TemplateSearchText.SETRANGE("Template No.","No.");
      IF TemplateSearchText.FINDFIRST THEN
        REPEAT
          TempTemplateSearchText.TRANSFERFIELDS(TemplateSearchText,TRUE);
          TempTemplateSearchText.INSERT;
        UNTIL TemplateSearchText.NEXT = 0;

      TempTemplateSearchText.FILTERGROUP(4);
      TempTemplateSearchText.SETRANGE("Template No.","No.");
      TempTemplateSearchText.FILTERGROUP(0);

      PAGE.RUNMODAL(0,TempTemplateSearchText);

      TemplateSearchText.DELETEALL;
      CASE TempTemplateSearchText.COUNT OF
        0:
          IF "Search Text" <> '' THEN BEGIN
            "Search Text" := '';
            MODIFY;
          END;

        1:
          BEGIN
            TempTemplateSearchText.FINDFIRST;
            "Search Text" := TempTemplateSearchText."Search Text";
            MODIFY;
          END;

        ELSE // More than 1
          BEGIN
            IF "Search Text" <> '' THEN BEGIN
              "Search Text" := '';
              MODIFY;
            END;

            TempTemplateSearchText.FINDSET;
            REPEAT
              EntryNo := EntryNo + 10000;

              TemplateSearchText.TRANSFERFIELDS(TempTemplateSearchText);
              TemplateSearchText."Template No." := "No.";
              TemplateSearchText."Entry No." := EntryNo;
              TemplateSearchText.INSERT;
            UNTIL TempTemplateSearchText.NEXT = 0
          END;
      END;
    END;

    [LineStart(801)]
    LOCAL PROCEDURE ModifyRelatedTemplates@3();
    VAR
      CopyFromTemplate@1000 : Record 6085579;
      CopyToTemplate@1001 : Record 6085579;
      Modify@1002 : Boolean;
    BEGIN
      IF "Data Type" <> "Data Type"::XML THEN
        EXIT;
      IF Type = Type::" " THEN
        EXIT;

      IF Type = Type::Master THEN BEGIN
        CopyFromTemplate := Rec;
        // Mark the identification template
        CopyToTemplate.SETRANGE("No.","XML Ident. Template No.");
        IF CopyToTemplate.FINDSET THEN
          REPEAT
            CopyToTemplate.MARK(TRUE);
          UNTIL CopyToTemplate.NEXT = 0;

        // Mark other Master templates with the same identification template
        CopyToTemplate.SETRANGE(Type,Type::Master);
        CopyToTemplate.SETFILTER("No.",'<>%1',"No.");
        CopyToTemplate.SETRANGE("XML Ident. Template No.","XML Ident. Template No.");
        IF CopyToTemplate.FINDSET THEN
          REPEAT
            CopyToTemplate.MARK(TRUE);
          UNTIL CopyToTemplate.NEXT = 0;
      END ELSE
        IF Type = Type::Identification THEN BEGIN
          CopyFromTemplate := Rec;
          CopyToTemplate.SETRANGE(Type,Type::Master);
          CopyToTemplate.SETRANGE("XML Ident. Template No.","No.");
          IF CopyToTemplate.FINDSET THEN
            REPEAT
              CopyToTemplate.MARK(TRUE);
            UNTIL CopyToTemplate.NEXT = 0;
        END;

      CopyToTemplate.SETRANGE(Type);
      CopyToTemplate.SETRANGE("No.");
      CopyToTemplate.SETRANGE("XML Ident. Template No.");
      CopyToTemplate.MARKEDONLY(TRUE);
      IF CopyToTemplate.FINDSET THEN
        REPEAT
          IF CopyToTemplate."Invoice XML Header Tag" <> CopyFromTemplate."Invoice XML Header Tag" THEN
            CopyToTemplate."Invoice XML Header Tag" := CopyFromTemplate."Invoice XML Header Tag";
          IF CopyToTemplate."Invoice XML Line Tag" <> CopyFromTemplate."Invoice XML Line Tag" THEN
            CopyToTemplate."Invoice XML Line Tag" := CopyFromTemplate."Invoice XML Line Tag";

          IF CopyToTemplate."Cr.Memo XML Header Tag" <> CopyFromTemplate."Cr.Memo XML Header Tag" THEN
            CopyToTemplate."Cr.Memo XML Header Tag" := CopyFromTemplate."Cr.Memo XML Header Tag";
          IF CopyToTemplate."Cr.Memo XML Line Tag" <> CopyFromTemplate."Cr.Memo XML Line Tag" THEN
            CopyToTemplate."Cr.Memo XML Line Tag" := CopyFromTemplate."Cr.Memo XML Line Tag";

          CopyToTemplate.MODIFY;
        UNTIL CopyToTemplate.NEXT = 0;
    END;

    [LineStart(854)]
    PROCEDURE SetStylesheetFile@6085577(VAR TempFile@6085573 : TEMPORARY Record 6085614);
    VAR
      WriteStream@6085574 : OutStream;
      ReadStream@6085575 : InStream;
    BEGIN
      CLEAR("XML Stylesheet File");
      "XML Stylesheet File".CREATEOUTSTREAM(WriteStream);
      TempFile.GetDataStream(ReadStream);
      COPYSTREAM(WriteStream,ReadStream);
      MODIFY;
    END;

    [LineStart(861)]
    PROCEDURE GetStylesheetFile@6085578(VAR TempFile@6085573 : TEMPORARY Record 6085614) : Boolean;
    VAR
      ReadStream@6085574 : InStream;
    BEGIN
      CALCFIELDS("XML Stylesheet File");
      IF NOT "XML Stylesheet File".HASVALUE THEN
        EXIT(FALSE);

      "XML Stylesheet File".CREATEINSTREAM(ReadStream);
      TempFile.CreateFromStream(STRSUBSTNO('%1.%2',"No.","XML Stylesheet File Extension"),ReadStream);
      EXIT(TRUE);
    END;

    [LineStart(870)]
    PROCEDURE ImportStylesheet@6085579();
    VAR
      TempFile@6085573 : TEMPORARY Record 6085614;
      ZipMgt@6085574 : Codeunit 6085683;
    BEGIN
      CALCFIELDS("XML Stylesheet File"); //For versions older than 6.00.00
      IF "XML Stylesheet File".HASVALUE THEN
        IF NOT CONFIRM(OverwriteStylesheetQst) THEN
          EXIT;

      TempFile.BrowseFile(ImportStylesheetMsg,'','Stylesheet files (*.xsl;*.xslt;*.zip)|*.xsl;*.xslt;*.zip');

      IF NOT TempFile.Data.HASVALUE THEN
        EXIT;

      "XML Stylesheet File Extension" := TempFile.Extension;
      IF "XML Stylesheet File Extension" = 'zip' THEN BEGIN
        ZipMgt.SelectFileFromZipFile(TempFile,"XML Stylesheet Main Filename","XML Stylesheet Main Filename C");

        IF ("XML Stylesheet Main Filename" = '') OR ( "XML Stylesheet Main Filename C" = '') THEN
          ERROR('');
      END ELSE BEGIN
        "XML Stylesheet Main Filename" := TempFile.Name;
        "XML Stylesheet Main Filename C" := TempFile.Name;
      END;

      SetStylesheetFile(TempFile);

      RefreshDocumentsHtml;
    END;

    [LineStart(896)]
    PROCEDURE ExportStylesheet@6085580();
    VAR
      TempFile@6085573 : Record 6085614;
    BEGIN
      IF NOT GetStylesheetFile(TempFile) THEN
        MESSAGE(NoStylesheetMsg);
      TempFile.SaveFileWithDialog(ExportStylesheetMsg,'Stylesheet files (*.xsl;*.xslt;*.zip)|*.xsl;*.xslt;*.zip');
    END;

    [LineStart(901)]
    LOCAL PROCEDURE RefreshDocumentsHtml@6085581();
    VAR
      Document@6085573 : Record 6085590;
      TransformXmltoHtml@6085574 : Codeunit 6086209;
      i@6085576 : Integer;
      TotalDoc@6085577 : Integer;
    BEGIN
      Document.RESET;
      Document.SETRANGE(Status,Document.Status::Open);
      IF Type = Type::Master THEN
        Document.SETRANGE("XML Master Template No.","No.")
      ELSE
        EXIT;

      TotalDoc := Document.COUNT;
      IF TotalDoc = 0 THEN
        EXIT;
      IF NOT "XML Stylesheet File".HASVALUE THEN
        EXIT;
      IF NOT CONFIRM(RefreshHtmlQst) THEN
        EXIT;

      WindowXSLT.OPEN(UpdStylesheetMsg);

      i := 0;
      IF Document.FINDSET THEN
        REPEAT
          TransformXmltoHtml.CreateDocumentHtml(Document);
          i += 1;
          WindowXSLT.UPDATE(1,STRSUBSTNO(UpdStylesheetMsg2,Document.TABLECAPTION,i,TotalDoc));
          WindowXSLT.UPDATE(2,(i / TotalDoc * 10000) DIV 1);
        UNTIL Document.NEXT = 0;

      WindowXSLT.CLOSE;

      IF TotalDoc = 1 THEN
        MESSAGE(OneDocumentUpdated)
      ELSE
        MESSAGE(STRSUBSTNO(MultipleDocumentsUpdated,TotalDoc));
    END;

    [LineStart(935)]
    LOCAL PROCEDURE CaptureXmlFieldValue@6086201(Document@6086200 : Record 6085590;Field@6086201 : Record 6085580);
    VAR
      CaptureEngine@6086202 : Codeunit 6085575;
    BEGIN
      IF Document."No." <> '' THEN
        IF (Field."XML Path" <> '') AND Field."Search for Value" THEN
          CaptureEngine.CaptureField(Document,0,Field,TRUE);
    END;

    [LineStart(940)]
    LOCAL PROCEDURE UpdFormulaOfRelatedField@6086205(Field@6086200 : Record 6085580);
    VAR
      FieldToSubsFrom@6086205 : Record 6085580;
      FormulaParts@6086204 : ARRAY [100] OF Text[1024];
      NoOfFormulaParts@6086203 : Integer;
      Found@6086202 : Boolean;
      i@6086201 : Integer;
    BEGIN
      IF Field."Subtract from Amount Field" <> '' THEN BEGIN
        IF FieldToSubsFrom.GET(Field."Template No.",Field.Type,Field."Subtract from Amount Field") THEN BEGIN
          IF FieldToSubsFrom.Formula = '' THEN
            EXIT;

          NoOfFormulaParts := CaptureMgt.ExplodeFieldFormula(FieldToSubsFrom.Formula,FormulaParts,'+');
          FOR i := 1 TO NoOfFormulaParts DO BEGIN
            IF FormulaParts[i] = Field.Code THEN
              Found := TRUE;
          END;

          IF NOT Found THEN BEGIN
            FieldToSubsFrom.Formula += STRSUBSTNO('+%1',Field.Code);
            FieldToSubsFrom.MODIFY;
          END;
        END;
      END;
    END;

    [LineStart(959)]
    PROCEDURE ResetSortOrderOnTemplateFields@4(TemplateNo@1000 : Code[20]);
    VAR
      TemplateField@1001 : Record 6085580;
      SortOrder@1002 : Integer;
    BEGIN
      TemplateField.SETCURRENTKEY("Template No.",Type,"Sort Order");
      TemplateField.SETRANGE("Template No.",TemplateNo);
      TemplateField.SETRANGE(Type,TemplateField.Type::Header);
      SortOrder := 10;
      IF TemplateField.FINDSET(TRUE) THEN
        REPEAT
          TemplateField."Sort Order" := SortOrder;
          TemplateField.MODIFY;
          SortOrder += 10;
        UNTIL TemplateField.NEXT = 0;

      TemplateField.SETRANGE(Type,TemplateField.Type::Line);
      SortOrder := 10;
      IF TemplateField.FINDSET(TRUE) THEN
        REPEAT
          TemplateField."Sort Order" := SortOrder;
          TemplateField.MODIFY;
          SortOrder += 10;
        UNTIL TemplateField.NEXT = 0;
    END;

    BEGIN
    END.
  }
}

OBJECT Table 6085580 CDC Template Field
{
  OBJECT-PROPERTIES
  {
    Date=12/12/21;
    Time=[ 9:04:27 PM];
    Modified=Yes;
    Version List=DCW13.70.00.8.01,ALR1.15;
  }
  PROPERTIES
  {
    DataCaptionFields=Type,Code,Field Name;
    OnInsert=VAR
               Template@1000000000 : Record 6085579;
             BEGIN
               IF "Language Code" = '' THEN BEGIN
                 Template.GET("Template No.");
                 "Language Code" := Template."Language Code";
               END;

               "Source Table Filter GUID" := CREATEGUID;
               SetOrderRecords;
             END;

    OnModify=BEGIN
               //Rec."Data version" := InstallMgt.GetDataVersion();
             END;

    OnDelete=VAR
               TemplField@161024012 : Record 6085580;
               Rule@1000000002 : Record 6085583;
               Caption@1000000000 : Record 6085581;
               Translation@1000000001 : Record 6085582;
               DataTransl@1160040001 : Record 6085584;
               RecIDMgt@1160040000 : Codeunit 6085604;
             BEGIN
               IF ("G/L Account Field Code" <> '') AND ("G/L Account Field Code" <> Code) THEN BEGIN
                 TemplField.SETRANGE("Template No.","Template No.");
                 TemplField.SETRANGE(Type,Type);
                 TemplField.SETRANGE("G/L Account Field Code","G/L Account Field Code");
                 IF TemplField.COUNT = 1 THEN
                   IF TemplField.GET("Template No.",Type,"G/L Account Field Code") THEN
                     TemplField.DELETE(TRUE);
               END;

               Rule.SETRANGE("Template No.","Template No.");
               Rule.SETRANGE(Type,Type);
               Rule.SETRANGE(Code,Code);
               Rule.DELETEALL(TRUE);

               Caption.SETRANGE("Template No.","Template No.");
               Caption.SETRANGE(Type,Type);
               Caption.SETRANGE(Code,Code);
               Caption.DELETEALL(TRUE);

               Translation.SETRANGE("Template No.","Template No.");
               Translation.SETRANGE(Type,Type);
               Translation.SETRANGE(Code,Code);
               Translation.DELETEALL(TRUE);

               DataTransl.SETRANGE("Template No.","Template No.");
               DataTransl.SETRANGE(Type,Type);
               DataTransl.SETRANGE("Field Code",Code);
               DataTransl.DELETEALL(TRUE);

               RecIDMgt.DeleteTableFilter("Source Table Filter GUID");
             END;

    CaptionML=[DEU=Vorlagenfeld;
               ENU=Template Field];
    LookupPageID=Page6085602;
    DrillDownPageID=Page6085602;
  }
  FIELDS
  {
    { 1   ;   ;Template No.        ;Code20        ;TableRelation="CDC Template";
                                                   CaptionML=[DEU=Vorlagennr.;
                                                              ENU=Template No.];
                                                   NotBlank=Yes }
    { 2   ;   ;Type                ;Option        ;CaptionML=[DEU=Art;
                                                              ENU=Type];
                                                   OptionCaptionML=[DEU=Kopf,Zeile;
                                                                    ENU=Header,Line];
                                                   OptionString=Header,Line }
    { 3   ;   ;Code                ;Code20        ;CaptionML=[DEU=Code;
                                                              ENU=Code];
                                                   NotBlank=Yes }
    { 4   ;   ;Data Type           ;Option        ;OnValidate=VAR
                                                                GLSetup@161024012 : Record 98;
                                                                Template@161024013 : Record 6085579;
                                                              BEGIN
                                                                SetFixedValue('');

                                                                IF "Data Type" <> "Data Type"::Lookup THEN
                                                                  VALIDATE("Source Table No.",0);

                                                                IF "Data Type" = "Data Type"::Number THEN BEGIN
                                                                  GLSetup.GET;
                                                                  VALIDATE("Decimal Places",GLSetup."Amount Decimal Places");
                                                                  VALIDATE("Blank Zero",TRUE);
                                                                END;

                                                                IF "Data Type" = "Data Type"::Date THEN BEGIN
                                                                  Template.GET("Template No.");
                                                                  "Date Format" := Template."Date Format" + 1;
                                                                END;

                                                                IF NOT ("Data Type" IN ["Data Type"::Text,"Data Type"::Date]) THEN
                                                                  "Enable Rule Generation" := FALSE;
                                                              END;

                                                   CaptionML=[DEU=Datentyp;
                                                              ENU=Data Type];
                                                   OptionCaptionML=[DEU=Text,Nummer,Datum,Boolesch,,,,,Lookup;
                                                                    ENU=Text,Number,Date,Boolean,,,,,Lookup];
                                                   OptionString=Text,Number,Date,Boolean,,,,,Lookup }
    { 5   ;   ;Required            ;Boolean       ;CaptionML=[DEU=Erforderlich;
                                                              ENU=Required] }
    { 6   ;   ;Search for Value    ;Boolean       ;CaptionML=[DEU=Nach Wert suchen;
                                                              ENU=Search for Value] }
    { 7   ;   ;Caption Is Part Of Value;Boolean   ;CaptionML=[DEU=Suchbegriff ist Teil des Wertes;
                                                              ENU=Caption Is Part Of Value] }
    { 8   ;   ;Insert on new Templates;Boolean    ;InitValue=Yes;
                                                   CaptionML=[DEU=In neue Vorlage einfÅgen;
                                                              ENU=Insert on new Templates] }
    { 9   ;   ;Number Has Decimals ;Boolean       ;CaptionML=[DEU=Zahl enthÑlt Dezimalstellen;
                                                              ENU=Number Has Decimals] }
    { 10  ;   ;Caption Offset X    ;Integer       ;CaptionML=[DEU=Suchbegriff Offset X;
                                                              ENU=Caption Offset X] }
    { 11  ;   ;Caption Offset Y    ;Integer       ;CaptionML=[DEU=Suchbegriff Offset Y;
                                                              ENU=Caption Offset Y] }
    { 12  ;   ;Fixed Value (Text)  ;Text250       ;CaptionML=[DEU=Fester Wert (Text);
                                                              ENU=Fixed Value (Text)] }
    { 13  ;   ;Fixed Value (Decimal);Decimal      ;CaptionML=[DEU=Fester Wert (Dezimal);
                                                              ENU=Fixed Value (Decimal)] }
    { 14  ;   ;Fixed Value (Date)  ;Date          ;CaptionML=[DEU=Fester Wert (Datum);
                                                              ENU=Fixed Value (Date)] }
    { 15  ;   ;Fixed Value (Lookup);Code20        ;TableRelation=IF (Lookup Table=CONST(Vendor)) Vendor
                                                                 ELSE IF (Lookup Table=CONST(Contact)) Contact
                                                                 ELSE IF (Lookup Table=CONST(Customer)) Customer
                                                                 ELSE IF (Lookup Table=CONST(Job)) Job
                                                                 ELSE IF (Lookup Table=CONST(Item)) Item
                                                                 ELSE IF (Lookup Table=CONST(Fixed Asset)) "Fixed Asset"
                                                                 ELSE IF (Lookup Table=CONST(Employee)) Employee
                                                                 ELSE IF (Lookup Table=CONST(Dimension Value)) "Dimension Value".Code WHERE (Dimension Code=FIELD(Lookup Rel. Code));
                                                   CaptionML=[DEU=Fester Wert (Lookup);
                                                              ENU=Fixed Value (Lookup)] }
    { 17  ;   ;Validation Dateformula From;DateFormula;
                                                   CaptionML=[DEU=Validierung Datumsformel von;
                                                              ENU=Validation Dateformula From] }
    { 18  ;   ;Validation Dateformula To;DateFormula;
                                                   CaptionML=[DEU=Validierung Datumsformel bis;
                                                              ENU=Validation Dateformula To] }
    { 19  ;   ;Never use Global Captions;Boolean  ;InitValue=Yes;
                                                   CaptionML=[DEU=Globale Suchbegriffe nie benutzen;
                                                              ENU=Never use Global Captions];
                                                   Description=Deprecated NAV }
    { 20  ;   ;Decimal Places      ;Code10        ;CaptionML=[DEU=Dezimalstellen;
                                                              ENU=Decimal Places] }
    { 21  ;   ;Blank Zero          ;Boolean       ;CaptionML=[DEU=Blank Zero;
                                                              ENU=Blank Zero] }
    { 22  ;   ;Language Code       ;Code10        ;TableRelation=Language;
                                                   CaptionML=[DEU=Sprachcode;
                                                              ENU=Language Code] }
    { 23  ;   ;Enable Rule Generation;Boolean     ;OnValidate=BEGIN
                                                                IF "Enable Rule Generation" THEN
                                                                  IF NOT ("Data Type" IN ["Data Type"::Text,"Data Type"::Date]) THEN
                                                                    ERROR(EnableRuleActivateErr,FIELDCAPTION("Enable Rule Generation"),"Data Type"::Text,"Data Type"::Date);
                                                              END;

                                                   CaptionML=[DEU=Regelerzeugung aktivieren;
                                                              ENU=Enable Rule Generation] }
    { 24  ;   ;Multiline           ;Boolean       ;CaptionML=[DEU=Mehrzeilig;
                                                              ENU=Multiline] }
    { 25  ;   ;Default Page Source ;Option        ;CaptionML=[DEU=Vorgabe Seitenherkunft;
                                                              ENU=Default Page Source];
                                                   OptionCaptionML=[DEU=Erste Seite,Letzte Seite;
                                                                    ENU=First Page,Last Page];
                                                   OptionString=First Page,Last Page }
    { 26  ;   ;Auto Update Caption ;Boolean       ;InitValue=Yes;
                                                   CaptionML=[DEU=Suchbegriffe autom. aktualisieren;
                                                              ENU=Auto Update Caption] }
    { 27  ;   ;Typical Field Width ;Decimal       ;CaptionML=[DEU=Typische Feldbreite;
                                                              ENU=Field Width];
                                                   DecimalPlaces=0:5 }
    { 28  ;   ;Auto Update Field Width;Boolean    ;InitValue=Yes;
                                                   CaptionML=[DEU=Feldbreite automatisch aktualisieren;
                                                              ENU=Auto Update Field Width];
                                                   Description=Deprecated NAV }
    { 29  ;   ;Typical Field Height;Decimal       ;CaptionML=[DEU=Typische Feldhîhe;
                                                              ENU=Field Height];
                                                   DecimalPlaces=0:5 }
    { 30  ;   ;Auto Update Field Height;Boolean   ;InitValue=Yes;
                                                   CaptionML=[DEU=Feldhîhe automatisch aktualisieren;
                                                              ENU=Auto Update Field Height];
                                                   Description=Deprecated NAV }
    { 31  ;   ;Sort Order          ;Integer       ;CaptionML=[DEU=Sortierung;
                                                              ENU=Sort Order] }
    { 32  ;   ;Field Name          ;Text50        ;CaptionML=[DEU=Feldname;
                                                              ENU=Field Name] }
    { 33  ;   ;Stop Lines Recognition;Option      ;CaptionML=[DEU=Zeilenerkennung stoppen;
                                                              ENU=Stop Lines Recognition];
                                                   OptionCaptionML=[DEU=" ,Falls die Caption in der gleichen Zeile ist,Falls der Wert in der gleichen Zeile ist,Falls die Caption oder der Wert in der gleichen Zeile ist,Falls die Caption in der gleichen Zeile ist (weiter auf nÑchster Seite),Falls der Wert in der gleichen Zeile ist (weiter auf nÑchster Seite),Falls die Caption oder der Wert in der gleichen Zeile ist (weiter auf nÑchster Seite)";
                                                                    ENU=" ,If Caption is on same line,If Value is on same line,If Caption or Value is on same line,If Caption is on same line (continue on next page),If Value is on same line (continue on next page),If Caption or Value is on same line (continue on next page)"];
                                                   OptionString=[ ,If Caption is on same line,If Value is on same line,If Caption or Value is on same line,If Caption is on same line (continue on next page),If Value is on same line (continue on next page),If Caption or Value is on same line (continue on next page)] }
    { 34  ;   ;Make Absolute Number;Boolean       ;CaptionML=[DEU=Absolutbetrag erzeugen;
                                                              ENU=Make Absolute Number] }
    { 37  ;   ;Lookup Table        ;Option        ;CaptionML=[DEU=Lookup Tabelle;
                                                              ENU=Lookup Table];
                                                   OptionCaptionML=[DEU=" ,Kreditor,Kontakt,Debitor,Projekt,Artikel,Anlage,Mitarbeiter,Dimensionswert";
                                                                    ENU=" ,Vendor,Contact,Customer,Job,Item,Fixed Asset,Employee,Dimension Value"];
                                                   OptionString=[ ,Vendor,Contact,Customer,Job,Item,Fixed Asset,Employee,Dimension Value] }
    { 38  ;   ;Lookup Rel. Code    ;Code20        ;TableRelation=IF (Lookup Table=CONST(Dimension Value)) Dimension;
                                                   CaptionML=[DEU=Relation Code;
                                                              ENU=Relation Code] }
    { 39  ;   ;Codeunit ID: Is OK  ;Integer       ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   CaptionML=[DEU=Codeunit ID: Ist OK;
                                                              ENU=Codeunit ID: Is OK];
                                                   BlankZero=Yes }
    { 41  ;   ;Codeunit ID: Lookup ;Integer       ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   CaptionML=[DEU=Codeunit ID: Lookup;
                                                              ENU=Codeunit ID: Lookup];
                                                   BlankZero=Yes }
    { 43  ;   ;Codeunit ID: Validate;Integer      ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   CaptionML=[DEU=Codeunit ID: Validate;
                                                              ENU=Codeunit ID: Validate];
                                                   BlankZero=Yes }
    { 45  ;   ;Formula             ;Code250       ;OnValidate=VAR
                                                                CaptureMgt@1160040000 : Codeunit 6085576;
                                                                WebClientManagement@6085574 : Codeunit 6085662;
                                                                TempDec@6085573 : Decimal;
                                                              BEGIN
                                                                SetFormula(Formula);
                                                              END;

                                                   CaptionML=[DEU=Formel;
                                                              ENU=Formula] }
    { 46  ;   ;G/L Account Field Code;Code20      ;TableRelation="CDC Template Field".Code WHERE (Template No.=FIELD(Template No.),
                                                                                                  Type=CONST(Header),
                                                                                                  Data Type=CONST(Text));
                                                   OnLookup=VAR
                                                              TemplateField@6085573 : Record 6085580;
                                                            BEGIN
                                                              TemplateField.FILTERGROUP(4);
                                                              TemplateField.SETRANGE("Template No.","Template No.");
                                                              TemplateField.SETRANGE(Type,TemplateField.Type::Header);
                                                              TemplateField.SETRANGE("Data Type",TemplateField."Data Type"::Text);
                                                              TemplateField.FILTERGROUP(0);
                                                              IF TemplateField.GET("Template No.",TemplateField.Type::Header,"G/L Account Field Code") THEN;
                                                              IF PAGE.RUNMODAL(0,TemplateField) = ACTION::LookupOK THEN
                                                                "G/L Account Field Code" := TemplateField.Code;
                                                            END;

                                                   CaptionML=[DEU=Konto Feldcode;
                                                              ENU=G/L Account Field Code] }
    { 47  ;   ;Transfer Amount to Document;Option ;CaptionML=[DEU=Betrag an Beleg Åbertragen;
                                                              ENU=Transfer Amount to Document];
                                                   OptionCaptionML=[DEU=" ,falls Zeilen nicht erkannt wurden,Immer";
                                                                    ENU=" ,If lines are not recognised,Always"];
                                                   OptionString=[ ,If lines are not recognised,Always] }
    { 48  ;   ;Subtract from Amount Field;Code20  ;TableRelation="CDC Template Field".Code WHERE (Template No.=FIELD(Template No.),
                                                                                                  Type=FIELD(Type),
                                                                                                  Transfer Amount to Document=FILTER(<>' '));
                                                   OnValidate=BEGIN
                                                                IF "Subtract from Amount Field" = Code THEN
                                                                  ERROR(Text003);
                                                              END;

                                                   CaptionML=[DEU=Betrag bei Registrierung abziehen von;
                                                              ENU=Subtract from Amount Field (on registration)] }
    { 49  ;   ;Codeunit ID: Capture Value;Integer ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Codeunit));
                                                   CaptionML=[DEU=Codeunit ID: Capture Wert;
                                                              ENU=Codeunit ID: Capture Value];
                                                   BlankZero=Yes }
    { 51  ;   ;Purch. Alloc. G/L Account No.;Code20;
                                                   TableRelation="G/L Account";
                                                   CaptionML=[DEU=Eink. Zuordnungssachkonto;
                                                              ENU=Purch. Alloc. G/L Account No.] }
    { 52  ;   ;Date Format         ;Option        ;CaptionML=[DEU=Datumsformat;
                                                              ENU=Date Format];
                                                   OptionCaptionML=[DEU=" ,Tag / Monat / Jahr,Monat / Tag / Jahr,Jahr / Tag / Monat,Jahr / Monat / Tag,Tag / Jahr / Monat,Monat / Jahr / Tag";
                                                                    ENU=" ,Day / Month / Year,Month / Day / Year,Year / Day / Month,Year / Month / Day,Day / Year / Month,Month / Year / Day"];
                                                   OptionString=[ ,Day / Month / Year,Month / Day / Year,Year / Day / Month,Year / Month / Day,Day / Year / Month,Month / Year / Day] }
    { 53  ;   ;Source Table No.    ;Integer       ;TableRelation=AllObj."Object ID" WHERE (Object Type=CONST(Table));
                                                   OnValidate=VAR
                                                                RecIDMgt@1160040000 : Codeunit 6085604;
                                                                DCLogMgt@1000 : Codeunit 6085658;
                                                              BEGIN
                                                                IF "Source Table No." <> 0 THEN
                                                                  TESTFIELD("Data Type","Data Type"::Lookup);

                                                                DCLogMgt.IsLogActive2("Source Table No.",TRUE);

                                                                IF "Source Table No." = xRec."Source Table No." THEN
                                                                  EXIT;

                                                                RecIDMgt.CheckDocValue(Type = Type::Line,Code,"Template No.",FIELDCAPTION("Source Table No."));
                                                                RecIDMgt.DeleteTableFilter("Source Table Filter GUID");
                                                                CLEAR("Source Table Filter GUID");
                                                                "Fixed Value (Rec. ID Tree ID)" := 0;
                                                                "Source Field No." := RecIDMgt.GetFirstKeyField("Source Table No.");
                                                              END;

                                                   CaptionML=[DEU=Herkunftstabellennr.;
                                                              ENU=Source Table No.];
                                                   BlankZero=Yes }
    { 55  ;   ;Source Table Filter GUID;GUID      ;CaptionML=[DEU=Herkunftsfeldfilter GUID;
                                                              ENU=Source Table Filter GUID] }
    { 56  ;   ;Source Field No.    ;Integer       ;TableRelation=Field.No. WHERE (TableNo=FIELD(Source Table No.));
                                                   OnValidate=VAR
                                                                RecIDMgt@1160040000 : Codeunit 6085604;
                                                              BEGIN
                                                                IF "Source Field No." = xRec."Source Field No." THEN
                                                                  EXIT;

                                                                IF xRec."Source Field No." > 0 THEN
                                                                  RecIDMgt.CheckDocValue(Type = Type::Line,Code,"Template No.",FIELDCAPTION("Source Field No."));

                                                                IF NOT RecIDMgt.PartOfKey("Source Table No.","Source Field No.") THEN
                                                                  ERROR(Text005,FIELDCAPTION("Source Field No."),FIELDCAPTION("Source Table No."));
                                                              END;

                                                   CaptionML=[DEU=Herkunftsfeldnr.;
                                                              ENU=Source Field No.];
                                                   BlankZero=Yes }
    { 57  ;   ;Destination Header Field No.;Integer;
                                                   TableRelation=Field.No.;
                                                   OnValidate=VAR
                                                                Template@1160040001 : Record 6085579;
                                                                Field@161024013 : Record 2000000041;
                                                                DocCat@161024012 : Record 6085575;
                                                                RecIDMgt@1160040000 : Codeunit 6085604;
                                                              BEGIN
                                                                IF ("Destination Header Field No." = xRec."Destination Header Field No.") OR ("Destination Header Field No." = 0) THEN
                                                                  EXIT;

                                                                Template.GET("Template No.");
                                                                DocCat.GET(Template."Category Code");
                                                                DocCat.TESTFIELD("Destination Header Table No.");

                                                                Field.GET(DocCat."Destination Header Table No.","Destination Header Field No.");
                                                                Field.TESTFIELD(Enabled);
                                                                Field.TESTFIELD(Class,Field.Class::Normal);
                                                              END;

                                                   CaptionML=[DEU=Feldnr. Zielkopf;
                                                              ENU=Destination Header Field No.];
                                                   BlankZero=Yes }
    { 58  ;   ;No. of Source Table Filters;Integer;FieldClass=FlowField;
                                                   CalcFormula=Count("CDC Table Filter Field" WHERE (Table Filter GUID=FIELD(Source Table Filter GUID)));
                                                   CaptionML=[DEU=Anzahl von Herkunftstabellenfiltern;
                                                              ENU=No. of Source Table Filters];
                                                   BlankZero=Yes;
                                                   Editable=No }
    { 59  ;   ;Fixed Value (Rec. ID Tree ID);Integer;
                                                   TableRelation="CDC Record ID Tree";
                                                   CaptionML=[DEU=Fester Wert (Datensatz-ID Baum-ID);
                                                              ENU=Fixed Value (Rec. ID Tree ID)] }
    { 60  ;   ;Destination Line Field No.;Integer ;TableRelation=Field.No.;
                                                   OnValidate=VAR
                                                                Template@1160040001 : Record 6085579;
                                                                Field@161024013 : Record 2000000041;
                                                                DocCat@161024012 : Record 6085575;
                                                                RecIDMgt@1160040000 : Codeunit 6085604;
                                                              BEGIN
                                                                IF ("Destination Line Field No." = xRec."Destination Line Field No.") OR ("Destination Line Field No." = 0) THEN
                                                                  EXIT;

                                                                Template.GET("Template No.");
                                                                DocCat.GET(Template."Category Code");
                                                                DocCat.TESTFIELD("Destination Line Table No.");

                                                                Field.GET(DocCat."Destination Line Table No.","Destination Line Field No.");
                                                                Field.TESTFIELD(Enabled);
                                                                Field.TESTFIELD(Class,Field.Class::Normal);
                                                              END;

                                                   CaptionML=[DEU=Feldnr. Zielzeile;
                                                              ENU=Destination Line Field No.];
                                                   BlankZero=Yes }
    { 61  ;   ;Delete Blanks       ;Boolean       ;CaptionML=[DEU=Leerzeichen lîschen;
                                                              ENU=Delete Blanks] }
    { 62  ;   ;Caption Mandatory   ;Boolean       ;CaptionML=[DEU=Suchtext notwendig;
                                                              ENU=Caption Mandatory] }
    { 63  ;   ;Use as Doc. Separator;Boolean      ;OnValidate=BEGIN
                                                                IF NOT "Use as Doc. Separator" THEN
                                                                  EXIT;

                                                                TESTFIELD(Type,Type::Header);
                                                              END;

                                                   CaptionML=[DEU=Als Belegtrenner verwenden;
                                                              ENU=Use as Document Separator] }
    { 64  ;   ;Fixed Value (Boolean);Boolean      ;CaptionML=[DEU=Fester Wert (Boolesch);
                                                              ENU=Fixed Value (Boolean)] }
    { 65  ;   ;Offset DPI          ;Integer       ;CaptionML=[DEU=Offset DPI;
                                                              ENU=Offset DPI] }
    { 66  ;   ;Typical Field DPI   ;Integer       ;CaptionML=[DEU=Typische Feld DPI;
                                                              ENU=Typical Field DPI] }
    { 67  ;   ;Transfer Blank Values;Boolean      ;CaptionML=[DEU=Leere Werte Åbertragen;
                                                              ENU=Transfer Blank Values] }
    { 68  ;   ;Calculate Date (Date Formula);DateFormula;
                                                   CaptionML=[DEU=Datum berechnen (Datumsformel);
                                                              ENU=Calculate Date (Date Formula)] }
    { 100 ;   ;XML Path            ;Text250       ;OnValidate=VAR
                                                                XmlLibrary@1000 : Codeunit 6085573;
                                                              BEGIN
                                                                XmlLibrary.FormatXmlPath("XML Path");
                                                                "XML Path" := XmlLibrary.StripHeaderLineTag(Rec,"XML Path");
                                                              END;

                                                   CaptionML=[DEU=XML-Pfad;
                                                              ENU=XML Path] }
    { 101 ;   ;Change Sign         ;Boolean       ;CaptionML=[DEU=Vorzeichen Ñndern;
                                                              ENU=Change Sign] }
    { 102 ;   ;Show Field          ;Option        ;CaptionML=[DEU=Feld anzeigen;
                                                              ENU=Show Field];
                                                   OptionCaptionML=[DEU=Nie,Wenn ein Wert existiert,Immer;
                                                                    ENU=Never,If it has a value,Always];
                                                   OptionString=Never,IfValue,Always }
    { 50001;  ;Replacement Field   ;Code20        ;TableRelation="CDC Template Field".Code WHERE (Template No.=FIELD(Template No.),
                                                                                                  Type=FIELD(Replacement Field Type));
                                                   OnValidate=VAR
                                                                CKLAdvLineRecognitionMgt@1000000000 : Codeunit 61000;
                                                              BEGIN
                                                                IF Rec."Replacement Field" <> '' THEN
                                                                  Rec.VALIDATE("Copy Value from Previous Value", FALSE);
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Erstatningsfelt;
                                                              DEU=Ersatzfeld;
                                                              ENU=Substitution Field;
                                                              FRA=Champ de substitution;
                                                              NLD=Vervangingsveld] }
    { 50002;  ;Linked Field        ;Code20        ;TableRelation="CDC Template Field".Code WHERE (Template No.=FIELD(Template No.),
                                                                                                  Type=CONST(Line));
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Ankerfelt;
                                                              DEU=Anker Feld;
                                                              ENU=Anchor Field;
                                                              FRA=Champ d'ancrage;
                                                              NLD=Ankerveld] }
    { 50003;  ;Sorting             ;Integer       ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Sortering;
                                                              DEU=Sortierung;
                                                              ENU=Sorting;
                                                              FRA=Tri;
                                                              NLD=Sorteren] }
    { 50004;  ;Field value position;Option        ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Feltposition;
                                                              DEU=Feldposition;
                                                              ENU=Field position;
                                                              FRA=Position du champ;
                                                              NLD=Veld positie];
                                                   OptionCaptionML=[DAN=" ,Over standardlinje,Under standardlinje";
                                                                    DEU=" ,Oberhalb Standardzeile,Unterhalb Standardzeile";
                                                                    ENU=" ,Above standard line,Below standard line";
                                                                    FRA=" ,Au-dessus de la ligne standard, en-dessous de la ligne standard";
                                                                    NLD=" ,boven de standaard lijn, onder de standaard lijn"];
                                                   OptionString=[ ,AboveStandardLine,BelowStandardLine] }
    { 50005;  ;Field value search direction;Option;OnValidate=BEGIN
                                                                TESTFIELD("Advanced Line Recognition Type", "Advanced Line Recognition Type"::FindFieldByColumnHeading);
                                                              END;

                                                   DataClassification=CustomerContent;
                                                   CaptionML=ENU=Value search direction;
                                                   OptionCaptionML=[DEU=AbwÑrts,AufwÑrts;
                                                                    ENU=Downwards,Upwards];
                                                   OptionString=Downwards,Upwards }
    { 50006;  ;Replacement Field Type;Option      ;OnValidate=BEGIN
                                                                IF xRec."Replacement Field Type" <> Rec."Replacement Field Type" THEN
                                                                                    CLEAR(Rec."Replacement Field");
                                                              END;

                                                   DataClassification=CustomerContent;
                                                   CaptionML=[DEU=Ersatzfeld Art;
                                                              ENU=Replacement field type];
                                                   OptionCaptionML=[DEU=Kopf,Zeile;
                                                                    ENU=Header,Line];
                                                   OptionString=Header,Line }
    { 50007;  ;Copy Value from Previous Value;Boolean;
                                                   OnValidate=BEGIN
                                                                IF Rec."Copy Value from Previous Value" THEN
                                                                  CLEAR(Rec."Replacement Field");
                                                              END;

                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=KopiÇr vërdi fra tidligere vërdi;
                                                              DEU=Wert vom vorherigen Wert kopieren;
                                                              ENU=Copy value from previous value;
                                                              FRA=Copier la valeur depuis la valeur prÇcÇdente;
                                                              NLD=Kopieer waarde van de vorige lijn] }
    { 50010;  ;Data version        ;Integer       ;DataClassification=CustomerContent;
                                                   CaptionML=[DEU=ALR Daten Version;
                                                              ENU=ALR Data version];
                                                   Editable=No }
    { 50011;  ;Advanced Line Recognition Type;Option;
                                                   DataClassification=CustomerContent;
                                                   CaptionML=[DAN=Avanceret linjegenkendelsestype;
                                                              DEU=Erw. Zeilenerkennung Art;
                                                              ENU=Advanced Line Recognition Type;
                                                              FRA=Type de reconnaissance avancÇe de ligne;
                                                              NLD=Geavanceerde lijnherkenningstype];
                                                   OptionCaptionML=[DAN=Standard,Anker-forbundet felt, Feltsõgning med overskrift,Feltsõgning med kolonneoverskrift,Gruppevërdi med overskrift;
                                                                    DEU=Standard,Mit Anker verknÅpftes Feld,Feldsuche mit Caption,Feldsuche mit SpaltenÅberschrift,Gruppierungsfeld mit Caption;
                                                                    ENU=Standard,Anchor linked field,Field search with caption,Field search with column heading;
                                                                    FRA=Standard,Champ liÇ aux ancrages,Recherche de champ avec lÇgende,Recherche de champ avec en-tàte de colonne,Valeur de groupe avec lÇgende;
                                                                    NLD=standaard,anker gekoppeld veld,veld zoeken met bijschrift,veld zoeken met kolomhoofding, groepwaarde met bijschrift];
                                                   OptionString=Default,LinkedToAnchorField,FindFieldByCaptionInPosition,FindFieldByColumnHeading }
    { 50012;  ;Offset Top          ;Integer       ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Forskydning top;
                                                              DEU=Offset Oben;
                                                              ENU=Offset Top;
                                                              FRA=Hauteur de dÇcalage;
                                                              NLD=Offset bovenkant] }
    { 50013;  ;Offset Bottom       ;Integer       ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Forskydning bund;
                                                              DEU=Offset Unten;
                                                              ENU=Offset Height;
                                                              FRA=Hauteur de dÇcalage;
                                                              NLD=Offset hoogte] }
    { 50014;  ;Offset Left         ;Integer       ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Forskydning venstre;
                                                              DEU=Offset Links;
                                                              ENU=Offset Left;
                                                              FRA=DÇcalage gauche;
                                                              NLD=Offset linkerkant] }
    { 50015;  ;Offset Right        ;Integer       ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Forskydning hõjre;
                                                              DEU=Offset Rechts;
                                                              ENU=Offset Width;
                                                              FRA=Largeur de dÇcalage;
                                                              NLD=Offset breedte] }
    { 50020;  ;ALR Value Caption Offset X;Integer ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Overskriftsforskydning X;
                                                              DEU=Wert Suchtext Offset X;
                                                              ENU=Caption Offset X;
                                                              FRA=DÇcalage de lÇgende X;
                                                              NLD=Offset bijschrift X] }
    { 50021;  ;ALR Value Caption Offset Y;Integer ;DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Overskriftsforskydning Y;
                                                              DEU=Wert Suchtext Offset Y;
                                                              ENU=Caption Offset Y;
                                                              FRA=DÇcalage de lÇgende Y;
                                                              NLD=Offset bijschrift Y] }
    { 50022;  ;ALR Typical Value Field Width;Decimal;
                                                   DataClassification=ToBeClassified;
                                                   CaptionML=[DAN=Vërdifeltets typiske bredde;
                                                              DEU=Typische Wert Feldbreite;
                                                              ENU=Field Width;
                                                              FRA=Largeur de champ;
                                                              NLD=Veldbreedte];
                                                   DecimalPlaces=0:5 }
  }
  KEYS
  {
    {    ;Template No.,Type,Code                  ;Clustered=Yes }
    {    ;Template No.,Type,Sort Order             }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;Type,Code,Field Name,Required,Search for Value }
  }
  CODE
  {
    VAR
      Text001@1000000000 : TextConst 'DEU=Es ist nicht ratsam, Leerzeichen als Trennzeichen fÅr Datumsvalidierungsregeln zu benutzen, da sie vor der Verarbeitung gelîscht werden. Benutzen Sie stattdessen einen Bindestrich - oder einen SchrÑgstrich /.;ENU=It is not recommended to use space as a seperator in Date Validation Rules as they will be deleted before evaluation. Use a seperator line - or / instead.';
      Text002@161024012 : TextConst 'DEU=Mîchten Sie auch das Feld ''%1'' lîschen?;ENU=Do you also want to delete the field ''%1''?';
      Text003@161024013 : TextConst 'DEU=Das Feld kann nicht aus sich selbst erzeugt werden.;ENU=The field cannot be subtracted from itself';
      Text004@1160040000 : TextConst 'DEU=Der Datensatz ist nicht in den Filtern von %1 enthalten.;ENU=The record is not within the filters of the %1.';
      Text005@1160040001 : TextConst 'DEU=%1 ist kein Teil des PrimÑrschlÅssels von %2.;ENU=The %1 is not part of the primary key of the %2.';
      Text006@1160040002 : TextConst 'DEU=Feld in %1;ENU=Field in %1';
      Text007@1160040011 : TextConst 'DEU=Feld Zielkopf;ENU=Destination Header Field';
      Text008@1160040010 : TextConst 'DEU=Feld Zielzeile;ENU=Destination Line Field';
      Text010@1003 : TextConst 'DEU=Aktualisiere Vorlagen\#1####################\@2@@@@@@@@@@@@@@@@@@@@;ENU=Updating templates\#1####################\@2@@@@@@@@@@@@@@@@@@@@';
      Text011@1002 : TextConst 'DEU=%1 von %2;ENU=%1 of %2';
      EnableRuleActivateErr@6085573 : TextConst 'DEU=%1 kann nur fÅr Datumstyp %2 oder %3 aktiviert werden.;ENU=%1 can only be activated for Date Type %2 or %3.';
      AlwaysOneDecimal@6085574 : TextConst 'DEU=Immer 1 Dezimalstelle;ENU=Always 1 decimal';
      AlwaysNoDecimals@6085575 : TextConst 'DEU=Immer %1 Dezimalstellen;ENU=Always %1 decimals';
      RangeOfDecimals@6085576 : TextConst 'DEU=%1-%2 Dezimalstellen;ENU=%1-%2 decimals';
      WrongExpressionFormat@6085577 : TextConst 'DEU=Geben Sie eine oder zwei Zahlen ein, die durch einen Doppelpunkt getrennt sind. Die erste Zahl muss kleiner oder gleich der zweiten Zahl sein. Zahlen mÅssen zwischen 0 und 9 liegen.;ENU=Enter one number or two numbers separated by a colon. The first number must be less or equal to the second number. Numbers must be between 0 and 9.';
      UnableToParseDecimalExpression@6085578 : TextConst 'DEU=Der eingegebene Ausdruck kann nicht Åbersetzt werden.;ENU=Unable to translate typed expression.';
      InvalidFormulaErr@6085600 : TextConst 'DEU=Die Formel fÅr das Vorlagenfeld ''%1'' ist ungÅltig. Sie darf nicht mit ''+'', ''-'', ''*'', ''/'', ''^'', ''%'' enden.;ENU=Formula for Template Field ''%1'' is invalid. It must not end with ''+'', ''-'', ''*'', ''/'', ''^'', ''%''.';
      InvalidFormulaErr2@6085290 : TextConst 'DEU=Die Formel fÅr das Vorlagenfeld ''%1'' ist ungÅltig. Sie darf nicht mit ''+'', ''*'', ''/'', ''^'', ''%'' beginnen.;ENU=Formula for Template Field ''%1'' is invalid. It must not begin with ''+'', ''*'', ''/'', ''^'', ''%''.';
      UpdateTemplateQst@1000 : TextConst 'DEU="Dadurch wird das Vorlagenfeld %1 (%2) in alle Vorlagen kopiert, in denen das Feld noch nicht vorhanden ist und die auf Basis der Belegkategorie %5 und %3 = %4 entstanden sind.\\Mîchten Sie fortfahren?";ENU="This will copy the template field %1 (%2) to all templates created from %3 = %4 for the document category %5 where the field doesn''t exist already.\\Do you want to continue?"';
      TemplateUpdatedTxt@6085579 : TextConst 'DEU=1 Vorlage wurde aktualisiert.;ENU=1 template was updated.';
      TemplatesUpdatedTxt@6085580 : TextConst 'DEU=%1 Vorlagen wurden aktualisiert.;ENU=%1 templates were updated.';

    [LineStart(1024)]
    PROCEDURE SyncFieldFromMaster@2();
    VAR
      Template@1000 : Record 6085579;
      Field@1001 : Record 6085580;
      Window@1002 : Dialog;
      Total@1003 : Integer;
      FieldsUpdated@1005 : Integer;
      i@1004 : Integer;
      MessageHandler@6086000 : Codeunit 6086011;
    BEGIN
      Template.GET("Template No.");
      Template.TESTFIELD(Type,Template.Type::Master);

      IF NOT CONFIRM(STRSUBSTNO(UpdateTemplateQst,Code,"Field Name",Template.FIELDCAPTION("Master Template No."),Template."No.",
        Template."Category Code"))
      THEN
        EXIT;

      Template.SETFILTER(Type,'<>%1',Template.Type::Master);
      Template.SETRANGE("Master Template No.","Template No.");
      Total := Template.COUNT;

      Window.OPEN(Text010);
      IF Template.FINDSET THEN
        REPEAT
          i += 1;
          Window.UPDATE(1,STRSUBSTNO(Text011,i,Total));
          Window.UPDATE(2,(i / Total * 10000) DIV 1);

          IF NOT Field.GET(Template."No.",Type,Code) THEN BEGIN
            FieldsUpdated += 1;
            Field.Clone('',Rec,Template,TRUE);
          END ;
        UNTIL Template.NEXT = 0;

      Window.CLOSE;
      IF FieldsUpdated = 1 THEN
        MessageHandler.ShowMessageNotification(STRSUBSTNO(TemplateUpdatedTxt),FALSE)
      ELSE
        MessageHandler.ShowMessageNotification(STRSUBSTNO(TemplatesUpdatedTxt,FieldsUpdated),FALSE);
    END;

    [LineStart(1056)]
    PROCEDURE Clone@161024012(FromCompany@1160040002 : Text[30];FromField@1160040003 : Record 6085580;ToTemplate@161024013 : Record 6085579;CreatedFromMasterTemplate@6085581 : Boolean);
    VAR
      ToField@1000000002 : Record 6085580;
      FromFieldRule@1000000010 : Record 6085583;
      ToFieldRule@1000000009 : Record 6085583;
      FromFieldCapt@1000000003 : Record 6085581;
      ToFieldCaption@1000000004 : Record 6085581;
      FromFieldTransl@1000000005 : Record 6085582;
      ToFieldTransl@1000000006 : Record 6085582;
      FromTableFilterFields@1160040000 : Record 6085762;
      ToTableFilterFields@1160040001 : Record 6085762;
      RecIDMgt@1000 : Codeunit 6085604;
      NoOfFromFieldRule@6085573 : Integer;
      Handled@6085600 : Boolean;
    BEGIN
      OnBeforeClone(FromCompany,FromField,ToTemplate,CreatedFromMasterTemplate,Handled);
      IF Handled THEN
        EXIT;

      ToField := FromField;
      ToField."Template No." := ToTemplate."No.";
      IF ToField.FIND('=') THEN
        EXIT;

      IF FromField."Fixed Value (Rec. ID Tree ID)" <> 0 THEN
        ToField.SetFixedValue(RecIDMgt.GetFieldValueInCompany(FromCompany,FromField."Fixed Value (Rec. ID Tree ID)",
          FromField."Source Field No."));
      ToField.INSERT(TRUE);

      IF FromCompany <> '' THEN BEGIN
        FromFieldRule.CHANGECOMPANY(FromCompany);
        FromFieldCapt.CHANGECOMPANY(FromCompany);
        FromFieldTransl.CHANGECOMPANY(FromCompany);
        FromTableFilterFields.CHANGECOMPANY(FromCompany);
      END;

      FromFieldRule.SETRANGE("Template No.",FromField."Template No.");
      FromFieldRule.SETRANGE(Type,FromField.Type);
      FromFieldRule.SETRANGE(Code,FromField.Code);
      IF FromFieldRule.FINDSET THEN BEGIN
        NoOfFromFieldRule := FromFieldRule.COUNT;

        REPEAT
          ToFieldRule := FromFieldRule;
          ToFieldRule."Template No." := ToField."Template No.";
          IF (NoOfFromFieldRule > 1) AND CreatedFromMasterTemplate AND FromField."Enable Rule Generation" THEN
            ToFieldRule."Created from Master Template" := TRUE
          ELSE
            ToFieldRule."Created from Master Template" := FALSE;
          ToFieldRule.INSERT(TRUE);
        UNTIL FromFieldRule.NEXT = 0;
      END;

      FromFieldCapt.SETRANGE("Template No.",FromField."Template No.");
      FromFieldCapt.SETRANGE(Type,FromField.Type);
      FromFieldCapt.SETRANGE(Code,FromField.Code);
      IF FromFieldCapt.FINDSET THEN
        REPEAT
          ToFieldCaption := FromFieldCapt;
          ToFieldCaption."Template No." := ToField."Template No.";
          ToFieldCaption.INSERT(TRUE);
        UNTIL FromFieldCapt.NEXT = 0;

      FromFieldTransl.SETRANGE("Template No.",FromField."Template No.");
      FromFieldTransl.SETRANGE(Type,FromField.Type);
      FromFieldTransl.SETRANGE(Code,FromField.Code);
      IF FromFieldTransl.FINDSET THEN
        REPEAT
          ToFieldTransl := FromFieldTransl;
          ToFieldTransl."Template No." := ToField."Template No.";
          ToFieldTransl.INSERT(TRUE);
        UNTIL FromFieldTransl.NEXT = 0;

      FromTableFilterFields.SETRANGE("Table Filter GUID",FromField."Source Table Filter GUID");
      IF FromTableFilterFields.FINDSET THEN
        REPEAT
          ToTableFilterFields := FromTableFilterFields;
          ToTableFilterFields."Table Filter GUID" := ToField."Source Table Filter GUID";
          ToTableFilterFields.INSERT(TRUE);
        UNTIL FromTableFilterFields.NEXT = 0;
    END;

    [LineStart(1123)]
    PROCEDURE SetFixedValue@1000000000(Value@1000000000 : Text[250]);
    VAR
      RecIDMgt@161024013 : Codeunit 6085604;
      CaptureMgt@1160040001 : Codeunit 6085576;
      RecID@161024012 : Text[30];
      DCLogMgt@1000 : Codeunit 6085658;
    BEGIN
      IF ("Source Table No." <> 0) OR ("Data Type" = "Data Type"::Lookup) THEN BEGIN
        "Fixed Value (Text)" := '';
        IF Value <> '' THEN
          DCLogMgt.IsLogActive("Source Table No.",TRUE);
        "Fixed Value (Rec. ID Tree ID)" := RecIDMgt.SetKeyValueWithGUID("Source Table No.","Source Field No.",0,
          "Source Table Filter GUID",Value,TRUE);
      END;

      CASE "Data Type" OF
        "Data Type"::Text:
          EVALUATE("Fixed Value (Text)",Value);
        "Data Type"::Number:
          IF Value = '' THEN
            "Fixed Value (Decimal)" := 0
          ELSE
            EVALUATE("Fixed Value (Decimal)",Value);
        "Data Type"::Date:
          IF Value = 'TODAY' THEN
            EVALUATE("Fixed Value (Text)",Value)
          ELSE BEGIN
            "Fixed Value (Text)" := '';
            EVALUATE("Fixed Value (Date)",Value);
          END;
        "Data Type"::Boolean:
          IF Value = '' THEN
            "Fixed Value (Boolean)" := FALSE
          ELSE
            CaptureMgt.ParseBoolean(Value,"Fixed Value (Boolean)");
      END;

      IF Value <> '' THEN
        "Search for Value" := FALSE;
    END;

    [External]
    [LineStart(1157)]
    PROCEDURE GetFixedValue@1000000001() : Text[250];
    VAR
      RecIDMgt@161024012 : Codeunit 6085604;
    BEGIN
      IF ("Source Table No." <> 0) OR ("Data Type" = "Data Type"::Lookup) THEN
        EXIT(RecIDMgt.GetKeyValue("Fixed Value (Rec. ID Tree ID)","Source Field No."));

      CASE "Data Type" OF
        "Data Type"::Text:
          EXIT(FORMAT("Fixed Value (Text)"));
        "Data Type"::Date:
          IF "Fixed Value (Date)" <> 0D THEN
            EXIT(FORMAT("Fixed Value (Date)"))
          ELSE
            EXIT("Fixed Value (Text)");
        "Data Type"::Number:
          IF "Fixed Value (Decimal)" <> 0 THEN
            EXIT(FORMAT("Fixed Value (Decimal)"));
        "Data Type"::Boolean:
          EXIT(FORMAT("Fixed Value (Boolean)"));
      END;
    END;

    [LineStart(1176)]
    PROCEDURE FormulaOnLookup@161024013(VAR Text@161024012 : Text[1024]) : Boolean;
    VAR
      TemplField@161024013 : Record 6085580;
    BEGIN
      TemplField.FILTERGROUP(2);
      TemplField.SETCURRENTKEY("Template No.",Type,"Sort Order");
      TemplField.SETRANGE("Template No.","Template No.");
      TemplField.SETRANGE(Type,Type);
      TemplField.SETFILTER(Code,'<>%1',Code);
      IF "Data Type" = "Data Type"::Number THEN
        TemplField.SETRANGE("Data Type","Data Type");
      TemplField.FILTERGROUP(0);
      IF STRLEN(Text) <= MAXSTRLEN(TemplField.Code) THEN
        IF TemplField.GET("Template No.",Type,Text) THEN;

      IF PAGE.RUNMODAL(0,TemplField) = ACTION::LookupOK THEN BEGIN
        Text := TemplField.Code;
        EXIT(TRUE);
      END;
    END;

    [LineStart(1193)]
    PROCEDURE GetDestFieldCaption@1160040000(FieldType@1160040002 : 'Header,Line') FieldCap : Text[250];
    VAR
      Template@1160040001 : Record 6085579;
      DocCat@1160040000 : Record 6085575;
      AllObjWithCaption@1160040004 : Record 2000000058;
      RecIDMgt@1160040003 : Codeunit 6085604;
    BEGIN
      IF Template.GET("Template No.") THEN
        DocCat.GET(Template."Category Code");

      IF FieldType = FieldType::Header THEN BEGIN
        FieldCap := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Table,DocCat."Destination Header Table No.");
        IF FieldCap = '' THEN
          FieldCap := Text007
        ELSE
          FieldCap := STRSUBSTNO(Text006,FieldCap);
      END ELSE BEGIN
        FieldCap := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Table,DocCat."Destination Line Table No.");
        IF FieldCap = '' THEN
          FieldCap := Text008
        ELSE
          FieldCap := STRSUBSTNO(Text006,FieldCap);
      END;
    END;

    [LineStart(1211)]
    LOCAL PROCEDURE SetOrderRecords@6085573();
    VAR
      SingleInstanceStorage@6085574 : Codeunit 6085789;
      TemplateField@6085573 : Record 6085580;
      TemplateField2@6085576 : Record 6085580;
      i@6085575 : Integer;
    BEGIN
      IF "Sort Order" <> 0 THEN
        EXIT;

      i := SingleInstanceStorage.GetActiveTemplFieldForP6085585;
      IF i = 0 THEN BEGIN
        TemplateField.SETCURRENTKEY("Template No.",Type,"Sort Order");
        TemplateField.SETRANGE("Template No.","Template No.");
        TemplateField.SETRANGE(Type,Type);
        IF TemplateField.FINDLAST THEN
          "Sort Order" := TemplateField."Sort Order" + 1
        ELSE
          "Sort Order" := 1;
      END ELSE BEGIN
        TemplateField.SETRANGE("Template No.","Template No.");
        TemplateField.SETRANGE(Type,Type);
        TemplateField.SETFILTER("Sort Order",'>%1',i);
        IF TemplateField.FINDSET(TRUE,FALSE) THEN
          REPEAT
            TemplateField2.GET(TemplateField."Template No.",TemplateField.Type,TemplateField.Code);
            TemplateField2."Sort Order" := TemplateField2."Sort Order" + 1;
            TemplateField2.MODIFY;
          UNTIL TemplateField.NEXT = 0;

        "Sort Order" := i + 1;
      END;
      SingleInstanceStorage.SetActiveTemplFieldForP6085585("Sort Order");
    END;

    [LineStart(1239)]
    PROCEDURE ValidateDecimalPlaces@6085575(DecimalPlacesDescriptionIn@6085573 : Text[5]) DecimalPlacesDescriptionOut : Text[50];
    VAR
      MinNoOfDecimals@6085578 : Integer;
      MinNoOfDecimalsText@6085580 : Text[10];
      MaxNoOfDecimals@6085579 : Integer;
      MaxNoOfDecimalsText@6085581 : Text[10];
      GenLedgerSetup@6085582 : Record 98;
      ColonPosition@6085583 : Integer;
    BEGIN
      IF NOT ("Data Type" = "Data Type"::Number) THEN
        EXIT('');

      IF NOT CheckDecimalPlacesFormat(DecimalPlacesDescriptionIn) THEN
        ERROR(WrongExpressionFormat);

      VALIDATE("Decimal Places",DecimalPlacesDescriptionIn);
      ColonPosition := STRPOS(DecimalPlacesDescriptionIn,':');
      IF ColonPosition = 0 THEN BEGIN
        IF "Decimal Places" = '1' THEN
          DecimalPlacesDescriptionOut := STRSUBSTNO(AlwaysOneDecimal)
        ELSE
          DecimalPlacesDescriptionOut := STRSUBSTNO(AlwaysNoDecimals,"Decimal Places");
      END ELSE BEGIN
        MinNoOfDecimalsText := COPYSTR(DecimalPlacesDescriptionIn,1,ColonPosition - 1);
        EVALUATE(MinNoOfDecimals,MinNoOfDecimalsText);
        MaxNoOfDecimalsText := COPYSTR(DecimalPlacesDescriptionIn,ColonPosition + 1,STRLEN(DecimalPlacesDescriptionIn));
        EVALUATE(MaxNoOfDecimals,MaxNoOfDecimalsText);
        IF (MinNoOfDecimals = MaxNoOfDecimals) THEN BEGIN
          IF MinNoOfDecimals = 1 THEN
            DecimalPlacesDescriptionOut := STRSUBSTNO(AlwaysOneDecimal)
          ELSE
            DecimalPlacesDescriptionOut := STRSUBSTNO(AlwaysNoDecimals,MinNoOfDecimals);
        END ELSE
          DecimalPlacesDescriptionOut := STRSUBSTNO(RangeOfDecimals,MinNoOfDecimals,MaxNoOfDecimals);
      END;
    END;

    [LineStart(1267)]
    PROCEDURE CheckDecimalPlacesFormat@1(VAR DecimalPlaces@1000 : Text[5]) OK : Boolean;
    VAR
      ColonPlace@1002 : Integer;
      DecimalPlacesPart1@1003 : Integer;
      DecimalPlacesPart2@1004 : Integer;
      Check@1005 : Text[5];
    BEGIN
      // Copied from T98 - need a local copy of the function due to wrong error handling in org. function
      OK := TRUE;
      ColonPlace := STRPOS(DecimalPlaces,':');

      IF ColonPlace = 0 THEN BEGIN
        IF NOT EVALUATE(DecimalPlacesPart1,DecimalPlaces) THEN
          OK := FALSE;
        IF (DecimalPlacesPart1 < 0) OR (DecimalPlacesPart1 > 9) THEN
          OK := FALSE;
      END ELSE BEGIN
        Check := COPYSTR(DecimalPlaces,1,ColonPlace - 1);
        IF Check = '' THEN
          OK := FALSE;
        IF NOT EVALUATE(DecimalPlacesPart1,Check) THEN
          OK := FALSE;
        Check := COPYSTR(DecimalPlaces,ColonPlace + 1,STRLEN(DecimalPlaces));
        IF Check = '' THEN
          OK := FALSE;
        IF NOT EVALUATE(DecimalPlacesPart2,Check) THEN
          OK := FALSE;
        IF DecimalPlacesPart1 > DecimalPlacesPart2 THEN
          OK := FALSE;
        IF (DecimalPlacesPart1 < 0) OR (DecimalPlacesPart1 > 9) THEN
          OK := FALSE;
        IF (DecimalPlacesPart2 < 0) OR (DecimalPlacesPart2 > 9) THEN
          OK := FALSE;
      END;
    END;

    [LineStart(1296)]
    PROCEDURE ParseDecimalPlacesDescription@6085574(DecimalPlacesDescriptionIn@6085573 : Text[50]) DecimalPlacesOut : Text[5];
    VAR
      IntegerVar@6085574 : Integer;
      MinNoOfDecimals@6085577 : Integer;
      MaxNoOfDecimals@6085576 : Integer;
      DashPosition@6085575 : Integer;
      FirstBlankPosition@6085578 : Integer;
      i@6085579 : Integer;
    BEGIN
      FirstBlankPosition := STRPOS(DecimalPlacesDescriptionIn,' ');

      // Expression is of form "blabla X blabla" -> Translate to X (=X:X)
      IF (DecimalPlacesDescriptionIn[FirstBlankPosition+2] = ' ') AND (DecimalPlacesDescriptionIn[FirstBlankPosition+1] IN
        ['0','1','2','3','4','5','6','7','8','9'])
      THEN BEGIN
        DecimalPlacesOut := FORMAT(DecimalPlacesDescriptionIn[FirstBlankPosition+1]);
        EXIT(DecimalPlacesOut);
      END;

      // Expression is of form "X", "X-", "X-Y", "-Y" -> Translate to X:X, X:Y, 0:Y
      DecimalPlacesOut := '';
      DecimalPlacesDescriptionIn := COPYSTR(DecimalPlacesDescriptionIn,1,3);
      FOR i := 1 TO 3 DO
        IF DecimalPlacesDescriptionIn[i] IN ['0','1','2','3','4','5','6','7','8','9','-',':'] THEN
          DecimalPlacesOut += FORMAT(DecimalPlacesDescriptionIn[i]);

      DecimalPlacesOut := CONVERTSTR(DecimalPlacesOut,'-',':');
      IF DecimalPlacesOut[1] = ':' THEN
        DecimalPlacesOut := '0' + DecimalPlacesOut;

      IF CheckDecimalPlacesFormat(DecimalPlacesOut) THEN
        EXIT(DecimalPlacesOut)
      ELSE
        ERROR(UnableToParseDecimalExpression);
    END;

    [LineStart(1323)]
    PROCEDURE SetFormula@6085577(FormulaTxt@6085576 : Text[250]);
    VAR
      CaptureMgt@6085575 : Codeunit 6085576;
      TempDec@6085573 : Decimal;
    BEGIN
      IF FormulaTxt = '' THEN BEGIN
        SetFixedValue(FormulaTxt);
        Formula := '';
        EXIT;
      END;

      IF ("Data Type" = "Data Type"::Number) THEN BEGIN
        CaptureMgt.ValidateNumberFormula("Template No.",FormulaTxt);
        IF EVALUATE(TempDec,FormulaTxt) THEN BEGIN
          SetFixedValue(FormulaTxt);
          Formula := '';
        END ELSE BEGIN
          SetFixedValue('');
          Formula := FormulaTxt;
        END;
      END ELSE
        IF CaptureMgt.ValidateTextFormula("Template No.",FormulaTxt) THEN BEGIN
          // FormulaTxt contains references to Template Fields
          SetFixedValue('');
          Formula := FormulaTxt;
        END ELSE BEGIN
          // No references, so must be Fixed Value
          SetFixedValue(FormulaTxt);
          Formula := '';
        END;

      "Search for Value" := FALSE;
    END;

    [LineStart(1352)]
    PROCEDURE IsFormulaValid@6085600(FormulaTxt@6085601 : Text[250];ShowError@6085600 : Boolean) : Boolean;
    BEGIN
      IF FormulaTxt = '' THEN
        EXIT(TRUE);
      IF "Data Type" <> "Data Type"::Text THEN BEGIN
        IF COPYSTR(FormulaTxt,STRLEN(FormulaTxt),1) IN ['+','-','*','/','^','%'] THEN BEGIN
          // Formula cannot end with an operator
          IF ShowError THEN
            ERROR(STRSUBSTNO(InvalidFormulaErr,Code));
          EXIT(FALSE);
        END;
        IF COPYSTR(FormulaTxt,1,1) IN ['+','*','/','^','%'] THEN BEGIN
          // Formula cannot begin with an operator (except '-')
          IF ShowError THEN
            ERROR(STRSUBSTNO(InvalidFormulaErr2,Code));
          EXIT(FALSE);
        END;
      END;
      EXIT(TRUE);
    END;

    [Integration]
    [LineStart(1371)]
    LOCAL PROCEDURE OnBeforeClone@6085601(FromCompany@6085600 : Text[30];FromField@6085601 : Record 6085580;ToTemplate@6085602 : Record 6085579;CreatedFromMasterTemplate@6085603 : Boolean;VAR Handled@6085604 : Boolean);
    BEGIN
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 61000 Adv. Line Recognition Mgt.
{
  OBJECT-PROPERTIES
  {
    Date=01/05/22;
    Time=10:55:06 PM;
    Modified=Yes;
    Version List=ALR1.15;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      FieldSetupCanceled@1000000000 : TextConst 'DAN=Feltopsëtning afbrudt fordi intet felt blev valgt!;DEU=Feldeinrichtung abgebrochen, da kein Feld ausgewÑhlt wurde!;ENU=Field setup aborted because no field was selected!;FRA=La configuration du champ a ÇtÇ interrompue car aucun champ n''a ÇtÇ sÇlectionnÇ!
    ;NLD=Veld instellen afgebroken, omdat er geen veld is geselecteerd!';
      FieldIsLinkedToSourceField@1000000001 : TextConst 'DAN=Feltet "%1" er nu forbundet med feltet "%2".;DEU=Das Feld "%1" ist nun mit dem Feld "%2" verknÅpft.;ENU=The field "%1" is now linked to field "%2".;FRA=Le champ "%1" est maintenant liÇ au champ "%2 ".;NLD=Het veld "%1" is nu gekoppeld aan het veld "%2".';
      MissingSourceFieldValue@1000000002 : TextConst 'DAN=Vërdien for kildefeltet %1 i linje %2 mangler! Trën venligst denne vërdi fõrst!;DEU=Der Wert fÅr Herkunftsfeld %1 in Zeile %2 fehlt! Bitte trainieren Sie zuerst diesen Wert an!;ENU=The value for source field %1 in line %2 is missing! Please train this value first!;FRA=La valeur du champ source %1 Ö la ligne %2 est manquante! Veuillez d''abord entraåner cette valeur!;NLD=De waarde voor het bronveld %1 in lijn %2 ontbreekt! train eerst deze waarde!';
      MissingFieldExampleValue@1000000003 : TextConst 'DAN=Vërdien for %1 (%2) i rëkke %3 mangler! Trën venligst denne vërdi fõrst!;DEU=Der Wert fÅr fÅr %1 (%2) Zeile %3 fehlt! Bitte trainieren Sie zuerst diesen Wert an!;ENU=The value for for %1 (%2) row %3 is missing! Please train this value first!;FRA=La valeur de %1 (%2) Ö la ligne %3 est manquante! Veuillez d''abord entraåner cette valeur!;NLD=De waarde voor %1 (%2) in rij %3 ontbreekt! train eerst deze waarde!';
      SelectOffsetSourceFieldFirst@1000000004 : TextConst 'DAN=Vëlg fõrst kildefeltet der skal vëre grundlag for positionen hvor vërdien skal findes.;DEU="Bitte wÑhlen Sie zuerst das Herkunftsfeld aus, an Hand dessen Position der Wert ermittelt werden soll. ";ENU="Please select first the source field on the basis of which position the value should be found. ";FRA=Veuillez d''abord sÇlectionner le champ source sur base duquel la position de la valeur doit àtre trouvÇe.;NLD=Selecteer eerst het bronveld op basis van welke positie de waarde moet worden gevonden.';
      CodeunitDoesNotExist@1000000005 : TextConst 'DAN=Codeunit %1 findes ikke! Er objektet omdõbt?;DEU=Die Standard Codeunit %1 existiert nicht! Wurde das Object ggf. umbenannt?;ENU=Codeunit %1 does not exist! Has the object been renamed?;FRA=Le Codeunit %1 n''existe pas ! L''objet a-t-il ÇtÇ renommÇ?;NLD=Codeunit %1 bestaat niet! Is het object hernoemd?';
      TrainCaptionFirstForField@1113400001 : TextConst 'DAN=Fejl! Feltet %1 er ikke forbundet med en overskrift! MarkÇr venligst overskriften fõrst.;DEU=Fehler! FÅr Feld %1 wurde noch keine Caption hinterlegt! Bitte pflegen Sie die Caption zuerst.;ENU=Error! For the field %1 hasn|t been trained a caption! Please train the caption first.;FRA=Erreur! Pour le champ %1 une lÇgende n''a pas ÇtÇ entraånÇe ! Veuillez d''abord entraåner la lÇgende.;NLD=Fout! Voor het veld %1 is het onderschrift getraind! Train het bijschrift eerst.';
      SelectTheOffsetField@1113400006 : TextConst 'DAN=Vëlg feltet som skal sammenkëdes med kildefeltet "%1".;DEU=WÑhlen Sie nun das Feld aus, welches Sie mit dem Herkunftsfeld "%1" verknÅpfen mîchten.;ENU=Please choose the field, which should be linked with the source field "%1".;FRA=Veuillez choisir le champ qui doit àtre liÇ au champ source "%1".;NLD=Kies het veld, welke gekoppeld moet zijn met het bronveld "%1".';
      ErrorDuringFieldSetup@1113400007 : TextConst 'DAN=Fejl under indstilling af felt.;DEU=Fehler bei Feldeinrichtung.;ENU=Error during field setup.;FRA=Erreur lors de la configuration du champ.;NLD=Fout tijdens het instellen van het veld.';
      SelectFieldForColumnHeaderSearch@1113400008 : TextConst 'DAN=Vëlg det felt der skal findes af kolonneoverskriften.;DEU=Bitte wÑhlen Sie das Feld aus, welches Åber die öberschrift gefunden werden soll.;ENU=Select the field that should be found by the column heading.;FRA=SÇlectionnez le champ qui doit àtre trouvÇ par l''en-tàte de colonne.;NLD=Selecteer het veld dat gevonden moet worden bij de koptekst van de kolom.';
      SelectFieldForCaptionSearch@1113400009 : TextConst 'DAN=Vëlg feltet hvis vërdi skal findes ved hjëlp af overskriften i den aktuelle linje.;DEU="Bitte wÑhlen Sie das Feld aus, welches innerhalb der Position mit Hilfe des Suchbegriffs gefunden werden soll. ";ENU=Choose the field whose value should be found by the caption in the current line.;FRA=Choisir le champ dont la valeur doit àtre trouvÇe par la lÇgende de la ligne actuelle.;NLD=Kies het veld waarvan de waarde in de huidige regel moet gevonden worden op basis van de koptekst.';
      FieldIsCapturedByColumnHeading@1160040001 : TextConst 'DAN=Feltet "%1" bliver nu fundet ved hjëlp af kolonneoverskriften "%2".;DEU="Das Feld ""%1"" wird nun innerhalb der Position Åber die SpaltenÅberschrift ""%2"" gesucht. ";ENU=The field "%1" will now be searched via the column heading "%2".;FRA=Le champ "%1" sera maintenant recherchÇ via l''en-tàte de colonne "%2".;NLD=Het veld "%1" zal nu worden doorzocht via de kolom koptekst "%2".';
      FieldIsCapturedByCaption@1113400010 : TextConst 'DAN=Vërdien i feltet "%1" bliver nu fundet ved hjëlp af kolonneoverskriften i den aktuelle linje.;DEU="Das Feld ""%1"" wird nun innerhalb der Position Åber den Suchtext/Caption gesucht. ";ENU=The value of field "%1" will now been searched via the caption in the current line.;FRA=La valeur du champ "%1" sera maintenant recherchÇe via la lÇgende dans la ligne actuelle.;NLD=De waarde van veld "%1" zal nu gezocht worden via het bijschrift in de huidige regel.';
      NoRequiredFieldFound@1000000006 : TextConst 'DAN=Intet obligatorisk felt med indstillingen "PÜkrëvet" blev fundet i linje %1! Konfigurer et obligatorisk felt fõrst.;DEU=Es wurde kein Zeilenfeld mit der aktivierten Option "Erforderlich" gefunden! Konfigurieren Sie zuerst ein Pflichtfeld.;ENU=No mandatory field with the option "Required" was found in line %1! Configure a mandatory field first.;FRA=Aucun champ obligatoire avec l''option "Requis" n''a ÇtÇ trouvÇ Ö la ligne %1! Configurez d''abord un champ obligatoire.;NLD=Er is geen verplicht veld met de optie "Vereist" gevonden in regel %1! Configureer eerst een verplicht veld.';
      ALRVersionNoText@1160040000 : TextConst 'DAN=ALR%1 (%2 Build %3);DEU=ALR%1 (%2 Build %3);ENU=ALR%1 (%2 Build %3);FRA=ALR%1 (%2 Build %3);NLD=ALR%1 (%2 Build %3)';
      NoALRFieldsForReset@1160040002 : TextConst 'DAN=Der er ikke konfigureret felter til avanceret linjegenkendelse, der kan nulstilles.;DEU=Es gibt keine Felder mit aktivierter erweiterter Zeilenerkennung, die zurÅckgesetzt werden kînnen.'';ENU=There are not fields configured for advanced line recognition, that can be reset.;FRA=Il n''y a pas de champs configurÇs pour la reconnaissance de ligne avancÇe, qui peuvent àtre rÇinitialisÇs.;NLD=Er zijn geen velden, geconfigureerd voor geavanceerde lijnherkenning, gevonden die kunnen worden gereset.';
      YouAreUsingALRVersion@1000 : TextConst 'DEU=You are using version advanced line recognition version: %1;ENU=You are using version advanced line recognition version: %1';

    [LineStart(1375)]
    PROCEDURE SetToAnchorLinkedField@1000000010(VAR TempDocumentLine@1000000008 : Record 6085596);
    VAR
      AnchorField@1000000007 : Record 6085580;
      LinkedField@1000000005 : Record 6085580;
      AnchorFieldDocumentValue@1113400000 : Record 6085593;
      LinkedFieldDocumentValue@1000000001 : Record 6085593;
      FieldsLinked@1000000000 : Integer;
    BEGIN
      // Get the anchor field that defines the position
      MESSAGE(SelectOffsetSourceFieldFirst);
      IF NOT SelectField(AnchorField,TempDocumentLine."Template No.",'',FALSE) THEN
        EXIT;

      // Get document value of the anchor field => is mandatory
      AnchorFieldDocumentValue.SETRANGE("Document No.",TempDocumentLine."Document No.");
      AnchorFieldDocumentValue.SETRANGE("Is Value",TRUE);
      AnchorFieldDocumentValue.SETRANGE(Code,AnchorField.Code);
      //AnchorFieldDocumentValue.SETRANGE("Line No.",1);
      AnchorFieldDocumentValue.SETRANGE("Line No.",TempDocumentLine."Line No.");
      AnchorFieldDocumentValue.SETRANGE(Type,AnchorFieldDocumentValue.Type::Line);
      AnchorFieldDocumentValue.SETRANGE("Is Valid",TRUE);
      AnchorFieldDocumentValue.SETRANGE("Template No.",TempDocumentLine."Template No.");
      IF NOT AnchorFieldDocumentValue.FINDFIRST THEN
        ERROR(MissingSourceFieldValue,AnchorField.Code,TempDocumentLine."Line No.");

      // Select the field that should be linked with anchor field
      MESSAGE(SelectTheOffsetField, AnchorField."Field Name");
      IF NOT SelectField(LinkedField,TempDocumentLine."Template No.",AnchorField.Code,FALSE) THEN
        ERROR(FieldSetupCanceled);

      // Link the selected field to anchor field
      // Find the value of the selected field
      LinkedFieldDocumentValue.SETRANGE("Document No.",TempDocumentLine."Document No.");
      LinkedFieldDocumentValue.SETRANGE("Is Value",TRUE);
      LinkedFieldDocumentValue.SETRANGE(Code,LinkedField.Code);
      //LinkedFieldDocumentValue.SETRANGE("Line No.",1);
      LinkedFieldDocumentValue.SETRANGE("Line No.",TempDocumentLine."Line No.");
      LinkedFieldDocumentValue.SETRANGE(Type,LinkedFieldDocumentValue.Type::Line);
      LinkedFieldDocumentValue.SETRANGE("Is Valid",TRUE);
      LinkedFieldDocumentValue.SETRANGE("Template No.",TempDocumentLine."Template No.");
      IF NOT LinkedFieldDocumentValue.FINDFIRST THEN
        ERROR(MissingFieldExampleValue,LinkedField."Field Name",LinkedField.Code);  //value is mandatory

      ResetField(LinkedField);

      // Calculate and save the offset values at the linked field
      LinkedField."Offset Top" := LinkedFieldDocumentValue.Top - AnchorFieldDocumentValue.Top;
      LinkedField."Offset Left" := LinkedFieldDocumentValue.Left - AnchorFieldDocumentValue.Left;
      LinkedField."Offset Bottom" := LinkedFieldDocumentValue.Bottom - LinkedFieldDocumentValue.Top;
      LinkedField."Offset Right" := LinkedFieldDocumentValue.Right - LinkedFieldDocumentValue.Left;
      LinkedField."Advanced Line Recognition Type" := LinkedField."Advanced Line Recognition Type"::LinkedToAnchorField;
      LinkedField."Linked Field" := AnchorFieldDocumentValue.Code;

      UpdateExecutionSequence(LinkedField,LinkedField."Linked Field");

      IF LinkedField.MODIFY(TRUE) THEN BEGIN
        SetTemplateToALRProcessing(TempDocumentLine."Template No.");
        MESSAGE(FieldIsLinkedToSourceField,LinkedField."Field Name",AnchorField."Field Name");
      END ELSE
        MESSAGE(ErrorDuringFieldSetup);
    END;

    [LineStart(1429)]
    PROCEDURE SetToFieldSearchWithColumnHeding@1113400003(VAR TempDocumentLine@1113400002 : Record 6085596);
    VAR
      LineIdentFieldDocumentValue@1000000001 : Record 6085593;
      SelectedField@1113400001 : Record 6085580;
      SelectedFieldDocumentValue@1000000004 : Record 6085593;
      CDCTemplateFieldCaption@1000000000 : Record 6085581;
    BEGIN
      // Find field value of a normal position field
      GetLineIdentifierValue(TempDocumentLine,LineIdentFieldDocumentValue);

      // Select field
      MESSAGE(SelectFieldForColumnHeaderSearch);
      IF NOT SelectField(SelectedField,TempDocumentLine."Template No.",'',FALSE) THEN
        ERROR(FieldSetupCanceled);

      // Check that the selected field has at least one caption
      CDCTemplateFieldCaption.SETRANGE("Template No.",SelectedField."Template No.");
      CDCTemplateFieldCaption.SETRANGE(Code,SelectedField.Code);
      CDCTemplateFieldCaption.SETRANGE(Type,CDCTemplateFieldCaption.Type::Line);
      IF NOT CDCTemplateFieldCaption.FINDFIRST THEN
        ERROR(TrainCaptionFirstForField, SelectedField.Code);

      // Find the value of the selected field
      GetSelectedFieldValue(TempDocumentLine, SelectedFieldDocumentValue,SelectedField);

      ResetField(SelectedField);

      // Setup field for column heading search
      SelectedField."Advanced Line Recognition Type" := SelectedField."Advanced Line Recognition Type"::FindFieldByColumnHeading;

      IF SelectedFieldDocumentValue.Top < LineIdentFieldDocumentValue.Top THEN
        SelectedField."Field value position" := SelectedField."Field value position"::AboveStandardLine
      ELSE
        SelectedField."Field value position" := SelectedField."Field value position"::BelowStandardLine;

      IF SelectedField.MODIFY(TRUE) THEN BEGIN
        SetTemplateToALRProcessing(TempDocumentLine."Template No.");
        MESSAGE(FieldIsCapturedByColumnHeading, SelectedField."Field Name",CDCTemplateFieldCaption.Caption);
      END ELSE
        MESSAGE(ErrorDuringFieldSetup);
    END;

    [LineStart(1464)]
    PROCEDURE SetToFieldSearchWithCaption@1113400000(VAR TempDocumentLine@1113400000 : Record 6085596);
    VAR
      LineIdentFieldDocumentValue@1000000001 : Record 6085593;
      SelectedField@1113400001 : Record 6085580;
      SelectedFieldDocumentValue@1000000002 : Record 6085593;
      CDCTemplateFieldCaption@1000000000 : Record 6085581;
      DocumentPage@1000000004 : Record 6085591;
      CaptureEngine@1000000003 : Codeunit 6085575;
    BEGIN
      // Find field value of a normal position field
      GetLineIdentifierValue(TempDocumentLine,LineIdentFieldDocumentValue);

      // Select field
      MESSAGE(SelectFieldForCaptionSearch);
      IF NOT SelectField(SelectedField,TempDocumentLine."Template No.",'',FALSE) THEN
        ERROR(FieldSetupCanceled);

      // Check that the selected field has at least one caption
      CDCTemplateFieldCaption.SETRANGE("Template No.",SelectedField."Template No.");
      CDCTemplateFieldCaption.SETRANGE(Code,SelectedField.Code);
      CDCTemplateFieldCaption.SETRANGE(Type,CDCTemplateFieldCaption.Type::Line);
      IF NOT CDCTemplateFieldCaption.FINDFIRST THEN
        ERROR(TrainCaptionFirstForField,SelectedField.Code);

      // Find the value of the selected field
      GetSelectedFieldValue(TempDocumentLine, SelectedFieldDocumentValue,SelectedField);

      ResetField(SelectedField);

      IF (SelectedFieldDocumentValue.Right - SelectedFieldDocumentValue.Left) > 0 THEN BEGIN
        DocumentPage.GET(TempDocumentLine."Document No.",TempDocumentLine."Page No.");
        SelectedField."ALR Typical Value Field Width" := ROUND((SelectedFieldDocumentValue.Right - SelectedFieldDocumentValue.Left)
                                                               / CaptureEngine.GetDPIFactor(150,DocumentPage."TIFF Image Resolution"),1);
      END;

      IF (SelectedFieldDocumentValue.Top <> 0) AND (CDCTemplateFieldCaption.Top <> 0) AND (SelectedFieldDocumentValue.Left <> 0) AND (CDCTemplateFieldCaption.Left <> 0) THEN BEGIN
          SelectedField."ALR Value Caption Offset X" := SelectedFieldDocumentValue.Left - CDCTemplateFieldCaption.Left;
          SelectedField."ALR Value Caption Offset Y" := SelectedFieldDocumentValue.Top - CDCTemplateFieldCaption.Top;
      END;

      SelectedField."Caption Mandatory" := TRUE;

      // Setup field for field search by caption
      SelectedField."Advanced Line Recognition Type" := SelectedField."Advanced Line Recognition Type"::FindFieldByCaptionInPosition;

      IF SelectedFieldDocumentValue.Top < LineIdentFieldDocumentValue.Top THEN
        SelectedField."Field value position" := SelectedField."Field value position"::AboveStandardLine
      ELSE
        SelectedField."Field value position" := SelectedField."Field value position"::BelowStandardLine;

      IF SelectedField.MODIFY(TRUE) THEN BEGIN;
        SetTemplateToALRProcessing(TempDocumentLine."Template No.");
        MESSAGE(FieldIsCapturedByCaption,SelectedField."Field Name");
      END ELSE
        MESSAGE(ErrorDuringFieldSetup);
    END;

    [LineStart(1512)]
    PROCEDURE ResetFieldFromMenu@1(VAR TempDocumentLine@1001 : Record 6085596);
    VAR
      FieldToReset@1000 : Record 6085580;
    BEGIN
      IF SelectField(FieldToReset,TempDocumentLine."Template No.",'',TRUE) THEN BEGIN
        ResetField(FieldToReset);
        FieldToReset.MODIFY(TRUE);
      END;
    END;

    [LineStart(1518)]
    LOCAL PROCEDURE ResetField@1000000004(VAR TemplateField@1000000000 : Record 6085580);
    BEGIN
      // Reset the current field to default values
      TemplateField."Search for Value" := FALSE;
      TemplateField.Required := FALSE;
      CLEAR(TemplateField."Advanced Line Recognition Type");
      CLEAR(TemplateField."Linked Field");
      CLEAR(TemplateField."Offset Top");
      CLEAR(TemplateField."Offset Bottom");
      CLEAR(TemplateField."Offset Left");
      CLEAR(TemplateField."Offset Right");
      CLEAR(TemplateField."Field value position");
      CLEAR(TemplateField."Field value search direction");
      CLEAR(TemplateField.Sorting);
      CLEAR(TemplateField."Replacement Field");
      CLEAR(TemplateField."Replacement Field Type");
      CLEAR(TemplateField."Copy Value from Previous Value");
      CLEAR(TemplateField."ALR Typical Value Field Width");
      CLEAR(TemplateField."Typical Field Height");
      CLEAR(TemplateField."Caption Mandatory");
      CLEAR(TemplateField."ALR Value Caption Offset X");
      CLEAR(TemplateField."ALR Value Caption Offset Y");
    END;

    [LineStart(1540)]
    LOCAL PROCEDURE SelectField@1113400002(VAR TemplateField@1000000000 : Record 6085580;TemplateNo@1113400001 : Code[20];ExcludedFieldsFilter@1113400000 : Text[250];ALROnlyFields@1160040000 : Boolean) : Boolean;
    VAR
      lTemplateFieldList@1000000003 : Page 6085602;
    BEGIN
      TemplateField.SETRANGE("Template No.",TemplateNo);
      TemplateField.SETRANGE(Type,TemplateField.Type::Line);

      IF ExcludedFieldsFilter <> '' THEN
        TemplateField.SETFILTER(Code,'<>%1',ExcludedFieldsFilter);

      IF ALROnlyFields THEN BEGIN
        TemplateField.SETFILTER("Advanced Line Recognition Type",'<>%1',TemplateField."Advanced Line Recognition Type"::Default);
        IF TemplateField.ISEMPTY THEN
          ERROR(NoALRFieldsForReset);
      END;

      lTemplateFieldList.SETTABLEVIEW(TemplateField);
      lTemplateFieldList.LOOKUPMODE(TRUE);
      IF lTemplateFieldList.RUNMODAL = ACTION::LookupOK THEN BEGIN
        lTemplateFieldList.GETRECORD(TemplateField);
        EXIT(TRUE);
      END;
    END;

    [LineStart(1560)]
    PROCEDURE SetTemplateToALRProcessing@1113400005(TemplateNo@1113400000 : Code[20]);
    VAR
      lTemplate@1113400001 : Record 6085579;
    BEGIN
      // Change Codeunit ID to the advanced line recognition codeunit on template
      IF lTemplate.GET(TemplateNo) THEN BEGIN
        lTemplate.VALIDATE("Codeunit ID: Line Capture",GetAdvLineRecCodeunit());
        lTemplate.MODIFY(TRUE);
      END;
    END;

    [LineStart(1567)]
    LOCAL PROCEDURE GetAdvLineRecCodeunit@1000000000() : Integer;
    VAR
      Object@1000000000 : Record 2000000001;
      AllObjWithCaption@1160040001 : Record 2000000058;
      ObjectList@1160040000 : Page 6086055;
    BEGIN
      Object.SETRANGE(Type,Object.Type::Codeunit);
      Object.SETRANGE(Name,'Adv. Purch/Sales Line Capture');
      IF NOT Object.ISEMPTY THEN BEGIN
        IF Object.FINDSET THEN BEGIN
          EXIT(Object.ID);
        END;
      END ELSE BEGIN
        ObjectList.LOOKUPMODE(TRUE);
        IF ObjectList.RUNMODAL = ACTION::LookupOK THEN BEGIN
          ObjectList.GETRECORD(AllObjWithCaption);
          EXIT(AllObjWithCaption."Object ID");
        END;

        ERROR(CodeunitDoesNotExist,'Adv. Purch/Sales Line Capture');
      END;
    END;

    [LineStart(1584)]
    LOCAL PROCEDURE GetLineIdentifierValue@1000000002(VAR TempDocumentLine@1160040000 : Record 6085596;VAR LineIdentFieldDocumentValue@1000000000 : Record 6085593);
    VAR
      LineIdentField@1000000003 : Record 6085580;
      LineIdentFieldFound@1000000004 : Boolean;
    BEGIN
      WITH LineIdentField DO BEGIN
        SETRANGE("Template No.",TempDocumentLine."Template No.");
        SETRANGE(Type,Type::Line);
        SETRANGE(Required,TRUE);
        SETRANGE("Advanced Line Recognition Type","Advanced Line Recognition Type"::Default);
        IF FINDSET THEN
          REPEAT
            //IF LineIdentFieldDocumentValue.GET(TempDocumentLine."Document No.",TRUE,LineIdentField.Code,1) THEN
            IF LineIdentFieldDocumentValue.GET(TempDocumentLine."Document No.",TRUE,LineIdentField.Code,TempDocumentLine."Line No.") THEN
              IF (LineIdentFieldDocumentValue."Template No." = TempDocumentLine."Template No.") AND
                 (LineIdentFieldDocumentValue.Type = LineIdentFieldDocumentValue.Type::Line)
              THEN
                LineIdentFieldFound := TRUE;
          UNTIL (NEXT = 0) OR LineIdentFieldFound;
      END;

      IF NOT LineIdentFieldFound THEN
        ERROR(NoRequiredFieldFound);
    END;

    [LineStart(1604)]
    LOCAL PROCEDURE GetSelectedFieldValue@1000000007(VAR TempDocumentLine@1160040000 : Record 6085596;VAR SelectedFieldDocumentValue@1000000000 : Record 6085593;SelectedField@1000000001 : Record 6085580);
    BEGIN
      SelectedFieldDocumentValue.SETRANGE("Document No.",TempDocumentLine."Document No.");
      SelectedFieldDocumentValue.SETRANGE("Is Value",TRUE);
      SelectedFieldDocumentValue.SETRANGE(Code,SelectedField.Code);
      //SelectedFieldDocumentValue.SETRANGE("Line No.",0,1);
      SelectedFieldDocumentValue.SETRANGE("Line No.",TempDocumentLine."Line No.");
      SelectedFieldDocumentValue.SETRANGE(Type,SelectedFieldDocumentValue.Type::Line);
      SelectedFieldDocumentValue.SETRANGE("Is Valid",TRUE);
      SelectedFieldDocumentValue.SETRANGE("Template No.",TempDocumentLine."Template No.");
      IF NOT SelectedFieldDocumentValue.FINDFIRST THEN
        ERROR(MissingFieldExampleValue,SelectedField."Field Name",SelectedField.Code);  //value is mandatory
    END;

    [LineStart(1616)]
    LOCAL PROCEDURE UpdateExecutionSequence@1000000001(VAR LinkedField@1000000000 : Record 6085580;PreviousFieldCode@1000000001 : Code[20]);
    VAR
      CurrField@1000000002 : Record 6085580;
      PrevField@1000000003 : Record 6085580;
      SortField@1000000004 : Record 6085580;
    BEGIN
      IF NOT PrevField.GET(LinkedField."Template No.",PrevField.Type::Line,PreviousFieldCode) THEN
        EXIT;

      IF LinkedField.Sorting <= PrevField.Sorting  THEN BEGIN
        SortField.SETRANGE("Template No.",LinkedField."Template No.");
        SortField.SETRANGE(Type,SortField.Type::Line);
        SortField.SETFILTER(Code,'<>%1',LinkedField.Code);
        SortField.SETFILTER(Sorting, '>=%1',LinkedField.Sorting  + 1);
        IF SortField.FINDSET THEN
          REPEAT
            SortField.Sorting := SortField.Sorting  + 1;
            SortField.MODIFY;
          UNTIL SortField.NEXT = 0;
        LinkedField.Sorting := LinkedField.Sorting + 1;
      END;
    END;

    [LineStart(1633)]
    PROCEDURE ShowVersionNo@1160040000() : Text;
    VAR
      VersionTriggers@1160040000 : Codeunit 2000000001;
      ApplicationVersion@1160040001 : Text;
      ApplicationBuild@1160040002 : Text;
    BEGIN
      //EXIT(14) //=> for older NAV/BC Versions without the version triggers
      VersionTriggers.GetApplicationVersion(ApplicationVersion);
      VersionTriggers.GetApplicationBuild(ApplicationBuild);

      MESSAGE(STRSUBSTNO(ALRVersionNoText,'15',ApplicationVersion,ApplicationBuild));
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 61001 Adv. Purch/Sales Line Capture
{
  OBJECT-PROPERTIES
  {
    Date=01/05/22;
    Time=10:24:12 PM;
    Modified=Yes;
    Version List=ALR1.15;
  }
  PROPERTIES
  {
    TableNo=6085590;
    OnRun=VAR
            CDCTemplate@1000 : Record 6085579;
          BEGIN
            //Reset template to standard line capture as we can now use an event
            IF NOT CDCTemplate.GET(Rec."Template No.") THEN
                EXIT;

            CDCTemplate."Codeunit ID: Line Capture" := 6085716;
            CDCTemplate.MODIFY(TRUE);

            CODEUNIT.RUN(CDCTemplate."Codeunit ID: Line Capture", Rec);
          END;

  }
  CODE
  {
    VAR
      CaptureMgt@1160040001 : Codeunit 6085576;
      LineManagementSI@100000001 : Codeunit 61003;
      DocumentComment@1000000000 : Record 6085594;
      TempMandatoryField@1000000002 : TEMPORARY Record 6085595;
      UseBufferWordsEvent@100000000 : Boolean;
      NoMandatoryFieldsFoundLbl@1000 : TextConst 'ENU=You cannot use the advanced line recognition option %1 when the template does not have at least one line field marked as required!';

    [EventSubscriber(Codeunit,6085703,OnAfterFullCapture)]
    [LineStart(1650)]
    LOCAL PROCEDURE CDCPurchFullCapture_OnAfterFullCapture@4(VAR Document@1000 : Record 6085590);
    BEGIN
      FindAllPONumbersInDocument(Document);
    END;

    [EventSubscriber(Codeunit,6085575,OnBeforeRunLineCaptureCodeunit)]
    [LineStart(1653)]
    LOCAL PROCEDURE CDCCaptureEngine_OnBeforeRunLineCaptureCodeunit@1000000000(VAR Document@1000 : Record 6085590;VAR Handled@1001 : Boolean);
    VAR
      TempDocLine@1000000001 : TEMPORARY Record 6085596;
      TemplateField@1000000000 : Record 6085580;
      TempSortedDocumentField@1113400000 : TEMPORARY Record 6085595;
      CDCTemplate@1002 : Record 6085579;
    BEGIN
      CleanupPrevValues(Document);

      IF NOT CDCTemplate.GET(Document."Template No.") THEN
        EXIT;

      //RUN STANDARD LINE CAPTURING CODEUNIT
      IF (CDCTemplate."Codeunit ID: Line Capture" <> 0) THEN
        CODEUNIT.RUN(CDCTemplate."Codeunit ID: Line Capture", Document);

      OnAfterStandardLineRecognition(Document, Handled);
      IF Handled THEN
        EXIT;

      //BUILD TEMPORARY LINE TABLE AND LOOP LINES
      Document.BuildTempLinesTable(TempDocLine);

      IF TempDocLine.FINDSET THEN BEGIN
        FillSortedFieldBuffer(TempSortedDocumentField, TempMandatoryField, TempDocLine);
        REPEAT
          TempSortedDocumentField.SETCURRENTKEY("Document No.","Sort Order");
          IF TempSortedDocumentField.FINDFIRST THEN
            REPEAT
              WITH TemplateField DO BEGIN
                GET(TempDocLine."Template No.",TemplateField.Type::Line,TempSortedDocumentField."Field Code");
                CASE "Advanced Line Recognition Type" OF
                  "Advanced Line Recognition Type"::LinkedToAnchorField: FindValueFromOffsetField(TempDocLine,TemplateField);
                  "Advanced Line Recognition Type"::FindFieldByCaptionInPosition: FindValueByCaptionInPosition(TempDocLine,TemplateField,Document);
                  "Advanced Line Recognition Type"::FindFieldByColumnHeading: FindFieldByColumnHeading(TempDocLine,TemplateField,Document);
                END;
              END;
          UNTIL TempSortedDocumentField.NEXT = 0;

          FindSubstitutionFieldValue(TempDocLine);

          GetValueFromPreviousValue(TempDocLine);
        UNTIL TempDocLine.NEXT = 0;

        CleanupTempValues(Document);
      END;
      Handled := TRUE;
    END;

    [LineStart(1695)]
    LOCAL PROCEDURE FindValueFromOffsetField@1210050000(TempDocLine@1210050009 : TEMPORARY Record 6085596;VAR OffsetField@1000000001 : Record 6085580);
    VAR
      OffsetSourceField@1113400000 : Record 6085580;
      OffsetSourceFieldValue@1113400001 : Record 6085593;
      DocumentValue@1113400002 : Record 6085593;
      CurrPage@1210050003 : Record 6085591;
      CurrTop@1000000002 : Integer;
      CurrLeft@1000000003 : Integer;
      CurrBottom@1000000004 : Integer;
      CurrRight@1000000005 : Integer;
    BEGIN
      //This function will capture the field value based on the offset/distance of a source field value

      //Get Line Identification Field Position
      IF NOT OffsetSourceField.GET(TempDocLine."Template No.",OffsetSourceField.Type::Line,OffsetField."Linked Field") THEN
        EXIT;

      // Get current value record of offset source field
      IF NOT OffsetSourceFieldValue.GET(TempDocLine."Document No.",TRUE,OffsetSourceField.Code,TempDocLine."Line No.") THEN
        EXIT;

      IF NOT CurrPage.GET(TempDocLine."Document No.",OffsetSourceFieldValue."Page No.") THEN
        EXIT;

      WITH OffsetSourceFieldValue DO BEGIN
        // Create offset area for value capturing
        CurrTop := Top + OffsetField."Offset Top";
        CurrLeft := Left + OffsetField."Offset Left";
        CurrBottom := CurrTop + OffsetField."Offset Bottom";
        CurrRight := CurrLeft + OffsetField."Offset Right";
        CaptureMgt.CaptureFromPos(CurrPage,OffsetField,TempDocLine."Line No.",TRUE,CurrTop,CurrLeft,CurrBottom,CurrRight,DocumentValue);
        IF DocumentValue.GET(TempDocLine."Document No.",TRUE,OffsetField.Code,TempDocLine."Line No.") THEN
          IF ((DocumentValue."Value (Text)" = '') AND (DocumentValue."Value (Decimal)" = 0)) OR (NOT DocumentValue."Is Valid" )THEN
            DocumentValue.DELETE;
      END;
    END;

    [LineStart(1721)]
    LOCAL PROCEDURE FindValueByCaptionInPosition@1113400000(VAR TempDocLine@1210050009 : TEMPORARY Record 6085596;VAR CurrField@1000000001 : Record 6085580;Document@1000 : Record 6085590) : Boolean;
    VAR
      DocumentValue@1113400000 : Record 6085593;
      DocumentValueCopy@1113400004 : Record 6085593;
      lCurrPage@1113400009 : Record 6085591;
      CaptureEngine@1113400002 : Codeunit 6085575;
      Word@1113400003 : Text[1024];
      FromTopPos@1113400008 : Integer;
      FromTopPage@1113400007 : Integer;
      ToBottomPos@1113400006 : Integer;
      ToBottomPage@1113400005 : Integer;
      i@1113400010 : Integer;
    BEGIN
      // We cannot proceed if there is no line field in the template defined as required=true
      IF TempMandatoryField.COUNT = 0 THEN
        ERROR(NoMandatoryFieldsFoundLbl, CurrField."Advanced Line Recognition Type");
      //This function will capture the field value based on the caption(s) in the area between the previous and next
      IF NOT Document.GET(TempDocLine."Document No.") THEN
        EXIT;

      //Delete current value
      IF DocumentValue.GET(TempDocLine."Document No.",TRUE,CurrField.Code,TempDocLine."Line No.") THEN
        DocumentValue.DELETE;

      CLEAR(Word);

      // Get valid range depended of search direction
      // 1. above the standard recognized line: range is between standard standard line and previous line
      // 2. below the standard recognized line: range is between standard standard line and next line
      IF (CurrField."Field value position" = CurrField."Field value position"::AboveStandardLine) THEN
        GetRangeToPrevLine(Document,TempDocLine,FromTopPage,FromTopPos,ToBottomPage,ToBottomPos)
      ELSE
        GetRangeToNextLine(Document,TempDocLine,FromTopPage,FromTopPos,ToBottomPage,ToBottomPos);

      IF (FromTopPage > 0) AND (ToBottomPage > 0) THEN
        FOR i := FromTopPage TO ToBottomPage DO BEGIN
          IF NOT lCurrPage.GET(Document."No.",i) THEN
            EXIT;

          CurrField."Caption Offset X" := CurrField."ALR Value Caption Offset X";
          CurrField."Caption Offset Y" := CurrField."ALR Value Caption Offset Y";
          CurrField."Typical Field Width" := CurrField."ALR Typical Value Field Width";

          //UseBufferWordsEvent := TRUE;
          IF i < ToBottomPage THEN BEGIN
            LineManagementSI.SetLineRegion(TempDocLine."Document No.",i,FromTopPos,i,lCurrPage."Bottom Word Pos.")
          END ELSE BEGIN
            IF (i > FromTopPage) AND (i < ToBottomPage) THEN BEGIN
              LineManagementSI.SetLineRegion(TempDocLine."Document No.",i,0,i,lCurrPage."Bottom Word Pos.")
            END ELSE BEGIN
              IF FromTopPos > ToBottomPos THEN BEGIN
                LineManagementSI.SetLineRegion(TempDocLine."Document No.",i,0,i,ToBottomPos)
              END ELSE BEGIN
                LineManagementSI.SetLineRegion(TempDocLine."Document No.",i,FromTopPos,i,ToBottomPos);
              END;
            END;
          END;

          Word := CaptureEngine.CaptureField(Document,lCurrPage."Page No.",CurrField,FALSE);

          IF Word <> '' THEN BEGIN
            IF (DocumentValue.GET(Document."No.",TRUE,CurrField.Code,0)) THEN BEGIN
              DocumentValueCopy := DocumentValue;
              DocumentValueCopy."Line No." := TempDocLine."Line No.";
              DocumentValueCopy.Type := DocumentValueCopy.Type::Line;
              DocumentValueCopy.INSERT;
              DocumentValue.DELETE;
            END;
            CaptureMgt.UpdateFieldValue(Document."No.",TempDocLine."Page No.",TempDocLine."Line No.",CurrField,Word,FALSE,FALSE);

            EXIT(TRUE);
          END;
        END;
    END;

    [LineStart(1783)]
    LOCAL PROCEDURE FindFieldByColumnHeading@1113400001(VAR TempDocLine@1210050009 : TEMPORARY Record 6085596;VAR CurrField@1000000001 : Record 6085580;Document@1000 : Record 6085590);
    VAR
      Template@1113400021 : Record 6085579;
      DocumentValue@1113400000 : Record 6085593;
      DocumentValueBuffer@1000000002 : TEMPORARY Record 6085593;
      DocumentValueNew@1113400022 : Record 6085593;
      CaptionStartWord@1113400004 : ARRAY [100] OF Record 6085592;
      CaptionEndWord@1113400003 : ARRAY [100] OF Record 6085592;
      CaptionPage@1113400005 : Record 6085591;
      CurrPage@1113400017 : Record 6085591;
      CaptionValue@1113400006 : Record 6085593;
      CaptionPageNo@1113400001 : Integer;
      CaptionFound@1113400002 : Boolean;
      PageStop@1113400016 : Boolean;
      FromTopPos@1113400010 : Integer;
      FromTopPage@1113400009 : Integer;
      ToBottomPos@1113400008 : Integer;
      ToBottomPage@1113400007 : Integer;
      NewBottom@1113400011 : Integer;
      LineNo@1113400012 : Integer;
      LineHeight@1113400013 : Integer;
      Top@1113400014 : Integer;
      Bottom@1113400015 : Integer;
      Right@1113400018 : Integer;
      FieldLeft@1113400019 : Integer;
      FieldWidth@1113400020 : Integer;
      LastFoundLineNo@1000000000 : Integer;
    BEGIN
      // We cannot proceed if there is no line field in the template defined as required=true
              IF TempMandatoryField.COUNT = 0 THEN
                  ERROR(NoMandatoryFieldsFoundLbl, CurrField."Advanced Line Recognition Type");

      //This function will capture the field value based on a column heading, actualy like the default line recognition but filtered on the area between the prev. and next line

      IF NOT Template.GET(TempDocLine."Template No.")THEN
        EXIT;

      // Delete old values
      IF DocumentValue.GET(TempDocLine."Document No.",TRUE,CurrField.Code,TempDocLine."Line No.") THEN
        DocumentValue.DELETE;

      // Find the Caption position on current or previous pages
      CaptionPageNo := TempDocLine."Page No.";
      REPEAT
        CaptionFound := GetStartAndEndCaption(CaptionStartWord,CaptionEndWord,CurrField,TempDocLine."Document No.",CaptionPageNo);
        IF NOT CaptionFound THEN
          CaptionPageNo -= 1;
      UNTIL (CaptionPageNo = 0) OR CaptionFound;

      IF (NOT CaptionFound) THEN
        EXIT;

      IF NOT CaptionPage.GET(TempDocLine."Document No.",CaptionPageNo) THEN
        EXIT;

      GetPositionOfCaption(CaptionPage,CurrField,CaptionStartWord[1],CaptionEndWord[1],CaptionValue,FieldLeft,FieldWidth,Bottom,Top);

      // Get position of next or previous line
      IF CurrField."Field value position" = CurrField."Field value position"::AboveStandardLine THEN BEGIN
        GetRangeToPrevLine(Document,TempDocLine,FromTopPage,FromTopPos,ToBottomPage,ToBottomPos);
        IF FromTopPos > Top THEN
          Top := FromTopPos;
      END ELSE BEGIN
        GetRangeToNextLine(Document,TempDocLine,FromTopPage,FromTopPos,ToBottomPage,ToBottomPos);
        Top := FromTopPos;
      END;

      NewBottom := 0;
      LineNo := 1000 * TempDocLine."Page No.";
      LineHeight := 12;


      Bottom := Top + LineHeight;

      PageStop := FALSE;
      IF NOT CurrPage.GET(TempDocLine."Document No.",FromTopPage) THEN
        EXIT;

      REPEAT
        LineNo += 1;
        Right := FieldLeft + FieldWidth;
        NewBottom := CaptureTableCell(Template,Document,CurrPage,CurrField,LineNo,Top,FieldLeft,Bottom,Right);
        IF NewBottom > 0 THEN BEGIN
          IF NewBottom > Bottom THEN
            Bottom := NewBottom;

          IF NOT IsFieldValid(CurrField,Document,LineNo)  THEN BEGIN
            DocumentValue.RESET;
            DocumentValue.SETRANGE("Document No.",Document."No.");
            DocumentValue.SETRANGE("Line No.",LineNo);
            DocumentValue.DELETEALL(TRUE);
          END ELSE BEGIN
            //PageStop := TRUE;
            LastFoundLineNo := LineNo;
            PageStop := (CurrField."Field value search direction" = CurrField."Field value search direction"::Downwards);
            IF DocumentValue.GET(TempDocLine."Document No.",TRUE,CurrField.Code,LastFoundLineNo) THEN BEGIN
              DocumentValueBuffer := DocumentValue;
              DocumentValueBuffer.INSERT;
              DocumentValue.DELETE;
            END;
          END;
        END;

        IF NOT PageStop THEN BEGIN
          Top := Bottom;
          Bottom := Top + LineHeight;

          IF (Bottom > CurrPage."Bottom Word Pos.") AND (CurrPage."Page No." < ToBottomPage) THEN BEGIN
            //New page - some variables must be reset
            IF CurrPage.GET(CurrPage."Document No.",CurrPage."Page No." + 1) THEN BEGIN
              CaptionPageNo  := CurrPage."Page No.";
              LineNo := 1000 * CurrPage."Page No.";
              IF GetStartAndEndCaption(CaptionStartWord,CaptionEndWord,CurrField,TempDocLine."Document No.",CaptionPageNo) THEN
                IF CaptionPage.GET(TempDocLine."Document No.",CurrPage."Page No.") THEN
                  IF GetPositionOfCaption(CaptionPage,CurrField,CaptionStartWord[1],CaptionEndWord[1],CaptionValue,FieldLeft,FieldWidth,Bottom,Top) THEN
                    Bottom := Top + LineHeight;
            END;
          END ELSE
            IF (Bottom > CurrPage."Bottom Word Pos.") OR ((Bottom > ToBottomPos) AND (CurrPage."Page No." = ToBottomPage)) THEN
              PageStop := TRUE;
        END;
      UNTIL PageStop;

      //Zeilennr. speichern
      IF DocumentValueBuffer.GET(TempDocLine."Document No.",TRUE,CurrField.Code,LastFoundLineNo) THEN BEGIN
        DocumentValueNew := DocumentValueBuffer;
        DocumentValueNew."Line No." := TempDocLine."Line No.";
        DocumentValueNew.INSERT;
        DocumentValueBuffer.DELETE;
        CaptureMgt.UpdateFieldValue(TempDocLine."Document No.",TempDocLine."Page No.",TempDocLine."Line No.",CurrField,DocumentValueNew."Value (Text)",FALSE,FALSE);
      END;
    END;

    [LineStart(1888)]
    LOCAL PROCEDURE FindSubstitutionFieldValue@1113400007(VAR TempDocLine@1000000001 : TEMPORARY Record 6085596);
    VAR
      TemplateField@1000000000 : Record 6085580;
      DocumentValue@1113400002 : Record 6085593;
      SubstitutionDocumentValue@1000000002 : Record 6085593;
      SubstitutionField@1113400003 : Record 6085580;
    BEGIN
      // Function goes through all field, setted up with substitution fields.
      // It checks if the value of the current field is empty and updates the value with the value of the substitution field (if exists).
      TemplateField.SETRANGE("Template No.",TempDocLine."Template No.");
      TemplateField.SETRANGE(Type, TemplateField.Type::Line);
      TemplateField.SETFILTER("Replacement Field",'<>%1','');
      IF TemplateField.ISEMPTY THEN
        EXIT;

        TemplateField.FINDSET;
        REPEAT
          IF NOT DocumentValue.GET(TempDocLine."Document No.",TRUE,TemplateField.Code,TempDocLine."Line No.") THEN
            IF SubstitutionField.GET(TempDocLine."Template No.",TemplateField."Replacement Field Type",TemplateField."Replacement Field") THEN
              IF SubstitutionDocumentValue.GET(TempDocLine."Document No.",TRUE,SubstitutionField.Code,TempDocLine."Line No.") THEN BEGIN
                CaptureMgt.UpdateFieldValue(TempDocLine."Document No.",TempDocLine."Page No.",TempDocLine."Line No.",TemplateField,SubstitutionDocumentValue."Value (Text)",FALSE,FALSE);
                IF DocumentValue.GET(TempDocLine."Document No.",TRUE,TemplateField.Code,TempDocLine."Line No.") THEN BEGIN
                  DocumentValue.Top := SubstitutionDocumentValue.Top;
                  DocumentValue.Bottom := SubstitutionDocumentValue.Bottom;
                  DocumentValue.Left := SubstitutionDocumentValue.Left;
                  DocumentValue.Right := SubstitutionDocumentValue.Right;
                  DocumentValue.MODIFY;
                END;
              END;
        UNTIL TemplateField.NEXT = 0;
    END;

    [LineStart(1913)]
    LOCAL PROCEDURE FindAllPONumbersInDocument@100000008(VAR DCDocument@100000000 : Record 6085590);
    VAR
      DocumentWord@100000002 : Record 6085592;
      PurchaseHeader@100000003 : Record 38;
      PurchaseHeaderBuffer@100000004 : TEMPORARY Record 38;
      Template@1001 : Record 6085579;
      TemplateField@100000006 : Record 6085580;
      DocumentValue@100000008 : Record 6085593;
      PurchasesPayablesSetup@100000001 : Record 312;
      NoSeries@100000009 : Record 308;
      NoSeriesLine@100000010 : Record 309;
      CDCModuleLicense@1000 : Codeunit 6086008;
      CaptureMgt@100000007 : Codeunit 6085576;
      FilterString@100000011 : Text;
      FoundPurchaseOrders@100000005 : Text;
      Pos@100000012 : Integer;
    BEGIN
      IF NOT CDCModuleLicense.IsMatchingActivated(TRUE) THEN
        EXIT;

      IF NOT Template.GET(DCDocument."Template No.") THEN
        EXIT;

      IF NOT Template."Autom. PO search" THEN
        EXIT;

      // Get order no. field first.
      IF NOT TemplateField.GET(DCDocument."Template No.",TemplateField.Type::Header,'OURDOCNO') THEN
        EXIT;

      DocumentWord.SETRANGE("Document No.",DCDocument."No.");

      // Create appropriate Filter string from Purchase Setup >>>
      PurchasesPayablesSetup.GET;
      NoSeries.GET(PurchasesPayablesSetup."Order Nos.");
      NoSeriesLine.SETRANGE("Series Code",NoSeries.Code);
      NoSeriesLine.SETFILTER("Starting Date",'%1|>=%2',0D,TODAY);
      NoSeriesLine.SETRANGE(Open,TRUE);
      IF NoSeriesLine.FINDFIRST THEN BEGIN
        Pos := 1;

        WHILE (Pos <= STRLEN(NoSeriesLine."Starting No.")) DO BEGIN
          IF NoSeriesLine."Starting No."[Pos] IN ['0'..'9'] THEN
            FilterString += '?'
          ELSE
            FilterString += FORMAT(NoSeriesLine."Starting No."[Pos]);
          Pos += 1;
        END;
      END;

      // Iterate through Document Word table and filter for our PO number filter string
      DocumentWord.SETFILTER(Word,FilterString);
      IF DocumentWord.FINDSET THEN
        REPEAT
          // Check if there is a PO in the system with the matched word
          IF PurchaseHeader.GET(PurchaseHeader."Document Type"::Order,UPPERCASE(DocumentWord.Word)) THEN BEGIN
            // Check if the number exists in the temp. PO buffer
            IF NOT PurchaseHeaderBuffer.GET(PurchaseHeader."Document Type",PurchaseHeader."No.") THEN BEGIN
              PurchaseHeaderBuffer := PurchaseHeader;
              PurchaseHeaderBuffer.INSERT;
            END;
          END;
        UNTIL DocumentWord.NEXT=0;

      // Iterate through all found PO's and create the string, that can be used for order matching
      IF PurchaseHeaderBuffer.FINDFIRST THEN
        REPEAT
          IF (STRLEN(FoundPurchaseOrders) + STRLEN(PurchaseHeaderBuffer."No.") + 1) <= MAXSTRLEN(DocumentValue."Value (Text)") THEN BEGIN
            IF (STRLEN(FoundPurchaseOrders) > 0) THEN
                FoundPurchaseOrders += ',';
              FoundPurchaseOrders += PurchaseHeaderBuffer."No.";
          END;
        UNTIL PurchaseHeaderBuffer.NEXT = 0;

        TemplateField.GET(DCDocument."Template No.",TemplateField.Type::Header,'OURDOCNO');
        CaptureMgt.UpdateFieldValue(DCDocument."No.",0,0,TemplateField,FoundPurchaseOrders,FALSE,FALSE);
    END;

    [LineStart(1974)]
    LOCAL PROCEDURE GetValueFromPreviousValue@1000000004(VAR TempDocLine@1000000001 : TEMPORARY Record 6085596);
    VAR
      TemplateField@1000000000 : Record 6085580;
      DocumentValue@1113400002 : Record 6085593;
    BEGIN
      // Function goes through all field, setted up with substitution fields.
      // It checks if the value of the current field is empty and updates the value with the value of the substitution field (if exists).
      TemplateField.SETRANGE("Template No.",TempDocLine."Template No.");
      TemplateField.SETRANGE("Copy Value from Previous Value",TRUE);
      IF TemplateField.FINDSET THEN
        REPEAT
          IF NOT DocumentValue.GET(TempDocLine."Document No.",TRUE,TemplateField.Code,TempDocLine."Line No.") THEN
            IF DocumentValue.GET(TempDocLine."Document No.",TRUE,TemplateField.Code,TempDocLine."Line No."-1) THEN
              CaptureMgt.UpdateFieldValue(TempDocLine."Document No.",TempDocLine."Page No.",TempDocLine."Line No.",TemplateField,DocumentValue."Value (Text)",FALSE,FALSE);
        UNTIL TemplateField.NEXT = 0;
    END;

    [LineStart(1986)]
    LOCAL PROCEDURE GetRangeToNextLine@1113400002(Document@1000 : Record 6085590;VAR TempDocLine@1000000000 : Record 6085596;VAR SearchFromPage@1113400002 : Integer;VAR SearchFromPos@1113400003 : Integer;VAR SearchToPage@1113400000 : Integer;VAR SearchToPos@1113400001 : Integer);
    VAR
      DocumentValue@1000000001 : Record 6085593;
      CurrPage@1113400004 : Record 6085591;
      StopPos@1000000002 : ARRAY [100] OF Integer;
    BEGIN
      // This function calculates the range until the next position/line
      CLEAR(SearchFromPage);
      CLEAR(SearchFromPos);
      CLEAR(SearchToPage);
      CLEAR(SearchToPos);


      DocumentValue.SETCURRENTKEY("Document No.","Is Value",Code,"Line No.");
      DocumentValue.SETRANGE("Document No.",TempDocLine."Document No.");
      DocumentValue.SETRANGE("Is Value",TRUE);
      DocumentValue.SETRANGE(Type,DocumentValue.Type::Line);
      DocumentValue.SETFILTER("Page No.", '>%1',0);

      GetCurrLinePosition(DocumentValue,TempDocLine."Line No.",SearchFromPage, SearchFromPos, SearchToPage, SearchToPos);

      // Filter for next line
      DocumentValue.SETRANGE("Line No.",TempDocLine."Line No." + 1);
      IF DocumentValue.FINDSET THEN BEGIN
        REPEAT
          IF (SearchToPage < DocumentValue."Page No.") OR (SearchToPage = 0)  THEN BEGIN
            SearchToPage := DocumentValue."Page No.";
            SearchToPos := 0;
          END;

          IF SearchToPage = DocumentValue."Page No." THEN BEGIN
            IF (SearchToPos < DocumentValue.Bottom) OR (SearchToPos = 0) THEN
                SearchToPos := DocumentValue.Bottom ;
          END;
        UNTIL DocumentValue.NEXT = 0;
      END ELSE BEGIN
        // As there is no next line, calculate to next header value or bottom of current page
        DocumentValue.SETCURRENTKEY("Document No.","Is Value",Code,"Line No.");
        DocumentValue.SETRANGE("Document No.",TempDocLine."Document No.");
        DocumentValue.SETRANGE("Is Value",FALSE);
        DocumentValue.SETRANGE(Type,DocumentValue.Type::Header);
        DocumentValue.SETRANGE("Page No.",SearchToPage);
        DocumentValue.SETFILTER(Top,'>%1',SearchToPos);
        DocumentValue.SETRANGE("Line No.", 0);
        IF DocumentValue.FINDSET(FALSE,FALSE) THEN BEGIN
          IF DocumentValue."Page No." > SearchToPage THEN BEGIN
            SearchToPage := DocumentValue."Page No.";
          END;
          SearchToPos := DocumentValue.Top
        END ELSE BEGIN
          DocumentValue.SETFILTER("Page No.",'>%1',SearchToPage);
          DocumentValue.SETRANGE(Top);
          IF DocumentValue.FINDSET(FALSE,FALSE) THEN BEGIN
            IF DocumentValue."Page No." > SearchToPage THEN BEGIN
              SearchToPage := DocumentValue."Page No.";
            END;
            SearchToPos := DocumentValue.Top
          END ELSE
            IF CurrPage.GET(TempDocLine."Document No.",SearchToPage) THEN
              SearchToPos := CurrPage."Bottom Word Pos.";
        END;
      END;

      GetStopLineRecognitionPositions(StopPos,SearchToPage,SearchToPos,Document);
      IF (StopPos[SearchToPage]>0) AND (StopPos[SearchToPage] <= SearchToPos) THEN
        SearchToPos := StopPos[SearchToPage];
    END;

    [LineStart(2048)]
    LOCAL PROCEDURE GetRangeToPrevLine@1113400009(Document@1000 : Record 6085590;VAR TempDocLine@1000000000 : Record 6085596;VAR RangeTopPage@1113400002 : Integer;VAR RangeTopPos@1113400003 : Integer;VAR RangeBottomPage@1113400000 : Integer;VAR RangeBottomPos@1113400001 : Integer);
    VAR
      DocumentValue@1000000001 : Record 6085593;
      CurrLineTopPage@1113400008 : Integer;
      CurrLineTopPos@1113400007 : Integer;
      CurrLineBottomPage@1113400006 : Integer;
      CurrLineBottomPos@1113400005 : Integer;
      PrevLineTopPage@1113400012 : Integer;
      PrevLineTopPos@1113400011 : Integer;
      PrevLineBottomPage@1113400010 : Integer;
      PrevLineBottomPos@1113400009 : Integer;
    BEGIN
      // This function calculates the range until the previous position/line
      CLEAR(PrevLineTopPage);
      CLEAR(PrevLineTopPos);
      CLEAR(PrevLineBottomPage);
      CLEAR(PrevLineBottomPos);

      WITH DocumentValue DO BEGIN
        SETCURRENTKEY("Document No.","Is Value",Code,"Line No.");
        SETRANGE("Document No.",Document."No.");
        SETRANGE("Is Value",TRUE);
        SETRANGE(Type,Type::Line);
        SETFILTER("Page No.", '>%1',0);

        GetCurrLinePosition(DocumentValue,TempDocLine."Line No.",CurrLineTopPage,CurrLineTopPos,CurrLineBottomPage,CurrLineBottomPos);

        // Filter for Prev line
        SETRANGE("Line No.",TempDocLine."Line No." - 1);
        IF FINDSET THEN BEGIN
          REPEAT
            IF ("Page No." < PrevLineTopPage) OR (PrevLineTopPage = 0) THEN BEGIN
              PrevLineTopPage := "Page No.";
              CLEAR(PrevLineTopPos);
            END;

            IF ("Page No." > PrevLineBottomPage) OR (PrevLineBottomPage = 0)  THEN BEGIN
              PrevLineBottomPage := "Page No.";
              CLEAR(PrevLineBottomPos);
            END;

            IF PrevLineTopPage = "Page No." THEN
              IF (Top < PrevLineTopPos) OR (PrevLineTopPos = 0) THEN
                PrevLineTopPos := Top;

            IF PrevLineBottomPage = "Page No." THEN
              IF (Bottom > PrevLineBottomPos) OR (PrevLineBottomPos = 0) THEN
                 PrevLineBottomPos := Bottom ;
          UNTIL NEXT = 0;
        END ELSE BEGIN
          // As there is no Prev line, calculate to Prev header value or bottom of current page
          SETCURRENTKEY("Document No.","Is Value",Code,"Line No.");
          SETRANGE("Document No.",Document."No.");
          SETRANGE("Is Value",FALSE);
          SETRANGE(Type,Type::Header);
          SETFILTER("Page No.",'<=%1',"Page No.");
          SETFILTER(Top,'<%1',CurrLineTopPos);
          IF FINDSET(FALSE,FALSE) THEN BEGIN
            PrevLineBottomPos := Bottom;
            PrevLineBottomPage := "Page No.";
          END ELSE BEGIN
            PrevLineBottomPos  := 0;
            PrevLineBottomPage := CurrLineTopPage;
          END;
        END;

        RangeTopPage := PrevLineBottomPage;
        RangeBottomPage := CurrLineTopPage;
        RangeTopPos := PrevLineBottomPos + 1;
        //RangeBottomPos := CurrLineTopPos - 1;
        RangeBottomPos := CurrLineBottomPos - 1;
      END;
    END;

    [LineStart(2110)]
    LOCAL PROCEDURE GetCurrLinePosition@1000000002(VAR DocumentValue@1000000000 : Record 6085593;LineNo@1000000001 : Integer;VAR CurrLineTopPage@1000000005 : Integer;VAR CurrLineTopPos@1000000004 : Integer;VAR CurrLineBottomPage@1000000003 : Integer;VAR CurrLineBottomPos@1000000002 : Integer);
    BEGIN
      WITH DocumentValue DO BEGIN
        // Filter for current line
        SETRANGE("Line No.",LineNo);
        IF FINDSET THEN
        REPEAT
          IF TempMandatoryField.GET(DocumentValue.GETFILTER("Document No."),Code) THEN BEGIN
            IF ("Page No." < CurrLineTopPage) OR (CurrLineTopPage = 0) THEN BEGIN
              CurrLineTopPage := "Page No.";
              CLEAR(CurrLineTopPos);
            END;

            IF ("Page No." > CurrLineBottomPage) OR (CurrLineBottomPage = 0)  THEN BEGIN
              CurrLineBottomPage := "Page No.";
              CLEAR(CurrLineBottomPos);
            END;

            IF CurrLineTopPage = "Page No." THEN
              IF (Top < CurrLineTopPos) OR (CurrLineTopPos = 0) THEN
                CurrLineTopPos := Top;

            IF CurrLineBottomPage = "Page No." THEN
              IF (Bottom > CurrLineBottomPos) OR (CurrLineBottomPos = 0) THEN
                CurrLineBottomPos := Bottom ;
          END;
        UNTIL NEXT = 0;
      END;
    END;

    [LineStart(2138)]
    LOCAL PROCEDURE GetStartAndEndCaption@1160040001(VAR CaptionStartWord@1160040002 : ARRAY [100] OF TEMPORARY Record 6085592;VAR CaptionEndWord@1160040001 : ARRAY [100] OF TEMPORARY Record 6085592;Field@1160040000 : Record 6085580;DocNo@1160040003 : Code[20];PageNo@1160040006 : Integer) : Boolean;
    VAR
      TemplateFieldCaption@1160040005 : Record 6085581;
      CaptureEngine@1160040004 : Codeunit 6085575;
      PrevCaptionStartWord@1113400000 : Record 6085592;
    BEGIN
      CLEAR(CaptionStartWord);
      CLEAR(CaptionEndWord);

      TemplateFieldCaption.SETRANGE("Template No.",Field."Template No.");
      TemplateFieldCaption.SETRANGE(Type,Field.Type);
      TemplateFieldCaption.SETRANGE(Code,Field.Code);
      IF TemplateFieldCaption.FINDSET THEN
        REPEAT
          IF CaptureEngine.FindCaption(DocNo,PageNo,Field,TemplateFieldCaption,CaptionStartWord,CaptionEndWord) THEN
            EXIT(TRUE);
        UNTIL (TemplateFieldCaption.NEXT = 0) OR ((CaptionStartWord[1].Word <> '') AND (CaptionEndWord[1].Word <> ''));
    END;

    [LineStart(2151)]
    LOCAL PROCEDURE GetPositionOfCaption@1113400003(CurrPage@1113400004 : Record 6085591;CaptionTemplateField@1113400001 : Record 6085580;CaptionStartWord@1113400003 : Record 6085592;CaptionEndWord@1113400002 : Record 6085592;DocumentValue@1113400000 : Record 6085593;VAR FieldLeft@1113400011 : Integer;VAR FieldWidth@1113400010 : Integer;VAR Bottom@1113400009 : Integer;VAR Top@1113400008 : Integer) CaptionValueFound : Boolean;
    VAR
      Template@1113400007 : Record 6085579;
      CaptureEngine@1113400006 : Codeunit 6085575;
    BEGIN
      Template.GET(CaptionTemplateField."Template No.");

      //Hole Positionen der caption
        CaptionValueFound := CaptureMgt.CaptureFromPos(CurrPage,CaptionTemplateField,0,FALSE,CaptionStartWord.Top,CaptionStartWord.Left,
          CaptionEndWord.Bottom,CaptionEndWord.Right,DocumentValue) <> '';

        IF CaptionValueFound THEN BEGIN
          FieldLeft := CaptionStartWord.Left +
          ROUND(CaptionTemplateField."Caption Offset X" * CaptureEngine.GetDPIFactor(CaptionTemplateField."Offset DPI",CurrPage."TIFF Image Resolution"),1);

          IF NOT Template."First Table Line Has Captions" THEN
            Bottom := CaptionStartWord.Top
          ELSE IF CaptionStartWord.Bottom > Bottom THEN
            Bottom := CaptionStartWord.Bottom;

          IF FieldWidth < CaptionEndWord.Right - CaptionStartWord.Left THEN
            FieldWidth := CaptionEndWord.Right - CaptionStartWord.Left;

          Top := CaptionStartWord.Top;
        END;
    END;

    [LineStart(2173)]
    LOCAL PROCEDURE CaptureTableCell@1000000005(VAR Template@161024014 : Record 6085579;VAR Document@1000000009 : Record 6085590;VAR Page@1000000000 : Record 6085591;VAR Field@1000000010 : Record 6085580;LineNo@1000000003 : Integer;Top@1000000007 : Integer;Left@1000000006 : Integer;Bottom@1000000005 : Integer;Right@1000000004 : Integer) : Integer;
    VAR
      Value@1000000008 : Record 6085593;
    BEGIN
      IF (Right - Left <= 0) OR (Bottom-Top <= 0) THEN
        EXIT;

      CaptureMgt.CaptureFromPos(Page,Field,LineNo,TRUE,Top,Left,Bottom,Right,Value);
      Value.FIND('=');

      IF (Value.IsBlank) OR TableCellAlreadyCaptured(Template,Page,Value) THEN
        Value.DELETE
      ELSE
        EXIT(Value.Bottom);
    END;

    [LineStart(2185)]
    LOCAL PROCEDURE TableCellAlreadyCaptured@1000000007(VAR Template@161024012 : Record 6085579;VAR Page@1000000002 : Record 6085591;VAR Value@1000000000 : Record 6085593) : Boolean;
    VAR
      Value2@1000000001 : Record 6085593;
      CaptureEngine@1113400000 : Codeunit 6085575;
    BEGIN
      Value2.SETCURRENTKEY("Document No.","Is Value",Type,"Page No.");
      IF NOT Template."First Table Line Has Captions" THEN
        Value2.SETRANGE("Is Value",TRUE);
      Value2.SETRANGE("Document No.",Page."Document No.");
      Value2.SETRANGE(Type,Value2.Type::Line);
      Value2.SETRANGE("Page No.",Value."Page No.");

      Value.Top := Value.Top + ROUND((Value.Bottom - Value.Top) / 2,1);
      Value.Left := Value.Left + 3;

      IF Value2.FINDSET(FALSE,FALSE) THEN
        REPEAT
          IF (NOT ((Value2.Code = Value.Code) AND (Value2."Line No." = Value."Line No."))) THEN
            IF CaptureEngine.IntersectsWith(Value,Value2) THEN
              EXIT(TRUE);
        UNTIL Value2.NEXT = 0;
    END;

    [LineStart(2203)]
    LOCAL PROCEDURE IsFieldValid@1113400005(VAR CaptionField@1113400000 : Record 6085580;Document@1000000001 : Record 6085590;LineNo@1000000002 : Integer) : Boolean;
    VAR
      Field@1000000000 : Record 6085580;
      Value@161024012 : Record 6085593;
    BEGIN
      CASE CaptionField."Data Type" OF
        Field."Data Type"::Number:
          BEGIN
            IF (NOT CaptionField.Required) THEN BEGIN
              IF Value.GET(Document."No.",TRUE,CaptionField.Code,LineNo) THEN BEGIN
                IF NOT Value."Is Valid" THEN BEGIN
                  EXIT;
                END ELSE BEGIN
                  EXIT(CaptureMgt.ParseNumber(Field,Value."Value (Text)",Value."Value (Decimal)"));
                END;
              END;
            END;
          END;
        Field."Data Type"::Text:
          IF Value.GET(Document."No.",TRUE,CaptionField.Code,LineNo) THEN BEGIN
            EXIT(IsValidText(CaptionField, Value."Value (Text)",Document."No."));
          END;
        Field."Data Type"::Date:
          IF Value.GET(Document."No.",TRUE,CaptionField.Code,LineNo) THEN
            EXIT(IsValidDate(CaptionField, Value."Value (Date)"));
        Field."Data Type"::Lookup:
          IF Value.GET(Document."No.",TRUE,CaptionField.Code,LineNo) THEN
            EXIT(IsValidLookup(CaptionField, Value."Value (Text)",Document."No."));
      END;
      EXIT(TRUE);
    END;

    [LineStart(2230)]
    LOCAL PROCEDURE FillSortedFieldBuffer@1113400004(VAR TempSortedDocumentField@1113400000 : Record 6085595;VAR MandatoryField@1000000000 : Record 6085595;TempDocLine@1113400003 : TEMPORARY Record 6085596);
    VAR
      TemplateField@1113400001 : Record 6085580;
    BEGIN
      WITH TemplateField DO BEGIN
        SETRANGE("Template No.",TempDocLine."Template No.");
        SETRANGE(Type,Type::Line);
        IF FINDSET THEN
          REPEAT
            IF ("Advanced Line Recognition Type" <> "Advanced Line Recognition Type"::Default) AND
               (STRLEN(Formula)=0) AND (STRLEN(GetFixedValue)=0)  THEN
            BEGIN
              TempSortedDocumentField."Document No." := TempDocLine."Document No.";
              TempSortedDocumentField."Sort Order" := Sorting;
              TempSortedDocumentField."Field Code" := Code;
              TempSortedDocumentField.INSERT;
            END ELSE BEGIN
              IF Required THEN BEGIN
                MandatoryField."Document No." := TempDocLine."Document No.";
                MandatoryField."Sort Order" := Sorting;
                MandatoryField."Field Code" := Code;
                MandatoryField.INSERT;
              END;
            END;
          UNTIL NEXT = 0;
      END;
    END;

    [LineStart(2254)]
    LOCAL PROCEDURE GetStopLineRecognitionPositions@1000000001(VAR StopPos@1000000003 : ARRAY [100] OF Integer;CurrPageNo@1000000002 : Integer;Bottom@1000000004 : Integer;Document@1000 : Record 6085590);
    VAR
      Field@1000000000 : Record 6085580;
      Value@1000000001 : Record 6085593;
    BEGIN
      Field.RESET;
      Field.SETCURRENTKEY("Template No.",Type,"Sort Order");
      Field.SETRANGE("Template No.",Document."Template No.");
      Field.SETRANGE(Type,Field.Type::Header);
      Field.SETFILTER("Stop Lines Recognition",'>%1',Field."Stop Lines Recognition"::" ");
      IF Field.FINDSET THEN
        REPEAT
          Value.RESET;
          Value.SETRANGE("Document No.",Document."No.");
          Value.SETRANGE(Type,Field.Type);
          Value.SETRANGE(Code,Field.Code);
          Value.SETRANGE("Page No.",CurrPageNo);

          CASE Field."Stop Lines Recognition" OF
            Field."Stop Lines Recognition"::"If Caption is on same line",
            Field."Stop Lines Recognition"::"If Caption is on same line (continue on next page)":
              Value.SETRANGE("Is Value",FALSE);
            Field."Stop Lines Recognition"::"If Value is on same line",
            Field."Stop Lines Recognition"::"If Value is on same line (continue on next page)":
              Value.SETRANGE("Is Value",TRUE);
            Field."Stop Lines Recognition"::"If Caption or Value is on same line",
            Field."Stop Lines Recognition"::"If Caption or Value is on same line (continue on next page)":
              Value.SETRANGE("Is Value");
          END;

          Value.SETFILTER(Top,'>%1',0);
          IF Value.FINDFIRST THEN BEGIN
            IF (StopPos[Value."Page No."] = 0) OR (StopPos[Value."Page No."] > Value.Top) THEN
              IF (NOT (Value.Left = Value.Right) AND (Value.Bottom = Value.Top)) THEN
                StopPos[Value."Page No."] := Value.Top;
          END;
        UNTIL Field.NEXT = 0;
    END;

    [LineStart(2288)]
    LOCAL PROCEDURE CleanupPrevValues@100000000(Document@1000 : Record 6085590);
    VAR
      DocumentValue@100000000 : Record 6085593;
    BEGIN
      DocumentValue.SETRANGE("Document No.",Document."No.");
      DocumentValue.SETRANGE(Type,DocumentValue.Type::Line);
      DocumentValue.DELETEALL;
    END;

    [LineStart(2293)]
    LOCAL PROCEDURE CleanupTempValues@1160040000(Document@1000 : Record 6085590);
    VAR
      DocumentValue@1160040000 : Record 6085593;
    BEGIN
      // Clean up temporary created values
      DocumentValue.SETRANGE("Document No.",Document."No.");
      DocumentValue.SETRANGE(Type,DocumentValue.Type::Line);
      DocumentValue.SETFILTER("Line No.",'1000..');
      DocumentValue.DELETEALL;
    END;

    [LineStart(2300)]
    LOCAL PROCEDURE "--CopiesFromCaptureManagement--"@1160040009();
    BEGIN
      // The following functions are a copy of the same functions in the Capture Management Codeunit, where they are defined as "local"
    END;

    [LineStart(2303)]
    LOCAL PROCEDURE IsValidNumber@6085574(VAR Field@6085575 : Record 6085580;Number@6085574 : Decimal) : Boolean;
    VAR
      FieldRule@6085576 : Record 6085583;
      TempTemplateField@6085573 : TEMPORARY Record 6085580;
    BEGIN
      IF Field."Codeunit ID: Capture Value" <> 0 THEN
        EXIT(TestCaptureValue(Field,FieldRule,FORMAT(Number)));

      IF (Number = 0) AND Field.Required THEN
        EXIT(FALSE);

      CaptureMgt.FilterRule(Field,FieldRule);

      TempTemplateField."Fixed Value (Decimal)" := Number;
      TempTemplateField.INSERT;

      IF FieldRule.FINDSET THEN
        REPEAT
          IF FieldRule.Rule <> '' THEN BEGIN
            TempTemplateField.SETFILTER("Fixed Value (Decimal)",FieldRule.Rule);
            IF TempTemplateField.ISEMPTY THEN
              EXIT(FALSE);
          END;
        UNTIL FieldRule.NEXT = 0;

      EXIT(TRUE);
    END;

    [LineStart(2326)]
    LOCAL PROCEDURE IsValidDate@1000000014(VAR Field@1000000001 : Record 6085580;Date@1000000000 : Date) : Boolean;
    VAR
      FieldRule@161024012 : Record 6085583;
    BEGIN
      IF Field."Codeunit ID: Capture Value" <> 0 THEN
        EXIT(TestCaptureValue(Field,FieldRule,FORMAT(Date)));

      IF (Date = 0D) THEN
        EXIT(NOT Field.Required);

      IF FORMAT(Field."Validation Dateformula From") <> '' THEN
        IF Date < CALCDATE(Field."Validation Dateformula From",TODAY) THEN
          EXIT(FALSE);

      IF FORMAT(Field."Validation Dateformula To") <> '' THEN
        IF Date > CALCDATE(Field."Validation Dateformula To",TODAY) THEN
          EXIT(FALSE);

      IF Date < 01011754D THEN
        EXIT(FALSE);

      EXIT(TRUE);
    END;

    [LineStart(2346)]
    LOCAL PROCEDURE IsValidText@1000000015(VAR Field@1000000001 : Record 6085580;Text@1000000000 : Text[250];DocumentNo@6085573 : Code[20]) : Boolean;
    VAR
      FieldRule@1000000004 : Record 6085583;
      TempValue@161024012 : TEMPORARY Record 6085593;
      RegEx@1000000003 : Codeunit 6085585;
      IsValid@1000000002 : Boolean;
    BEGIN
      Text := UPPERCASE(Text);

      IF Field."Codeunit ID: Capture Value" <> 0 THEN
        IF TestCaptureValue(Field,FieldRule,Text) THEN
          EXIT(TRUE);

      CaptureMgt.FilterRule(Field,FieldRule);
      IF NOT FieldRule.FINDFIRST THEN
        EXIT((Text <> '') OR (NOT Field.Required));

      IF Text = '' THEN
        EXIT(NOT Field.Required);

      TempValue."Value (Text)" := Text;
      TempValue.INSERT;

      REPEAT
        FieldRule.Rule := UPPERCASE(FieldRule.Rule);
        IF (STRPOS(FieldRule.Rule,'<') <> 0) OR
          (STRPOS(FieldRule.Rule,'>') <> 0) OR
          (STRPOS(FieldRule.Rule,'|') <> 0) OR
          (STRPOS(FieldRule.Rule,'*') <> 0) OR
          (STRPOS(FieldRule.Rule,'&') <> 0)
        THEN BEGIN
          TempValue.SETFILTER("Value (Text)",FieldRule.Rule);
          IsValid := NOT TempValue.ISEMPTY;
        END ELSE BEGIN
          IF RegEx.IsMatch(Text,FieldRule.Rule) THEN BEGIN
            IF Field."Codeunit ID: Capture Value" <> 0 THEN
              IsValid := TestCaptureValue(Field,FieldRule,Text)
            ELSE
              IsValid := TRUE;

            IF IsValid AND Field."Enable Rule Generation" THEN BEGIN
              ClearFldRuleCreatedFromMaster(FieldRule,DocumentNo);

              // Several rules could have been copied from the master template. Delete these when a rule matches the found value
              DelFldRulesCreatedFromMaster(FieldRule."Entry No.");
            END;
          END;
        END;
      UNTIL (FieldRule.NEXT = 0) OR (IsValid);

      EXIT(IsValid);
    END;

    [LineStart(2392)]
    LOCAL PROCEDURE IsValidLookup@1000000031(Field@1000000001 : Record 6085580;Value@1160040000 : Text[250];DocumentNo@6085573 : Code[20]) : Boolean;
    VAR
      RecIDMgt@1160040001 : Codeunit 6085604;
    BEGIN
      EXIT(IsValidText(Field,Value,DocumentNo));
    END;

    [LineStart(2395)]
    LOCAL PROCEDURE IsValidBoolean@1160040016(VAR Field@1000000001 : Record 6085580;Boolean@1000000000 : Boolean) : Boolean;
    BEGIN
      EXIT(TRUE);
    END;

    [LineStart(2398)]
    LOCAL PROCEDURE TestCaptureValue@161024017(Field@161024012 : Record 6085580;Rule@161024013 : Record 6085583;Value@161024014 : Text[1024]) : Boolean;
    VAR
      TempCaptureFieldVal@161024015 : Record 6085597;
    BEGIN
      TempCaptureFieldVal."Field Type" := Field.Type;
      TempCaptureFieldVal."Field Code" := Field.Code;
      TempCaptureFieldVal."File Rule Entry No." := Rule."Entry No.";
      TempCaptureFieldVal.Rule := Rule.Rule;
      TempCaptureFieldVal.Value := Value;
      CODEUNIT.RUN(Field."Codeunit ID: Capture Value",TempCaptureFieldVal);
      EXIT(TempCaptureFieldVal."Is Valid");
    END;

    [LineStart(2407)]
    LOCAL PROCEDURE ClearFldRuleCreatedFromMaster@6085577(VAR FieldRule@6085573 : Record 6085583;DocumentNo@6085574 : Code[20]);
    BEGIN
      IF FieldRule."Created from Master Template" THEN BEGIN
        FieldRule."Created from Master Template" := FALSE;
        FieldRule."Document No." := DocumentNo;
        FieldRule.MODIFY(TRUE);
      END;
    END;

    [LineStart(2414)]
    LOCAL PROCEDURE DelFldRulesCreatedFromMaster@6085579(SkipEntryNo@6085574 : Integer);
    VAR
      FieldRule@6085573 : Record 6085583;
    BEGIN
      FieldRule.SETRANGE("Created from Master Template",TRUE);
      FieldRule.SETFILTER("Entry No.",'<>%1',SkipEntryNo);
      IF NOT FieldRule.ISEMPTY THEN
        FieldRule.DELETEALL(TRUE);
    END;

    [Integration(TRUE)]
    [LineStart(2420)]
    LOCAL PROCEDURE OnAfterStandardLineRecognition@1160040002(VAR Document@1160040000 : Record 6085590;VAR Handled@1160040001 : Boolean);
    BEGIN
    END;

    BEGIN
    END.
  }
}

OBJECT Codeunit 61002 Adv. Purch. - Line Validation
{
  OBJECT-PROPERTIES
  {
    Date=12/12/21;
    Time=[ 9:10:12 PM];
    Modified=Yes;
    Version List=ALR1.15;
  }
  PROPERTIES
  {
    TableNo=6085596;
    OnRun=BEGIN
            ALRLineValidation(Rec);
          END;

  }
  CODE
  {
    VAR
      LineAmountDiffCalcDiscAmtTxt@6085576 : TextConst 'DAN=I linje %1 er linjebelõb genkendt (%2) forskellig fra linjebelõb beregnet (%3) nÜr den genkendte rabat-% (%4) benyttes til beregning af rabatbelõb (%5).;DEU=Der erfasste Zeilenbetrag (%2) unterscheidet sich in Zeile %1 vom berechneten Zeilenbetrag (%3), der mit dem erfassten Rabatt % (%4) berechnet wurde, um den Rabattbetrag (%5) zu berechnen.;ENU=Line Amount captured (%2) is different from Line Amount calculated (%3) using captured Discount % (%4) to calculate Discount Amount (%5) on line %1.;FRA=Le montant de la ligne capturÇe (%2) est diffÇrent du montant de la ligne calculÇ (%3) Ö l''aide du % remise (%4) capturÇ pour calculer le montant de la remise (%5) Ö la ligne %1.;NLD=Herkend lijnbedrag (%2) is verschillend van berekend lijnbedrag (%3) met behulp van herkende korting % (%4) om korting (%5) op regel %1 te berekenen.';
      LineAmountDiffCapDiscAmtTxt@6085577 : TextConst 'DAN=I linje %1 er linjebelõb genkendt (%2) forskellig fra linjebelõb beregnet (%3) nÜr det genkendte rabatbelõb (%4) benyttes.;DEU=Der erfasste Zeilenbetrag (%2) unterscheidet sich in Zeile %1 von dem berechneten Zeilenbetrag (%3), der mit dem erfassten Rabattbetrag (%4) berechnet wurde.;ENU=Line Amount captured (%2) is different from Line Amount calculated (%3) using captured Discount Amount (%4) on line %1.;FRA=Line Amount captured (%2) is different from Line Amount calculated (%3) using captured Discount Amount (%4) on line %1.;NLD=Herkend lijnbedrag (%2) is verschillend van berekend lijnbedrag (%3) met behulp van herkende korting % (%4) op regel %1.';
      LineAmountDiffTxt@6085573 : TextConst 'DAN=I linje %1 er linjebelõb genkendt (%2) forskellig fra linjebelõb beregnet (%3).;DEU=Der erfasste Zeilenbetrag (%2) unterscheidet sich vom in Zeile %1 berechneten Zeilenbetrag (%3).;ENU=Line Amount captured (%2) is different from Line Amount calculated (%3) on line %1.;FRA=Le montant de la ligne capturÇe (%2) est diffÇrent du montant de ligne calculÇ (%3) Ö la ligne %1.;NLD=Herkend lijnbedrag (%2) is anders dan berekend lijnbedrag (%3) op regel %1.';
      WarningTxt@6085574 : TextConst 'DAN=ADVARSEL: %1;DEU=WARNUNG: %1;ENU=ATTENTION : %1;FRA=ATTENTION : %1;NLD=WAARSCHUWING: %1';

    [LineStart(2425)]
    LOCAL PROCEDURE ALRLineValidation@1(VAR TempDocumentLine@1000 : TEMPORARY Record 6085596);
    VAR
      Document@1001 : Record 6085590;
      Field@1022 : Record 6085580;
      DocumentComment@1021 : Record 6085594;
      EmptyField@1020 : Record 6085580;
      PurchDocMgt@1019 : Codeunit 6085709;
      CaptureMgt@1018 : Codeunit 6085576;
      DCAppMgt@1017 : Codeunit 6085722;
      Quantity@1016 : Decimal;
      UnitCost@1015 : Decimal;
      LineAmount@1014 : Decimal;
      DiscAmount@1013 : Decimal;
      DiscPct@1012 : Decimal;
      LineAmount2@1011 : Decimal;
      AmountRoundingPrecision@1010 : Decimal;
      OtherCharges@1009 : Decimal;
      UnitCharge@1008 : Decimal;
      LineDescription@1007 : Text[250];
      CommentText@1006 : Text[1024];
      CurrencyCode@1004 : Code[10];
      CommentType@1003 : 'Information,Warning,Error';
    BEGIN
      IF NOT Document.GET(TempDocumentLine."Document No.") THEN
        EXIT;

      //LineAccountNo := PurchDocMgt.GetLineAccountNo(Document,TempDocumentLine."Line No.");
      LineDescription := PurchDocMgt.GetLineDescription(Document,TempDocumentLine."Line No.");
      Quantity := PurchDocMgt.GetLineQuantity(Document,TempDocumentLine."Line No.");
      UnitCost := PurchDocMgt.GetLineUnitCost(Document,TempDocumentLine."Line No.");
      DiscPct := PurchDocMgt.GetLineDiscPct(Document,TempDocumentLine."Line No.");
      DiscAmount := PurchDocMgt.GetLineDiscAmount(Document,TempDocumentLine."Line No.");
      LineAmount := PurchDocMgt.GetLineAmount(Document,TempDocumentLine."Line No.");
      OtherCharges := PurchDocMgt.GetLineOtherCharges(Document,TempDocumentLine."Line No.");
      UnitCharge := PurchDocMgt.GetLineUnitCharge(Document,TempDocumentLine."Line No.");
      CurrencyCode := PurchDocMgt.GetCurrencyCode(Document);

      //ALR >>>
      //IF (LineAccountNo = '') AND (Quantity = 0) AND (UnitCost = 0) AND (LineAmount = 0) AND (DiscPct = 0) AND
      //  (DiscAmount = 0) AND (LineDescription = '')
      //THEN BEGIN
      //  Skip := TRUE;
      //  EXIT;
      //END;
      Field.SETRANGE("Template No.",TempDocumentLine."Template No.");
      Field.SETRANGE(Type,Field.Type::Line);
      Field.SETRANGE(Required,TRUE);
      IF Field.FINDSET THEN
      REPEAT
        IF STRLEN(CaptureMgt.GetValueAsText(TempDocumentLine."Document No.",TempDocumentLine."Line No.",Field)) = 0 THEN
          TempDocumentLine.Skip := TRUE;
      UNTIL Field.NEXT = 0;
      IF TempDocumentLine.Skip THEN
        EXIT;
      //ALR <<<

      Field.SETRANGE(Required);
      IF Field.FINDSET THEN
        REPEAT
          IF NOT CaptureMgt.IsValidValue(Field,TempDocumentLine."Document No.",TempDocumentLine."Line No.") THEN BEGIN
            // No need to write an error here as an error written in C6085580 - CDC Doc. - Field Validation
            TempDocumentLine.OK := FALSE;
            EXIT;
          END;
        UNTIL Field.NEXT = 0;

      IF NOT DCAppMgt.GetAmountRoundingPrecision(CurrencyCode,AmountRoundingPrecision) THEN BEGIN
        TempDocumentLine.OK := FALSE;
        EXIT;
      END;

      LineAmount2 := ROUND(Quantity * (UnitCost + UnitCharge),AmountRoundingPrecision);
      LineAmount2 += ROUND(OtherCharges,AmountRoundingPrecision);

      IF DiscAmount <> 0 THEN
        LineAmount2 := LineAmount2 - ROUND(DiscAmount,AmountRoundingPrecision)
      ELSE
        IF DiscPct <> 0 THEN BEGIN
          // We are rounding the discount amount before we subtract it from LineAmount as this is how standard NAV behaves on an Invoice
          DiscAmount :=  ROUND(LineAmount2 * DiscPct / 100,AmountRoundingPrecision);
          LineAmount2 := LineAmount2 - DiscAmount;
        END;

      // We use AmountRoundingPrecision as any roundings should be equal to AmountRoundingPrecision. In this situation,
      // we want the used to be able to register the document.
      // When a document is registered with a rounding difference, the
      TempDocumentLine.OK := (ABS(LineAmount - LineAmount2) <= AmountRoundingPrecision);

      IF TempDocumentLine."Create Comment" THEN
        IF LineAmount <> LineAmount2 THEN BEGIN
          IF TempDocumentLine.OK THEN BEGIN
            CommentType := CommentType::Warning;
            CommentText := WarningTxt;
          END ELSE BEGIN
            CommentType := CommentType::Error;
            CommentText := '%1';
          END;

          // LineAmount is Line Amount as captured/keyed in on the document line. We therefore want to show all decimals.
          IF (DiscPct = 0) AND (DiscAmount = 0) THEN
            DocumentComment.Add(Document,EmptyField,TempDocumentLine."Line No.",DocumentComment.Area::Validation,CommentType,
              STRSUBSTNO(CommentText,STRSUBSTNO(LineAmountDiffTxt,TempDocumentLine."Line No.",DCAppMgt.FormatAmountNoRounding(LineAmount,CurrencyCode),
                DCAppMgt.FormatAmount(LineAmount2,CurrencyCode))))
          ELSE
            IF DiscPct <> 0 THEN
              DocumentComment.Add(Document,EmptyField,TempDocumentLine."Line No.",DocumentComment.Area::Validation,CommentType,
                STRSUBSTNO(CommentText,STRSUBSTNO(LineAmountDiffCalcDiscAmtTxt,TempDocumentLine."Line No.",
                  DCAppMgt.FormatAmountNoRounding(LineAmount,CurrencyCode),
                  DCAppMgt.FormatAmount(LineAmount2,CurrencyCode),DiscPct,DCAppMgt.FormatAmount(DiscAmount,CurrencyCode))))
            ELSE
              DocumentComment.Add(Document,EmptyField,TempDocumentLine."Line No.",DocumentComment.Area::Validation,CommentType,
                STRSUBSTNO(CommentText,STRSUBSTNO(LineAmountDiffCapDiscAmtTxt,TempDocumentLine."Line No.",
                  DCAppMgt.FormatAmountNoRounding(LineAmount,CurrencyCode),
                  DCAppMgt.FormatAmount(LineAmount2,CurrencyCode),DCAppMgt.FormatAmount(DiscAmount,CurrencyCode))));
        END;
    END;

    [EventSubscriber(Codeunit,6085704,OnBeforeLineValidation)]
    [LineStart(2519)]
    LOCAL PROCEDURE PurchLineValidation_OnBeforeLineValidation@7(VAR TempDocumentLine@1000 : Record 6085596;Document@1001 : Record 6085590;VAR Handled@1002 : Boolean);
    VAR
      CDCTemplate@1003 : Record 6085579;
    BEGIN
      IF Handled THEN
        EXIT;

      IF NOT CDCTemplate.GET(Document."Template No.") THEN
        EXIT;

      IF CDCTemplate."ALR Line Validation Type" <> CDCTemplate."ALR Line Validation Type"::AdvancedLineRecognition THEN
        EXIT;

      ALRLineValidation(TempDocumentLine);
      Handled := TRUE;
    END;

    BEGIN
    {
      This codeunit validates lines on purchase documents
    }
    END.
  }
}

OBJECT Codeunit 61003 ALR Line Management SI
{
  OBJECT-PROPERTIES
  {
    Date=03/30/21;
    Time=12:00:00 PM;
    Modified=Yes;
    Version List=ALR1.15;
  }
  PROPERTIES
  {
    SingleInstance=Yes;
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      CurrDocumentNo@1160040000 : Code[20];
      LineRegionFromPage@100000003 : Integer;
      LineRegionFromPos@100000002 : Integer;
      LineRegionToPage@100000001 : Integer;
      LineRegionToPos@100000000 : Integer;

    [LineStart(2534)]
    PROCEDURE SetLineRegion@100000005(DocumentNo@1160040000 : Code[20];FromPage@1000000003 : Integer;FromPos@1000000002 : Integer;ToPage@1000000001 : Integer;ToPos@1000000000 : Integer);
    BEGIN
      CurrDocumentNo := DocumentNo;
      LineRegionFromPage := FromPage;
      LineRegionFromPos := FromPos;
      LineRegionToPage  := ToPage;
      LineRegionToPos := ToPos;
    END;

    [EventSubscriber(Codeunit,6085575,OnBeforeBufferWords)]
    [LineStart(2541)]
    LOCAL PROCEDURE OnBeforeBufferWordsSubscriber@100000001(DocumentNo@100000000 : Code[20];PageNo@100000001 : Integer;VAR Words@100000002 : Record 6085592;VAR GlobalWords@100000003 : Record 6085592;VAR Handled@100000004 : Boolean);
    VAR
      DocumentPage@100000009 : Record 6085591;
    BEGIN
      IF (CurrDocumentNo = DocumentNo) AND ((LineRegionFromPage > 0) OR (LineRegionToPage > 0)) THEN BEGIN
        Words.SETRANGE("Document No.",DocumentNo);
        DocumentPage.SETRANGE("Document No.",DocumentNo);
        DocumentPage.SETRANGE("Page No.",LineRegionFromPage,LineRegionToPage);
        IF DocumentPage.FINDSET THEN BEGIN
          Handled := TRUE;
          REPEAT
            IF LineRegionToPos = 0 THEN BEGIN
              Words.SETFILTER(Top,STRSUBSTNO('%1..%2',LineRegionFromPos,DocumentPage."Bottom Word Pos."))
            END ELSE BEGIN
              Words.SETFILTER(Top,DELCHR(STRSUBSTNO('%1..%2',LineRegionFromPos,LineRegionToPos),'=',' '));
            END;

            IF Words.FINDSET(FALSE,FALSE) THEN BEGIN
              REPEAT
                GlobalWords := Words;
                GlobalWords.INSERT;
              UNTIL Words.NEXT = 0;
            END;
          UNTIL DocumentPage.NEXT = 0;
        END;
        SetLineRegion('',0,0,0,0);
      END;
    END;

    BEGIN
    END.
  }
}

OBJECT Page 6085584 CDC Template Card
{
  OBJECT-PROPERTIES
  {
    Date=01/05/22;
    Time=10:53:18 PM;
    Modified=Yes;
    Version List=DCW17.00.00.8.01,ALR1.15;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Vorlagenkarte;
               ENU=Template Card];
    InsertAllowed=No;
    SourceTable=Table6085579;
    DataCaptionExpr=GetCaption;
    PageType=Card;
    RefreshOnActivate=Yes;
    OnOpenPage=VAR
                 DCApprovalsBridge@6085574 : Codeunit 6085790;
                 PurchaseHeader@6085573 : Record 38;
                 CDCModuleLicense@6085575 : Codeunit 6086008;
                 DocCat@6085576 : Record 6085575;
               BEGIN
                 IF "No." <> '' THEN
                   CategoryCodeVisible := FALSE
                 ELSE
                   CategoryCodeVisible := TRUE;

                 ShowApproval := ((DCApprovalsBridge.IsPurchApprovalEnabledDocType(PurchaseHeader."Document Type"::Invoice)) OR
                   (DCApprovalsBridge.IsPurchApprovalEnabledDocType(PurchaseHeader."Document Type"::"Credit Memo"))) AND CDCModuleLicense.
                 IsApprovalActivated(FALSE);

                 AdvCaptureActivated := CDCModuleLicense.IsAdvCaptureActivated(FALSE);

                 IF NOT DocCat.GET("Category Code") THEN
                   CLEAR(DocCat);

                 HasSourceTableNo := DocCat."Source Table No." <> 0;
               END;

    OnAfterGetRecord=VAR
                       DocCat@1160040000 : Record 6085575;
                       TemplateSearchText@1160040001 : Record 6085588;
                     BEGIN
                       SETRANGE("No.");
                       SourceID := GetSourceID;
                       SourceName := GetSourceName;

                       CodeunitLineCapture := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Line Capture");
                       CodeunitAfterCapture := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: After Capture");
                       CodeunitLineVal := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Line Validation");
                       CodeunitDocVal := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Doc. Validation");
                       CodeunitRegister := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Register");
                       CodeunitRegisterYN := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Register (Y/N)");
                       CodeunitAfterStep1 := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: After Step 1");
                       CodeunitAfterStep2 := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: After Step 2");
                       CodeunitTransl := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Translations");
                       CodeunitShowMatch := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Show Match");

                       LineRecognitionEnabled := "Recognize Lines" = "Recognize Lines"::Yes;
                       RecognizeLinesBoolean := LineRecognitionEnabled;
                       PurchUpdateOrder := "Purch. Inv. Reg. Step 1" = "Purch. Inv. Reg. Step 1"::"Match & Update Order";
                       PurchUpdateRetOrder := "Purch. Cr.Memo Reg. Step 1" = "Purch. Cr.Memo Reg. Step 1"::"Match & Update Return Order";

                       IF NOT DocCat.GET("Category Code") THEN
                         CLEAR(DocCat);
                       IsSales := DocCat."Destination Header Table No." = DATABASE::"Sales Header";
                       IsPurchases := DocCat."Destination Header Table No." = DATABASE::"Purchase Header";
                       ShowInteractionTemplateCode := "Codeunit ID: Register" = CODEUNIT::"CDC Doc. - Reg. (Log Interact)";
                       ShowFirstLineHasCaptions := ("Recognize Lines" = "Recognize Lines"::Yes) OR (Type = Type::Master);
                       ShowDescription := SetShowDescription;
                       IsMasterTemplate := Type = Type::Master;
                       IsIdentificationTemplate := Type = Type::Identification;
                       PageIsEditable := CurrPage.EDITABLE;

                       HasSourceTableNo := DocCat."Source Table No." <> 0;

                       CurrPage.Fields.PAGE.SetTemplateNo("No.");
                       ShowMatching := ShowMatchingGroup;
                       ShowAutoOrderVarianceInv := "Purch. Inv. Reg. Step 1" = "Purch. Inv. Reg. Step 1"::"Match & Update Order";
                       ShowAutoOrderVarianceCrM := "Purch. Cr.Memo Reg. Step 1" = "Purch. Cr.Memo Reg. Step 1"::"Match & Update Return Order";

                       SearchTextEditable := TRUE AND PageIsEditable;
                       SearchText := "Search Text";
                       TemplateSearchText.SETRANGE("Template No.","No.");
                       IF NOT TemplateSearchText.ISEMPTY THEN BEGIN
                         SearchTextEditable := FALSE;
                         TemplateSearchText.FINDFIRST;
                         SearchText := TemplateSearchText."Search Text" + ' ' + STRSUBSTNO(TotalSearchTextsTxt,TemplateSearchText.COUNT);
                       END;

                       ShowXMLFields := "Data Type" = "Data Type"::XML;
                       StylesheetImported := "XML Stylesheet File".HASVALUE;
                       ShowUnitCostVariance := "Purch. Match Unit Cost" <> "Purch. Match Unit Cost"::No;
                     END;

    OnNewRecord=BEGIN
                  IF GETFILTER("Category Code") <> '' THEN
                    "Category Code" := GETRANGEMIN("Category Code");
                  SourceID := '';

                  CodeunitLineCapture := '';
                  CodeunitAfterCapture := '';
                  CodeunitLineVal := '';
                  CodeunitDocVal := '';
                  CodeunitRegister := '';
                  CodeunitRegisterYN := '';
                  CodeunitAfterStep1 := '';
                  CodeunitAfterStep2 := '';
                  CodeunitTransl := '';
                  CodeunitShowMatch := '';
                END;

    ActionList=ACTIONS
    {
      { 161024038;   ;ActionContainer;
                      Name=ActionItems;
                      ActionContainerType=ActionItems }
      { 161024037;1  ;ActionGroup;
                      Name=Functions;
                      CaptionML=[DEU=F&unktionen;
                                 ENU=F&unctions] }
      { 161024036;2  ;Action    ;
                      Name=Copy;
                      Ellipsis=Yes;
                      CaptionML=[DEU=&Kopie;
                                 ENU=&Copy];
                      ToolTipML=[DEU="ôffnen Sie ein Fenster, um eine neue Vorlage basierend auf dieser Vorlage zu erstellen. ";
                                 ENU="Open a window to create a new template based on this template. "];
                      Image=Copy;
                      OnAction=VAR
                                 CopyTempl@161024012 : Report 6085583;
                               BEGIN
                                 CopyTempl.SetFromTemplate(Rec);
                                 CopyTempl.RUNMODAL;
                               END;
                                }
      { 6085589 ;1   ;ActionGroup;
                      Name=Xml;
                      CaptionML=[DEU=Xml;
                                 ENU=Xml] }
      { 6085590 ;2   ;Action    ;
                      Name=ImportXslt;
                      CaptionML=[DEU=Stylesheet importieren;
                                 ENU=Import Stylesheet];
                      ToolTipML=[DEU=ôffnen Sie ein Fenster, um eine Stylesheet-Datei zu importieren.;
                                 ENU=Open a window to import a Stylesheet file.];
                      Visible=ShowXMLFields AND IsMasterTemplate;
                      Image=Import;
                      OnAction=BEGIN
                                 ImportStylesheet;
                               END;
                                }
      { 6085591 ;2   ;Action    ;
                      Name=ExportXslt;
                      CaptionML=[DEU=Stylesheet exportieren;
                                 ENU=Export Stylesheet];
                      ToolTipML=[DEU=ôffnen Sie ein Fenster, um die Stylesheet-Datei der Vorlage zu exportieren.;
                                 ENU=Open a window to export the Template's Stylesheet file.];
                      Visible=ShowXMLFields AND IsMasterTemplate;
                      Enabled=StylesheetImported;
                      Image=Export;
                      OnAction=BEGIN
                                 ExportStylesheet;
                               END;
                                }
      { 161024025;   ;ActionContainer;
                      Name=RelatedInformation;
                      ActionContainerType=RelatedInformation }
      { 161024024;1  ;ActionGroup;
                      Name=Template;
                      CaptionML=[DEU=&Vorlage;
                                 ENU=&Template] }
      { 6085599 ;2   ;Action    ;
                      Name=Network Profile;
                      CaptionML=[DEU=Netzwerkprofile;
                                 ENU=Network Profiles];
                      Image=Relationship;
                      OnAction=BEGIN
                                 ShowCDNNetworkProfiles;
                               END;
                                }
      { 161024022;2  ;ActionGroup;
                      Name=TranslationsGr;
                      CaptionML=[DEU=öbersetzungen;
                                 ENU=&Translations];
                      Image=Track }
      { 6       ;3   ;Action    ;
                      Name=Accounts for Amounts;
                      ShortCutKey=Ctrl+T;
                      CaptionML=[DEU=Konten fÅr BetrÑge;
                                 ENU=Accounts for Amounts];
                      ToolTipML=[DEU=öbersetzungen fÅr Konten fÅr BetrÑge anzeigen oder bearbeiten.;
                                 ENU=View or edit Account for Amounts translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSaleTranslTempl@1000 : Codeunit 6085710;
                               BEGIN
                                 PurchSaleTranslTempl.ShowAccountsForAmountsTrans(Rec);
                               END;
                                }
      { 7       ;3   ;Action    ;
                      Name=Salesperson/Purchaser;
                      CaptionML=[DEU=VerkÑufer/EinkÑufer;
                                 ENU=Salesperson/Purchaser];
                      ToolTipML=[DEU=öbersetzungen fÅr VerkÑufer/EinkÑufer anzeigen oder bearbeiten.;
                                 ENU=View or edit Salesperson/Purchaser translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSaleTranslTempl@1000 : Codeunit 6085710;
                               BEGIN
                                 PurchSaleTranslTempl.ShowSalespersonPurchaserTrans(Rec);
                               END;
                                }
      { 4       ;3   ;Action    ;
                      Name=NoTranslation;
                      CaptionML=[DEU=Nr.;
                                 ENU=No.];
                      ToolTipML=[DEU=öbersetzungen fÅr Nr. anzeigen oder bearbeiten.;
                                 ENU=View or edit No. translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSaleTranslTempl@1000 : Codeunit 6085710;
                               BEGIN
                                 PurchSaleTranslTempl.ShowItemNoTrans(Rec);
                               END;
                                }
      { 5       ;3   ;Action    ;
                      Name=DescriptionTranslation;
                      CaptionML=[DEU=Beschreibung;
                                 ENU=Description];
                      ToolTipML=[DEU=öbersetzungen fÅr Beschreibung anzeigen oder bearbeiten.;
                                 ENU=View or edit Description translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSaleTranslTempl@1000 : Codeunit 6085710;
                               BEGIN
                                 PurchSaleTranslTempl.ShowDescriptionTrans(Rec);
                               END;
                                }
      { 9       ;3   ;Action    ;
                      Name=UOM;
                      CaptionML=[DEU=Einheit;
                                 ENU=Unit of Measure];
                      ToolTipML=[DEU=öbersetzungen fÅr Einheit anzeigen oder bearbeiten.;
                                 ENU=View or edit Unit of Measure translations.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSaleTranslTempl@1000 : Codeunit 6085710;
                               BEGIN
                                 PurchSaleTranslTempl.ShowUOMTrans(Rec);
                               END;
                                }
      { 1       ;3   ;Action    ;
                      Name=CrossReferences;
                      CaptionML=[DEU=Artikelre&ferenzen;
                                 ENU=Cross Re&ferences];
                      ToolTipML=[DEU=Richtet eine eigene öbersetzung des ausgewÑhlten Artikel fÅr den Debitor oder Kreditor ein. Artikelreferenzen auf die Artikelnummer des Debitors bedeuten, dass ihre Artikelnummer automatisch anstelle der von Ihnen verwendeten Nummer auf den Verkaufsbelegen angezeigt wird.;
                                 ENU=Set up a customer's or vendor's own identification of the selected item. Cross-references to the customer's item number means that the item number is automatically shown on sales documents instead of the number that you use.];
                      Image=Change;
                      PromotedCategory=Category6;
                      OnAction=VAR
                                 ItemReferenceMgt@6085574 : Codeunit 6086026;
                               BEGIN
                                 ItemReferenceMgt.ShowItemReference("Source Record Table ID","Source Record No.");
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                Name=ContentArea;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                CaptionML=[DEU=Allgemein;
                           ENU=General];
                GroupType=Group }

    { 1000000002;2;Field  ;
                Name=No.;
                SourceExpr="No.";
                Visible=FALSE;
                ImplicitType=Code20 }

    { 1160040020;2;Field  ;
                Name=Category Code;
                ToolTipML=[DEU=Gibt die Belegkategorie an, zu der die Vorlage gehîrt.;
                           ENU=Specifies the category that the template belongs to.];
                SourceExpr="Category Code";
                Visible=CategoryCodeVisible;
                ImplicitType=Code10 }

    { 6085575;2;Field     ;
                Name=SourceID;
                ToolTipML=[DEU=Gibt den PrimÑrschlÅssel des Datensatzes an, zu dem diese Vorlage gehîrt. Bei Einkaufsvorlagen wird die Kreditorennummer angezeigt.;
                           ENU=Specifies the primary key of the record this template belong. For purchase related templates this will show the number of the vendor.];
                SourceExpr=SourceID;
                CaptionClass=GetSourceIDCaption;
                Importance=Promoted;
                Visible=FALSE;
                Editable=NOT IsMasterTemplate;
                OnValidate=BEGIN
                             SetSourceID(SourceID);
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           IF Type = Type::Master THEN
                             EXIT;

                           EXIT(RecIDMgt.LookupRecordID("Category Code",Text));
                         END;

                ImplicitType=Text250 }

    { 161024031;2;Field   ;
                Name=SourceName;
                ToolTipML=[DEU=Gibt den Namen des Datensatzes an, zu dem diese Vorlage gehîrt. Bei Einkaufsvorlagen wird der Name des Lieferanten angezeigt.;
                           ENU=Specifies the name of the record this template belong. For purchase related templates this will show the name of the vendor.];
                SourceExpr=SourceName;
                CaptionClass=GetSourceIDCaption;
                Visible=HasSourceTableNo;
                Editable=NOT IsMasterTemplate AND PageIsEditable;
                OnValidate=BEGIN
                             SetSourceID(SourceName);
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=VAR
                           Text2@6085573 : Text[250];
                         BEGIN
                           IF Type = Type::Master THEN
                             EXIT;

                           Text2 := GetSourceID;
                           IF NOT RecIDMgt.LookupRecordID("Category Code",Text2) THEN
                             EXIT;

                           SetSourceID(Text2);
                           CurrPage.UPDATE(TRUE);
                         END;

                ImplicitType=Text250 }

    { 6085578;2;Group     ;
                Name=DescriptionGroup;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowDescription;
                GroupType=Group }

    { 1000000007;3;Field  ;
                Name=Description;
                ToolTipML=[DEU=Gibt eine Beschreibung der Vorlage an.;
                           ENU=Specifies the description of the template.];
                SourceExpr=Description;
                ImplicitType=Text30 }

    { 1000000010;3;Field  ;
                Name=Default;
                ToolTipML=[DEU=Gibt an, ob dies die Standardvorlage fÅr diesen Datensatz ist.;
                           ENU=Specifies whether this is the default template for this record.];
                SourceExpr=Default;
                ImplicitType=Boolean }

    { 6085588;2;Field     ;
                Name=Data Type;
                SourceExpr="Data Type";
                Editable=IsIdentificationTemplate OR IsMasterTemplate;
                ImplicitType=Option }

    { 6085587;2;Group     ;
                Name=XML Data;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowXMLFields;
                GroupType=Group }

    { 6085585;3;Group     ;
                Name=Control6085585;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=IsMasterTemplate;
                GroupType=Group }

    { 6085586;4;Field     ;
                Name=XML Identification Template No.;
                ToolTipML=[DEU=Gibt die XML-Master-Vorlage an, die sich auf die aktuelle Identifikationsvorlage bezieht.;
                           ENU=Specifies the XML Identification Template related to the current Master Template.];
                SourceExpr="XML Ident. Template No.";
                Editable=IsMasterTemplate;
                ImplicitType=Code20 }

    { 6085595;3;Group     ;
                Name=Control6085595;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=IsMasterTemplate;
                GroupType=Group }

    { 6085593;4;Field     ;
                Name=StylesheetImported;
                CaptionML=[DEU=Stylesheet importiert;
                           ENU=Stylesheet Imported];
                ToolTipML=[DEU=Gibt an, ob fÅr die Vorlage ein XML-Stylesheet importiert wurde.;
                           ENU=Specifies whether the Template has a XML Stylesheet imported.];
                SourceExpr=StylesheetImported;
                Editable=FALSE;
                ImplicitType=Boolean }

    { 6085592;2;Group     ;
                Name=Invoice;
                CaptionML=[DEU=Rechnung;
                           ENU=Invoice];
                Visible=ShowXMLFields;
                GroupType=Group }

    { 6085584;3;Field     ;
                Name=Invoice XML Header Tag;
                CaptionML=[DEU=XML-Header-Tag;
                           ENU=XML Header Tag];
                ToolTipML=[DEU=Gibt das XML-Header-Tag fÅr Rechnungen an.;
                           ENU=Specifies the XML Header tag for Invoice Documents.];
                SourceExpr="Invoice XML Header Tag";
                OnAssistEdit=BEGIN
                               CaptureMgt.XmlPathAssistEdit(DocumentNo,"No.",0,'',"Invoice XML Header Tag");
                             END;

                ImplicitType=Text150 }

    { 6085583;3;Field     ;
                Name=Invoice XML Line Tag;
                CaptionML=[DEU=XML-Zeilen-Tag;
                           ENU=XML Line Tag];
                ToolTipML=[DEU="Gibt das XML-Zeilen-Tag fÅr Rechnungen an. Hiermit wird angegeben, wo die Rechnungszeilen im XML-Dokument platziert werden. ";
                           ENU="Specifies the XML Line tag for Invoice Documents. This will be used to indicate where the Invoice lines are placed in the XML Document. "];
                SourceExpr="Invoice XML Line Tag";
                OnAssistEdit=BEGIN
                               CaptureMgt.XmlPathAssistEdit(DocumentNo,"No.",0,'',"Invoice XML Line Tag");
                             END;

                ImplicitType=Text150 }

    { 6085698;3;Field     ;
                Name=Split XML at XPath Invoice;
                CaptionML=[DEU=Bei XML-Pfad teilen;
                           ENU=Split at XML Path];
                ToolTipML=[DEU=Gibt den XML-Pfad an, bei dem die Rechnungsdokumente aufgeteilt werden sollen.;
                           ENU=Specifies the XML Path where the invoice documents will be split.];
                SourceExpr="Split XML at XPath Invoice";
                ImplicitType=Text250 }

    { 6085594;2;Group     ;
                Name=Cr.Memo;
                CaptionML=[DEU=Gutschrift;
                           ENU=Credit Memo];
                Visible=ShowXMLFields;
                GroupType=Group }

    { 2   ;3   ;Field     ;
                Name=Cr.Memo XML Header Tag;
                CaptionML=[DEU=XML-Header-Tag;
                           ENU=XML Header Tag];
                ToolTipML=[DEU=Gibt das XML-Header-Tag fÅr Gutschriften an.;
                           ENU=Specifies the XML Header tag for Credit Memo Documents.];
                SourceExpr="Cr.Memo XML Header Tag";
                OnAssistEdit=BEGIN
                               CaptureMgt.XmlPathAssistEdit(DocumentNo,"No.",0,'',"Cr.Memo XML Header Tag");
                             END;

                ImplicitType=Text150 }

    { 3   ;3   ;Field     ;
                Name=Cr.Memo XML Line Tag;
                CaptionML=[DEU=XML-Zeilen-Tag;
                           ENU=XML Line Tag];
                ToolTipML=[DEU="Gibt das XML-Zeilen-Tag fÅr Gutschriften an. Hiermit wird angegeben, wo die Gutschriftszeilen im XML-Dokument platziert werden. ";
                           ENU="Specifies the XML Line tag for Credit Memo Documents. This will be used to indicate where the Credit Memo lines are placed in the XML Document. "];
                SourceExpr="Cr.Memo XML Line Tag";
                OnAssistEdit=BEGIN
                               CaptureMgt.XmlPathAssistEdit(DocumentNo,"No.",0,'',"Cr.Memo XML Line Tag");
                             END;

                ImplicitType=Text150 }

    { 6085699;3;Field     ;
                Name=Split XML at XPath Cr. Memo;
                CaptionML=[DEU=Bei XML-Pfad teilen;
                           ENU=Split at XML Path];
                ToolTipML=[DEU=Gibt den XML-Pfad an, bei dem die Gutschriftsdokumente aufgeteilt werden sollen.;
                           ENU=Specifies the XML Path where the credit memo documents will be split.];
                SourceExpr="Split XML at XPath Cr. Memo";
                ImplicitType=Text250 }

    { 1000000012;2;Field  ;
                Name=SearchTexts;
                ToolTipML=[DEU=Gibt einen oder mehrere eindeutige Texte an, die beim Identifizieren der Vorlage fÅr ein Dokument verwendet werden. Wenn alle Texte in einem Dokument vorhanden sind, wird die Vorlage automatisch auf dieses Dokument angewendet.;
                           ENU=Specifies one or more unique texts used when identifying the template for a document. If all texts exist in a document, then the template will automatically be applied to that document.];
                SourceExpr=SearchText;
                CaptionClass=FIELDCAPTION("Search Text");
                Visible=NOT IsMasterTemplate;
                Editable=SearchTextEditable;
                OnValidate=BEGIN
                             IF SearchTextEditable THEN BEGIN
                               "Search Text" := SearchText;
                               CurrPage.UPDATE(TRUE);
                             END ELSE
                               CurrPage.UPDATE(FALSE);
                           END;

                OnDrillDown=BEGIN
                              DrillDownSearchTexts;
                              CurrPage.UPDATE(FALSE);
                            END;

                ImplicitType=Text250 }

    { 1000000027;2;Field  ;
                Name=Language Code;
                ToolTipML=[DEU=Gibt die Sprache an, in der Datumsangaben erkannt werden, wenn Monate in Worten und nicht in Zahlen geschrieben werden. Um beispielsweise "October" zu erkennen, muss die Sprache Englisch sein. Bei allen Vorlagenfeldern wird die Sprache von der Vorlage Åbernommen.;
                           ENU=Specifies the language used to recognize dates when months are written in words and not numerical. For example, to recognize "Oktober" the language must be Danish. All template fields will have the language inherited from the template.];
                SourceExpr="Language Code";
                Importance=Additional;
                ImplicitType=Code10 }

    { 161024035;2;Field   ;
                Name=Date Format;
                ToolTipML=[DEU=Gibt das Datumsformat an, das zum Erkennen von Datumsangaben in Dokumenten verwendet wird. Alle Vorlagenfelder nutzen das von der Vorlage Åbernommene Datumsformat.;
                           ENU=Specifies the date format used to recognize dates in documents. All template fields will have the date format inherited from the template.];
                SourceExpr="Date Format";
                Importance=Additional;
                ImplicitType=Option }

    { 6085577;2;Group     ;
                Name=Lines;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowFirstLineHasCaptions AND AdvCaptureActivated AND NOT ShowXMLFields;
                GroupType=Group }

    { 161024015;3;Field   ;
                Name=First Table Line Has Captions;
                ToolTipML=[DEU=Gibt an, ob die erste Zeile der erfassten Belegzeilen die Suchtexte enthÑlt.;
                           ENU=Specifies whether the first line of captured document lines is a caption line.];
                SourceExpr="First Table Line Has Captions";
                Importance=Additional;
                ImplicitType=Boolean }

    { 1000000008;2;Field  ;
                Name=Show Document After Register;
                ToolTipML=[DEU=Gibt an, ob Dokumente nach der Registrierung angezeigt werden sollen.;
                           ENU=Specifies whether to show documents after registration.];
                SourceExpr="Show Document After Register";
                ImplicitType=Option }

    { 6085576;2;Group     ;
                Name=Interactions;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowInteractionTemplateCode;
                GroupType=Group }

    { 1000000026;3;Field  ;
                Name=Interaction Template Code;
                ToolTipML=[DEU=Gibt den Code der AktivitÑtenvorlage an, die beim Erstellen von AktivitÑtenprotokollposten verwendet wird.;
                           ENU=Specifies the code of the interaction template used when creating interaction log entries.];
                SourceExpr="Interaction Template Code";
                Importance=Additional;
                ImplicitType=Code10 }

    { 6085581;2;Group     ;
                Name=MergeEMailGroup;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=AdvCaptureActivated AND NOT ShowXMLFields;
                GroupType=Group }

    { 1160040013;3;Field  ;
                Name=Merge from same E-mail;
                ToolTipML=[DEU=Gibt an, ob beim Importieren von Dokumenten alle angehÑngten PDF Dokumente aus derselben E-Mail in ein Dokument zusammengefÅhrt werden sollen.;
                           ENU=Specifies whether to merge all documents from the same email when importing documents.];
                SourceExpr="Merge from same E-mail";
                Importance=Additional;
                ImplicitType=Boolean }

    { 6085574;2;Group     ;
                Name=RecognizeLines;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=AdvCaptureActivated;
                GroupType=Group }

    { 6085582;3;Field     ;
                Name=RecognizeLinesBoolean;
                CaptionML=[DEU=Zeilen erkennen;
                           ENU=Recognize Lines];
                ToolTipML=[DEU=Gibt an, ob Dokumentenzeilen erfasst werden sollen. Dies wird automatisch aktiviert, wenn Sie die Zeilenerkennung in einem Dokument einrichten.;
                           ENU=Specifies whether to capture document lines. This is automatically enabled when you set up line capturing in a document.];
                SourceExpr=RecognizeLinesBoolean;
                Importance=Promoted;
                OnValidate=BEGIN
                             IF RecognizeLinesBoolean THEN
                               VALIDATE("Recognize Lines","Recognize Lines"::Yes)
                             ELSE
                               VALIDATE("Recognize Lines","Recognize Lines"::No);
                             CurrPage.UPDATE(TRUE);
                           END;

                ImplicitType=Boolean }

    { 1160040025;2;Group  ;
                Name=Line Recognition;
                CaptionML=[DEU=Zeilenerkennung;
                           ENU=Line Recognition];
                Visible=LineRecognitionEnabled OR IsMasterTemplate;
                GroupType=Group }

    { 1160040001;3;Field  ;
                Name=Use Vendor/Customer Item Nos.;
                CaptionML=[DEU=Kreditor nutzt unsere Artikelnummern;
                           ENU=Vendor uses your Item Nos.];
                ToolTipML=[DEU=Gibt an, ob der Kreditor die gleichen Nummern wie Ihre Artikelnummern verwendet und Sie daher keine öbersetzung von der Kreditor-Artikelnr. in Ihre Artikelnummer erstellen mÅssen.;
                           ENU=Specifies if the vendor is using the same numbers as your item numbers and thereby you do not need to create a translation from the vendor item number to your item number.];
                SourceExpr="Use Vendor/Customer Item Nos.";
                ImplicitType=Boolean }

    { 10  ;3   ;Field     ;
                SourceExpr="ALR Line Validation Type";
                ImplicitType=Option }

    { 12  ;3   ;Field     ;
                Name=ALRValidateLineTotals;
                Description=Needed until field is implemented by default;
                SourceExpr="Validate Line Totals";
                ImplicitType=Boolean }

    { 1000000015;1;Group  ;
                Name=Purchase Documents;
                CaptionML=[DEU=Einkaufsbelege;
                           ENU=Purchase Documents];
                Visible=IsPurchases;
                GroupType=Group }

    { 1160040022;2;Group  ;
                Name=Registration;
                CaptionML=[DEU=Registrierung;
                           ENU=Registration];
                GroupType=Group }

    { 161024027;3;Field   ;
                Name=Purch. Inv. Reg. Step 1;
                ToolTipML=[DEU=Gibt den ersten Schritt an, der bei der Registrierung von Einkaufsrechnungen ausgefÅhrt werden muss.;
                           ENU=Specifies the first step to perform when registering purchase invoices.];
                SourceExpr="Purch. Inv. Reg. Step 1";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ImplicitType=Option }

    { 161024026;3;Field   ;
                Name=Purch. Inv. Reg. Step 2;
                ToolTipML=[DEU=Gibt den zweiten Schritt an, der bei der Registrierung von Einkaufsrechnungen ausgefÅhrt werden muss.;
                           ENU=Specifies the second step to perform when registering purchase invoices.];
                SourceExpr="Purch. Inv. Reg. Step 2";
                Importance=Promoted;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ImplicitType=Option }

    { 161024019;3;Field   ;
                Name=Purch. Cr.Memo Reg. Step 1;
                ToolTipML=[DEU=Gibt den ersten Schritt an, der bei der Registrierung von Einkaufsgutschriften ausgefÅhrt werden muss.;
                           ENU=Specifies the first step to perform when registering purchase credit memos.];
                SourceExpr="Purch. Cr.Memo Reg. Step 1";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ImplicitType=Option }

    { 161024018;3;Field   ;
                Name=Purch. Cr.Memo Reg. Step 2;
                ToolTipML=[DEU=Gibt den zweiten Schritt an, der bei der Registrierung von Einkaufsgutschriften ausgefÅhrt werden muss.;
                           ENU=Specifies the second step to perform when registering purchase credit memos.];
                SourceExpr="Purch. Cr.Memo Reg. Step 2";
                ImplicitType=Option }

    { 161024034;3;Field   ;
                Name=Posting Date;
                ToolTipML=[DEU=Gibt an, welches Datum bei der Registrierung von Einkaufsbelegen als Buchungsdatum verwendet werden soll.;
                           ENU=Specifies which date to use as the posting date when registering purchase documents.];
                SourceExpr="Posting Date";
                ImplicitType=Option }

    { 161024039;3;Field   ;
                Name=Prices Including VAT;
                ToolTipML=[DEU=Gibt an, ob Einkaufsbelege mit Preisen inkl. MwSt. erstellt werden sollen. Wenn eine Vorlage erstellt wird, wird diese Einstellung vom Kreditor Åbernommen.;
                           ENU=Specifies whether to create purchase documents with prices including VAT. When a template is created this setting defaults from the vendor.];
                SourceExpr="Prices Including VAT";
                ImplicitType=Boolean }

    { 161024020;3;Field   ;
                Name=Allow Register without Amounts;
                ToolTipML=[DEU=Gibt an, ob Dokumente ohne Auswahl eines Sachkontos, einer Anlage, eines Artikels oder eines Artikel Zu-/Abschlag registriert werden dÅrfen. Dadurch werden Einkaufsbelege ohne Zeilen erstellt.;
                           ENU=Specifies whether it should be allowed to register documents without assigning any G/L account, fixed asset, item or item charge before registering. Doing so will create purchase documents without any lines.];
                SourceExpr="Allow Register without Amounts";
                ImplicitType=Boolean }

    { 1000000014;3;Field  ;
                Name=Purch. Validate VAT Calc.;
                ToolTipML=[DEU=Gibt an, ob die MwSt.-Berechnung ÅberprÅft wird, wenn Einkaufsbelege registriert werden. Document Capture prÅft, ob der Betrag ohne MwSt. und der MwSt.-Betrag gleich dem Betrag inkl. MwSt. entspricht und erlaubt nur die Registrierung, wenn er gÅltig ist.;
                           ENU=Specifies whether to validate the VAT calculation when registering purchase documents. Document Capture checks if the amount excl. VAT and the VAT amount equal to the amount incl. VAT, and only allows you to register if it is valid.];
                SourceExpr="Purch. Validate VAT Calc.";
                Importance=Promoted;
                ImplicitType=Boolean }

    { 61000;3  ;Field     ;
                Name=ALRLineValidationTypeSales;
                SourceExpr="ALR Line Validation Type";
                ImplicitType=Option }

    { 1160040024;2;Group  ;
                Name=Approval;
                CaptionML=[DEU=Genehmigung;
                           ENU=Approval];
                Visible=ShowApproval;
                GroupType=Group }

    { 161024041;3;Field   ;
                Name=Approval Flow Code;
                ToolTipML=[DEU=Gibt einen Genehmigungsablaufcode an, der fÅr alle mit dieser Vorlage erstellten Einkaufsbelege verwendet werden soll.;
                           ENU=Specifies an approval flow code to use on all purchase documents created with this template.];
                SourceExpr="Approval Flow Code";
                ImplicitType=Code10 }

    { 161024016;3;Field   ;
                Name=Amount Validation;
                ToolTipML=[DEU=Gibt an, ob wÑhrend der Genehmigung die Gesamt-ZeilenbetrÑge bei der Registrierung oder Genehmigung ÅberprÅft werden sollen, um sicherzustellen, dass sie mit den ursprÅnglichen BetrÑgen auf den importierten Dokumenten Åbereinstimmen.;
                           ENU=Specifies whether to check the sum of line amounts when registering or approving purchase documents to ensure they match the original amounts on imported documents.];
                SourceExpr="Amount Validation";
                ImplicitType=Option }

    { 161024014;3;Field   ;
                Name=Purch. Auto App. within Var.;
                ToolTipML=[DEU=Gibt an, ob Einkaufsbelege bei der Registrierung automatisch genehmigt werden sollen, wenn sie mit einer Bestellung oder einer RÅcklieferung innerhalb der erlaubten Abweichung Åbereinstimmen.;
                           ENU=Specifies whether to automatically approve purchase documents when registering if they match with a purchase order or a purchase return order within the allowed variance.];
                SourceExpr="Purch. Auto App. within Var.";
                ImplicitType=Boolean }

    { 1160040023;2;Group  ;
                Name=Matching;
                CaptionML=[DEU=Bestellabgleich;
                           ENU=Matching];
                Visible=ShowMatching;
                GroupType=Group }

    { 61001;3  ;Field     ;
                Name=ALRAutomPOsearch;
                ToolTipML=[DEU=Es wird automatisch nach passenden Bestellnummern gesucht;
                           ENU=The system automatically searches for matching order numbers];
                SourceExpr="Autom. PO search";
                ImplicitType=Boolean }

    { 6085573;3;Field     ;
                Name=Purch. Auto Match;
                ToolTipML=[DEU=Gibt an, ob Dokumente bei der Verarbeitung automatisch abgeglichen werden.;
                           ENU=Specifies whether to match documents automatically when processed.];
                SourceExpr="Purch. Auto Match";
                ImplicitType=Boolean }

    { 161024028;3;Field   ;
                Name=Purch. Match Invoice;
                ToolTipML=[DEU=Gibt an, welche Art von Dokumenten mit Rechnungen abgeglichen werden sollen.;
                           ENU=Specifies which type of documents to match invoices.];
                SourceExpr="Purch. Match Invoice";
                ImplicitType=Option }

    { 1160040019;3;Field  ;
                Name=Purch. Match Credit Memo;
                ToolTipML=[DEU=Gibt an, welche Art von Dokumenten mit Gutschriften abgeglichen werden sollen.;
                           ENU=Specifies which type of documents to match credit memos.];
                SourceExpr="Purch. Match Credit Memo";
                ImplicitType=Option }

    { 1000000019;3;Field  ;
                Name=Max. Variance Amt Allowed LCY;
                ToolTipML=[DEU=Gibt die maximal zulÑssige Differenz an, wenn eine Rechnung oder Gutschrift automatisch einer Lieferung oder RÅcklieferung zugeordnet wird. Document Capture akzeptiert einen automatischen Abgleich, auch wenn zwischen dem Betrag auf der importierten Rechnung oder Gutschrift und dem abgeglichenen Beleg eine Abweichung besteht, sofern er innerhalb dieses Betrags liegt.;
                           ENU=Specifies the maximum difference allowed when automatically matching an invoice or credit memo to either a receivable or deliverable document. Document Capture accepts an automatic match, even if there is a discrepancy between the amount on the imported invoice or credit memo and the matched document, if it is within this amount.];
                SourceExpr="Max. Variance Amt Allowed LCY";
                ImplicitType=Decimal }

    { 1160040011;3;Field  ;
                Name=Allowed Variance %;
                ToolTipML=[DEU=Gibt die maximal zulÑssige Differenz in % an, wenn eine Rechnung oder Gutschrift automatisch einer Lieferung oder RÅcklieferung zugeordnet wird. Document Capture akzeptiert einen automatischen Abgleich, auch wenn zwischen dem Betrag auf der importierten Rechnung oder Gutschrift und dem abgeglichenen Beleg eine Abweichung besteht, sofern er innerhalb dieses Prozentsatzes liegt.;
                           ENU=Specifies the maximum percentage difference allowed when automatically matching an invoice or credit memo to either a receivable or deliverable document. Document Capture accepts an automatic match, even if there is a discrepancy between the amount on the imported invoice or credit memo and the matched document, if it is within the allowed percentage.];
                SourceExpr="Allowed Variance %";
                ImplicitType=Decimal }

    { 161024023;3;Field   ;
                Name=Variance Posting Account;
                ToolTipML=[DEU=Gibt das Sachkonto an, das zum Buchen eines potenziellen Abweichungsbetrags verwendet wird.;
                           ENU=Specifies the G/L account used to post a potential variance amount.];
                SourceExpr="Variance Posting Account";
                ImplicitType=Code20 }

    { 1160040016;3;Field  ;
                Name=Copy Matched Header Dimensions;
                ToolTipML=[DEU=Gibt an, ob die Kopfdimensionen des abgeglichenen Belegs bei der Registrierung in die Einkaufsrechnung oder -gutschrift kopiert werden sollen.;
                           ENU=Specifies whether to copy the header dimensions of the matched document to the purchase invoice or credit memo when registering.];
                SourceExpr="Copy Matched Header Dimensions";
                ImplicitType=Boolean }

    { 6085579;3;Group     ;
                Name=ShowAutoOrderVarianceInv;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowAutoOrderVarianceInv;
                GroupType=Group }

    { 161024032;4;Field   ;
                Name=Auto Receive Order Variance;
                ToolTipML=[DEU=Gibt an, ob die mit der erlaubten Abweichung hinzugefÅgte Bestellzeile automatisch geliefert werden soll.;
                           ENU=Specifies whether to automatically receive the allowed variance line created on a purchase order.];
                SourceExpr="Auto Receive Order Variance";
                ImplicitType=Boolean }

    { 6085580;3;Group     ;
                Name=ShowAutoOrderVarianceCrM;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowAutoOrderVarianceCrM;
                GroupType=Group }

    { 161024033;4;Field   ;
                Name=Auto Ship Return Order Var.;
                ToolTipML=[DEU=Gibt an, ob die mit der erlaubten Abweichung hinzugefÅgte Reklamationzeile automatisch geliefert werden soll.;
                           ENU=Specifies whether to automatically ship the allowed variance line created on a purchase return order.];
                SourceExpr="Auto Ship Return Order Var.";
                ImplicitType=Boolean }

    { 1160040021;2;Group  ;
                Name=Line Matching;
                CaptionML=[DEU=Zeilen matching;
                           ENU=Line Matching];
                Visible=LineRecognitionEnabled;
                GroupType=Group }

    { 1000000022;3;Field  ;
                Name=Purch. Match Order No.;
                ToolTipML=[DEU=Gibt an, ob die im Kopf oder in den Belegzeilen angegebene Bestellnummer Åbereinstimmen soll, wenn die Rechnung oder Gutschrift automatisch abgeglichen wird.;
                           ENU=Specifies whether to match the order number identified in the document header or lines, when automatically matching the invoice or credit memo.];
                SourceExpr="Purch. Match Order No.";
                ImplicitType=Option }

    { 1000000023;3;Field  ;
                Name=Purch. Match Item No.;
                ToolTipML=[DEU=Gibt an, ob die erkannte Artikelnr. in den Zeilen Åbereinstimmen soll, wenn die Rechnung oder Gutschrift automatisch abgeglichen wird. Die Artikelnr. muss bereits einem internen Konto / Artikel zugeordnet sein, bevor dies funktioniert.;
                           ENU=Specifies whether to match the vendor item number on the lines when automatically matching the invoice or credit memo. The vendor item number must already be mapped to an internal account/item before this works.];
                SourceExpr="Purch. Match Item No.";
                ImplicitType=Option }

    { 1000000024;3;Field  ;
                Name=Purch. Match Quantity;
                ToolTipML=[DEU=Gibt an, ob die Menge in den Zeilen abgeglichen werden soll, wenn die Rechnung oder Gutschrift automatisch abgeglichen wird.;
                           ENU=Specifies whether to match the quantity on the lines when automatically matching the invoice or credit memo.];
                SourceExpr="Purch. Match Quantity";
                ImplicitType=Option }

    { 1000000025;3;Field  ;
                Name=Purch. Match Unit Cost>;
                ToolTipML=[DEU=Gibt an, ob der EK-Preis in den Zeilen abgeglichen werden soll, wenn die Rechnung oder Gutschrift automatisch abgeglichen wird.;
                           ENU=Specifies whether to match the unit cost on the lines when automatically matching the invoice or credit memo.];
                SourceExpr="Purch. Match Unit Cost";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ImplicitType=Option }

    { 6085596;3;Group     ;
                Name=Unit Cost - Variance;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowUnitCostVariance;
                GroupType=Group }

    { 6085597;4;Field     ;
                ToolTipML=[DEU=Gibt die maximal erlaubte Abweichung zwischen dem erkannten Einstandspreis und dem Einstandspreis in der Bestellung an. Der Toleranzbetrag wird in MW angegeben, jedoch in die FremdwÑhrung umgerechnet, wenn die Bestellung in FremdwÑhrung erfolgt.;
                           ENU=Specifies the maximum variance between the recognized Unit Cost and the Unit Cost on the Purchase Order(PO). The variance amount is specified in LCY but it is converted to FCY if the PO is in foreign currency.];
                SourceExpr="Unit Cost - Variance Amt (LCY)";
                ImplicitType=Decimal }

    { 6085598;4;Field     ;
                ToolTipML=[DEU="Gibt die maximale Abweichung zwischen dem erkannten Einstandspreis und dem Einstandspreis in der Bestellung als Prozentsatz des erkannten Werts an (""Einstandspreis"" auf der Rechnung). Beispiel: Wenn auf der Rechnung ein Einstandspreis von 100, - erfasst wurde und die Vorlage ""Einstandspreis - Toleranz %"" = 10% enthÑlt, stimmt der ""Bestellabgleich"" mit Bestellpositionen mit Einstandspreisen zwischen 90,- und 110,- Åberein. Wenn sowohl ""Einstandspreis - Toleranz %"" als auch ""Einstandspreis - Toleranzbetrag (MW)"" mit Werten gefÅllt sind, die sich von 0 (Null) unterscheiden, wird der kleinere der beiden Werte verwendet. ";
                           ENU="Specifies the maximum variance between the recognized Unit Cost and the Unit Cost on the Purchase Order(PO) as a percentage of the recognized value (""Unit Cost"" on the invoice). As an example: If a Unit Cost of 100,- has been recognized on the invoice, and the template has ""Unit Cost - Variance %"" = 10%, then ""Auto Match"" will match against PO lines with Unit Cost between 90,- and 110,-. If both ""Unit Cost - Variance %"" and ""Unit Cost - Variance Amt (LCY)"" are populated with values different from 0 (zero) the lesser of the two is used. "];
                SourceExpr="Unit Cost - Variance %";
                ImplicitType=Decimal }

    { 1160040003;1;Group  ;
                Name=Sales Documents;
                CaptionML=[DEU=Verkaufsbelege;
                           ENU=Sales Documents];
                Visible=IsSales;
                GroupType=Group }

    { 1160040026;2;Group  ;
                Name=Registration2;
                CaptionML=[DEU=Registrierung;
                           ENU=Registration];
                GroupType=Group }

    { 1160040002;3;Field  ;
                Name=Sales Order Reg. Step 1;
                ToolTipML=[DEU=Gibt den ersten Schritt an, der bei der Registrierung von VerkaufsauftrÑgen ausgefÅhrt werden muss.;
                           ENU=Specifies the first step to perform when registering sales orders.];
                SourceExpr="Sales Order Reg. Step 1";
                Importance=Promoted;
                ImplicitType=Option }

    { 1160040004;3;Field  ;
                Name=Sales Order Reg. Step 2;
                ToolTipML=[DEU=Gibt den zweiten Schritt an, der bei der Registrierung von VerkaufsauftrÑgen ausgefÅhrt werden muss.;
                           ENU=Specifies the second step to perform when registering sales orders.];
                SourceExpr="Sales Order Reg. Step 2";
                ImplicitType=Option }

    { 1160040017;3;Field  ;
                Name=Sales Cr.Memo Reg. Step 1;
                ToolTipML=[DEU=Gibt den ersten Schritt an, der bei der Registrierung von Verkaufsgutschriften ausgefÅhrt werden muss.;
                           ENU=Specifies the first step to perform when registering sales credit memos.];
                SourceExpr="Sales Cr.Memo Reg. Step 1";
                ImplicitType=Option }

    { 1160040018;3;Field  ;
                Name=Sales Cr.Memo Reg. Step 2;
                ToolTipML=[DEU=Gibt den zweiten Schritt an, der bei der Registrierung von Verkaufsgutschriften ausgefÅhrt werden muss.;
                           ENU=Specifies the second step to perform when registering sales credit memos.];
                SourceExpr="Sales Cr.Memo Reg. Step 2";
                ImplicitType=Option }

    { 1160040005;3;Field  ;
                Name=SalesPostingDate;
                ToolTipML=[DEU=Gibt an, welches Datum bei der Registrierung von Verkaufsbelegen als Buchungsdatum verwendet werden soll.;
                           ENU=Specifies which date to use as the posting date when registering sales documents.];
                SourceExpr="Posting Date";
                ImplicitType=Option }

    { 1160040027;2;Group  ;
                Name=Line Recognition2;
                CaptionML=[DEU=Zeilenerkennung;
                           ENU=Line Recognition];
                Visible=LineRecognitionEnabled;
                GroupType=Group }

    { 1160040007;3;Field  ;
                Name=SalesUseVendorCustomerItemNos;
                CaptionML=[DEU=Debitor nutzt unsere Artikelnummern;
                           ENU=Customer uses your Item Nos.];
                ToolTipML=[DEU=Gibt an, ob der Debitor die gleichen Nummern wie Ihre Artikelnummern verwendet und Sie daher keine öbersetzung von der Debitor-Artikelnr. in Ihre Artikelnummer erstellen mÅssen.;
                           ENU=Specifies if the customer is using the same numbers as your item numbers and thereby you do not need to create a translation from the customer item number to your item number.];
                SourceExpr="Use Vendor/Customer Item Nos.";
                ImplicitType=Boolean }

    { 1160040010;3;Field  ;
                Name=SalesValidateLineTotals;
                ToolTipML=[DEU=Gibt an, ob der Betrag aller erkannten Zeilen gegen das Feld Betrag ohne MwSt. geprÅft werden soll. Bei einer erkannten Differenz wird damit die Registrierung eines Dokuments verhindert.;
                           ENU=Specifies whether to validate the amount of all recognized lines against the field amount excl. VAT and thereby prevent from registering a document there is a difference.];
                SourceExpr="Validate Line Totals";
                Importance=Promoted;
                ImplicitType=Boolean }

    { 161024040;1;Part    ;
                Name=Fields;
                CaptionML=[DEU=Felder;
                           ENU=Fields];
                PagePartID=Page6085585 }

    { 1000000017;1;Group  ;
                Name=Codeunits;
                CaptionML=[DEU=Codeunits;
                           ENU=Codeunits];
                Visible=AdvCaptureActivated;
                Editable=PageIsEditable;
                GroupType=Group }

    { 161024017;2;Field   ;
                Name=CodeunitLineCapture;
                CaptionML=[DEU=Zeilencapture;
                           ENU=Line Capture];
                ToolTipML=[DEU=Gibt eine Codeunit an, die beim Capturen von Dokumenten ausgefÅhrt werden soll.;
                           ENU=Specifies a codeunit to run when capturing lines of documents.];
                SourceExpr=CodeunitLineCapture;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Line Capture",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitLineCapture));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;

                ImplicitType=Text250 }

    { 1000000034;2;Field  ;
                Name=CodeunitAfterCapture;
                CaptionML=[DEU=Nach Capture;
                           ENU=After Capture];
                ToolTipML=[DEU=Gibt eine Codeunit an, die nach der Erkennung von Feldern und Zeilen ausgefÅhrt werden soll, jedoch bevor dem Benutzer Werte angezeigt werden.;
                           ENU=Specifies a codeunit to run after capturing fields and lines, but before values are shown to the user.];
                SourceExpr=CodeunitAfterCapture;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: After Capture",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitAfterCapture));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;

                ImplicitType=Text250 }

    { 1000000035;2;Field  ;
                Name=CodeunitLineVal;
                CaptionML=[DEU=Zeilenvalidierung;
                           ENU=Line Validation];
                ToolTipML=[DEU=Gibt eine Codeunit an, die ausgefÅhrt werden soll, um die Werte von erkannten Zeilen zu ÅberprÅfen.;
                           ENU=Specifies a codeunit to run to validate values of captured lines.];
                SourceExpr=CodeunitLineVal;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Line Validation",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitLineVal));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;

                ImplicitType=Text250 }

    { 1000000036;2;Field  ;
                Name=CodeunitDocVal;
                CaptionML=[DEU=Belegvalidierung;
                           ENU=Document Validation];
                ToolTipML=[DEU=Gibt eine Codeunit an, die ausgefÅhrt werden soll, um zu ÅberprÅfen, ob ein Dokument fÅr die Registrierung gÅltig ist.;
                           ENU=Specifies a codeunit to run to check if a document is valid for registration.];
                SourceExpr=CodeunitDocVal;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Doc. Validation",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitDocVal));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;

                ImplicitType=Text250 }

    { 1000000037;2;Field  ;
                Name=CodeunitRegister;
                CaptionML=[DEU=Registrierung;
                           ENU=Register];
                ToolTipML=[DEU=Gibt eine Codeunit an, die beim Registrieren von Dokumenten ausgefÅhrt werden soll.;
                           ENU=Specifies a codeunit to run when registering documents.];
                SourceExpr=CodeunitRegister;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Register",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitRegister));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;

                ImplicitType=Text250 }

    { 1000000038;2;Field  ;
                Name=CodeunitRegisterYN;
                CaptionML=[DEU=Registrieren (Ja/Nein);
                           ENU=Register (Y/N)];
                ToolTipML=[DEU=Gibt eine Codeunit an, die ausgefÅhrt werden soll, wenn die Dokumentregistrierung manuell aktiviert wird, jedoch bevor die Codeunit zum Registrieren von Dokumenten ausgefÅhrt wird.;
                           ENU=Specifies a codeunit to run when manually activating document registration but before the codeunit to register documents is run.];
                SourceExpr=CodeunitRegisterYN;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Register (Y/N)",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitRegisterYN));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;

                ImplicitType=Text250 }

    { 161024012;2;Field   ;
                Name=CodeunitAfterStep1;
                CaptionML=[DEU=Nach Schritt 1;
                           ENU=After Step 1];
                ToolTipML=[DEU=Gibt eine Codeunit an, die nach dem ersten Registrierungsschritt ausgefÅhrt werden soll.;
                           ENU=Specifies a codeunit to run after performing the first registration step.];
                SourceExpr=CodeunitAfterStep1;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: After Step 1",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitAfterStep1));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;

                ImplicitType=Text250 }

    { 161024013;2;Field   ;
                Name=CodeunitAfterStep2;
                CaptionML=[DEU=Nach Schritt 2;
                           ENU=After Step 2];
                ToolTipML=[DEU=Gibt eine Codeunit an, die nach dem zweiten Registrierungsschritt ausgefÅhrt werden soll.;
                           ENU=Specifies a codeunit to run after performing the second registration step.];
                SourceExpr=CodeunitAfterStep2;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: After Step 2",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitAfterStep2));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;

                ImplicitType=Text250 }

    { 1000000040;2;Field  ;
                Name=CodeunitTranslations;
                CaptionML=[DEU=öbersetzungen anzeigen;
                           ENU=Show Translations];
                ToolTipML=[DEU=Gibt eine Codeunit an, die zum Anzeigen von VorlagenÅbersetzungen ausgefÅhrt werden soll.;
                           ENU=Specifies a codeunit to run to show template translations.];
                SourceExpr=CodeunitTransl;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Translations",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitTransl));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;

                ImplicitType=Text250 }

    { 1000000041;2;Field  ;
                Name=CodeunitShowMatch;
                CaptionML=[DEU=Zuordnung zeigen;
                           ENU=Show Match];
                ToolTipML=[DEU=Gibt eine Codeunit an, die ausgefÅhrt werden soll, um Åbereinstimmende Zeilen anzuzeigen.;
                           ENU=Specifies a codeunit to run to show matched lines.];
                SourceExpr=CodeunitShowMatch;
                LookupPageID=Objects;
                OnValidate=BEGIN
                             VALIDATE("Codeunit ID: Show Match",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Codeunit,CodeunitShowMatch));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Codeunit,Text));
                         END;

                ImplicitType=Text250 }

  }
  CODE
  {
    VAR
      AllObjWithCaption@1000 : Record 2000000058;
      RecIDMgt@1001 : Codeunit 6085604;
      CaptureMgt@6085588 : Codeunit 6085576;
      SourceID@161024012 : Text[250];
      SourceName@6085578 : Text[250];
      SearchText@1160040013 : Text[250] INDATASET;
      CodeunitLineCapture@1160040001 : Text[250];
      CodeunitAfterCapture@1160040002 : Text[250];
      CodeunitLineVal@1160040003 : Text[250];
      CodeunitDocVal@1160040004 : Text[250];
      CodeunitRegister@1160040005 : Text[250];
      CodeunitRegisterYN@1160040006 : Text[250];
      CodeunitAfterStep1@1160040007 : Text[250];
      CodeunitAfterStep2@1160040008 : Text[250];
      CodeunitTransl@1160040010 : Text[250];
      CodeunitShowMatch@1160040011 : Text[250];
      CategoryCodeVisible@1160040000 : Boolean INDATASET;
      IsSales@1160040015 : Boolean INDATASET;
      IsPurchases@6085590 : Boolean INDATASET;
      PurchUpdateOrder@1160040014 : Boolean INDATASET;
      PurchUpdateRetOrder@1160040016 : Boolean INDATASET;
      LineRecognitionEnabled@1160040017 : Boolean INDATASET;
      ShowInteractionTemplateCode@6085573 : Boolean INDATASET;
      ShowFirstLineHasCaptions@6085574 : Boolean INDATASET;
      ShowApproval@6085575 : Boolean INDATASET;
      ShowMatching@6085576 : Boolean INDATASET;
      ShowDescription@6085580 : Boolean INDATASET;
      IsMasterTemplate@6085577 : Boolean INDATASET;
      PageIsEditable@6085579 : Boolean INDATASET;
      TotalSearchTextsTxt@1160040012 : TextConst 'DEU=(%1 Texte insgesamt);ENU=(%1 texts in total)';
      SearchTextEditable@1160040018 : Boolean INDATASET;
      ShowAutoOrderVarianceInv@6085581 : Boolean INDATASET;
      ShowAutoOrderVarianceCrM@6085582 : Boolean INDATASET;
      AdvCaptureActivated@6085583 : Boolean INDATASET;
      RecognizeLinesBoolean@6085584 : Boolean INDATASET;
      HasSourceTableNo@6085585 : Boolean INDATASET;
      ShowXMLFields@6085586 : Boolean INDATASET;
      IsIdentificationTemplate@6085587 : Boolean INDATASET;
      StylesheetImported@6085589 : Boolean INDATASET;
      DocumentNo@6085600 : Code[20];
      ShowUnitCostVariance@6085591 : Boolean INDATASET;

    [LineStart(2651)]
    LOCAL PROCEDURE SetShowDescription@6085574() : Boolean;
    VAR
      Template@6085573 : Record 6085579;
    BEGIN
      CASE Type OF
        Type::Identification:
          BEGIN
            IF "Data Type" = "Data Type"::XML THEN BEGIN
              Template.SETCURRENTKEY("Category Code",Type);
              Template.SETRANGE("Category Code","Category Code");
              Template.SETRANGE(Type,Type);
            END ELSE
              EXIT(FALSE);
          END;
        Type::Master:
          BEGIN
            Template.SETCURRENTKEY("Category Code",Type);
            Template.SETRANGE("Category Code","Category Code");
            Template.SETRANGE(Type,Type);
          END;
        Type::" ":
          BEGIN
            Template.SETCURRENTKEY("Category Code","Source Record ID Tree ID");
            Template.SETRANGE("Category Code","Category Code");
            Template.SETRANGE("Source Record ID Tree ID","Source Record ID Tree ID");
          END;
      END;
      EXIT(Template.COUNT > 1);
    END;

    [LineStart(2677)]
    PROCEDURE GetCaption@1160040000() : Text[250];
    BEGIN
      CASE Type OF
        Type::Identification,Type::Master:
          EXIT(STRSUBSTNO('%1 - %2',Type,"No."));
        Type::" ":
          EXIT(STRSUBSTNO('%1 - %2 - %3',"No.",GetSourceID,GetSourceName));
      END;
    END;

    [LineStart(2685)]
    PROCEDURE SetDocumentNo@6085600(NewDocumentNo@6085600 : Code[20]);
    BEGIN
      DocumentNo := NewDocumentNo;
      CurrPage.Fields.PAGE.SetDocumentNo(DocumentNo);
    END;

    [LineStart(2689)]
    LOCAL PROCEDURE ShowCDNNetworkProfiles@1();
    VAR
      TemplateProfileRel@1001 : Record 6086235;
    BEGIN
      TemplateProfileRel.FILTERGROUP := 2;

      TemplateProfileRel.SETRANGE("Document Category",Rec."Category Code");
      TemplateProfileRel.SETRANGE("XML Master Template",Rec."No.");

      PAGE.RUN(PAGE::"CTS-CDN DC Templ. Profile Rel.",TemplateProfileRel);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 6085586 CDC Template Field Card
{
  OBJECT-PROPERTIES
  {
    Date=01/05/22;
    Time=10:55:59 PM;
    Modified=Yes;
    Version List=DCW17.00.00.8.00,ALR1.15;
  }
  PROPERTIES
  {
    CaptionML=[DEU=Vorlage Feld Karte;
               ENU=Template Field Card];
    SourceTable=Table6085580;
    DataCaptionExpr=STRSUBSTNO('%1 - %2 - %3 - %4',"Template No.",Type,Code,"Field Name");
    PageType=Card;
    OnOpenPage=BEGIN
                 UpdateControls;
               END;

    OnAfterGetRecord=VAR
                       Template@6085574 : Record 6085579;
                       DocCat@6085573 : Record 6085575;
                     BEGIN
                       UpdateControls;

                       Template.GET("Template No.");
                       DocCat.GET(Template."Category Code");

                       CodeunitLookup := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Lookup");
                       CodeunitCaptureVal := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Capture Value");
                       CodeunitIsValid := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Is OK");
                       CodeunitValidate := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Codeunit,"Codeunit ID: Validate");

                       SourceTable := RecIDMgt.GetObjectCaption(AllObjWithCaption."Object Type"::Table,"Source Table No.");
                       SourceField := RecIDMgt.GetFieldCaption("Source Table No.","Source Field No.");

                       DestHeaderField := RecIDMgt.GetFieldCaption(DocCat."Destination Header Table No.","Destination Header Field No.");
                       DestLineField := RecIDMgt.GetFieldCaption(DocCat."Destination Line Table No.","Destination Line Field No.");

                       FormulaTxt := '';
                       IF Formula <> '' THEN
                         FormulaTxt := Formula
                       ELSE BEGIN
                         FormulaTxt := GetFixedValue;
                         IF FormulaTxt <> '' THEN
                           FormulaTxt := '''' + FormulaTxt + '''';
                       END;

                       UpdateALRFields();
                     END;

    OnNewRecord=BEGIN
                  FILTERGROUP(4);
                  SETRANGE(Type);
                  SETRANGE(Code);

                  CLEAR(Type);
                  Code := '';
                  FILTERGROUP(0);

                  UpdateControls;

                  CodeunitLookup := '';
                  CodeunitCaptureVal := '';
                  CodeunitIsValid := '';
                  CodeunitValidate := '';

                  SourceTable := '';
                  SourceField := '';

                  DestHeaderField := '';
                  DestLineField := '';
                END;

    OnQueryClosePage=BEGIN
                       EXIT(IsFormulaValid(FormulaTxt,TRUE));
                     END;

    ActionList=ACTIONS
    {
      { 6085575 ;    ;ActionContainer;
                      Name=RelatedInformation;
                      ActionContainerType=RelatedInformation }
      { 6085574 ;1   ;ActionGroup;
                      Name=Functions;
                      CaptionML=[DEU=F&unktionen;
                                 ENU=F&unctions] }
      { 6085576 ;2   ;Action    ;
                      Name=Captions;
                      CaptionML=[DEU=Suchtexte;
                                 ENU=Captions];
                      ToolTipML=[DEU=Anzeigen oder Bearbeiten der Suchtexte, die in Dokumenten verwendet werden, um einen entsprechenden Wert zu finden.;
                                 ENU=View or edit captions searched for in documents to find a corresponding value.];
                      Promoted=Yes;
                      Visible=NOT ShowXmlPath;
                      Image=Comment;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowCaptions;
                               END;
                                }
      { 6085573 ;2   ;Action    ;
                      Name=Rules;
                      CaptionML=[DEU=Regeln;
                                 ENU=Rules];
                      ToolTipML=[DEU=Zeigen Sie die Regeln an oder bearbeiten Sie sie, um zu ÅberprÅfen, ob ein Feld einen gÅltigen Wert enthÑlt.;
                                 ENU=View or edit the rules used to check if a field contains a valid value.];
                      Promoted=Yes;
                      Image=ViewCheck;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowRules;
                               END;
                                }
      { 6085577 ;2   ;Action    ;
                      Name=Codeunits;
                      CaptionML=[DEU=Codeunits;
                                 ENU=Codeunits];
                      ToolTipML=[DEU=Anzeigen oder Bearbeiten von Codeunits, die zum AusfÅhren erweiterter Feldaktionen verwendet werden.;
                                 ENU=View or edit codeunits used to perform advanced field actions.];
                      Promoted=Yes;
                      Image=CodesList;
                      PromotedCategory=Process;
                      OnAction=BEGIN
                                 ShowCodeunits;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                Name=ContentArea;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                Name=General;
                CaptionML=[DEU=Allgemein;
                           ENU=General];
                GroupType=Group }

    { 1160040016;2;Field  ;
                Name=Type;
                ToolTipML=[DEU=Gibt an, ob es sich um ein Kopf- oder Zeilenfeld handelt.;
                           ENU=Specifies whether this is a header or line field.];
                SourceExpr=Type;
                Visible=ShowCodeAndType;
                ImplicitType=Option }

    { 1160040017;2;Field  ;
                Name=Code;
                ToolTipML=[DEU=Gibt einen Vorlagenfeldcode an.;
                           ENU=Specifies a template field code.];
                SourceExpr=Code;
                Visible=ShowCodeAndType;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ImplicitType=Code20 }

    { 1000000026;2;Field  ;
                Name=Field Name;
                ToolTipML=[DEU=Gibt den Namen des Felds an, das bei der Verarbeitung von Dokumenten angezeigt wird.;
                           ENU=Specifies the name of the field shown when processing documents.];
                SourceExpr="Field Name";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ImplicitType=Text50 }

    { 6085585;2;Group     ;
                Name=XmlPathGroup;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowXmlPath;
                GroupType=Group }

    { 6085584;3;Field     ;
                Name=XMLPath;
                ToolTipML=[DEU=Gibt den XML-Pfad an, unter dem sich der Wert fÅr dieses Feld im XML-Dokument befindet.;
                           ENU=Specifies the XML Path where the value for this field is to be found in the XML Document.];
                SourceExpr="XML Path";
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                OnAssistEdit=VAR
                               CaptureMgt@6085573 : Codeunit 6085576;
                             BEGIN
                               IF CaptureMgt.XmlPathAssistEdit(CurrentDocumentNo,"Template No.",Type,Code,"XML Path") THEN
                                 VALIDATE("XML Path");
                             END;

                ImplicitType=Text250 }

    { 6085601;2;Group     ;
                Name=ShowFieldGroup;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowXmlPath AND ShowXMLShowField;
                GroupType=Group }

    { 1   ;3   ;Field     ;
                ToolTipML=[DEU=Gibt an, ob das Zeilenfeld in der Dokumentenkarte angezeigt werden soll.;
                           ENU=Specifies wheather to show the Line Template Field in the Document Card.];
                SourceExpr="Show Field";
                ImplicitType=Option }

    { 1000000008;2;Field  ;
                Name=Caption;
                CaptionML=[DEU=Suchtext;
                           ENU=Caption];
                ToolTipML=[DEU=Gibt den Suchtext an, nach dem in Dokumenten gesucht wird, um das Feld und den Wert zu identifizieren. Verwenden Sie den Drilldown, um weitere Suchtexte anzugeben.;
                           ENU=Specifies the caption that is searched for in documents to identify the field and value. Use drill down to specify alternative captions.];
                SourceExpr=CaptionText;
                Visible=NOT ShowXmlPath;
                Editable=EditCaption;
                OnValidate=VAR
                             TemplateFieldCaption@6085573 : Record 6085581;
                           BEGIN
                             TemplateFieldCaption.SETRANGE("Template No.","Template No.");
                             TemplateFieldCaption.SETRANGE(Type,Type);
                             TemplateFieldCaption.SETRANGE(Code,Code);
                             IF TemplateFieldCaption.FINDFIRST THEN BEGIN
                               IF CaptionText = '' THEN
                                 TemplateFieldCaption.DELETE
                               ELSE BEGIN
                                 TemplateFieldCaption.Caption := CaptionText;
                                 TemplateFieldCaption."Caption Length" := STRLEN(TemplateFieldCaption.Caption);
                                 TemplateFieldCaption.MODIFY;
                               END;
                             END ELSE BEGIN
                               TemplateFieldCaption.INIT;
                               TemplateFieldCaption."Template No." := "Template No.";
                               TemplateFieldCaption.Type := Type;
                               TemplateFieldCaption.Code := Code;
                               TemplateFieldCaption."Line No." := 10000;
                               TemplateFieldCaption.Caption := CaptionText;
                               TemplateFieldCaption."Caption Length" := STRLEN(TemplateFieldCaption.Caption);
                               TemplateFieldCaption.INSERT;
                             END;
                           END;

                OnDrillDown=BEGIN
                              ShowCaptions;
                            END;

                ImplicitType=Text300 }

    { 1000000025;2;Field  ;
                Name=Rule;
                CaptionML=[DEU=Regel;
                           ENU=Rule];
                ToolTipML=[DEU=Gibt die Regel an, mit der geprÅft wird, ob der Wert des Felds ein korrektes Format hat. Verwenden Sie den Drilldown, um mehrere Regeln anzugeben.;
                           ENU=Specifies the rule used to check if the value of the field has a correct format. Use drill down to specify multiple rules.];
                SourceExpr=RuleText;
                Editable=EditRule;
                OnValidate=VAR
                             TemplateFieldRule@6085573 : Record 6085583;
                           BEGIN
                             TemplateFieldRule.SETRANGE("Template No.","Template No.");
                             TemplateFieldRule.SETRANGE(Type,Type);
                             TemplateFieldRule.SETRANGE(Code,Code);
                             IF TemplateFieldRule.FINDFIRST THEN BEGIN
                               IF RuleText = '' THEN
                                 TemplateFieldRule.DELETE
                               ELSE BEGIN
                                 TemplateFieldRule.Rule := RuleText;
                                 TemplateFieldRule.MODIFY;
                               END;
                             END ELSE BEGIN
                               TemplateFieldRule.INIT;
                               TemplateFieldRule."Template No." := "Template No.";
                               TemplateFieldRule.Type := Type;
                               TemplateFieldRule.Code := Code;
                               TemplateFieldRule."Entry No." := 10000;
                               TemplateFieldRule.Rule := RuleText;
                               TemplateFieldRule.INSERT;
                             END;
                           END;

                OnDrillDown=BEGIN
                              ShowRules;
                            END;

                ImplicitType=Text300 }

    { 1000000003;2;Field  ;
                Name=Required;
                ToolTipML=[DEU=Gibt an, ob das Feld ein Pflichtfeld ist. Wenn im Dokument kein Wert erkannt werden kann, muss der Wert manuell angegeben werden, um das Dokument registrieren zu kînnen.;
                           ENU=Specifies whether a value is required for the field before a document can be registered. If a value cannot be recognized in the document, then the value must be specified manually to register the document.];
                SourceExpr=Required;
                Importance=Additional;
                ImplicitType=Boolean }

    { 1000000004;2;Field  ;
                Name=Search for Value;
                ToolTipML=[DEU=Gibt an, ob wÑhrend der Erkennung nach dem Feld gesucht werden soll.;
                           ENU=Specifies whether to search for the field during recognition.];
                SourceExpr="Search for Value";
                Importance=Additional;
                Editable=SearchForValueEditable;
                ImplicitType=Boolean }

    { 6085583;2;Field     ;
                Name=Formula Text;
                CaptionML=[DEU=Formel;
                           ENU=Formula];
                ToolTipML=[DEU=Gibt eine Formel an, die zur Berechnung des Feldwerts verwendet wird. Wenn es sich um ein Zahlenfeld handelt, kînnen Sie die Formel mit anderen Zahlenfeldern aus der Vorlage oder mit konstanten Zahlenwerten erstellen und Operatoren wie * / + - verwenden. Wenn es sich um ein Textfeld handelt, kînnen Sie alle Felder aus der Vorlage verwenden und die Werte mithilfe des Pluszeichens verketten.;
                           ENU=Specifies a formula used to calculate the field value. If it is a number-field, you can construct the formula with other number-fields from the template, or with constant number values, and use operators such as * / + -. If it is a text field, you can use all fields from the template, and concatenate the values using the + sign.];
                SourceExpr=FormulaTxt;
                OnValidate=BEGIN
                             FormulaTxt := RemoveQuotationMarks(FormulaTxt);
                             SetFormula(FormulaTxt);
                             SearchForValueEditable := (Formula = '') AND (FixedValue = '');
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=VAR
                           PrevText@6085573 : Text[1024];
                         BEGIN
                           PrevText := Text;
                           IF FormulaOnLookup(Text) THEN BEGIN
                             Text := PrevText + Text;
                             EXIT(TRUE);
                           END;
                         END;

                ImplicitType=Text1024 }

    { 161024016;2;Field   ;
                Name=Insert on new Templates;
                ToolTipML=[DEU=Gibt an, ob das Feld in alle neuen Vorlagen eingefÅgt werden soll. Wenn dies nicht aktiviert ist, kann das Feld bei Bedarf manuell zu einzelnen Dokumenten und Vorlagen hinzugefÅgt werden.;
                           ENU=Specifies whether to insert the field on all new templates. If this is not enabled, then the field can be manually added to individual documents and templates when needed.];
                SourceExpr="Insert on new Templates";
                Importance=Additional;
                Visible=IsMasterTemplate;
                ImplicitType=Boolean }

    { 1000000022;2;Field  ;
                Name=Default Page Source;
                ToolTipML=[DEU=Gibt an, ob bei der Suche nach dem Wert des Felds mit der ersten oder letzten Seite begonnen werden soll. Wenn auf der ersten oder letzten Seite kein Wert erkannt wird, wird der Rest des Dokuments durchsucht.;
                           ENU=Specifies whether to start on the first or last page when searching for the value of the field. If a value is not recognized on either the first or last page, then the rest of the document is searched.];
                SourceExpr="Default Page Source";
                Importance=Additional;
                Visible=NOT ShowXmlPath;
                ImplicitType=Option }

    { 1000000002;2;Field  ;
                Name=Data Type;
                ToolTipML=[DEU=Gibt den Datentyp der in diesem Feld gespeicherten Werte an.;
                           ENU=Specifies the data type of the values saved in this field.];
                SourceExpr="Data Type";
                Importance=Additional;
                OnValidate=BEGIN
                             CurrPage.UPDATE(TRUE);
                           END;

                ImplicitType=Option }

    { 6085581;2;Group     ;
                Name=StopLineRecognition;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowStopLineRecognition AND NOT ShowXmlPath;
                GroupType=Group }

    { 1000000015;3;Field  ;
                Name=Stop Lines Recognition;
                ToolTipML=[DEU=Gibt an, wann die Zeilenerkennung in Dokumenten gestoppt werden soll.;
                           ENU=Specifies when to stop recognizing lines in documents.];
                SourceExpr="Stop Lines Recognition";
                Importance=Additional;
                Visible=LineRecognitionEnabled;
                ImplicitType=Option }

    { 1160040015;2;Field  ;
                Name=Use as Doc. Separator;
                ToolTipML=[DEU=Gibt an, ob das Feld ein Belegtrennzeichen ist und ob Dokumente automatisch aufgeteilt werden sollen, wenn sich der Wert des Felds in einer PDF-Datei zwischen einer Seite und der nÑchsten Ñndert. Wird in Kombination mit der Konfiguration der Belegtrennung auf der Belegkategorie verwendet.;
                           ENU=Specifies whether the field is a document separator and if documents should be split automatically if the value of the field changes between one page and the next in a PDF file. Used in combination with the configuration of document splitting on the document category.];
                SourceExpr="Use as Doc. Separator";
                Importance=Additional;
                Visible=NOT ShowXmlPath;
                ImplicitType=Boolean }

    { 1160040011;2;Group  ;
                Name=Date Settings;
                CaptionML=[DEU=Datumseinstellungen;
                           ENU=Date Settings];
                Visible=IsDate;
                GroupType=Group }

    { 1000000011;3;Field  ;
                Name=Language Code;
                ToolTipML=[DEU=Gibt die Sprache an, in der Datumsangaben erkannt werden, wenn Monate in Worten und nicht in Zahlen geschrieben werden. Um beispielsweise "October" zu erkennen, muss die Sprache Englisch sein. Bei allen Vorlagenfeldern wird die Sprache von der Vorlage Åbernommen.;
                           ENU=Specifies the language used to recognize dates when months are written in words and not numerical. For example, to recognize "Oktober" the language must be Danish. All template fields will have the language inherited from the template.];
                SourceExpr="Language Code";
                Editable=IsDate;
                ImplicitType=Code10 }

    { 161024025;3;Field   ;
                Name=Date Format;
                ToolTipML=[DEU=Gibt das Datumsformat an, das zum Erkennen von Datumsangaben in Dokumenten verwendet wird. Alle Vorlagenfelder nutzen das von der Vorlage Åbernommene Datumsformat.;
                           ENU=Specifies the date format used to recognize dates in documents. All template fields have the date format inherited from the template.];
                SourceExpr="Date Format";
                Editable=IsDate;
                ImplicitType=Option }

    { 1160040005;3;Field  ;
                Name=Validation Dateformula From;
                ToolTipML=[DEU=Gibt eine Datumsformel an, um das frÅheste zulÑssige Datum fÅr ein Feld zu definieren. Die Berechnung erfolgt in Bezug auf das heutige Datum.;
                           ENU=Specifies a date formula to define the earliest allowed date for a field. The calculation will be made in relation to today's date.];
                SourceExpr="Validation Dateformula From";
                Importance=Additional;
                Editable=IsDate;
                ImplicitType=DateFormula }

    { 1160040004;3;Field  ;
                Name=Validation Dateformula To;
                ToolTipML=[DEU=Gibt eine Datumsformel zum Definieren des letzten zulÑssigen Datums fÅr ein Feld an. Die Berechnung der Formel erfolgt nach heutigem Datum.;
                           ENU=Specifies a date formula for defining the latest allowed date for a field. Calculating the formula will be done according to today's date.];
                SourceExpr="Validation Dateformula To";
                Importance=Additional;
                Editable=IsDate;
                ImplicitType=DateFormula }

    { 6085586;3;Field     ;
                ToolTipML=[DEU=Gibt eine Datumsformel (zum Bsp. CM-1D) an, die auf den erfassten Datumswert angewendet wird.;
                           ENU=Specifies a date formula (e.g. CM-1D) that will be applied to the captured date value.];
                SourceExpr="Calculate Date (Date Formula)";
                Importance=Additional;
                Editable=IsDate;
                ImplicitType=DateFormula }

    { 1160040014;2;Group  ;
                Name=Number Settings;
                CaptionML=[DEU=Nummerierung Einstellungen;
                           ENU=Number Settings];
                Visible=IsNumber;
                GroupType=Group }

    { 1160040013;3;Field  ;
                Name=Make Absolute Number;
                ToolTipML=[DEU=Gibt an, ob negative Zahlen in positive Zahlen umgewandelt werden sollen.;
                           ENU=Specifies whether to convert negative numbers into positive numbers.];
                SourceExpr="Make Absolute Number";
                Editable=IsNumber;
                ImplicitType=Boolean }

    { 6085582;3;Field     ;
                Name=DecimalPlacesDescription;
                CaptionML=[DEU=Dezimalstellen;
                           ENU=Decimal Places];
                ToolTipML=[DEU=Gibt die Anzahl der Dezimalstellen fÅr Werte an. Zum Beispiel bedeutet 2: 5, dass das Feld immer 2 Dezimalstellen und maximal 5 Dezimalstellen enthÑlt.;
                           ENU=Specifies the number of decimal places for values. E.g. 2:5 means that the field will always show 2 decimals and a maximum of 5 decimals.];
                SourceExpr=DecimalPlacesDescription;
                Editable=IsNumber;
                OnValidate=BEGIN
                             DecimalPlacesDescription := ParseDecimalPlacesDescription(DecimalPlacesDescription);
                             DecimalPlacesDescription := ValidateDecimalPlaces(DecimalPlacesDescription);
                             MODIFY;
                             CurrPage.UPDATE(TRUE);
                           END;

                OnAssistEdit=BEGIN
                               PAGE.RUNMODAL(PAGE::"CDC Decimal Places Lookup",Rec);
                               CurrPage.UPDATE(TRUE);
                             END;

                ImplicitType=Text50 }

    { 1160040001;3;Field  ;
                Name=Blank Zero;
                ToolTipML=[DEU=Gibt an, ob das Feld leer bleiben soll, anstatt "0" anzuzeigen, wenn der Wert Null ist.;
                           ENU=Specifies whether the field should be left empty, instead of showing "0", if the value is zero.];
                SourceExpr="Blank Zero";
                Importance=Additional;
                Editable=IsNumber;
                ImplicitType=Boolean }

    { 61099;3  ;Field     ;
                Name=ALRChangeSign;
                ToolTipML=[DEU=Dreht das Vorzeichen einer Zahl um.;
                           ENU=Flips the sign of a number.];
                Description=Needed until field is implemented by default;
                SourceExpr="Change Sign";
                ImplicitType=Boolean }

    { 1160040010;2;Group  ;
                Name=Lookup Values;
                CaptionML=[DEU=Lookup Werte;
                           ENU=Lookup Values];
                Visible=IsLookup;
                GroupType=Group }

    { 161024015;3;Field   ;
                Name=SourceTable;
                CaptionML=[DEU=Herkunftstabellen;
                           ENU=Source Table];
                ToolTipML=[DEU=Gibt die Tabelle an, die alle gÅltigen Werte fÅr das Feld enthÑlt.;
                           ENU=Specifies the table that contains all valid values for the field.];
                SourceExpr=SourceTable;
                Editable=IsLookup;
                OnValidate=BEGIN
                             VALIDATE("Source Table No.",RecIDMgt.GetObjectID(AllObjWithCaption."Object Type"::Table,SourceTable));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupObject(AllObjWithCaption."Object Type"::Table,Text));
                         END;

                ImplicitType=Text250 }

    { 161024028;3;Field   ;
                Name=SourceField;
                CaptionML=[DEU=Herkunftsfeld;
                           ENU=Source Field];
                ToolTipML=[DEU=Gibt das Feld der Herkunftstabelle an, das die Werte enthÑlt, die im Feld gespeichert werden sollen.;
                           ENU=Specifies the field of the source table which contains the values to be saved in the field.];
                SourceExpr=SourceField;
                Editable=IsLookup;
                LookupPageID=Field List;
                OnValidate=BEGIN
                             VALIDATE("Source Field No.",RecIDMgt.GetFieldID("Source Table No.",SourceField));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=BEGIN
                           EXIT(RecIDMgt.LookupField(Text,"Source Table No.",TRUE));
                         END;

                ImplicitType=Text250 }

    { 161024029;3;Field   ;
                Name=No. of Source Table Filters;
                ToolTipML=[DEU="Gibt die Anzahl der auf die Herkunftstabelle angewendeten Filter an, wenn einige DatensÑtze aus der Herkunftstabelle herausgefiltert werden sollen. ";
                           ENU="Specifies the number of filters applied to the source table if some records from the source table should be filtered out. "];
                SourceExpr="No. of Source Table Filters";
                OnDrillDown=BEGIN
                              RecIDMgt.ShowTableFields("Source Table No.","Template No.",Type,TRUE,"Source Table Filter GUID");
                              CurrPage.UPDATE(TRUE);
                            END;

                ImplicitType=Integer }

    { 1160040009;2;Group  ;
                Name=Transfer Value to...;
                CaptionML=[DEU=Wert Åbertragen nach...;
                           ENU=Transfer Value to...];
                Visible=ShowTransferValue;
                GroupType=Group }

    { 161024030;3;Field   ;
                Name=DestHeaderField;
                ToolTipML=[DEU=Gibt das Feld in der Kopftabelle an, in das der Wert beim Registrieren von Dokumenten Åbertragen werden soll.;
                           ENU=Specifies the field in the header table where to transfer the value when registering documents.];
                SourceExpr=DestHeaderField;
                CaptionClass=GetDestFieldCaption(0);
                Editable=IsDestHeader;
                OnValidate=VAR
                             Template@1160040001 : Record 6085579;
                             DocCat@1160040002 : Record 6085575;
                           BEGIN
                             Template.GET("Template No.");
                             DocCat.GET(Template."Category Code");
                             VALIDATE("Destination Header Field No.",RecIDMgt.GetFieldID(DocCat."Destination Header Table No.",DestHeaderField));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=VAR
                           DocCat@161024014 : Record 6085575;
                           Template@161024013 : Record 6085579;
                         BEGIN
                           IF Type = Type::Line THEN
                             EXIT;

                           Template.GET("Template No.");
                           DocCat.GET(Template."Category Code");
                           EXIT(RecIDMgt.LookupField(Text,DocCat."Destination Header Table No.",FALSE));
                         END;

                ImplicitType=Text250 }

    { 1160040000;3;Field  ;
                Name=DestLineField;
                ToolTipML=[DEU=Gibt das Feld in der Zeilentabelle an, in das der Wert beim Registrieren von Dokumenten Åbertragen werden soll.;
                           ENU=Specifies the field in the line table where to transfer the value when registering documents.];
                SourceExpr=DestLineField;
                CaptionClass=GetDestFieldCaption(1);
                Editable=IsDestLine;
                OnValidate=VAR
                             Template@1160040001 : Record 6085579;
                             DocCat@1160040002 : Record 6085575;
                           BEGIN
                             Template.GET("Template No.");
                             DocCat.GET(Template."Category Code");
                             VALIDATE("Destination Line Field No.",RecIDMgt.GetFieldID(DocCat."Destination Line Table No.",DestLineField));
                             CurrPage.UPDATE(TRUE);
                           END;

                OnLookup=VAR
                           DocCat@1160040003 : Record 6085575;
                           Template@1160040002 : Record 6085579;
                         BEGIN
                           Template.GET("Template No.");
                           DocCat.GET(Template."Category Code");
                           EXIT(RecIDMgt.LookupField(Text,DocCat."Destination Line Table No.",FALSE));
                         END;

                ImplicitType=Text250 }

    { 1160040003;3;Field  ;
                Name=Transfer Blank Values;
                ToolTipML=[DEU=Gibt an, ob Felder ohne Wert in einem Dokument wÑhrend der Registrierung in die Kopf- oder Zeilentabelle Åbertragen werden mÅssen, wodurch der Wert des Felds im neu erstellten Dokument ausgeblendet wird. Wenn dies nicht aktiviert ist, werden Feldwerte wÑhrend der Registrierung nur in die Kopf- oder Zeilentabelle Åbertragen, wenn das Dokument einen Wert enthÑlt.;
                           ENU=Specifies whether fields without a value in a document must be transferred to the header or line table during registration, thereby blanking the value of the field in the newly created document. If this is not enabled, field values will only be transferred to the header or line table during registration, if there is a value in the field in the document.];
                SourceExpr="Transfer Blank Values";
                Importance=Additional;
                ImplicitType=Boolean }

    { 1160040007;2;Group  ;
                Name=Advanced Recognition Settings;
                CaptionML=[DEU=Erweiterte Erkennungseinstellungen;
                           ENU=Advanced Recognition Settings];
                GroupType=Group }

    { 1160040012;3;Field  ;
                Name=Delete Blanks;
                ToolTipML=[DEU=Gibt an, ob alle Leerzeichen aus dem erkannten Wert gelîscht werden sollen.;
                           ENU=Specifies whether to delete all spaces from the recognized value.];
                SourceExpr="Delete Blanks";
                Importance=Additional;
                ImplicitType=Boolean }

    { 6085578;3;Group     ;
                Name=MultiLineGroup;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowMultiline AND NOT ShowXmlPath;
                GroupType=Group }

    { 161024027;4;Field   ;
                Name=Multiline;
                ToolTipML=[DEU=Gibt an, ob es sich um ein mehrzeiliges Feld handelt und der Wert sich Åber mehrere Zeilen erstreckt.;
                           ENU=Specifies whether this is a multiline field and the value is on multiple lines.];
                SourceExpr=Multiline;
                Importance=Additional;
                ImplicitType=Boolean }

    { 1000000019;3;Field  ;
                Name=Typical Field Width;
                ToolTipML=[DEU=Gibt die typische Breite der erkannten Feldwerte an.;
                           ENU=Specifies the typical width of recognized field values.];
                SourceExpr="Typical Field Width";
                Importance=Additional;
                Visible=NOT ShowXmlPath;
                ImplicitType=Decimal }

    { 1000000021;3;Field  ;
                Name=Typical Field Height;
                ToolTipML=[DEU=Gibt die typische Hîhe der erkannten Feldwerte an.;
                           ENU=Specifies the typical height of recognized field values.];
                SourceExpr="Typical Field Height";
                Importance=Additional;
                Visible=NOT ShowXmlPath;
                ImplicitType=Decimal }

    { 1160040006;2;Group  ;
                Name=Rules and Captions;
                CaptionML=[DEU=Regeln und Suchbegriffe;
                           ENU=Rules and Captions];
                GroupType=Group }

    { 6085579;3;Group     ;
                Name=EnableRuleGroup;
                CaptionML=[DEU="";
                           ENU=""];
                Visible=ShowEnableGenRule;
                GroupType=Group }

    { 1000000009;4;Field  ;
                Name=Enable Rule Generation;
                ToolTipML=[DEU=Gibt an, ob die Liste der Regeln automatisch verwaltet werden soll. Wenn aktiviert, wird beim Erfassen eines Werts automatisch eine neue Regel mit regulÑren AusdrÅcken generiert, die dem erfassten Wert entsprechen.;
                           ENU=Specifies whether to maintain the list of rules automatically. When enabled, a new rule will automatically be generated, when capturing a value (by manually updating the field caption and value), with a regular expressions that matches the captured value.];
                SourceExpr="Enable Rule Generation";
                Importance=Additional;
                ImplicitType=Boolean }

    { 1000000016;3;Field  ;
                Name=Auto Update Caption;
                ToolTipML=[DEU=Gibt an, ob der Suchtext automatisch aktualisiert werden soll, wenn Sie einen neuen Suchtext in einem Dokument auswÑhlen.;
                           ENU=Specifies whether to automatically update the captions when you select a new caption in a document.];
                SourceExpr="Auto Update Caption";
                Importance=Additional;
                Visible=NOT ShowXmlPath;
                ImplicitType=Boolean }

    { 1000000017;3;Field  ;
                Name=Caption Is Part Of Value;
                ToolTipML=[DEU=Gibt an, ob der Suchtext Teil des Werts ist. Ein Suchtext fÅr die dÑnische Zahlungs-ID lautet beispielsweise +71. Da der Feldwert +71 enthÑlt, ist der Suchtext jedoch Teil des Feldwerts.;
                           ENU=Specifies whether the caption is part of the value. E.g., a caption for the Danish payment ID is +71, but since the field value contains +71 the caption is part of the field value.];
                SourceExpr="Caption Is Part Of Value";
                Importance=Additional;
                Visible=NOT ShowXmlPath;
                ImplicitType=Boolean }

    { 1160040002;3;Field  ;
                Name=Caption Mandatory;
                ToolTipML=[DEU=Gibt an, ob ein Feldwert nur aus dem Dokument erkannt werden kann, wenn eine entsprechender Suchtext vorhanden ist. Wenn die Option deaktiviert ist und im Dokument kein Suchtext erkannt wird, wird der Wert aus dem gleichen Bereich im Dokument wie das zuletzt mit derselben Vorlage erkannte Dokument Åbernommen. Dabei wird davon ausgegangen, dass der Wert in diesem Bereich den richtigen Datentyp hat und den Feldregeln entspricht.;
                           ENU=Specifies whether a field value can only be recognized from the document if there is a corresponding caption. If disabled and no caption is recognized in the document, then the value will be taken from the same area in the document as on the last document recognized with the same template, under the condition that the value in that area is of the correct data type and complies to the field rules.];
                SourceExpr="Caption Mandatory";
                Importance=Additional;
                Visible=NOT ShowXmlPath;
                ImplicitType=Boolean }

    { 161024026;1;Group   ;
                Name=Purchase;
                CaptionML=[DEU=Einkauf;
                           ENU=Purchase];
                Visible=ShowPurchaseTab;
                GroupType=Group }

    { 161024024;2;Field   ;
                Name=Transfer Amount to Document;
                ToolTipML=[DEU=Gibt an, ob der Wert des Felds bei der Registrierung in eine Einkaufszeile Åbertragen werden soll.;
                           ENU=Specifies whether to transfer the value of the field to a purchase line when registering.];
                SourceExpr="Transfer Amount to Document";
                Editable=IsNumberAndHeader;
                ImplicitType=Option }

    { 161024023;2;Field   ;
                Name=G/L Account Field Code;
                ToolTipML=[DEU=Gibt ein optionales Vorlagenfeld an, das die Sachkontonummer enthÑlt, die beim Erstellen einer Einkaufszeile fÅr den Wert dieses Felds verwendet wird.;
                           ENU=Specifies an optional template field which contains the G/L account number used when creating a purchase line for the value of this field.];
                SourceExpr="G/L Account Field Code";
                Editable=IsNumberAndHeader;
                ImplicitType=Code20 }

    { 161024019;2;Field   ;
                Name=Subtract from Amount Field;
                ToolTipML=[DEU=Gibt ein anderes Feld an, dessen Wert vom Wert dieses Felds abgezogen werden muss. Wenn der Gesamtbetrag inkl. Fracht in einem Feld dargestellt wird, aber der Frachtbetrag auch in einem anderen Feld separat angezeigt. In diesem Fall kînnen Sie den Frachtbetrag in einem Feld angeben und den Wert vom Gesamtbetrag abziehen, sodass die Versandkosten nicht doppelt Åbertragen werden.;
                           ENU=Specifies another field which must have its value subtracted by the value of this field. Eg. if total amount, incl. freight is in a field, but the freight amount is also shown separately in another field. In this case, you can choose to recognize freight amount in a field, then deduct the value from the total amount, so shipping costs are not transferred twice.];
                SourceExpr="Subtract from Amount Field";
                Editable=IsNumberAndHeader;
                OnLookup=VAR
                           TemplateField@6085573 : Record 6085580;
                         BEGIN
                           TemplateField.FILTERGROUP(4);
                           TemplateField.SETRANGE("Template No.","Template No.");
                           TemplateField.SETRANGE(Type,Type);
                           TemplateField.SETFILTER("Transfer Amount to Document",'<>%1',"Transfer Amount to Document"::" ");
                           TemplateField.SETFILTER(Code,'<>%1',Code);
                           TemplateField.FILTERGROUP(0);
                           IF PAGE.RUNMODAL(0,TemplateField) = ACTION::LookupOK THEN BEGIN
                             Text := TemplateField.Code;
                             EXIT(TRUE);
                           END;
                         END;

                ImplicitType=Code20 }

    { 161024018;2;Field   ;
                Name=Purch. Alloc. G/L Account No.;
                ToolTipML=[DEU=Gibt das Sachkonto an, das fÅr automatisch erstellte Einkaufszuordnungen verwendet werden soll.;
                           ENU=Specifies the G/L cost account number to use when automatically creating purchase allocations.];
                SourceExpr="Purch. Alloc. G/L Account No.";
                Visible=ShowAllocations;
                Editable=IsNumberAndHeader;
                ImplicitType=Code20 }

    { 61000;1  ;Group     ;
                Name=ALR;
                CaptionML=[DAN=Avanceret Linjegenkendelse;
                           DEU=Erweiterte Zeilenerkennung;
                           ENU=Advanced Line Recognition;
                           FRA=Reconnaissance avancÇe de ligne;
                           NLD=Geavanceerde lijnherkenning];
                GroupType=Group }

    { 61001;2  ;Field     ;
                ToolTipML=[DAN=Angiver hvordan feltvërdien genkendes. Med Standard fremsõges vërdien ved hjëlp af standardlinjegenkendelse.;
                           DEU=Gibt an, wie der Feldwert gefunden werden soll. Bei Standard wird das Feld Åber die Standard Zeilenerkennung gesucht.;
                           ENU=Specifies how the field value is to be found. With Standard, the field is searched for using the standard row recognition.;
                           FRA=SpÇcifie comment la valeur du champ doit àtre trouvÇe. Avec Standard, le champ est recherchÇ en utilisant la reconnaissance de ligne standard.;
                           NLD=Hiermee geeft u aan hoe de waarde van het veld wordt gevonden. Met standaardwaarde wordt het veld gezocht naar het gebruik van de standaard lijnherkenning.];
                SourceExpr="Advanced Line Recognition Type";
                ImplicitType=Option }

    { 61002;2  ;Group     ;
                Name=ALRLinkedFieldGroup;
                Visible=IsLinkedFieldSearch;
                GroupType=Group;
                ShowCaption=No }

    { 61003;3  ;Field     ;
                ToolTipML=[DAN=Angiver kildefeltet der bruges til at beregne feltvërdien ved hjëlp af afstande/forskydninger.
                           ;
                           DEU=Gibt das Herkunftsfeld an, welches zur Berechnung des Feldwerts Åber AbstÑnde/Offsets genutzt wird.;
                           ENU=Specifies the source field used to calculate the field value via distances/offsets.;
                           FRA=SpÇcifie le champ source utilisÇ pour calculer la valeur du champ via des distances/dÇcalages.;
                           NLD=Geeft het bronveld in dat gebruikt wordt om de waarde van het veld te bepalen via afstanden/offsets.];
                SourceExpr="Linked Field";
                ImplicitType=Code20 }

    { 61004;2  ;Field     ;
                ToolTipML=[DAN=Angiver positionen for rëkkefõlgen, i hvilken feltet behandles.
                           ;
                           DEU=Gibt die Stelle der Reihenfolge an, in der das Feld verarbeitet wird.;
                           ENU=Specifies the position of the sequence in which the field is processed.;
                           FRA=Bepaalt de positie van de volgorde waarin het veld wordt verwerkt.
                           ;
                           NLD=Bepaalt de positie van de volgorde waarin het veld wordt verwerkt.];
                SourceExpr=Sorting;
                Importance=Additional;
                ImplicitType=Integer }

    { 61005;2  ;Group     ;
                Name=ALRCaptionBasedFieldGroup;
                Visible=ShowPositionDependendFields;
                GroupType=Group;
                ShowCaption=No }

    { 61006;3  ;Field     ;
                ToolTipML=[DAN=Angiver om det genkendte felt sõges over eller under den linje hvor vërdierne for standardlinjegenkendelsen blev fundet.;
                           DEU=Gibt an, ob das gesuchte Feld ober- oder unterhalb der Zeile gesucht wird, in welcher die Werte der Standard Zeilenerkennung gefunden wurden.;
                           ENU=Specifies whether the searched field is searched above or below the line in which the values of the standard line recognition were found.;
                           FRA=SpÇcifie si le champ recherchÇ est recherchÇ au-dessus ou en dessous de la ligne dans laquelle les valeurs de la reconnaissance de ligne standard ont ÇtÇ trouvÇes.;
                           NLD=Geeft aan of het zoekveld boven of onder de regel wordt gezocht waarin de waarden van de standaardregelherkenning werden gevonden.];
                SourceExpr="Field value position";
                ImplicitType=Option }

    { 61007;3  ;Field     ;
                SourceExpr="Field value search direction";
                ImplicitType=Option }

    { 61008;2  ;Group     ;
                Name=ALRNoValueFound;
                CaptionML=[DEU=Wenn Wert leer ist;
                           ENU=When value is empty];
                GroupType=Group }

    { 61009;3  ;Field     ;
                SourceExpr="Replacement Field Type";
                ImplicitType=Option }

    { 61010;3  ;Field     ;
                ToolTipML=[DAN=Angiver linjefeltet hvor indholdet benyttes som vërdi, hvis vërdien af det aktuelle felt ikke kan genkendes.;
                           DEU=Gibt das Zeilenfeld an, dessen Inhalt als Wert verwendet wird, wenn der Wert des aktuellen Feldes nicht gefunden werden kann.;
                           ENU=Specifies the line field whose content will be used as value if the value of the current field cannot be found.;
                           FRA=SpÇcifie le champ de ligne dont le contenu sera utilisÇ comme valeur si la valeur du champ actuel est introuvable.;
                           NLD=Geeft het regelveld aan waarvan de inhoud als waarde wordt gebruikt indien de waarde van het huidige veld niet kan worden gevonden.];
                SourceExpr="Replacement Field";
                ImplicitType=Code20 }

    { 61011;3  ;Field     ;
                ToolTipML=[DAN=Hvis vërdien af det aktuelle felt ikke findes, kopieres vërdien til den aktuelle linje fra det samme felt i den forrige linje.;
                           DEU=Wenn der Wert des aktuellen Feldes nicht gefunden wird, wird vom gleichen Feld aus der vorherigen Zeile dessen Wert in die aktuelle Zeile kopiert.;
                           ENU=If the value of the current field is not found, the value is copied to the current line from the same field from the previous line.;
                           FRA=Si la valeur du champ actuel n'est pas trouvÇe, la valeur est copiÇe dans la ligne actuelle Ö partir du màme champ de la ligne prÇcÇdente.;
                           NLD=Als de waarde van dit veld niet wordt gevonden op de huidige regel, wordt de waarde overgenomen van de vorige regel.];
                SourceExpr="Copy Value from Previous Value";
                ImplicitType=Boolean }

    { 61012;2  ;Group     ;
                CaptionML=[DAN=Forskydninger;
                           DEU=AbstÑnde;
                           ENU=Offsets;
                           FRA=DÇcalages;
                           NLD=Verschuivingen];
                GroupType=Group }

    { 61013;3  ;Field     ;
                ToolTipML=[DAN=Angiver afstanden til top.;
                           DEU=Gibt den Abstand nach oben an.;
                           ENU=Specifies the distance to the top.;
                           FRA=SpÇcifie la distance par rapport au haut.;
                           NLD=Bepaalt de afstand naar de bovenkant.];
                SourceExpr="Offset Top";
                Importance=Additional;
                ImplicitType=Integer }

    { 61014;3  ;Field     ;
                ToolTipML=[DAN=Angiver afstanden til bund.;
                           DEU=Gibt den Abstand nach unten an.;
                           ENU=Specifies the distance to the bottom.;
                           FRA=SpÇcifie la distance par rapport au bas.;
                           NLD=Bepaalt de afstand naar de onderkant.];
                SourceExpr="Offset Bottom";
                Importance=Additional;
                ImplicitType=Integer }

    { 61015;3  ;Field     ;
                ToolTipML=[DAN=Angiver afstanden til venstre.;
                           DEU=Gibt den Abstand nach links an.;
                           ENU=Specifies the distance to the left.;
                           FRA=SpÇcifie la distance par rapport Ö la gauche.;
                           NLD=Bepaalt de afstand naar de linkerkant.];
                SourceExpr="Offset Left";
                Importance=Additional;
                ImplicitType=Integer }

    { 61016;3  ;Field     ;
                ToolTipML=[DAN=Angiver afstanden til hõjre.;
                           DEU=Gibt den Abstand nach rechts an.;
                           ENU=Specifies the distance to the right.;
                           FRA=SpÇcifie la distance par rapport Ö la droite.;
                           NLD=Bepaalt de afstand naar de rechterkant.];
                SourceExpr="Offset Right";
                Importance=Additional;
                ImplicitType=Integer }

    { 61017;3  ;Field     ;
                ToolTipML=[DAN=Angiver afstanden til sõgetekst/overskrift pÜ X- aksen.
                           ;
                           DEU=Gibt den Abstand zum Suchtext an auf der X-Achse an.;
                           ENU=Specifies the distance to the search text/caption on the X axis.;
                           FRA=SpÇcifie la distance avec le texte/lÇgende de la recherche sur l'axe X.;
                           NLD=Specificeert de afstand naar de zoektekst/bijschrift op de X-as.];
                SourceExpr="ALR Value Caption Offset X";
                Importance=Additional;
                ImplicitType=Integer }

    { 61018;3  ;Field     ;
                ToolTipML=[DAN=Angiver afstanden til sõgetekst/oerskrift pÜ Y-aksen.
                           ;
                           DEU=Gibt den Abstand zum Suchtext an auf der Y-Achse an.;
                           ENU=Specifies the distance to the search text/caption on the Y axis.;
                           FRA=SpÇcifie la distance avec le texte/lÇgende de la recherche sur l'axe Y.;
                           NLD=Bepaalt de afstand naar de zoektekst/bijschrift op de X-as.];
                SourceExpr="ALR Value Caption Offset Y";
                Importance=Additional;
                ImplicitType=Integer }

    { 61019;3  ;Field     ;
                ToolTipML=[DAN=Angiver den forventede feltbredde for feltet.;
                           DEU=Gibt die erwartete Feldbreite des Feldes an.;
                           ENU=Specifies the expected field width of the field.;
                           FRA=SpÇcifie la largeur attendue du champ.;
                           NLD=Specificeert de verwachte veldbreedte.];
                SourceExpr="ALR Typical Value Field Width";
                Importance=Additional;
                ImplicitType=Decimal }

    { 61020;3  ;Field     ;
                SourceExpr="Data version";
                Visible=FALSE;
                ImplicitType=Integer }

    { 6085580;1;Part      ;
                Name=Template Field Translations;
                SubPageLink=Template No.=FIELD(Template No.),
                            Type=FIELD(Type),
                            Code=FIELD(Code);
                PagePartID=Page6085588;
                PartType=Page }

  }
  CODE
  {
    VAR
      AllObjWithCaption@1160040000 : Record 2000000058;
      RecIDMgt@1001 : Codeunit 6085604;
      IsMasterTemplate@1160040010 : Boolean INDATASET;
      IsDate@161024012 : Boolean INDATASET;
      IsNumber@161024013 : Boolean INDATASET;
      IsNumberAndHeader@161024014 : Boolean INDATASET;
      IsLookup@1161054000 : Boolean INDATASET;
      SearchForValueEditable@161024015 : Boolean INDATASET;
      IsDestHeader@161024016 : Boolean INDATASET;
      IsDestLine@1004 : Boolean INDATASET;
      IsNewField@1160040011 : Boolean INDATASET;
      ShowCodeAndType@6085583 : Boolean INDATASET;
      LineRecognitionEnabled@1160040005 : Boolean INDATASET;
      CodeunitLookup@1160040001 : Text[250];
      CodeunitCaptureVal@1160040004 : Text[250];
      CodeunitIsValid@1160040003 : Text[250];
      CodeunitValidate@1160040002 : Text[250];
      SourceTable@1160040006 : Text[250];
      SourceField@1160040009 : Text[250];
      DestHeaderField@1160040007 : Text[250];
      DestLineField@1160040008 : Text[250];
      FixedValue@1000 : Text[250];
      ShowTransferValue@6085573 : Boolean INDATASET;
      ShowPurchaseTab@6085574 : Boolean INDATASET;
      CaptionText@6085575 : Text[300];
      RuleText@6085576 : Text[300];
      TotalCaptions@6085577 : TextConst 'DEU=(%1 Suchtexte gesamt);ENU=(%1 captions in total)';
      TotalRules@6085578 : TextConst 'DEU=(%1 Regeln gesamt);ENU=(%1 rules in total)';
      EditCaption@6085579 : Boolean INDATASET;
      EditRule@6085580 : Boolean INDATASET;
      ShowMultiline@6085581 : Boolean INDATASET;
      ShowEnableGenRule@6085582 : Boolean INDATASET;
      IsPageEditable@1002 : Boolean INDATASET;
      ShowStopLineRecognition@6085584 : Boolean INDATASET;
      ShowAllocations@6085585 : Boolean INDATASET;
      DecimalPlacesDescription@6085586 : Text[50];
      FormulaTxt@6085587 : Text[1024];
      ShowXmlPath@6085588 : Boolean INDATASET;
      CurrentDocumentNo@6085589 : Code[20];
      ShowXMLShowField@6085600 : Boolean INDATASET;
      IsLinkedFieldSearch@1003 : Boolean INDATASET;
      ShowPositionDependendFields@1005 : Boolean INDATASET;

    [LineStart(2753)]
    LOCAL PROCEDURE UpdateControls@6085573();
    VAR
      Template@6085574 : Record 6085579;
      DocCat@6085573 : Record 6085575;
      TemplateFieldCaption@6085577 : Record 6085581;
      TemplateFieldRule@6085576 : Record 6085583;
      ContiniaVersionMgt@6085578 : Codeunit 6192775;
      i@6085575 : Integer;
      CDCModuleLicense@6085579 : Codeunit 6086008;
      DCSetup@6085581 : Record 6085573;
      TemplateCode@6085600 : Code[20];
    BEGIN
      IsPageEditable := CurrPage.EDITABLE;

      DCSetup.GET;

      TemplateCode := "Template No.";
      IF TemplateCode = '' THEN
        TemplateCode := GETFILTER("Template No.");

      IF Template.GET(TemplateCode) THEN
        DocCat.GET(Template."Category Code");

      FixedValue := GetFixedValue;

      SearchForValueEditable := (Formula = '') AND (FixedValue = '');

      IsMasterTemplate := Template.Type = Template.Type::Master;
      IsDate := "Data Type" = "Data Type"::Date;
      IsNumber := "Data Type" = "Data Type"::Number;
      IsNumberAndHeader := ("Data Type" = "Data Type"::Number) AND (Type = Type::Header);
      IsLookup := ("Data Type" = "Data Type"::Lookup) AND IsPageEditable;
      IsDestHeader := (Type = Type::Header) AND (DocCat."Destination Header Table No." <> 0) AND IsPageEditable;
      IsDestLine := (DocCat."Destination Line Table No." <> 0) AND IsPageEditable;
      LineRecognitionEnabled := Template."Recognize Lines" = Template."Recognize Lines"::Yes;
      IsNewField := Code = '';
      ShowCodeAndType := IsNewField OR (ContiniaVersionMgt.NavVersion < 100000);
      ShowPurchaseTab := DocCat.IsPurchInvCrMemoCategory AND ("Data Type" = "Data Type"::Number) AND (Type = Type::Header);
      ShowTransferValue := NOT ((DocCat."Destination Header Table No." = 0) AND (DocCat."Destination Line Table No." = 0));
      ShowMultiline := Type = Type::Header;
      ShowEnableGenRule := ("Data Type" = "Data Type"::Text) OR ("Data Type" = "Data Type"::Date);
      ShowStopLineRecognition := CDCModuleLicense.IsAdvCaptureActivated(FALSE);
      ShowAllocations := DCSetup."Enable Purchase Allocation" AND CDCModuleLicense.IsApprovalActivated(FALSE);

      EditCaption := IsPageEditable AND NOT IsNewField;
      IF NOT IsNewField THEN BEGIN
        TemplateFieldCaption.SETRANGE("Template No.","Template No.");
        TemplateFieldCaption.SETRANGE(Type,Type);
        TemplateFieldCaption.SETRANGE(Code,Code);
        IF TemplateFieldCaption.FIND('-') THEN BEGIN
          i := TemplateFieldCaption.COUNT;
          IF i = 1 THEN
            CaptionText := TemplateFieldCaption.Caption
          ELSE BEGIN
            CaptionText := TemplateFieldCaption.Caption + ' ' + STRSUBSTNO(TotalCaptions,i);
            EditCaption := FALSE;
          END;
        END ELSE
          CaptionText := '';
      END ELSE
        CaptionText := '';

      EditRule := IsPageEditable AND NOT IsNewField;
      IF NOT IsNewField THEN BEGIN
        TemplateFieldRule.SETRANGE("Template No.","Template No.");
        TemplateFieldRule.SETRANGE(Type,Type);
        TemplateFieldRule.SETRANGE(Code,Code);
        IF TemplateFieldRule.FIND('-') THEN BEGIN
          i := TemplateFieldRule.COUNT;
          IF i = 1 THEN
            RuleText := TemplateFieldRule.Rule
          ELSE BEGIN
            RuleText := TemplateFieldRule.Rule + ' ' + STRSUBSTNO(TotalRules,i);
            EditRule := FALSE;
          END;
        END ELSE
          RuleText := '';
      END ELSE
        RuleText := '';

      DecimalPlacesDescription := ValidateDecimalPlaces("Decimal Places");
      ShowXmlPath := Template."Data Type" = Template."Data Type"::XML;
      ShowXMLShowField := Type = Type::Line;
    END;

    [LineStart(2826)]
    LOCAL PROCEDURE ShowCaptions@6085575();
    VAR
      TemplateFieldCaption@6085573 : Record 6085581;
    BEGIN
      TemplateFieldCaption.FILTERGROUP(2);
      TemplateFieldCaption.SETRANGE("Template No.","Template No.");
      TemplateFieldCaption.SETRANGE(Type,Type);
      TemplateFieldCaption.SETRANGE(Code,Code);
      TemplateFieldCaption.FILTERGROUP(0);
      PAGE.RUNMODAL(PAGE::"CDC Template Field Captions",TemplateFieldCaption);
      UpdateControls;
    END;

    [LineStart(2835)]
    LOCAL PROCEDURE ShowRules@6085579();
    VAR
      TemplateFieldRule@6085573 : Record 6085583;
    BEGIN
      TemplateFieldRule.FILTERGROUP(2);
      TemplateFieldRule.SETRANGE("Template No.","Template No.");
      TemplateFieldRule.SETRANGE(Type,Type);
      TemplateFieldRule.SETRANGE(Code,Code);
      TemplateFieldRule.FILTERGROUP(0);
      PAGE.RUNMODAL(PAGE::"CDC Template Field Rules",TemplateFieldRule);
      UpdateControls;
    END;

    [LineStart(2844)]
    LOCAL PROCEDURE ShowCodeunits@6085580();
    VAR
      TemplateField@6085574 : Record 6085580;
    BEGIN
      TemplateField.FILTERGROUP(2);
      TemplateField.SETRANGE("Template No.","Template No.");
      TemplateField.SETRANGE(Type,Type);
      TemplateField.SETRANGE(Code,Code);
      TemplateField.FILTERGROUP(0);
      PAGE.RUNMODAL(PAGE::"CDC Template Field Codeunits",TemplateField);
    END;

    [LineStart(2852)]
    LOCAL PROCEDURE RemoveQuotationMarks@6085574(FormulaString@6085573 : Text[1024]) : Text[1024];
    VAR
      FormulaLength@6085575 : Integer;
    BEGIN
      IF FormulaString = '' THEN
        EXIT;

      FormulaLength := STRLEN(FormulaString);
      IF (FormulaString[1] = '''') AND (FormulaString[FormulaLength] = '''') THEN BEGIN
        FormulaString := COPYSTR(FormulaString,2,FormulaLength);
        FormulaString := COPYSTR(FormulaString,1,FormulaLength-2);
      END;
      EXIT(FormulaString);
    END;

    [LineStart(2863)]
    PROCEDURE SetDocumentNo@6085576(DocumentNo@6085573 : Code[20]);
    BEGIN
      CurrentDocumentNo := DocumentNo;
    END;

    [LineStart(2866)]
    LOCAL PROCEDURE UpdateALRFields@6();
    BEGIN
      IsLinkedFieldSearch := Rec."Advanced Line Recognition Type" = Rec."Advanced Line Recognition Type"::LinkedToAnchorField;
      ShowPositionDependendFields := (Rec."Advanced Line Recognition Type" IN [Rec."Advanced Line Recognition Type"::FindFieldByColumnHeading, Rec."Advanced Line Recognition Type"::FindFieldByCaptionInPosition]);
    END;

    BEGIN
    END.
  }
}

OBJECT Page 6085597 CDC Document Lines ListPart
{
  OBJECT-PROPERTIES
  {
    Date=01/05/22;
    Time=10:55:47 PM;
    Modified=Yes;
    Version List=DCW17.00.00.8.01,ALR1.15;
  }
  PROPERTIES
  {
    CaptionML=[DEU=CDC Document Lines ListPart;
               ENU=CDC Document Lines ListPart];
    LinksAllowed=No;
    SourceTable=Table6085596;
    PageType=ListPart;
    SourceTableTemporary=Yes;
    OnInit=BEGIN
             IdentifierVisible := TRUE;
           END;

    OnOpenPage=BEGIN
                 IdentifierVisible := FALSE;
               END;

    OnAfterGetRecord=BEGIN
                       UpdateTranslInfo;
                       FillSortingBuffer;
                     END;

    OnNewRecord=BEGIN
                  "Document No." := Document."No.";
                  "Template No." := Document."Template No.";
                  "Translate to Type" := 0;
                  "Translate to No." := '';

                  IF NOT BelowxRec THEN BEGIN
                    xRecLineNo := xRec."Line No.";
                    "Line No." := 0
                  END ELSE
                    "Line No." := GetLastLineNo + 1;

                  CurrLineNo := "Line No.";
                END;

    OnInsertRecord=BEGIN
                     xRecLineNo := 0;

                     IF NOT BelowxRec THEN
                       ManuallyInsertLine(xRec."Line No.");
                     EXIT(TRUE);
                   END;

    OnDeleteRecord=VAR
                     Value@1000000000 : Record 6085593;
                   BEGIN
                     Value.SETCURRENTKEY("Document No.","Is Value",Type,"Page No.","Line No.");
                     Value.SETRANGE("Document No.",Document."No.");
                     Value.SETRANGE("Is Value",TRUE);
                     Value.SETRANGE(Type,Value.Type::Line);
                     Value.SETRANGE("Line No.","Line No.");
                     Value.DELETEALL;
                     EXIT(TRUE);
                   END;

    OnAfterGetCurrRecord=BEGIN
                           CurrLineNo := "Line No.";
                         END;

    ActionList=ACTIONS
    {
      { 1160040000;  ;ActionContainer;
                      Name=ActionItems;
                      ActionContainerType=ActionItems }
      { 1160040002;1 ;ActionGroup;
                      Name=Line;
                      CaptionML=[DEU=&Zeile;
                                 ENU=&Line];
                      Image=Line }
      { 1160040001;2 ;Action    ;
                      Name=Card;
                      CaptionML=[DEU=Karte;
                                 ENU=Card];
                      ToolTipML=[DEU=Zeigt detaillierte Informationen Åber den in der Belegzeile oder Buchungsblattzeile befindlichen Datensatz an oder Ñndert diese.;
                                 ENU=View or change detailed information about the record on the document or journal line.];
                      Image=EditLines;
                      OnAction=BEGIN
                                 Rec.ShowCard;
                               END;
                                }
      { 3       ;1   ;ActionGroup;
                      Name=TranslationsGr;
                      CaptionML=[DEU=öbersetzungen;
                                 ENU=&Translations];
                      Image=Track }
      { 6       ;2   ;Action    ;
                      Name=NoTranslation;
                      CaptionML=[DEU=Nr.;
                                 ENU=No.];
                      ToolTipML=[DEU=öbersetzungen fÅr Nr. anzeigen oder bearbeiten.;
                                 ENU=View or edit No. translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSalesTransl@1001 : Codeunit 6085707;
                               BEGIN
                                 PurchSalesTransl.ShowItemNoTrans(Document);
                               END;
                                }
      { 5       ;2   ;Action    ;
                      Name=DescriptionTranslation;
                      CaptionML=[DEU=Beschreibung;
                                 ENU=Description];
                      ToolTipML=[DEU=öbersetzungen fÅr Beschreibung anzeigen oder bearbeiten.;
                                 ENU=View or edit Description translations of the template.];
                      Image=Track;
                      OnAction=VAR
                                 PurchSalesTransl@1001 : Codeunit 6085707;
                               BEGIN
                                 PurchSalesTransl.ShowDescriptionTrans(Document);
                               END;
                                }
      { 4       ;2   ;Action    ;
                      Name=UOM;
                      CaptionML=[DEU=Einheit;
                                 ENU=Unit of Measure];
                      ToolTipML=[DEU=öbersetzungen fÅr Einheit anzeigen oder bearbeiten.;
                                 ENU=View or edit Unit of Measure translations.];
                      Visible=ShowUOMTranslation;
                      Image=Track;
                      OnAction=VAR
                                 PurchSalesTransl@1001 : Codeunit 6085707;
                               BEGIN
                                 IF "Translate to Type" = "Translate to Type"::Item THEN
                                   PurchSalesTransl.ShowUOMTrans(Document,"Translate to No.")
                                 ELSE
                                   PurchSalesTransl.ShowUOMTrans(Document,'');
                               END;
                                }
      { 8       ;2   ;Action    ;
                      Name=CrossReferences;
                      CaptionML=[DEU=Artikelreferenzen;
                                 ENU=Cross References];
                      ToolTipML=[DEU=Richtet eine eigene öbersetzung des ausgewÑhlten Artikel fÅr den Debitor oder Kreditor ein. Artikelreferenzen auf die Artikelnummer des Debitors bedeuten, dass ihre Artikelnummer automatisch anstelle der von Ihnen verwendeten Nummer auf den Verkaufsbelegen angezeigt wird.;
                                 ENU=Set up a customer's or vendor's own identification of the selected item. Cross-references to the customer's item number means that the item number is automatically shown on sales documents instead of the number that you use.];
                      Image=Change;
                      OnAction=VAR
                                 ItemReferenceMgt@6085574 : Codeunit 6086026;
                               BEGIN
                                 ItemReferenceMgt.ShowItemReference(Document."Source Record Table ID",Document."Source Record No.");
                               END;
                                }
      { 61000   ;1   ;ActionGroup;
                      Name=AdvancedLineRecognition;
                      CaptionML=[DAN=Avanceret linjegenkendelse;
                                 DEU=Erw. Zeilenerkennung;
                                 ENU=Adv. line recognition;
                                 FRA=Recon. avancÇe de ligne;
                                 NLD=Geavanceerde lijnherkenning];
                      Image=SetupLines }
      { 61001   ;2   ;Action    ;
                      Name=SearchByLinkedField;
                      CaptionML=[DAN=Find vërdi ved hjëlp af forbundet felt;
                                 DEU=Suche Åber verknÅpftes Feld;
                                 ENU=Find value by linked field;
                                 FRA=Trouver valeur par champ liÇ;
                                 NLD=Vind waarde via gekoppeld veld];
                      ToolTipML=[DAN=Det õnskede felt bliver fundet via en fast forskydning (afstand) fra et andet felt.;
                                 DEU=Das gewÅnschte Feld wird Åber einen fest definiertes Offset (Abstand) von einem anderen Feld gefunden.;
                                 ENU=The desired field is found via a fixed offset (distance) from another field.;
                                 FRA=Le champ dÇsirÇ est trouvÇ via un dÇcalage fixe (distance) Ö partir d'un autre champ.;
                                 NLD=Het gewenste veld wordt gevonden via een vaste offset (afstand) uit een ander veld.
                                 ];
                      Promoted=Yes;
                      Image=Link;
                      PromotedCategory=Process;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1000000000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.SetToAnchorLinkedField(Rec);
                               END;
                                }
      { 61002   ;2   ;Action    ;
                      Name=SearchByColumnHeading;
                      CaptionML=[DAN=Find vërdi ved hjëlp af kolonneoverskrift;
                                 DEU=Feld mit SpaltenÅberschrift;
                                 ENU=Find value by column heading;
                                 FRA=Rechercher valeur par en-tàte de colonne;
                                 NLD=Vind waarde via kolomkoptekst];
                      ToolTipML=[DAN=Der sõges efter det õnskede felt ved hjëlp af en tidligere anvendt kolonneoverskrift i omrÜdet for den aktuelle position.;
                                 DEU=Das gewÅnschte Feld wird Åber eine vorher trainierte SpaltenÅberschrift im Bereich der aktuellen Position gesucht.;
                                 ENU=The desired field is searched for using a previously trained column heading in the range of the current position.;
                                 FRA=Le champ dÇsirÇ est recherchÇ en utilisant un texte/lÇgende de recherche prÇalablement entraånÇ dans la zone de la position courante.;
                                 NLD=Het gewenste veld wordt gezocht via een eerder getrainde kolomkop binnen het bereik van de huidige positie.];
                      Promoted=Yes;
                      Image=Table;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1113400000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.SetToFieldSearchWithColumnHeding(Rec);
                               END;
                                }
      { 61003   ;2   ;Action    ;
                      Name=SearchByCaption;
                      CaptionML=[DAN=Find vërdi ved hjëlp af overskrift;
                                 DEU=Feld mit Suchtext;
                                 ENU=Find value by caption;
                                 FRA=Trouver valeur par lÇgende;
                                 NLD=Vind waarde via bijschrift];
                      ToolTipML=[DAN=Der sõges efter det õnskede felt ved hjëlp af en tidligere anvendt sõgetekst/overskrift i omrÜdet for den aktuelle position.;
                                 DEU=Das gewÅnschte Feld wird Åber einen vorher trainierten Suchtext/Caption im Bereich der aktuellen Position gesucht.;
                                 ENU=The desired field is searched for using a previously trained search text/caption in the area of the current position.;
                                 FRA=Le champ dÇsirÇ est recherchÇ en utilisant un texte/lÇgende de recherche prÇalablement entraånÇ dans la zone de la position courante.;
                                 NLD=Het gewenste veld wordt gezocht via een eerder getrainde zoektekst/bijschrift in het gebied van de huidige positie.];
                      Promoted=Yes;
                      Image=Find;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1113400000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.SetToFieldSearchWithCaption(Rec);
                               END;
                                }
      { 61004   ;2   ;Separator  }
      { 61005   ;2   ;Action    ;
                      Name=ResetFieldToDefault;
                      CaptionML=[DAN=Nulstil felt;
                                 DEU=Feld zurÅcksetzen;
                                 ENU=Reset field;
                                 FRA=RÇinitialiser le champ;
                                 NLD=Veld opnieuw instellen];
                      ToolTipML=[DAN=De avancerede linjegenkendelsesindstillinger nulstilles til det õnskede felt.
                                 ;
                                 DEU=Die Einstellungen der erweiterten Zeilenerkennung werden fÅr das gewÅnschte Feld zurÅckgesetzt.;
                                 ENU=The advanced line recognition settings are reset for the desired field.;
                                 FRA=Les paramätres de reconnaissance avancÇs de ligne sont rÇinitialisÇs pour le champ dÇsirÇ.;
                                 NLD=De geavanceerde lijnherkenning instellingen voor het gewenste veld zijn gereset.];
                      Image=ResetStatus;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.ResetFieldFromMenu(Rec);
                               END;
                                }
      { 61006   ;2   ;Action    ;
                      Name=ShowVersionNo;
                      CaptionML=[DAN=Version;
                                 DEU=Version;
                                 ENU=Version;
                                 FRA=Version;
                                 NLD=Versie];
                      ToolTipML=[DAN=Viser den aktuelt benyttede version af avancerede linjegenkendelse.;
                                 DEU=Zeigt die aktuell verwendete Version der erweiterten Zeilenerkennung an.;
                                 ENU=Displays the currently used version of the advanced line detection.;
                                 FRA=Affiche la version actuellement utilisÇe de la dÇtection avancÇe de ligne.;
                                 NLD=Toont de momenteel gebruikte versie van de geavanceerde lijnherkenning.];
                      Image=Info;
                      OnAction=VAR
                                 AdvLineRecognitionMgt@1160040000 : Codeunit 61000;
                               BEGIN
                                 AdvLineRecognitionMgt.ShowVersionNo();
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                Name=ContentArea;
                ContainerType=ContentArea }

    { 6085600;1;Field     ;
                Name=CDC Document Lines ListPart;
                SourceExpr='';
                Visible=IdentifierVisible }

    { 1000000001;1;Group  ;
                Name=Repeater;
                IndentationColumnName=1;
                GroupType=Repeater }

    { 1000000002;2;Field  ;
                Name=OK;
                ToolTipML=[DEU=Gibt an, ob die Zeile gÅltig ist.;
                           ENU=Specifies whether the line is valid.];
                SourceExpr=OK;
                Editable=FALSE;
                ImplicitType=Boolean }

    { 1   ;2   ;Field     ;
                Name=Translate to Type;
                ToolTipML=[DEU=Gibt die interne Art an, in den die erkannte Nummer Åbersetzt werden soll.;
                           ENU=Specifies the internal type to translate the recognized number value to.];
                SourceExpr="Translate to Type";
                Editable=AllowEdit;
                ImplicitType=Option }

    { 2   ;2   ;Field     ;
                Name=Translate to No.;
                ToolTipML=[DEU=Gibt die interne Nummer an, in die die erkannte Nummer Åbersetzt werden soll.;
                           ENU=Specifies the internal number to translate the recognized number value to.];
                SourceExpr="Translate to No.";
                Editable=AllowEdit;
                OnValidate=BEGIN
                             FillSortingBuffer;
                             Document.FIND('=');
                             Document.ValidateDocument;
                           END;

                OnLookup=BEGIN
                           EXIT(LookupTranslToNo(Text));
                         END;

                ImplicitType=Code20 }

    { 1000000013;2;Field  ;
                Name=Control1000000013;
                CaptionML=[DEU=Zugeordnete Menge;
                           ENU=Matched Quantity];
                ToolTipML=[DEU=Gibt die mit der Zeile Åbereinstimmende Menge an.;
                           ENU=Specifies the quantity matched to the line.];
                DecimalPlaces=0:5;
                BlankZero=Yes;
                SourceExpr=GetMatchedQty;
                Visible=ShowMatchedQty;
                Editable=AllowEdit;
                OnDrillDown=BEGIN
                              ShowMatchSpec;
                            END;
                             }

    { 161024012;2;Field   ;
                Name=Line No.;
                ToolTipML=[DEU=Gibt die Zeilennummer an.;
                           ENU=Specifies the line number.];
                SourceExpr="Line No.";
                Visible=FALSE;
                Editable=FALSE;
                ImplicitType=Integer }

    { 1100000000;2;Field  ;
                Name=Field Value 1;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 1";
                CaptionClass=FieldCaptions[1];
                Visible=NoOfColumns >= 1;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(1,"Field Value 1");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(1,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(1);
                             END;

                ImplicitType=Text250 }

    { 1100000001;2;Field  ;
                Name=Field Value 2;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 2";
                CaptionClass=FieldCaptions[2];
                Visible=NoOfColumns >= 2;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(2,"Field Value 2");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(2,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(2);
                             END;

                ImplicitType=Text250 }

    { 1100000002;2;Field  ;
                Name=Field Value 3;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 3";
                CaptionClass=FieldCaptions[3];
                Visible=NoOfColumns >= 3;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(3,"Field Value 3");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(3,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(3);
                             END;

                ImplicitType=Text250 }

    { 1100000003;2;Field  ;
                Name=Field Value 4;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 4";
                CaptionClass=FieldCaptions[4];
                Visible=NoOfColumns >= 4;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(4,"Field Value 4");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(4,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(4);
                             END;

                ImplicitType=Text250 }

    { 1100000004;2;Field  ;
                Name=Field Value 5;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 5";
                CaptionClass=FieldCaptions[5];
                Visible=NoOfColumns >= 5;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(5,"Field Value 5");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(5,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(5);
                             END;

                ImplicitType=Text250 }

    { 1100000005;2;Field  ;
                Name=Field Value 6;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 6";
                CaptionClass=FieldCaptions[6];
                Visible=NoOfColumns >= 6;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(6,"Field Value 6");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(6,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(6);
                             END;

                ImplicitType=Text200 }

    { 1100000006;2;Field  ;
                Name=Field Value 7;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 7";
                CaptionClass=FieldCaptions[7];
                Visible=NoOfColumns >= 7;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(7,"Field Value 7");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(7,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(7);
                             END;

                ImplicitType=Text200 }

    { 1100000007;2;Field  ;
                Name=Field Value 8;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 8";
                CaptionClass=FieldCaptions[8];
                Visible=NoOfColumns >= 8;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(8,"Field Value 8");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(8,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(8);
                             END;

                ImplicitType=Text200 }

    { 1100000008;2;Field  ;
                Name=Field Value 9;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 9";
                CaptionClass=FieldCaptions[9];
                Visible=NoOfColumns >= 9;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(9,"Field Value 9");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(9,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(9);
                             END;

                ImplicitType=Text200 }

    { 1100000009;2;Field  ;
                Name=Field Value 10;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 10";
                CaptionClass=FieldCaptions[10];
                Visible=NoOfColumns >= 10;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(10,"Field Value 10");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(10,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(10);
                             END;

                ImplicitType=Text200 }

    { 1000000003;2;Field  ;
                Name=Field Value 11;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 11";
                CaptionClass=FieldCaptions[11];
                Visible=NoOfColumns >= 11;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(11,"Field Value 11");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(11,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(11);
                             END;

                ImplicitType=Text150 }

    { 1000000004;2;Field  ;
                Name=Field Value 12;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 12";
                CaptionClass=FieldCaptions[12];
                Visible=NoOfColumns >= 12;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(12,"Field Value 12");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(12,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(12);
                             END;

                ImplicitType=Text150 }

    { 1000000005;2;Field  ;
                Name=Field Value 13;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 13";
                CaptionClass=FieldCaptions[13];
                Visible=NoOfColumns >= 13;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(13,"Field Value 13");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(13,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(13);
                             END;

                ImplicitType=Text150 }

    { 1000000006;2;Field  ;
                Name=Field Value 14;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 14";
                CaptionClass=FieldCaptions[14];
                Visible=NoOfColumns >= 14;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(14,"Field Value 14");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(14,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(14);
                             END;

                ImplicitType=Text150 }

    { 1000000007;2;Field  ;
                Name=Field Value 15;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 15";
                CaptionClass=FieldCaptions[15];
                Visible=NoOfColumns >= 15;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(15,"Field Value 15");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(15,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(15);
                             END;

                ImplicitType=Text150 }

    { 1000000008;2;Field  ;
                Name=Field Value 16;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 16";
                CaptionClass=FieldCaptions[16];
                Visible=NoOfColumns >= 16;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(16,"Field Value 16");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(16,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(16);
                             END;

                ImplicitType=Text100 }

    { 1000000009;2;Field  ;
                Name=Field Value 17;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 17";
                CaptionClass=FieldCaptions[17];
                Visible=NoOfColumns >= 17;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(17,"Field Value 17");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(17,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(17);
                             END;

                ImplicitType=Text100 }

    { 1000000010;2;Field  ;
                Name=Field Value 18;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 18";
                CaptionClass=FieldCaptions[18];
                Visible=NoOfColumns >= 18;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(18,"Field Value 18");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(18,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(18);
                             END;

                ImplicitType=Text100 }

    { 1000000011;2;Field  ;
                Name=Field Value 19;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 19";
                CaptionClass=FieldCaptions[19];
                Visible=NoOfColumns >= 19;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(19,"Field Value 19");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(19,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(19);
                             END;

                ImplicitType=Text100 }

    { 1000000012;2;Field  ;
                Name=Field Value 20;
                AssistEdit=Yes;
                ToolTipML=[DEU=Gibt den Wert des konfigurierten Felds an.;
                           ENU=Specifies the value of the configured field.];
                SourceExpr="Field Value 20";
                CaptionClass=FieldCaptions[20];
                Visible=NoOfColumns >= 20;
                Editable=AllowEdit;
                OnValidate=BEGIN
                             UpdateFieldValue(20,"Field Value 20");
                           END;

                OnLookup=BEGIN
                           EXIT(LookupValue(20,Text));
                         END;

                OnAssistEdit=BEGIN
                               Assist(20);
                             END;

                ImplicitType=Text100 }

  }
  CODE
  {
    VAR
      Document@1000000010 : Record 6085590;
      DocCat@1160040002 : Record 6085575;
      CaptureMgt@1000000008 : Codeunit 6085576;
      WebClientMgt@6085575 : Codeunit 6085662;
      ShowMatchedQty@1000000001 : Boolean INDATASET;
      AllowEdit@1000000002 : Boolean INDATASET;
      IdentifierVisible@6085600 : Boolean;
      FieldCodes@1001 : ARRAY [20] OF Code[20];
      FieldCaptions@1000 : ARRAY [20] OF Text[250];
      xRecLineNo@6085573 : Integer;
      CurrLineNo@6085574 : Integer;
      NoOfColumns@6085577 : Integer INDATASET;
      ShowUOMTranslation@6085576 : Boolean INDATASET;

    [LineStart(2913)]
    PROCEDURE GetCaptions@1000000002();
    VAR
      Field@1000000003 : Record 6085580;
      Template@1000000001 : Record 6085579;
      I@1000000002 : Integer;
      AddField@1000 : Boolean;
    BEGIN
      CLEAR(FieldCodes);
      CLEAR(FieldCaptions);
      NoOfColumns := 0;

      Field.SETCURRENTKEY("Template No.",Type,"Sort Order");
      Field.SETRANGE("Template No.",Document."Template No.");
      Field.SETRANGE(Type,Field.Type::Line);
      IF Field.FINDSET THEN
        REPEAT
          AddField := TRUE;
          IF Document."File Type" = Document."File Type"::XML THEN BEGIN
            IF Field."Show Field" = Field."Show Field"::IfValue THEN
              IF NOT CaptureMgt.LineFieldHasAnyValues(Document,Field.Code) THEN
                AddField := FALSE;

            IF Field."Show Field" = Field."Show Field"::Never THEN
              AddField := FALSE;
          END;

          IF AddField THEN BEGIN
            I := I + 1;
            FieldCodes[I] := Field.Code;
            FieldCaptions[I] := Field."Field Name";
            NoOfColumns += 1;
          END;
        UNTIL (Field.NEXT = 0) OR (I = 20);

      FOR I := 1 TO 20 DO
        IF FieldCaptions[I] = '' THEN
          FieldCaptions[I] := '-';
    END;

    [LineStart(2945)]
    PROCEDURE SetDocument@1000000003(VAR NewDocument@1000000001 : Record 6085590;BuildTempLines@1000 : Boolean);
    VAR
      Value@1000000003 : Record 6085593;
      Template@1000000005 : Record 6085579;
      i@1000000000 : Integer;
      NoOfLines@1000000004 : Integer;
    BEGIN
      Document := NewDocument;
      ShowUOMTranslation := Document.GetSourceTableNo = DATABASE::Vendor;

      IF NOT DocCat.GET(Document."Document Category Code") THEN
        CLEAR(DocCat);

      DELETEALL;

      GetCaptions;

      IF BuildTempLines THEN
        Document.BuildTempLinesTable(Rec);

      CurrPage.UPDATE(FALSE);
    END;

    [LineStart(2961)]
    PROCEDURE GoToFirstLine@2();
    BEGIN
      IF FINDFIRST THEN;
    END;

    [LineStart(2964)]
    PROCEDURE UpdatePage@1000000000();
    BEGIN
      UpdateFieldValues;
    END;

    [LineStart(2967)]
    PROCEDURE UpdateFieldValues@1000000006();
    VAR
      Template@1000000002 : Record 6085579;
      Field@1000000000 : Record 6085580;
      i@1000000001 : Integer;
      Update@6085573 : Boolean;
    BEGIN
      IF CurrLineNo > 0 THEN // We store the line number OnAfterGetCurrRecord as the Rec point might be invalid in NAV2017 at the point of invocation (UpdatePage).
        Update := NOT GET("Document No.",CurrLineNo);

      "Field Value 1" := GetValueAsText(FieldCodes[1]);
      "Field Value 2" := GetValueAsText(FieldCodes[2]);
      "Field Value 3" := GetValueAsText(FieldCodes[3]);
      "Field Value 4" := GetValueAsText(FieldCodes[4]);
      "Field Value 5" := GetValueAsText(FieldCodes[5]);
      "Field Value 6" := GetValueAsText(FieldCodes[6]);
      "Field Value 7" := GetValueAsText(FieldCodes[7]);
      "Field Value 8" := GetValueAsText(FieldCodes[8]);
      "Field Value 9" := GetValueAsText(FieldCodes[9]);
      "Field Value 10" := GetValueAsText(FieldCodes[10]);
      "Field Value 11" := GetValueAsText(FieldCodes[11]);
      "Field Value 12" := GetValueAsText(FieldCodes[12]);
      "Field Value 13" := GetValueAsText(FieldCodes[13]);
      "Field Value 14" := GetValueAsText(FieldCodes[14]);
      "Field Value 15" := GetValueAsText(FieldCodes[15]);
      "Field Value 16" := GetValueAsText(FieldCodes[16]);
      "Field Value 17" := GetValueAsText(FieldCodes[17]);
      "Field Value 18" := GetValueAsText(FieldCodes[18]);
      "Field Value 19" := GetValueAsText(FieldCodes[19]);
      "Field Value 20" := GetValueAsText(FieldCodes[20]);

      AllowEdit := Document.Status = Document.Status::Open;

      IF WebClientMgt.IsWebClient AND Update THEN BEGIN
        DELETEALL;
        Document.BuildTempLinesTable(Rec);
        CurrPage.UPDATE(FALSE);
      END ELSE
        IF LineIsInserted("Document No.",CurrLineNo) THEN
          CurrPage.UPDATE(TRUE);
    END;

    [LineStart(3002)]
    LOCAL PROCEDURE LineIsInserted@1(DocumentNo@1001 : Code[20];LineNo@1002 : Integer) : Boolean;
    VAR
      TempDocumentLine@1000 : TEMPORARY Record 6085596;
    BEGIN
      TempDocumentLine.COPY(Rec,TRUE);
      EXIT(TempDocumentLine.GET(DocumentNo,LineNo));
    END;

    [LineStart(3006)]
    PROCEDURE GetValueAsText@1000000008(FieldCode@1000000000 : Code[20]) : Text[250];
    VAR
      Field@1000000001 : Record 6085580;
    BEGIN
      IF Field.GET(Document."Template No.",Field.Type::Line,FieldCode) THEN
        EXIT(CaptureMgt.GetValueAsText(Document."No.","Line No.",Field));
    END;

    [LineStart(3010)]
    PROCEDURE UpdateFieldValue@1000000007(ActiveFieldIndex@1000000003 : Integer;VAR NewValue@1000000000 : Text[250]);
    VAR
      Field@1000000004 : Record 6085580;
      Value@1000000002 : Record 6085593;
    BEGIN
      IF xRecLineNo <> 0 THEN BEGIN
        ManuallyInsertLine(xRecLineNo);
        xRecLineNo := 0;
      END;

      Field.GET(Document."Template No.",Field.Type::Line,FieldCodes[ActiveFieldIndex]);
      CaptureMgt.UpdateFieldValue(Document."No.","Page No.","Line No.",Field,NewValue,TRUE,TRUE);
      NewValue := GetValueAsText(FieldCodes[ActiveFieldIndex]);

      ValidateLine;
      IF MODIFY THEN;

      UpdatePage;
    END;

    [LineStart(3025)]
    PROCEDURE Assist@1000000011(ActiveFieldIndex@1000000001 : Integer);
    VAR
      TemplateFieldCard@6085573 : Page 6085586;
      Field@1000000000 : Record 6085580;
    BEGIN
      Field.GET(Document."Template No.",Field.Type::Line,FieldCodes[ActiveFieldIndex]);
      Field.SETRECFILTER;
      TemplateFieldCard.SetDocumentNo(Document."No.");
      TemplateFieldCard.SETTABLEVIEW(Field);
      TemplateFieldCard.RUN;
    END;

    [LineStart(3032)]
    PROCEDURE LookupValue@1000000004(ActiveFieldIndex@1000000001 : Integer;VAR Text@1000000002 : Text[1024]) : Boolean;
    VAR
      Field@1000000000 : Record 6085580;
      NewText@1000000003 : Text[1024];
    BEGIN
      Field.GET(Document."Template No.",Field.Type::Line,FieldCodes[ActiveFieldIndex]);
      NewText := CaptureMgt.LookupValue("Document No.",Field,"Line No.",Text);
      IF NewText <> '' THEN BEGIN
        Text := NewText;
        EXIT(TRUE);
      END;
    END;

    [LineStart(3040)]
    PROCEDURE GetMatchedQty@1000000005() : Decimal;
    VAR
      PurchDocMgt@1001 : Codeunit 6085709;
    BEGIN
      EXIT(PurchDocMgt.GetDocLineMatchedQty(Rec));
    END;

    [LineStart(3043)]
    PROCEDURE SetShowMatchedQty@1000000001(NewShowMatchedQty@1000000000 : Boolean);
    BEGIN
      ShowMatchedQty := NewShowMatchedQty;
    END;

    [LineStart(3046)]
    PROCEDURE ValidateLine@1160040000();
    VAR
      Template@1160040000 : Record 6085579;
    BEGIN
      IF Template.GET(Document."Template No.") AND (Template."Codeunit ID: Line Validation" <> 0) THEN
        CODEUNIT.RUN(Template."Codeunit ID: Line Validation",Rec)
      ELSE
        OK := TRUE;
    END;

    [LineStart(3052)]
    PROCEDURE HasLines@6085573() : Boolean;
    BEGIN
      IF COUNT = 0 THEN
        EXIT(FALSE)
      ELSE
        IF COUNT = 1 THEN BEGIN
          IF ("Field Value 1" = '') AND
            ("Field Value 2" = '') AND
            ("Field Value 3" = '') AND
            ("Field Value 4" = '') AND
            ("Field Value 5" = '') AND
            ("Field Value 6" = '') AND
            ("Field Value 7" = '') AND
            ("Field Value 8" = '') AND
            ("Field Value 9" = '') AND
            ("Field Value 10" = '') AND
            ("Field Value 11" = '') AND
            ("Field Value 12" = '') AND
            ("Field Value 13" = '') AND
            ("Field Value 14" = '') AND
            ("Field Value 15" = '') AND
            ("Field Value 16" = '') AND
            ("Field Value 17" = '') AND
            ("Field Value 18" = '') AND
            ("Field Value 19" = '') AND
            ("Field Value 20" = '')
          THEN
            EXIT(FALSE);
        END;
      EXIT(TRUE);
    END;

    BEGIN
    END.
  }
}

